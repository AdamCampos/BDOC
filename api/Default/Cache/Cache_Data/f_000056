(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{"+T9e":function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("mrSG"),o=i("IzEk"),s=i("ONOH"),r=i("Z9D8"),a=i("LUpO"),c=i("PoZZ"),l=i("d74k"),d=i("Ejbi"),u=i("W5cs"),h=i("gBNM"),_=i("UVhF"),f=i("zewe"),m=i("fXoL"),E=i("ofXK"),I=i("TLn4"),p=i("qx4N"),b=i("+qkj");function R(e,t){if(1&e&&m.Tb(0,"sda-loading-indicator",3),2&e){const e=m.lc();m.sc("message",e.OBJECT_DETAILS_LOADING)("centered",!0)}}function g(e,t){if(1&e&&(m.Yb(0,"div",4),m.Tb(1,"sda-form-controls",5),m.Xb()),2&e){const e=m.lc();m.Ib("object-details--fixed-height",e.relatedItemTabs.length>0),m.Eb(1),m.sc("form",e.form)("isEditable",!1)}}function O(e,t){if(1&e&&m.Tb(0,"sda-related-items-section",6),2&e){const e=m.lc();m.sc("tabs",e.relatedItemTabs)}}let v=(()=>{class e{constructor(e,t,i,n,o,s,r){this.formService=e,this.exceptionService=t,this.filterService=i,this.objectDetailsService=n,this.sdaTranslateService=o,this.changeDetection=s,this.configService=r,this.relatedItemTabs=[],this.initialized=!1,this.OBJECT_DETAILS_LOADING=this.sdaTranslateService.get("OBJECT_DETAILS_LOADING","Loading object details, please wait..."),this.OBJECT_DETAILS_ERROR=this.sdaTranslateService.get("INITIALISATION_ERROR","An error occurred whilst initializing"),this.showTodoListForm=!1}ngOnChanges(){this.getFormSubscription&&this.getFormSubscription.unsubscribe(),this.buildForm()}ngOnDestroy(){this.getFormSubscription&&this.getFormSubscription.unsubscribe()}buildForm(){try{this.id&&this.config&&(this.initialized=!1,this.getFormSubscription=this.formService.getForm(this.id,this.config,this.methodOBID,this.showTodoListForm).pipe(Object(o.a)(1)).subscribe(e=>{this.relatedItemTabs=[];const t=this.formService.filterDisplayItemsByDisplayType(e,"RelationshipMaintenance"),{filteredItems:i=[]}=t,o=Object(n.a)(t,["filteredItems"]);this.form=o,this.generateGridTabs(i),this.initialized=!0,this.changeDetection.detectChanges()}))}catch(e){const t=new r.a(e,this.OBJECT_DETAILS_ERROR,"ObjectDetailsComponent","buildForm");this.exceptionService.handleException(t)}}generateGridTabs(e){e.forEach(e=>{const t=e.navigation?new h.a(e.name,`Objects('${e.obid}')/${e.navigation}?$count=true`,this.config,void 0,e.obid,e.navigation):new h.a(e.name,void 0,this.config);t.isRowSelectable=!0,t.config=this.config,t.onCellClicked=e=>this.routeToDetailsView(e),this.relatedItemTabs.push(t)})}routeToDetailsView(e){this.objectDetailsService.showObjectDetailsForm(this.filterService.createLinkOdataQueryFilter(this.getDataSource(e),e.parentTab.parentOBID,e.parentTab.parentRelDef,void 0),e.object.OBID,this.configService.selectedQueryConfigs,e.parentTab.columnSetUID)}getDataSource(e){const t=new kendo.data.DataSource,i=new u.a,n=[new l.a(e.parentTab.state.sort[0].field,e.parentTab.state.sort[0].dir)];return t.filter(i),t.page=()=>e.parentTab.currentPageNumber,t.sort=()=>n,t}}return e.\u0275fac=function(t){return new(t||e)(m.Sb(_.a),m.Sb(a.a),m.Sb(c.a),m.Sb(f.a),m.Sb(d.a),m.Sb(m.h),m.Sb(s.a))},e.\u0275cmp=m.Mb({type:e,selectors:[["sda-object-details"]],inputs:{id:"id",config:"config",methodOBID:"methodOBID",showTodoListForm:"showTodoListForm"},features:[m.Cb],decls:3,vars:3,consts:[[3,"message","centered",4,"ngIf"],["class","object-details",3,"object-details--fixed-height",4,"ngIf"],[3,"tabs",4,"ngIf"],[3,"message","centered"],[1,"object-details"],[3,"form","isEditable"],[3,"tabs"]],template:function(e,t){1&e&&(m.Sc(0,R,1,2,"sda-loading-indicator",0),m.Sc(1,g,2,4,"div",1),m.Sc(2,O,1,1,"sda-related-items-section",2)),2&e&&(m.sc("ngIf",!t.initialized),m.Eb(1),m.sc("ngIf",t.initialized),m.Eb(1),m.sc("ngIf",t.initialized&&t.relatedItemTabs.length>0))},directives:[E.t,I.a,p.a,b.a],styles:[".object-details[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]{display:flex;flex:1;flex-direction:column;height:100%}.object-details[_ngcontent-%COMP%]{display:flex;flex:1 1 100%;flex-direction:column;border-bottom:1px solid #cad0d7}"]}),e})()},"+qkj":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("Ejbi"),o=i("fXoL"),s=i("7EHt"),r=i("HXFx");let a=(()=>{class e{constructor(e){this.sdaTranslateService=e,this.FORM_RELATED_ITEMS=this.sdaTranslateService.get("FORM_RELATED_ITEMS","Related Items")}}return e.\u0275fac=function(t){return new(t||e)(o.Sb(n.a))},e.\u0275cmp=o.Mb({type:e,selectors:[["sda-related-items-section"]],inputs:{tabs:"tabs"},decls:6,vars:5,consts:[["displayMode","flat"],[1,"related-items-panel",3,"expanded"],["collapsedHeight","38px","expandedHeight","38px"],[3,"tabs","openInfoMapInNewTab","showItemCount"]],template:function(e,t){1&e&&(o.Yb(0,"mat-accordion",0),o.Yb(1,"mat-expansion-panel",1),o.Yb(2,"mat-expansion-panel-header",2),o.Yb(3,"mat-panel-title"),o.Uc(4),o.Xb(),o.Xb(),o.Tb(5,"sda-tabbed-grid-view",3),o.Xb(),o.Xb()),2&e&&(o.Eb(1),o.sc("expanded",!0),o.Eb(3),o.Wc(" ",t.FORM_RELATED_ITEMS," "),o.Eb(1),o.sc("tabs",t.tabs)("openInfoMapInNewTab",!0)("showItemCount",!0))},directives:[s.a,s.c,s.g,s.h,r.a],styles:[".related-items-panel[_ngcontent-%COMP%]{border-radius:0!important;box-shadow:none!important}.related-items-panel.mat-expanded[_ngcontent-%COMP%]{overflow:visible;-webkit-animation:delay-overflow 1s;animation:delay-overflow 1s}.related-items-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{background-color:#ebedf0!important}.related-items-panel[_ngcontent-%COMP%]     .mat-expansion-panel-body{padding:0}.related-items-panel[_ngcontent-%COMP%]     sda-tabbed-grid-view{flex:none;height:auto}.related-items-panel[_ngcontent-%COMP%]     sda-tabbed-grid-view mat-tab-group{height:40vh;min-height:250px;border-top:1px solid #cad0d7}"]}),e})()},"1SLH":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("fXoL"),o=(i("R0Ic"),i("ofXK")),s=(i("YyRF"),i("tyNb"));let r=(()=>{let e=class{};return e.\u0275mod=n.Qb({type:e}),e.\u0275inj=n.Pb({factory:function(t){return new(t||e)},imports:[[o.c,s.k],s.k]}),e})()},"20dk":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t=!0,i=""){this.objectsToRefresh=e,this.refreshResultsGrid=t,this.origin=i}}},"2CD4":function(e,t,i){"use strict";i.d(t,"a",(function(){return _}));var n=i("qxoO"),o=i("zHoD"),s=i("8ihU"),r=i("IUya"),a=i("jNCI"),c=i("PEjJ"),l=i("20dk"),d=i("+eYH"),u=i("fXoL");const h=["filemanagement"];let _=(()=>{class e extends s.a{constructor(e,t){super(e),this.dataRefreshService=t,this.existingFilesColumnSet="CS_CopyToLocalColumnSet",this.mode=o.a.None,this.reviewObjects=[]}ngOnInit(){this.supportingInformationEditorModel=this.getData(),this.supportingInformationEditorModel&&this.reviewObjects.push(new d.a(this.supportingInformationEditorModel.parentOBID,"",this.supportingInformationEditorModel.config)),this.disableOkayButton()}ok(){this.fileManagementComponent.onFinish()}filesPendingForUploadOrDelete(){this.fileManagementComponent.disableFinishButton?this.disableOkayButton():this.enableOkayButton()}onUploadOrDeleteSuccess(e){e&&this.refreshAttachedFiles()}cancel(){this.refreshAttachedFiles()}refreshAttachedFiles(){const e=new r.a(!1);this.closeModal.next(e),this.dataRefreshService.refreshData(new l.a(this.reviewObjects,!1,"SDASupportingInformation"))}}return e.\u0275fac=function(t){return new(t||e)(u.Sb(a.a),u.Sb(c.a))},e.\u0275cmp=u.Mb({type:e,selectors:[["sda-supporting-information-editor"]],viewQuery:function(e,t){var i;1&e&&u.bd(h,!0),2&e&&u.Gc(i=u.ic())&&(t.fileManagementComponent=i.first)},features:[u.Bb],decls:2,vars:7,consts:[[3,"uploadMode","objects","columnSet","canDeleteFiles","showFooter","navigateBack","ignoreResRefsForNonDocs","filesPendingForUploadOrDelete","uploadOrDeleteSuccess"],["filemanagement",""]],template:function(e,t){1&e&&(u.Yb(0,"sda-file-management",0,1),u.hc("filesPendingForUploadOrDelete",(function(){return t.filesPendingForUploadOrDelete()}))("uploadOrDeleteSuccess",(function(e){return t.onUploadOrDeleteSuccess(e)})),u.Xb()),2&e&&u.sc("uploadMode",t.mode)("objects",t.reviewObjects)("columnSet",t.existingFilesColumnSet)("canDeleteFiles",!0)("showFooter",!1)("navigateBack",!1)("ignoreResRefsForNonDocs",!0)},directives:[n.a],styles:["[_nghost-%COMP%]{margin-bottom:10px}sda-searchbar[_ngcontent-%COMP%]{display:flex;max-width:670px;margin:auto;padding:20px 15px}sda-kendo-grid[_ngcontent-%COMP%]{height:calc(90vh - 240px)}"]}),e})()},"4xmA":function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("ofXK"),o=i("3Pt+"),s=i("NFeN"),r=i("7LiV"),a=i("dPl2"),c=i("Y+ZO"),l=i("xNYO"),d=i("K9v4"),u=i("Wbmx"),h=i("inpI"),_=i("PMIr"),f=i("YSVQ"),m=i("MX5F"),E=i("txXS"),I=i("GDd0"),p=i("sRnt"),b=i("C5TI"),R=i("P42K"),g=i("By7v"),O=i("fXoL");let v=(()=>{class e{}return e.\u0275mod=O.Qb({type:e}),e.\u0275inj=O.Pb({factory:function(t){return new(t||e)},providers:[g.a,R.a],imports:[[n.c,r.b,a.c,I.a,d.a,I.a,E.a,f.a,o.j,c.b,u.a,h.a,p.a,l.a,_.a,m.a,b.a,s.b]]}),e})()},By7v:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("lJxs"),o=i("J7mc"),s=i("ONOH"),r=i("fXoL");let a=(()=>{class e{constructor(e,t){this.dataService=e,this.configService=t}getDocumentReviewDetailsByDocument(e,t,i,o,s,r,a,c,l=!1,d="e1XmtlIssueStateREJECTED",u=this.configService.selectedCreateConfig){return this.dataService.get("GetDocumentReviewDetailsByDocument?DocumentOBID='"+e+"'&ColumnSetUID='"+t+"'&CreateTQMethodUID='"+i+"'&LaunchMarkupFromHyperlinkMethod='"+o+"'&LaunchMarkupFromSupportingInformationMethod='"+s+"'&ManageActionMarkupsMethodViewOnlyUID='"+r+"'&ManageDocumentMarkupsMethodViewOnlyUID='"+a+"'&ReviewMode=Intergraph.SPF.Server.API.ClientSupport.Types.QualityAssurance.DocumentReview.ReviewMode'"+c+"'&ExposeConsolidatorReview="+l+"&ActionRejectStatusParam='"+d+"'",u).pipe(Object(n.a)(e=>JSON.parse(e.value)))}getDocumentReviewDetailsByWorkflowStep(e,t,i,o,s,r,a,c,l,d,u,h,_,f,m="e1XmtlIssueStateREJECTED"){return this.dataService.get("GetDocumentReviewDetailsByWorkflowStep?WorkflowStepOBID='"+e+"'&ColumnSetUID='"+t+"'&CreateTQMethodUID='"+i+"'&CreateActionMethodUID='"+o+"'&UpdateActionMethodUID='"+s+"'&EditCommentMethodUID='"+r+"'&LaunchMarkupFromHyperlinkMethod='"+a+"'&LaunchMarkupFromSupportingInformationMethod='"+c+"'&ManageActionMarkupsMethodUID='"+l+"'&ManageActionMarkupsMethodViewOnlyUID='"+d+"'&ManageDocumentMarkupsMethodUID='"+u+"'&ManageActionRelatedItemsMethodUID='"+h+"'&ManageReviewOrCommentRelatedItemsMethodUID='"+_+"'&ReviewMode=Intergraph.SPF.Server.API.ClientSupport.Types.QualityAssurance.DocumentReview.ReviewMode'"+f+"'&ActionRejectStatusParam='"+m+"'",this.configService.selectedCreateConfig).pipe(Object(n.a)(e=>JSON.parse(e.value)))}completeDocumentReview(e,t){return this.dataService.post("CompleteDocumentReview",JSON.stringify({WorkflowStepOBID:e,IsConsolidator:t}),this.configService.selectedCreateConfig)}waiveDocumentReview(e){return this.dataService.post("WaiveDocumentReview",JSON.stringify({WorkflowStepOBID:e}),this.configService.selectedCreateConfig)}getSupportingInformationForObject(e,t){return this.dataService.post("GetSupportingInformationForObject",JSON.stringify({ObjectOBID:e,DocumentsToExclude:[t]}),this.configService.selectedCreateConfig)}}return e.\u0275fac=function(t){return new(t||e)(r.dc(o.a),r.dc(s.a))},e.\u0275prov=r.Ob({token:e,factory:e.\u0275fac}),e})()},C5TI:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("ofXK"),o=i("3Pt+"),s=i("dPl2"),r=i("K9v4"),a=i("Wbmx"),c=i("thHT"),l=i("inpI"),d=i("MX5F"),u=i("fXoL");let h=(()=>{class e{}return e.\u0275mod=u.Qb({type:e}),e.\u0275inj=u.Pb({factory:function(t){return new(t||e)},imports:[[n.c,s.c,r.a,o.j,a.a,l.a,d.a,c.a]]}),e})()},CRLB:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("ofXK"),o=i("NFeN"),s=i("83Gb"),r=i("vFAW"),a=i("fXoL");let c=(()=>{class e{}return e.\u0275mod=a.Qb({type:e}),e.\u0275inj=a.Pb({factory:function(t){return new(t||e)},imports:[[n.c,r.a,s.a,o.b]]}),e})(),l=(()=>{class e{}return e.\u0275mod=a.Qb({type:e}),e.\u0275inj=a.Pb({factory:function(t){return new(t||e)},imports:[[n.c,c]]}),e})()},IsVC:function(e,t,i){"use strict";i.d(t,"d",(function(){return n})),i.d(t,"h",(function(){return o})),i.d(t,"r",(function(){return s})),i.d(t,"p",(function(){return r})),i.d(t,"o",(function(){return a})),i.d(t,"b",(function(){return c})),i.d(t,"a",(function(){return l})),i.d(t,"c",(function(){return d})),i.d(t,"e",(function(){return u})),i.d(t,"i",(function(){return h})),i.d(t,"k",(function(){return _})),i.d(t,"f",(function(){return f})),i.d(t,"n",(function(){return m})),i.d(t,"m",(function(){return E})),i.d(t,"j",(function(){return I})),i.d(t,"l",(function(){return p})),i.d(t,"g",(function(){return b})),i.d(t,"q",(function(){return R})),i.d(t,"s",(function(){return g})),i.d(t,"t",(function(){return O}));const n="920602",o="927830",s="899595",r="909862",a="909867",c="928384",l="938799",d="909866",u="905384",h="955371",_="955364",f="995219",m="1075193",E="909957",I="1016009",p="1082261",b="955370",R="1193820",g="1193821",O="1194089"},K9v4:function(e,t,i){"use strict";i.d(t,"a",(function(){return M}));var n=i("ofXK"),o=i("3Pt+"),s=i("tyNb"),r=i("F+hv"),a=i("txXS"),c=i("Tfoa"),l=i("uD/B"),d=i("BLqR"),u=i("+T9e"),h=i("fXoL"),_=i("TLn4"),f=i("ue3H"),m=i("qx4N"),E=i("+qkj"),I=i("RY2J"),p=i("HDO1"),b=i("4dwF"),R=i("dLJk"),g=i("F8dI"),O=i("rrPm"),v=i("8OmR"),T=i("ltBE"),S=i("XwBL");let w=(()=>{class e{transform(e){return S.a.replaceUnderscore(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=h.Rb({name:"sdaFormatEntityType",type:e,pure:!0}),e})();var C=i("7Ihv");let M=(()=>{class e{}return e.\u0275mod=h.Qb({type:e}),e.\u0275inj=h.Pb({factory:function(t){return new(t||e)},imports:[[n.c,o.j,a.a,s.k,r.a,l.a,c.a]]}),e})();h.Nc(d.a,[n.q,n.r,n.s,n.t,n.A,n.w,n.x,n.y,n.z,n.u,n.v,o.F,o.u,o.E,o.c,o.v,o.y,o.a,o.B,o.C,o.x,o.p,o.q,o.A,o.l,o.k,o.w,o.b,o.d,o.s,o.t,o.r,s.l,s.h,s.j,s.i,s.n,_.a,f.a,m.a,E.a,u.a,d.a],[n.b,n.G,n.p,n.k,n.E,n.g,n.C,n.F,n.d,n.f,n.i,n.j,n.l,I.a,p.a,b.a,R.a,g.a,O.a,v.a,T.a,w,C.a])},KKdV:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(e){return e[e.ViewOnly=0]="ViewOnly",e[e.Review=1]="Review",e[e.Consolidate=2]="Consolidate",e[e.Compliance=3]="Compliance",e[e.Reconsolidate=4]="Reconsolidate",e[e.ViewOnlyExternal=5]="ViewOnlyExternal",e[e.Info=6]="Info",e}({})},KQs8:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t){this.config=e,this.parentOBID=t}}},P42K:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("LRne"),o=i("lJxs"),s=i("C4gn"),r=i("jNCI"),a=i("J7mc"),c=i("Ejbi"),l=i("ONOH"),d=i("fXoL");let u=(()=>{class e{constructor(e,t,i,n,o){this.dataService=e,this.configService=t,this.featureSetNavigationService=i,this.modalService=n,this.sdaTranslateService=o,this.REVIEW_NO_LONGER_AVAILABLE_FOR_EDITING=this.sdaTranslateService.get("REVIEW_NO_LONGER_AVAILABLE_FOR_EDITING","The review is no longer available for editing because the document review process has been completed. <BR/>You will now be returned to the To Do List.")}isReviewWorkflowEditable(e){return e&&e.obid?this.dataService.get(`Objects?$filter=Class eq '${e.entityType||"SPFWorkflowStep"}' and OBID eq '${e.obid}'&$select=SPFStepStatus`,this.configService.selectedCreateConfig,!0).pipe(Object(o.a)(e=>e[0]&&e[0].SPFStepStatus&&"RS"===e[0].SPFStepStatus)):Object(n.a)(!0)}navigateToToDoList(){this.featureSetNavigationService.navigateBack(!0)}reviewCompletedMessageAndEjectUser(){this.modalService.alert(this.REVIEW_NO_LONGER_AVAILABLE_FOR_EDITING).then(()=>{this.navigateToToDoList()})}}return e.\u0275fac=function(t){return new(t||e)(d.dc(a.a),d.dc(l.a),d.dc(s.a),d.dc(r.a),d.dc(c.a))},e.\u0275prov=d.Ob({token:e,factory:e.\u0275fac}),e})()},"QF+H":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},YSVQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("ofXK"),o=i("GDd0"),s=i("CRLB"),r=i("fXoL");let a=(()=>{class e{}return e.\u0275mod=r.Qb({type:e}),e.\u0275inj=r.Pb({factory:function(t){return new(t||e)},imports:[[n.c,s.a,o.a]]}),e})()},d74k:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t){this.field=e,this.dir=t}}},ltBE:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("fXoL");let o=(()=>{class e{transform(e,t,i){return e?i?e.filter(e=>e[t].toLowerCase().includes(i.toLowerCase())):e:[]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=n.Rb({name:"sdaFilter",type:e,pure:!0}),e})()},uxtN:function(e,t,i){"use strict";i.d(t,"a",(function(){return bi}));var n=i("fXoL"),o=i("F8JD"),s=i("4B5/"),r=i("m8I0"),a=i("KkJr"),c=i("WjcW"),l=i("qSfU"),d=i("wN6G"),u=i("LUpO"),h=i("C4gn"),_=i("c+03"),f=i("UwO9"),m=i("jNCI"),E=i("ti2P"),I=i("g++2"),p=i("/oMx"),b=i("7Ekh"),R=i("PEjJ"),g=i("HLw3"),O=i("Ejbi"),v=i("+eYH"),T=i("JrsU"),S=i("41Lq"),w=i("ONOH"),C=i("biIz"),M=i("QF+H"),D=i("KKdV"),A=i("P42K"),N=i("By7v"),P=i("lUp+"),y=i("ofXK"),U=i("N8M/");function B(e,t){if(1&e){const e=n.Zb();n.Yb(0,"button",12),n.hc("click",(function(){return n.Kc(e),n.lc(),n.Hc(5).toggle()})),n.Xb()}}function F(e,t){if(1&e){const e=n.Zb();n.Yb(0,"a",13),n.hc("click",(function(i){return n.Kc(e),t.$implicit.action(i)})),n.Uc(1),n.Xb()}if(2&e){const e=t.$implicit;n.Eb(1),n.Wc(" ",e.title," ")}}function L(e,t){if(1&e&&n.Tb(0,"i",18),2&e){const e=n.lc(2);n.tc("title",e.REVIEW_MARKUPS_REJECTED_ACTIONS_WARNING)}}function k(e,t){if(1&e&&(n.Yb(0,"div",14),n.Tb(1,"i",15),n.Yb(2,"p",16),n.Uc(3),n.Xb(),n.Sc(4,L,1,1,"i",17),n.Xb()),2&e){const e=n.lc();n.Eb(2),n.tc("title",e.REVIEW_ACTION_MARKUPS_IDENTIFIED_TOOLTIP),n.Eb(1),n.Wc(" ",e.REVIEW_ACTION_MARKUPS_IDENTIFIED," "),n.Eb(1),n.sc("ngIf",e.review.HasRejectedMarkupActions)}}function V(e,t){if(1&e&&(n.Yb(0,"span",19),n.Uc(1),n.Xb()),2&e){const e=n.lc();n.Eb(1),n.Wc(" ",e.REVIEW_DOCUMENT_REV_WARNING_TITLE," ")}}function x(e,t){if(1&e&&(n.Yb(0,"section",20),n.Yb(1,"ul",21),n.Yb(2,"li",22),n.Uc(3),n.Xb(),n.Yb(4,"li",22),n.Uc(5),n.Xb(),n.Xb(),n.Xb()),2&e){const e=t.$implicit;n.Eb(3),n.Wc("",e.key,": "),n.Eb(2),n.Vc(e.value)}}let W=(()=>{class e{constructor(e){this.sdaTranslateService=e,this.userCanManageMarkupLayers=!0,this.onManageMarkupLayers=new n.o,this.summaryItems=[],this.REVIEW_DOCUMENT_SUMMARY_TITLE=this.sdaTranslateService.get("REVIEW_DOCUMENT_SUMMARY_TITLE","Document Summary"),this.REVIEW_DOCUMENT_REV_WARNING_TITLE=this.sdaTranslateService.get("REVIEW_DOCUMENT_REV_WARNING_TITLE","Warning: The document has been revised. This is no longer the latest revision."),this.REVIEW_ACTION_MANAGE_LAYERS_BUTTON=this.sdaTranslateService.get("REVIEW_ACTION_MANAGE_LAYERS_BUTTON","Manage Layers"),this.REVIEW_ACTION_MARKUPS_IDENTIFIED=this.sdaTranslateService.get("REVIEW_ACTION_MARKUPS_IDENTIFIED","MARKUPS IDENTIFIED"),this.REVIEW_ACTION_MARKUPS_IDENTIFIED_TOOLTIP=this.sdaTranslateService.get("REVIEW_ACTION_MARKUPS_IDENTIFIED_TOOLTIP","Markups to be transmitted have been selected."),this.REVIEW_MARKUPS_REJECTED_ACTIONS_WARNING=this.sdaTranslateService.get("REVIEW_MARKUPS_REJECTED_ACTIONS_WARNING","One or more selected markup layers contain an action that is Rejected. If the markup layer is selected the review cannot be completed."),this.menuOptions=new Array}ngOnInit(){this.review.ColumnSetProperties.forEach(e=>{this.summaryItems.push(new T.a(e.DisplayName,e.Value))}),this.initialiseOverflowOptions()}initialiseOverflowOptions(){this.menuOptions=[],this.userCanManageMarkupLayers&&this.menuOptions.push({title:this.REVIEW_ACTION_MANAGE_LAYERS_BUTTON,action:()=>{this.onManageMarkupLayers.emit()}})}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(O.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-document-summary-view"]],inputs:{review:"review",mode:"mode",userCanManageMarkupLayers:"userCanManageMarkupLayers"},outputs:{onManageMarkupLayers:"onManageMarkupLayers"},decls:13,vars:7,consts:[[1,"doc-summary__header"],[1,"doc-summary__title"],["class","fa fa-ellipsis-v sda-button sda-button--clear doc-summary__title-button",3,"click",4,"ngIf"],[3,"closeOnAllClicks"],["overlay",""],[1,"sda-overlay-content-hook"],[1,"comp-overflow"],["class","comp-overflow__item",3,"click",4,"ngFor","ngForOf"],["class","doc-summary__bar",4,"ngIf"],[1,"doc-summary__body"],["class","doc-summary__item doc-summary__item--warning",4,"ngIf"],["class","doc-summary__inner",4,"ngFor","ngForOf"],[1,"fa","fa-ellipsis-v","sda-button","sda-button--clear","doc-summary__title-button",3,"click"],[1,"comp-overflow__item",3,"click"],[1,"doc-summary__bar"],["aria-hidden","true",1,"fa","fa-th","doc-summary__icon"],[1,"doc-summary__data","doc-summary__data--tooltip",3,"title"],["class","fa fa-exclamation-circle warning-icon","aria-hidden","true",3,"title",4,"ngIf"],["aria-hidden","true",1,"fa","fa-exclamation-circle","warning-icon",3,"title"],[1,"doc-summary__item","doc-summary__item--warning"],[1,"doc-summary__inner"],[1,"document-summary__ul"],[1,"doc-summary__item"]],template:function(e,t){1&e&&(n.Yb(0,"div",0),n.Yb(1,"h4",1),n.Uc(2),n.Xb(),n.Sc(3,B,1,0,"button",2),n.Yb(4,"sda-overlay",3,4),n.Yb(6,"div",5),n.Yb(7,"nav",6),n.Sc(8,F,2,1,"a",7),n.Xb(),n.Xb(),n.Xb(),n.Xb(),n.Sc(9,k,5,3,"div",8),n.Yb(10,"div",9),n.Sc(11,V,2,1,"span",10),n.Sc(12,x,6,2,"section",11),n.Xb()),2&e&&(n.Eb(2),n.Vc(t.REVIEW_DOCUMENT_SUMMARY_TITLE),n.Eb(1),n.sc("ngIf",(null==t.menuOptions?null:t.menuOptions.length)>0),n.Eb(1),n.sc("closeOnAllClicks",!0),n.Eb(4),n.sc("ngForOf",t.menuOptions),n.Eb(1),n.sc("ngIf",t.review.HasRelatedMarkups),n.Eb(2),n.sc("ngIf",t.review.RevUnderChangeInSameConfig),n.Eb(1),n.sc("ngForOf",t.summaryItems))},directives:[y.t,U.a,y.s],styles:["[_nghost-%COMP%]{flex-shrink:0;flex-direction:column;padding:15px 10px 30px;background-color:#fff;overflow-x:hidden;overflow-y:auto}.doc-summary__header[_ngcontent-%COMP%], [_nghost-%COMP%]{position:relative;display:flex;flex-grow:1}.doc-summary__header[_ngcontent-%COMP%]{align-items:flex-start}.doc-summary__title[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-grow:1;flex-direction:column;margin-bottom:15px;font-weight:500;line-height:1}.doc-summary__title-button[_ngcontent-%COMP%]{margin:0 0 8px;font-size:14px!important;padding-top:0;padding-bottom:0}.doc-summary__bar[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;margin:0 0 12px!important}.doc-summary__icon[_ngcontent-%COMP%]{flex-shrink:0;margin-right:5px}.doc-summary__data[_ngcontent-%COMP%]{font-size:13px;line-height:1;color:#515e6b}.doc-summary__data--tooltip[_ngcontent-%COMP%]{cursor:help;border-bottom:1px dotted #75d2ff}.doc-summary__inner[_ngcontent-%COMP%]:not(:first-child):not(:only-child), .doc-summary__list[_ngcontent-%COMP%]:not(:first-child):not(:only-child){margin-top:15px}.doc-summary__item[_ngcontent-%COMP%]{padding-right:40px;font-size:13px;font-weight:400}.doc-summary__item[_ngcontent-%COMP%]:first-child{margin-bottom:5px;font-weight:500;font-size:14px}.doc-summary__item--warning[_ngcontent-%COMP%]{margin-bottom:5px;color:#6e0a17;font-weight:500}"]}),e})();var Y=i("7LiV"),j=i("7zfz");function X(e,t){if(1&e){const e=n.Zb();n.Yb(0,"li",2),n.Yb(1,"a",3),n.hc("click",(function(){n.Kc(e);const i=t.$implicit;return n.lc().viewRendition(i)})),n.Tb(2,"i",4),n.Yb(3,"p",5),n.Uc(4),n.Xb(),n.Xb(),n.Xb()}if(2&e){const e=t.$implicit;n.Eb(4),n.Vc(e.DisplayName)}}let G=(()=>{class e{constructor(){this.onRenditionClicked=new n.o}viewRendition(e){this.onRenditionClicked.emit(new v.a(e.OBID,e.DisplayName,e.Config))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-rendition-summary-view"]],inputs:{childRenditions:"childRenditions"},outputs:{onRenditionClicked:"onRenditionClicked"},decls:2,vars:1,consts:[[1,"rendition-summary__list","clearfix"],["class","rendition-summary__item",4,"ngFor","ngForOf"],[1,"rendition-summary__item"],[1,"rendition-summary__link",3,"click"],["aria-hidden","true",1,"fa","fa-file","rendition-summary__icon"],[1,"rendition-summary__name"]],template:function(e,t){1&e&&(n.Yb(0,"ul",0),n.Sc(1,X,5,1,"li",1),n.Xb()),2&e&&(n.Eb(1),n.sc("ngForOf",t.childRenditions))},directives:[y.s],styles:[".rendition-summary__name[_ngcontent-%COMP%]{overflow-wrap:break-word;word-wrap:break-word;word-break:break-word}[_nghost-%COMP%]{position:relative;display:flex;flex-shrink:0;flex-grow:1;flex-direction:column;padding:1.5px 1px 3px;background-color:#fff;overflow-x:hidden;overflow-y:auto}.rendition-summary__header[_ngcontent-%COMP%]{display:flex;flex-grow:1;align-items:flex-start}.rendition-summary__body[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:row;background:#ebedf0;overflow:hidden}.rendition-summary__title[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-grow:1;flex-direction:column;margin-bottom:15px;font-weight:500;line-height:1}.rendition-summary__list[_ngcontent-%COMP%]{list-style:none}.rendition-summary__item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-top:5px;padding-left:0;overflow:hidden}.rendition-summary__item[_ngcontent-%COMP%]:first-child{margin-top:0}.rendition-summary__link[_ngcontent-%COMP%]{display:flex;flex:1;font-size:13px}.rendition-summary__link[_ngcontent-%COMP%]:hover{cursor:pointer}.rendition-summary__link--disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.rendition-summary__link--disabled[_ngcontent-%COMP%]   .rendition-summary__name[_ngcontent-%COMP%]{color:#333}.rendition-summary__icon[_ngcontent-%COMP%]{flex-shrink:0;margin-right:12px;color:#515e6b;font-size:16px}.rendition-summary__name[_ngcontent-%COMP%]{color:#0087c8}.rendition-summary__count[_ngcontent-%COMP%]{padding:1px 5px;font-size:12px;border:1px solid #000}.rendition-summary__count[_ngcontent-%COMP%]:not(:only-child):not(:first-child){margin-left:4px}.rendition-summary__title[_ngcontent-%COMP%]{padding-top:15px}"]}),e})();function K(e,t){if(1&e&&(n.Yb(0,"div",12),n.Tb(1,"i",13),n.Yb(2,"span",14),n.Uc(3),n.Xb(),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.tc("title",t.REVIEW_FILES_SUMMARY_COMMENTS_BUBBLE_TOOLTIP),n.Eb(3),n.Vc(e.Comments.length)}}function H(e,t){if(1&e&&(n.Yb(0,"div",12),n.Tb(1,"i",15),n.Yb(2,"span",14),n.Uc(3),n.Xb(),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.tc("title",t.REVIEW_FILES_SUMMARY_PRIMARY_ACTIONS_BUBBLE_TOOLTIP),n.Eb(3),n.Vc(e.PrimaryActions.length)}}function $(e,t){if(1&e&&(n.Yb(0,"div",12),n.Tb(1,"i",16),n.Yb(2,"span",14),n.Uc(3),n.Xb(),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.tc("title",t.REVIEW_FILES_SUMMARY_REFERENCE_ACTIONS_BUBBLE_TOOLTIP),n.Eb(3),n.Vc(e.ReferenceActions.length)}}function Q(e,t){if(1&e){const e=n.Zb();n.Yb(0,"li",6),n.Yb(1,"a",7),n.hc("click",(function(){n.Kc(e);const i=t.$implicit;return n.lc().viewFile(i)})),n.Tb(2,"i",8),n.Yb(3,"p",9),n.Uc(4),n.Xb(),n.Xb(),n.Yb(5,"div",10),n.Sc(6,K,4,2,"div",11),n.Sc(7,H,4,2,"div",11),n.Sc(8,$,4,2,"div",11),n.Xb(),n.Xb()}if(2&e){const e=t.$implicit;n.Eb(1),n.Ib("file-summary__link--disabled",!e.IsViewable),n.Eb(3),n.Vc(e.Name),n.Eb(2),n.sc("ngIf",e.Comments.length>=1),n.Eb(1),n.sc("ngIf",e.PrimaryActions.length>=1),n.Eb(1),n.sc("ngIf",e.ReferenceActions.length>=1)}}function z(e,t){1&e&&n.Tb(0,"div")}function J(e,t){if(1&e){const e=n.Zb();n.Yb(0,"p-accordionTab",22),n.Yb(1,"p-header",23),n.Uc(2),n.Xb(),n.Yb(3,"sda-rendition-summary-view",24,20),n.hc("onRenditionClicked",(function(t){return n.Kc(e),n.lc(3).viewRendition(t)})),n.Xb(),n.Xb()}if(2&e){const e=n.lc().$implicit,t=n.lc(2);n.sc("selected",e.OBID===t.renditions[0].OBID),n.Eb(2),n.Wc(" ",e.DisplayName," "),n.Eb(1),n.sc("childRenditions",e.Relationships)}}function Z(e,t){if(1&e){const e=n.Zb();n.Yb(0,"sda-rendition-summary-view",25),n.hc("onRenditionClicked",(function(t){return n.Kc(e),n.lc(3).viewRendition(t)})),n.Xb()}if(2&e){const e=n.lc().$implicit;n.sc("childRenditions",e.Relationships)}}function q(e,t){if(1&e&&(n.Yb(0,"div"),n.Sc(1,z,1,0,"div",19),n.Sc(2,J,5,3,"ng-template",null,20,n.Tc),n.Sc(4,Z,1,1,"ng-template",null,21,n.Tc),n.Xb()),2&e){const e=t.$implicit,i=n.Hc(3),o=n.Hc(5);n.Eb(1),n.sc("ngIf",(null==e.Relationships?null:e.Relationships.length)>0&&(null==e.DisplayName?null:e.DisplayName.length)>0)("ngIfThen",i)("ngIfElse",o)}}function ee(e,t){if(1&e&&(n.Yb(0,"div",17),n.Yb(1,"h4",1),n.Uc(2),n.Xb(),n.Yb(3,"p-accordion"),n.Sc(4,q,6,3,"div",18),n.Xb(),n.Xb()),2&e){const e=n.lc();n.Eb(2),n.Vc(e.REVIEW_RENDITIONS_SUMMARY_TITLE),n.Eb(2),n.sc("ngForOf",e.renditions)}}let te=(()=>{class e{constructor(e){this.sdaTranslateService=e,this.onFileClicked=new n.o,this.onRenditionClicked=new n.o,this.REVIEW_FILES_SUMMARY_TITLE=this.sdaTranslateService.get("REVIEW_FILES_SUMMARY_TITLE","Files"),this.REVIEW_RENDITIONS_SUMMARY_TITLE=this.sdaTranslateService.get("REVIEW_RENDITIONS_SUMMARY_TITLE","Renditions"),this.REVIEW_FILES_SUMMARY_PRIMARY_ACTIONS_BUBBLE_TOOLTIP=this.sdaTranslateService.get("REVIEW_FILES_SUMMARY_PRIMARY_ACTIONS_BUBBLE_TOOLTIP","Primary Actions"),this.REVIEW_FILES_SUMMARY_COMMENTS_BUBBLE_TOOLTIP=this.sdaTranslateService.get("REVIEW_FILES_SUMMARY_COMMENTS_BUBBLE_TOOLTIP","Comments"),this.REVIEW_FILES_SUMMARY_REFERENCE_ACTIONS_BUBBLE_TOOLTIP=this.sdaTranslateService.get("REVIEW_FILES_SUMMARY_REFERENCE_ACTIONS_BUBBLE_TOOLTIP","Reference Actions")}viewFile(e){e.IsViewable&&this.onFileClicked.emit(new v.a(e.OBID,e.Name,this.config))}viewRendition(e){this.onRenditionClicked.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(O.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-files-summary-view"]],inputs:{files:"files",renditions:"renditions",config:"config"},outputs:{onFileClicked:"onFileClicked",onRenditionClicked:"onRenditionClicked"},decls:7,vars:3,consts:[[1,"file-summary__header"],[1,"file-summary__title"],[1,"file-summary__body"],[1,"file-summary__list"],["class","file-summary__item",4,"ngFor","ngForOf"],["class","rendition-summary__title",4,"ngIf"],[1,"file-summary__item"],[1,"file-summary__link",3,"click"],["aria-hidden","true",1,"fa","fa-file","file-summary__icon"],[1,"file-summary__name"],[1,"file-summary__count-wrapper","feedback-wrapper"],["class","feedback-item",3,"title",4,"ngIf"],[1,"feedback-item",3,"title"],["aria-hidden","true",1,"fa","fa-comment-o","feedback-item__icon","feedback-item__icon--comments"],[1,"feedback-item__data"],["aria-hidden","true",1,"fa","fa-commenting","feedback-item__icon","feedback-item__icon--actions"],["aria-hidden","true",1,"fa","fa-commenting-o","feedback-item__icon","feedback-item__icon--actions"],[1,"rendition-summary__title"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfThen","ngIfElse"],["withTab",""],["withOutTab",""],[3,"selected"],[1,"rendition-accordion__header"],[3,"childRenditions","onRenditionClicked"],["id","rendition-without-tab",3,"childRenditions","onRenditionClicked"]],template:function(e,t){1&e&&(n.Yb(0,"div",0),n.Yb(1,"h4",1),n.Uc(2),n.Xb(),n.Xb(),n.Yb(3,"div",2),n.Yb(4,"ul",3),n.Sc(5,Q,9,6,"li",4),n.Xb(),n.Xb(),n.Sc(6,ee,5,2,"div",5)),2&e&&(n.Eb(2),n.Vc(t.REVIEW_FILES_SUMMARY_TITLE),n.Eb(3),n.sc("ngForOf",t.files),n.Eb(1),n.sc("ngIf",t.renditions&&t.renditions.length>0))},directives:[y.s,y.t,Y.a,Y.c,j.b,G],styles:[".file-summary__name[_ngcontent-%COMP%]{overflow-wrap:break-word;word-wrap:break-word;word-break:break-word}[_nghost-%COMP%]{position:relative;display:flex;flex-shrink:0;flex-grow:1;flex-direction:column;padding:15px 10px 30px;background-color:#fff;overflow-x:hidden;overflow-y:auto}.file-summary__header[_ngcontent-%COMP%]{display:flex;flex-grow:1;align-items:flex-start}.file-summary__title[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-grow:1;flex-direction:column;margin-bottom:15px;font-weight:500;line-height:1}.file-summary__list[_ngcontent-%COMP%]{list-style:none}.file-summary__item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-top:5px;padding-left:0;overflow:hidden}.file-summary__item[_ngcontent-%COMP%]:first-child{margin-top:0}.file-summary__link[_ngcontent-%COMP%]{display:flex;flex:1;font-size:13px}.file-summary__link[_ngcontent-%COMP%]:hover{cursor:pointer}.file-summary__link--disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.8}.file-summary__link--disabled[_ngcontent-%COMP%]   .file-summary__name[_ngcontent-%COMP%]{color:#333}.file-summary__icon[_ngcontent-%COMP%]{flex-shrink:0;margin-right:12px;color:#515e6b;font-size:16px}.file-summary__name[_ngcontent-%COMP%]{color:#0087c8}.file-summary__count[_ngcontent-%COMP%]{padding:1px 5px;font-size:12px;border:1px solid #000}.file-summary__count[_ngcontent-%COMP%]:not(:only-child):not(:first-child){margin-left:4px}.rendition-summary__title[_ngcontent-%COMP%]{padding-top:15px}.rendition-accordion__header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between}.rendition-accordion__header__text[_ngcontent-%COMP%]{font-weight:500;font-size:13px;color:#003a55;text-transform:uppercase}"]}),e})();var ie=i("dPl2");function ne(e,t){if(1&e&&(n.Yb(0,"div",12),n.Tb(1,"i",13),n.Yb(2,"span",14),n.Uc(3),n.Xb(),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.tc("title",t.REVIEW_REVIEWERS_SUMMARY_PRIMARY_COMMENTS_BUBBLE_TOOLTIP),n.Eb(3),n.Vc(t.getPrimaryCommentCountForUser(e))}}function oe(e,t){if(1&e&&(n.Yb(0,"div",12),n.Tb(1,"i",15),n.Yb(2,"span",14),n.Uc(3),n.Xb(),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.tc("title",t.REVIEW_REVIEWERS_SUMMARY_REFERENCE_COMMENTS_BUBBLE_TOOLTIP),n.Eb(3),n.Vc(t.getReferenceCommentCountForUser(e))}}function se(e,t){if(1&e&&(n.Yb(0,"div",12),n.Tb(1,"i",16),n.Yb(2,"span",14),n.Uc(3),n.Xb(),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.tc("title",t.REVIEW_REVIEWERS_SUMMARY_PRIMARY_ACTIONS_BUBBLE_TOOLTIP),n.Eb(3),n.Vc(t.getPrimaryActionCountForUser(e))}}function re(e,t){if(1&e&&(n.Yb(0,"div",12),n.Tb(1,"i",17),n.Yb(2,"span",14),n.Uc(3),n.Xb(),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.tc("title",t.REVIEW_REVIEWERS_SUMMARY_REFERENCE_ACTIONS_BUBBLE_TOOLTIP),n.Eb(3),n.Vc(t.getReferenceActionCountForUser(e))}}function ae(e,t){if(1&e&&(n.Yb(0,"div",1),n.Yb(1,"div",2),n.kc(),n.Yb(2,"svg",3),n.Yb(3,"title"),n.Uc(4),n.Xb(),n.Tb(5,"circle",4),n.Tb(6,"path",5),n.Xb(),n.Xb(),n.jc(),n.Yb(7,"div",6),n.Yb(8,"div",7),n.Yb(9,"h6",8),n.Uc(10),n.Xb(),n.Xb(),n.Yb(11,"div",9),n.Yb(12,"div",10),n.Sc(13,ne,4,2,"div",11),n.Sc(14,oe,4,2,"div",11),n.Sc(15,se,4,2,"div",11),n.Sc(16,re,4,2,"div",11),n.Xb(),n.Xb(),n.Xb(),n.Xb()),2&e){const e=t.$implicit,i=n.lc();n.Eb(1),n.tc("title",i.QA_DOCUMENT_REVIEW_CONTRIBUTOR_ICON),n.Eb(3),n.Vc(i.QA_DOCUMENT_REVIEW_CONTRIBUTOR_ICON),n.Eb(6),n.Vc(e.DisplayName),n.Eb(3),n.sc("ngIf",i.getPrimaryCommentCountForUser(e)>0),n.Eb(1),n.sc("ngIf",i.getReferenceCommentCountForUser(e)>0),n.Eb(1),n.sc("ngIf",i.getPrimaryActionCountForUser(e)>0),n.Eb(1),n.sc("ngIf",i.getReferenceActionCountForUser(e)>0)}}let ce=(()=>{class e{constructor(e){this.sdaTranslateService=e,this.REVIEW_REVIEWERS_SUMMARY_PRIMARY_ACTIONS_BUBBLE_TOOLTIP=this.sdaTranslateService.get("REVIEW_REVIEWERS_SUMMARY_PRIMARY_ACTIONS_BUBBLE_TOOLTIP","Primary Actions"),this.REVIEW_REVIEWERS_SUMMARY_PRIMARY_COMMENTS_BUBBLE_TOOLTIP=this.sdaTranslateService.get("REVIEW_REVIEWERS_SUMMARY_PRIMARY_COMMENTS_BUBBLE_TOOLTIP","Primary Comments"),this.QA_DOCUMENT_REVIEW_CONTRIBUTOR_ICON=this.sdaTranslateService.get("QA_DOCUMENT_REVIEW_CONTRIBUTOR_ICON","Document Review Contributor"),this.REVIEW_REVIEWERS_SUMMARY_REFERENCE_ACTIONS_BUBBLE_TOOLTIP=this.sdaTranslateService.get("REVIEW_REVIEWERS_SUMMARY_REFERENCE_ACTIONS_BUBBLE_TOOLTIP","Reference Actions"),this.REVIEW_REVIEWERS_SUMMARY_REFERENCE_COMMENTS_BUBBLE_TOOLTIP=this.sdaTranslateService.get("REVIEW_REVIEWERS_SUMMARY_REFERENCE_COMMENTS_BUBBLE_TOOLTIP","Reference Comments")}getPrimaryCommentCountForUser(e){return this.primaryComments?this.primaryComments.filter(t=>t.UserOBID===e.OBID).length:0}getPrimaryActionCountForUser(e){return this.primaryActions?this.primaryActions.filter(t=>t.UserOBID===e.OBID).length:0}getReferenceCommentCountForUser(e){return this.referenceComments?this.referenceComments.filter(t=>t.UserOBID===e.OBID).length:0}getReferenceActionCountForUser(e){return this.referenceActions?this.referenceActions.filter(t=>t.UserOBID===e.OBID).length:0}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(O.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-contributors-summary-view"]],inputs:{contributors:"contributors",primaryComments:"primaryComments",primaryActions:"primaryActions",referenceComments:"referenceComments",referenceActions:"referenceActions"},decls:1,vars:1,consts:[["class","contributors__reviewer",4,"ngFor","ngForOf"],[1,"contributors__reviewer"],[1,"contributors__indicator",3,"title"],["width","18","height","18","viewBox","0 0 24 24",1,"contributors__user-icon"],["cx","11.9","cy","7.8","r","4.8"],["d","M11.9,14.9c-3.3,0-10,1.6-10,4.8V21c0,0.6,0.5,1,1.1,1h17.9c0.6,0,1.1-0.4,1.1-1v-1.4C21.9,16.5,15.3,14.9,11.9,14.9z"],[1,"contributors__details"],[1,"contributors__name-container"],[1,"contributors__name"],[1,"contributors__date-container"],[1,"contributors__comment-count"],["class","feedback-item",3,"title",4,"ngIf"],[1,"feedback-item",3,"title"],["aria-hidden","true",1,"fa","fa-comment","feedback-item__icon","feedback-item__icon--primary-comments"],[1,"feedback-item__data"],["aria-hidden","true",1,"fa","fa-comment-o","feedback-item__icon","feedback-item__icon--reference-comments"],["aria-hidden","true",1,"fa","fa-commenting","feedback-item__icon","feedback-item__icon--primary-actions"],["aria-hidden","true",1,"fa","fa-commenting-o","feedback-item__icon","feedback-item__icon--reference-actions"]],template:function(e,t){1&e&&n.Sc(0,ae,17,7,"div",0),2&e&&n.sc("ngForOf",t.contributors)},directives:[y.s,y.t],styles:[".contributors__name-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;height:20px}.contributors__name[_ngcontent-%COMP%]{height:100%;justify-content:center;font-size:14px;font-weight:500}.contributors__reviewer[_ngcontent-%COMP%]{position:relative;display:flex;padding:10px;border-bottom:1px solid #dbe0e4}.contributors__reviewer[_ngcontent-%COMP%]:last-child{border-bottom:none}.contributors__indicator[_ngcontent-%COMP%]{width:28px}.contributors__user-icon[_ngcontent-%COMP%]{color:#515e6b;font-size:18px}.contributors__details[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column}.contributors__date-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:5px}.contributors__date[_ngcontent-%COMP%]{margin-right:15px;font-size:12px;color:#515e6b}.contributors__comment-count[_ngcontent-%COMP%]{display:flex;flex:1}"]}),e})();var le=i("+T9e"),de=i("Z9D8");class ue{constructor(e,t,i,n){this.reviewer=e,this.review=t,this.referenceActions=i,this.primaryActions=n}}var he=i("NFeN"),_e=i("F8dI");function fe(e,t){if(1&e&&(n.Yb(0,"div",20),n.Tb(1,"mat-icon",21),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.Ib("reviewer__icon--you",e.reviewer.IsCurrentUser),n.sc("title",t.QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON)}}function me(e,t){if(1&e&&(n.Yb(0,"div",20),n.Tb(1,"mat-icon",22),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.Ib("reviewer__icon--you",e.reviewer.IsCurrentUser),n.sc("title",t.QA_DOCUMENT_REVIEW_REVIEWER_ICON)}}function Ee(e,t){1&e&&n.Tb(0,"i",23)}function Ie(e,t){1&e&&n.Tb(0,"i",24)}function pe(e,t){if(1&e&&(n.Yb(0,"span",25),n.Uc(1),n.Xb()),2&e){const e=n.lc(2);n.Eb(1),n.Wc(" ",e.YOU," ")}}function be(e,t){if(1&e){const e=n.Zb();n.Yb(0,"i",26),n.hc("click",(function(){n.Kc(e);const t=n.lc().$implicit;return n.lc().signOffReview(t)})),n.Xb()}if(2&e){const e=n.lc(2);n.sc("title",e.REVIEW_REVIEWERS_SUMMARY_SIGNED_OFF_BUTTON_STATE_SIGNOFF_TOOLTIP)}}function Re(e,t){if(1&e){const e=n.Zb();n.Yb(0,"i",27),n.hc("click",(function(){n.Kc(e);const t=n.lc().$implicit;return n.lc().undoSignOffReview(t)})),n.Xb()}if(2&e){const e=n.lc(2);n.sc("title",e.REVIEW_REVIEWERS_SUMMARY_SIGNED_OFF_BUTTON_STATE_SIGNEDOFF_TOOLTIP)}}function ge(e,t){if(1&e&&(n.Yb(0,"p",28),n.Uc(1),n.mc(2,"sdaConvertToLocalDateTime"),n.Xb()),2&e){const e=n.lc().$implicit;n.Eb(1),n.Wc(" ",n.nc(2,1,e.review.ModifiedDate)," ")}}function Oe(e,t){if(1&e&&(n.Yb(0,"p",28),n.Uc(1),n.Xb()),2&e){const e=n.lc(2);n.Eb(1),n.Wc(" ",e.REVIEW_REVIEWERS_SUMMARY_IN_REVIEW," ")}}function ve(e,t){if(1&e&&(n.Yb(0,"div",29),n.Tb(1,"i",30),n.Yb(2,"span",31),n.Uc(3),n.Xb(),n.Xb()),2&e){const e=n.lc().$implicit;n.Eb(3),n.Vc(e.primaryActions.length)}}function Te(e,t){if(1&e&&(n.Yb(0,"div",29),n.Tb(1,"i",32),n.Yb(2,"span",31),n.Uc(3),n.Xb(),n.Xb()),2&e){const e=n.lc().$implicit;n.Eb(3),n.Vc(e.referenceActions.length)}}function Se(e,t){if(1&e&&(n.Yb(0,"li",33),n.Uc(1),n.Xb()),2&e){const e=t.$implicit;n.Eb(1),n.Wc(" ",e," ")}}function we(e,t){if(1&e&&(n.Yb(0,"div",1),n.Yb(1,"div",2),n.Sc(2,fe,2,3,"div",3),n.Sc(3,me,2,3,"div",3),n.Sc(4,Ee,1,0,"i",4),n.Sc(5,Ie,1,0,"i",5),n.Xb(),n.Yb(6,"div",6),n.Yb(7,"div",7),n.Yb(8,"h6",8),n.Uc(9),n.Sc(10,pe,2,1,"span",9),n.Xb(),n.Yb(11,"div",10),n.Sc(12,be,1,1,"i",11),n.Sc(13,Re,1,1,"i",12),n.Xb(),n.Xb(),n.Yb(14,"div",13),n.Sc(15,ge,3,3,"p",14),n.Sc(16,Oe,2,1,"p",14),n.Yb(17,"div",15),n.Sc(18,ve,4,1,"div",16),n.Xb(),n.Yb(19,"div",15),n.Sc(20,Te,4,1,"div",16),n.Xb(),n.Xb(),n.Yb(21,"div",17),n.Yb(22,"ul",18),n.Sc(23,Se,2,1,"li",19),n.Xb(),n.Xb(),n.Xb(),n.Xb()),2&e){const e=t.$implicit,i=n.lc();n.Eb(2),n.sc("ngIf",e.reviewer.IsConsolidator),n.Eb(1),n.sc("ngIf",!e.reviewer.IsConsolidator),n.Eb(1),n.sc("ngIf",e.review&&e.review.IsCompleted),n.Eb(1),n.sc("ngIf",e.review&&e.review.IsWaived),n.Eb(4),n.Wc(" ",e.reviewer.DisplayName," "),n.Eb(1),n.sc("ngIf",e.reviewer.IsCurrentUser),n.Eb(2),n.sc("ngIf",2===i.mode&&!e.reviewer.IsCurrentUser&&e.review&&!e.review.IsWaived&&!e.review.HasReviewBeenConsolidated),n.Eb(1),n.sc("ngIf",2===i.mode&&!e.reviewer.IsCurrentUser&&e.review&&!e.review.IsWaived&&e.review.HasReviewBeenConsolidated),n.Eb(2),n.sc("ngIf",e.review),n.Eb(1),n.sc("ngIf",!e.review),n.Eb(1),n.sc("title",i.REVIEW_REVIEWERS_SUMMARY_PRIMARY_ACTIONS_BUBBLE_TOOLTIP),n.Eb(1),n.sc("ngIf",e.primaryActions&&e.primaryActions.length>0),n.Eb(1),n.sc("title",i.REVIEW_REVIEWERS_SUMMARY_REFERENCE_ACTIONS_BUBBLE_TOOLTIP),n.Eb(1),n.sc("ngIf",e.referenceActions&&e.referenceActions.length>0),n.Eb(3),n.sc("ngForOf",e.reviewer.Disciplines)}}function Ce(e,t){if(1&e&&(n.Yb(0,"div",20),n.Tb(1,"mat-icon",21),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.Ib("reviewer__icon--you",e.IsCurrentUser),n.sc("title",t.QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON)}}function Me(e,t){if(1&e&&(n.Yb(0,"div",20),n.Tb(1,"mat-icon",22),n.Xb()),2&e){const e=n.lc(2);n.sc("title",e.QA_DOCUMENT_REVIEW_REVIEWER_ICON)}}function De(e,t){if(1&e&&(n.Yb(0,"div",1),n.Yb(1,"div",2),n.Sc(2,Ce,2,3,"div",3),n.Sc(3,Me,2,1,"div",34),n.Xb(),n.Yb(4,"div",6),n.Yb(5,"div",7),n.Yb(6,"h6",8),n.Uc(7),n.Xb(),n.Xb(),n.Yb(8,"div",13),n.Yb(9,"p",28),n.Uc(10),n.Xb(),n.Xb(),n.Xb(),n.Xb()),2&e){const e=t.$implicit,i=n.lc();n.Eb(2),n.sc("ngIf",e.IsConsolidator),n.Eb(1),n.sc("ngIf",!e.IsConsolidator),n.Eb(4),n.Wc(" ",e.DisplayName," "),n.Eb(3),n.Wc(" ",i.REVIEW_REVIEWERS_SUMMARY_NOT_STARTED," ")}}let Ae=(()=>{class e{constructor(e,t,i,n){this.notificationService=e,this.exceptionService=t,this.crudService=i,this.sdaTranslateService=n,this.reviewsByUser=new Array,this.REVIEW_REVIEWERS_SUMMARY_SIGNED_OFF_BUTTON_STATE_SIGNOFF_TOOLTIP=this.sdaTranslateService.get("REVIEW_REVIEWERS_SUMMARY_SIGNED_OFF_BUTTON_STATE_SIGNOFF_TOOLTIP","Sign off this review"),this.REVIEW_REVIEWERS_SUMMARY_SIGNED_OFF_BUTTON_STATE_SIGNEDOFF_TOOLTIP=this.sdaTranslateService.get("REVIEW_REVIEWERS_SUMMARY_SIGNED_OFF_BUTTON_STATE_SIGNEDOFF_TOOLTIP","This review is signed off. Click to reopen."),this.REVIEW_REVIEWERS_SUMMARY_PRIMARY_ACTIONS_BUBBLE_TOOLTIP=this.sdaTranslateService.get("REVIEW_REVIEWERS_SUMMARY_PRIMARY_ACTIONS_BUBBLE_TOOLTIP","Primary Actions"),this.REVIEW_REVIEWERS_SUMMARY_REFERENCE_ACTIONS_BUBBLE_TOOLTIP=this.sdaTranslateService.get("REVIEW_REVIEWERS_SUMMARY_REFERENCE_ACTIONS_BUBBLE_TOOLTIP","Reference Actions"),this.REVIEW_REVIEWERS_SUMMARY_NOT_STARTED=this.sdaTranslateService.get("REVIEW_REVIEWERS_SUMMARY_NOT_STARTED","Review not started"),this.REVIEW_REVIEWERS_SUMMARY_IN_REVIEW=this.sdaTranslateService.get("REVIEW_REVIEWERS_SUMMARY_IN_REVIEW","In Review"),this.YOU=this.sdaTranslateService.get("YOU","You"),this.QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON=this.sdaTranslateService.get("QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON","Document Review Consolidator"),this.QA_DOCUMENT_REVIEW_REVIEWER_ICON=this.sdaTranslateService.get("QA_DOCUMENT_REVIEW_REVIEWER_ICON","Document Reviewer"),this.REVIEW_REVIEWERS_SUMMARY_SIGN_OFF_BUTTON=this.sdaTranslateService.get("REVIEW_REVIEWERS_SUMMARY_SIGN_OFF_BUTTON","SIGN OFF"),this.REVIEW_REVIEWERS_SUMMARY_SIGNED_OFF_BUTTON=this.sdaTranslateService.get("REVIEW_REVIEWERS_SUMMARY_SIGNED_OFF_BUTTON","SIGNED OFF")}ngOnInit(){this.reviewers.forEach(e=>{const t=this.reviews.filter(t=>t.UserOBID===e.OBID),i=this.referenceActions.filter(t=>t.UserOBID===e.OBID),n=this.primaryActions.filter(t=>t.UserOBID===e.OBID);if(t&&1===t.length)t[0].IsConsolidatedReview&&(e.IsConsolidator=!0),this.addReviewSummary(new ue(e,t[0],i,n));else{if(t&&t.length>1)throw new de.a(void 0,this.sdaTranslateService.getFormatted("REVIEW_REVIEWERS_SUMMARY_MULTIPLE_REVIEWS_EXCEPTION-USER_NAME","More than one review was found for reviewer {0}",[e.DisplayName]));this.addReviewSummary(new ue(e,void 0,i,n))}})}signOffReview(e){e&&this.save(e,!0)}undoSignOffReview(e){e&&this.save(e,!1)}save(e,t){if(e.review){const i=new c.a(void 0);i.properties.push(new l.a("SCLBProjComsReviewHasBeenConsolidated",t)),this.crudService.update(e.review.OBID,i).subscribe(()=>{this.notificationService.success(this.sdaTranslateService.get("REVIEW_UPDATE_SUCCESS","Review successfully updated")),e.review.HasReviewBeenConsolidated=t,e.reviewer.HasContentBeenConsolidated=t},e=>{this.exceptionService.handleException(e)})}}addReviewSummary(e){e.reviewer.IsCurrentUser?this.reviewsByUser.unshift(e):this.reviewsByUser.push(e)}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(S.a),n.Sb(u.a),n.Sb(d.a),n.Sb(O.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-reviewers-summary-view"]],inputs:{reviewers:"reviewers",reviews:"reviews",referenceActions:"referenceActions",primaryActions:"primaryActions",mode:"mode",recipientsWithNoReviews:"recipientsWithNoReviews"},decls:2,vars:2,consts:[["class","reviewer",4,"ngFor","ngForOf"],[1,"reviewer"],[1,"reviewer__indicator"],[3,"reviewer__icon--you","title",4,"ngIf"],["class","fa fa-check reviewer__icon reviewer__icon--completed","aria-hidden","true",4,"ngIf"],["class","fa fa-times reviewer__icon reviewer__icon--waived","aria-hidden","true",4,"ngIf"],[1,"reviewer__details"],[1,"reviewer-name"],[1,"reviewer-name__title"],["class","reviewer-name__title__you",4,"ngIf"],[1,"reviewer-sign-off"],["class","fa fa-square-o reviewer-sign-off__icon reviewer-sign-off__icon--unchecked",3,"title","click",4,"ngIf"],["class","fa fa-check-square reviewer-sign-off__icon reviewer-sign-off__icon--checked",3,"title","click",4,"ngIf"],[1,"reviewer-date"],["class","reviewer-date__data",4,"ngIf"],[1,"reviewer__comment-count","feedback-wrapper",3,"title"],["class","feedback-item",4,"ngIf"],[1,"reviewer__disciplines-list"],[1,"disciplines__list"],["class","disciplines__item",4,"ngFor","ngForOf"],[3,"title"],["svgIcon","user-hardhat",1,"class.reviewer__icon"],["svgIcon","user",1,"class.reviewer__icon"],["aria-hidden","true",1,"fa","fa-check","reviewer__icon","reviewer__icon--completed"],["aria-hidden","true",1,"fa","fa-times","reviewer__icon","reviewer__icon--waived"],[1,"reviewer-name__title__you"],[1,"fa","fa-square-o","reviewer-sign-off__icon","reviewer-sign-off__icon--unchecked",3,"title","click"],[1,"fa","fa-check-square","reviewer-sign-off__icon","reviewer-sign-off__icon--checked",3,"title","click"],[1,"reviewer-date__data"],[1,"feedback-item"],["aria-hidden","true",1,"fa","fa-commenting","feedback-item__icon"],[1,"feedback-item__data"],["aria-hidden","true",1,"fa","fa-commenting-o","feedback-item__icon"],[1,"disciplines__item"],[3,"title",4,"ngIf"]],template:function(e,t){1&e&&(n.Sc(0,we,24,15,"div",0),n.Sc(1,De,11,4,"div",0)),2&e&&(n.sc("ngForOf",t.reviewsByUser),n.Eb(1),n.sc("ngForOf",t.recipientsWithNoReviews))},directives:[y.s,y.t,he.a],pipes:[_e.a],styles:['.reviewer[_ngcontent-%COMP%]{position:relative;display:flex;padding:10px;border-bottom:1px solid #dbe0e4}.reviewer[_ngcontent-%COMP%]:last-child{border-bottom:none}.reviewer__indicator[_ngcontent-%COMP%]{width:28px}.reviewer__icon[_ngcontent-%COMP%]{font-size:18px;color:#515e6b;text-shadow:0 -1px #fff}.reviewer__icon--waived[_ngcontent-%COMP%]{color:#a30f21}.reviewer__icon--completed[_ngcontent-%COMP%]{color:#3e732a}.reviewer__icon--you[_ngcontent-%COMP%]{color:#00608f}.reviewer__details[_ngcontent-%COMP%]{flex:1}.reviewer__stats[_ngcontent-%COMP%]{display:flex}.reviewer-sign-off__icon[_ngcontent-%COMP%]{font-size:18px;cursor:pointer}.reviewer-sign-off__icon--checked[_ngcontent-%COMP%]{color:#559d39}.reviewer-date[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:5px}.reviewer-date__data[_ngcontent-%COMP%]{margin-right:15px;font-size:12px;color:#515e6b}.reviewer-name[_ngcontent-%COMP%]{display:flex;justify-content:space-between;height:20px}.reviewer-name__title[_ngcontent-%COMP%]{height:100%;justify-content:center;font-size:14px;font-weight:500}.reviewer-name__title__you[_ngcontent-%COMP%]{color:#697a8b;font-size:12px;font-style:italic}.disciplines__item[_ngcontent-%COMP%]{display:inline-block;font-size:12px}.disciplines__item[_ngcontent-%COMP%]:not(:last-child){margin-right:5px}.disciplines__item[_ngcontent-%COMP%]:not(:last-child):after{content:","}']}),e})();var Ne=i("FedY"),Pe=i("J7mc");class ye{constructor(e,t,i,n,o){this.title=e,this.items=t,this.childGroups=i,this.isExpanded=n,this.id=o}}var Ue=i("Spnr"),Be=i("zewe"),Fe=i("+ooB"),Le=i("tCxB"),ke=i("KQs8"),Ve=i("2CD4"),xe=i("8gPv");function We(e,t){if(1&e){const e=n.Zb();n.Yb(0,"div",5),n.Yb(1,"button",6),n.hc("click",(function(){return n.Kc(e),n.lc(2).manageFiles()})),n.Tb(2,"i",7),n.Yb(3,"span",8),n.Uc(4),n.Xb(),n.Xb(),n.Yb(5,"button",6),n.hc("click",(function(){return n.Kc(e),n.lc(2).onManageItems.emit()})),n.Tb(6,"i",9),n.Yb(7,"span",8),n.Uc(8),n.Xb(),n.Xb(),n.Xb()}if(2&e){const e=n.lc(2);n.Eb(1),n.tc("title",e.REVIEW_SUPPORTING_INFORMATION_ATTACH_FILES_TOOLTIP),n.Eb(3),n.Vc(e.REVIEW_SUPPORTING_INFORMATION_ADD_FILES_BUTTON),n.Eb(1),n.tc("title",e.REVIEW_SUPPORTING_INFORMATION_MANAGE_OBJECTS_TOOLTIP),n.Eb(3),n.Vc(e.REVIEW_SUPPORTING_INFORMATION_MANAGE_RELATED_ITEMS_BUTTON)}}function Ye(e,t){if(1&e&&(n.Yb(0,"h4",14),n.Uc(1),n.Xb()),2&e){const e=n.lc().$implicit;n.Eb(1),n.Wc(" ",e.title," ")}}function je(e,t){if(1&e&&n.Tb(0,"sda-chip-list-view",15),2&e){const e=n.lc().$implicit;n.sc("chips",e.items)}}function Xe(e,t){if(1&e&&n.Tb(0,"sda-chip-list-view",15),2&e){const e=n.lc().$implicit;n.sc("chips",e.items)}}function Ge(e,t){if(1&e&&(n.Yb(0,"p-accordionTab",18),n.Sc(1,Xe,1,1,"sda-chip-list-view",12),n.Xb()),2&e){const e=t.$implicit;n.sc("selected",e.isExpanded)("header",e.title),n.Eb(1),n.sc("ngIf",(null==e.items?null:e.items.length)>0)}}function Ke(e,t){if(1&e&&(n.Yb(0,"p-accordion",16),n.Sc(1,Ge,2,3,"p-accordionTab",17),n.Xb()),2&e){const e=n.lc().$implicit;n.sc("multiple",!0),n.Eb(1),n.sc("ngForOf",e.childGroups)}}function He(e,t){if(1&e&&(n.Yb(0,"div",10),n.Sc(1,Ye,2,1,"h4",11),n.Sc(2,je,1,1,"sda-chip-list-view",12),n.Sc(3,Ke,2,2,"p-accordion",13),n.Xb()),2&e){const e=t.$implicit;n.Eb(1),n.sc("ngIf",(null==e.items?null:e.items.length)>0||(null==e.childGroups?null:e.childGroups.length)>0),n.Eb(1),n.sc("ngIf",(null==e.items?null:e.items.length)>0),n.Eb(1),n.sc("ngIf",(null==e.childGroups?null:e.childGroups.length)>0)}}function $e(e,t){if(1&e&&(n.Yb(0,"p-accordion",1),n.Yb(1,"p-accordionTab",2),n.Sc(2,We,9,4,"div",3),n.Sc(3,He,4,3,"div",4),n.Xb(),n.Xb()),2&e){const e=n.lc();n.sc("multiple",!0),n.Eb(1),n.sc("header",e.REVIEW_SUPPORTING_INFORMATION_HEADER),n.Eb(1),n.sc("ngIf",1===e.mode&&e.isEditable||2===e.mode||4===e.mode),n.Eb(1),n.sc("ngForOf",e.chipListGroups)}}let Qe=(()=>{class e{constructor(e,t,i,o,s,r,a,c,l,d,u,h){this.notificationService=e,this.sdaTranslateService=t,this.exceptionService=i,this.objectDetailsService=o,this.crudService=s,this.modalService=r,this.reviewProvider=a,this.componentFactoryResolver=c,this.injector=l,this.dataRefreshService=d,this.reviewDataService=u,this.loggingService=h,this.isEditable=!0,this.onFileClicked=new n.o,this.onObjectClicked=new n.o,this.onManageItems=new n.o,this.onRelBuilderClosed=new n.o,this.REVIEW_SUPPORTING_INFORMATION_TITLE=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_TITLE","Attach files"),this.REVIEW_SUPPORTING_INFORMATION_HEADER=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_HEADER","Supporting Information"),this.REVIEW_SUPPORTING_INFORMATION_DOCS_HEADER=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_DOCS_HEADER","Referenced Documents"),this.REVIEW_SUPPORTING_INFORMATION_FILES_HEADER=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_FILES_HEADER","Attached Files"),this.REVIEW_SUPPORTING_INFORMATION_RENDITIONS_HEADER=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_RENDITIONS_HEADER","Renditioned Files"),this.REVIEW_SUPPORTING_INFORMATION_OTHER_OBJECTS_HEADER=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_OTHER_OBJECTS_HEADER","Other Objects"),this.REVIEW_SUPPORTING_INFORMATION_ATTACH_TOOLTIP=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_ATTACH_TOOLTIP","Upload files and find documents for supporting information"),this.REVIEW_SUPPORTING_INFORMATION_TERMINATE_FILE_MODAL_MSG=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_TERMINATE_FILE_MODAL_MSG-NAME","Are you sure you want to terminate the file {0}?"),this.REVIEW_SUPPORTING_INFORMATION_TERMINATE_REL_MODAL_TITLE=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_TERMINATE_REL_MODAL_TITLE","Terminate Relationship"),this.REVIEW_SUPPORTING_INFORMATION_TERMINATE_FILE_MODAL_TITLE=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_TERMINATE_FILE_MODAL_TITLE","Terminate File"),this.REVIEW_SUPPORTING_INFORMATION_TERMINATE_REL_SUCCESS=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_TERMINATE_REL_SUCCESS","Relationship successfully terminated"),this.REVIEW_SUPPORTING_INFORMATION_TERMINATE_FILE_SUCCESS=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_TERMINATE_FILE_SUCCESS","File successfully terminated"),this.REVIEW_SUPPORTING_INFORMATION_MANAGE_RELATED_ITEMS_BUTTON=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_MANAGE_RELATED_ITEMS_BUTTON","Manage related items"),this.REVIEW_SUPPORTING_INFORMATION_ADD_FILES_BUTTON=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_ADD_FILES_BUTTON","Attach files"),this.REVIEW_NO_LONGER_AVAILABLE_FOR_EDITING=this.sdaTranslateService.get("REVIEW_NO_LONGER_AVAILABLE_FOR_EDITING","The review is no longer available for editing because the document review process has been completed. <BR/>You will now be returned to the To Do List."),this.REVIEW_SUPPORTING_INFORMATION_MANAGE_OBJECTS_TOOLTIP=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_MANAGE_OBJECTS_TOOLTIP","Manage related items for supporting information"),this.REVIEW_SUPPORTING_INFORMATION_ATTACH_FILES_TOOLTIP=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_ATTACH_FILES_TOOLTIP","Attach files for supporting information"),this.REVIEW_SUPPORTING_INFORMATION_BODY_DOCUMENT_TITLE=this.sdaTranslateService.get("REVIEW_SUPPORTING_INFORMATION_BODY_DOCUMENT_TITLE","Documents"),this.PRIMARY_DOCUMENT_TITLE=this.sdaTranslateService.get("PRIMARY_DOCUMENT_TITLE","Primary"),this.REFERENCE_DOCUMENTS_TITLE=this.sdaTranslateService.get("REFERENCE_DOCUMENTS_TITLE","Reference"),this.chipListGroups=[],this.DOCUMENT_SECTION_ID="DOCS",this.OTHER_OBJECTS_SECTION_ID="OO",this.RENDITIONED_FILES_SECTION_ID="RENDITIONEDFILES",this.FILES_SECTION_ID="FILES",this.viewObjectDetails=e=>{this.objectDetailsService.showObjectDetailsModal(this.componentFactoryResolver,this.injector,e)},this.terminateRelatedFile=(e,t=!1)=>{this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(i=>{i?this.modalService.confirm(this.REVIEW_SUPPORTING_INFORMATION_TERMINATE_FILE_MODAL_TITLE,this.sdaTranslateService.getFormatted("REVIEW_SUPPORTING_INFORMATION_TERMINATE_REL_MODAL_MSG-NAME","Are you sure you want to terminate the relationship to {0}?",[e.name])).then(i=>{i&&this.crudService.terminate(e.obid).subscribe(()=>{this.notificationService.success(this.REVIEW_SUPPORTING_INFORMATION_TERMINATE_FILE_SUCCESS),t?(this.supportingInformation.PrimaryDocuments.forEach(t=>{t.Relationships=t.Relationships.filter(t=>t.OBID!==e.obid)}),this.supportingInformation.ReferenceDocuments.forEach(t=>{t.Relationships=t.Relationships.filter(t=>t.OBID!==e.obid)}),this.refreshDocumentSupportingInformation()):(this.supportingInformation.Files=this.supportingInformation.Files.filter(t=>t.OBID!==e.obid),this.refreshFileSupportingInformation()),this.sortSupportingInformation()},e=>{this.exceptionService.handleException(e)})}):this.reviewProvider.reviewCompletedMessageAndEjectUser()})},this.viewFile=e=>{e.config=this.config,this.onFileClicked.emit({file:e,parentOBID:this.parentOBID})},this.refreshDataSubscription=this.dataRefreshService.refreshData$.subscribe(e=>{e&&e.objectsToRefresh&&1===e.objectsToRefresh.length&&(this.onRelBuilderClosed.emit(),this.refreshUpdatedObject(e.objectsToRefresh[0]))})}ngOnInit(){this.onBuildChipListGroups()}ngOnDestroy(){this.refreshDataSubscription&&this.refreshDataSubscription.unsubscribe()}showSupportingInfo(){return this.isEditable&&0!==this.mode||2===this.mode||4===this.mode||this.supportingInformation&&this.hasSupportingInfo()}manageFiles(){this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{if(e){const e=new Fe.a(this.REVIEW_SUPPORTING_INFORMATION_TITLE,Ve.a,this.componentFactoryResolver,this.injector);e.data=new ke.a(this.config,this.parentOBID),e.size="xlarge",e.disableOk=!0,this.modalService.showModal(e).catch(e=>{this.loggingService.error(new de.a(e))})}else this.reviewProvider.reviewCompletedMessageAndEjectUser()})}hasSupportingInfo(){return this.supportingInformation.PrimaryDocuments&&this.supportingInformation.PrimaryDocuments.length>0||this.supportingInformation.ReferenceDocuments&&this.supportingInformation.ReferenceDocuments.length>0||this.supportingInformation.Files&&this.supportingInformation.Files.length>0||this.supportingInformation.OtherObjects&&this.supportingInformation.OtherObjects.length>0||this.primaryFileRenditions&&this.primaryFileRenditions.length>0||this.referenceFileRenditions&&this.referenceFileRenditions.length>0}terminatePrimaryDocumentRelationship(e){this.terminateRels(this.sdaTranslateService.getFormatted("REVIEW_SUPPORTING_INFORMATION_TERMINATE_REL_MODAL_MSG-NAME","Are you sure you want to terminate the relationship to {0}?",[e.name]),e.obid,this.relatedPrimaryDocumentRelDef,this.relatedPrimaryDocumentRelDefIs12)}terminateReferenceDocumentRelationship(e){this.terminateRels(this.sdaTranslateService.getFormatted("REVIEW_SUPPORTING_INFORMATION_TERMINATE_REL_MODAL_MSG-NAME","Are you sure you want to terminate the relationship to {0}?",[e.name]),e.obid,this.relatedReferenceDocumentRelDef,this.relatedReferenceDocumentRelDefIs12)}terminateOtherObjectRelationship(e){this.terminateRels(this.sdaTranslateService.getFormatted("REVIEW_SUPPORTING_INFORMATION_TERMINATE_REL_MODAL_MSG-NAME","Are you sure you want to terminate the relationship to {0}?",[e.name]),e.obid,this.relatedOtherObjectRelDef,this.relatedOtherObjectRelDefIs12)}terminateRels(e,t,i,n){this.modalService.confirm(this.REVIEW_SUPPORTING_INFORMATION_TERMINATE_REL_MODAL_TITLE,e).then(e=>{e&&this.crudService.unrelate(t,this.parentOBID,i,n,!0).subscribe(()=>{this.notificationService.success(this.REVIEW_SUPPORTING_INFORMATION_TERMINATE_REL_SUCCESS),this.supportingInformation.ReferenceDocuments=this.supportingInformation.ReferenceDocuments.filter(e=>e.OBID!==t),this.supportingInformation.PrimaryDocuments=this.supportingInformation.PrimaryDocuments.filter(e=>e.OBID!==t),this.refreshDocumentSupportingInformation(),this.supportingInformation.OtherObjects.forEach(e=>{e.Objects=e.Objects.filter(e=>e.OBID!==t)}),this.refreshOtherObjectSupportingInformation(),this.sortSupportingInformation()},e=>{this.exceptionService.handleException(e)})})}refreshUpdatedObject(e){e.obid===this.parentOBID&&this.reviewDataService.getSupportingInformationForObject(e.obid,this.documentOBID).subscribe(e=>{this.supportingInformation.Files=e.Files,this.supportingInformation.ReferenceDocuments=e.ReferenceDocuments,this.supportingInformation.PrimaryDocuments=e.PrimaryDocuments,this.supportingInformation.OtherObjects=e.OtherObjects,this.refreshFileSupportingInformation(),this.refreshDocumentSupportingInformation(),this.refreshOtherObjectSupportingInformation(),this.sortSupportingInformation()})}onBuildChipListGroups(){this.chipListGroups=[],this.refreshDocumentSupportingInformation(),this.refreshFileSupportingInformation(),this.refreshOtherObjectSupportingInformation(),this.refreshPrimaryFileRenditionSupportingInformation(),this.refreshReferenceFileRenditionSupportingInformation(),this.sortSupportingInformation()}buildDocumentChips(e,t=!0){return e.map(e=>new Ue.a(new v.a(e.OBID,e.DisplayName,e.Config,e.DisplayName),!0,!0,this.viewObjectDetails,this.isFileOrDocumentTerminateAvailable(),e=>{t?this.terminatePrimaryDocumentRelationship(e):this.terminateReferenceDocumentRelationship(e)},this.transformChildRelationships(e.Relationships,!0,this.viewFile,void 0,!1,!1),!0))}buildOtherObjectChips(e){return e.map(e=>new Ue.a(new v.a(e.OBID,e.DisplayName,e.Config,e.DisplayName),!0,!0,this.viewObjectDetails,this.isFileOrDocumentTerminateAvailable(),e=>{this.terminateOtherObjectRelationship(e)},[],!0))}refreshOtherObjectSupportingInformation(){if(this.supportingInformation.OtherObjects&&this.supportingInformation.OtherObjects.length>0){const e=this.getOrCreateChipListGroupById(this.REVIEW_SUPPORTING_INFORMATION_OTHER_OBJECTS_HEADER,this.OTHER_OBJECTS_SECTION_ID);e.childGroups=[],this.supportingInformation.OtherObjects.forEach(t=>{const i=this.buildOtherObjectChips(t.Objects);if(i.length>0){const n=new ye(t.ClassDef,i);e.childGroups.push(n)}})}}refreshDocumentSupportingInformation(){const e=this.supportingInformation.PrimaryDocuments?this.buildDocumentChips(this.supportingInformation.PrimaryDocuments):[],t=this.supportingInformation.ReferenceDocuments?this.buildDocumentChips(this.supportingInformation.ReferenceDocuments,!1):[],i=this.getOrCreateChipListGroupById(this.REVIEW_SUPPORTING_INFORMATION_BODY_DOCUMENT_TITLE,this.DOCUMENT_SECTION_ID);if(i.childGroups=[],e.length>0){const t=new ye(this.PRIMARY_DOCUMENT_TITLE,e,void 0,!0);i.childGroups.push(t)}if(t.length>0){const e=new ye(this.REFERENCE_DOCUMENTS_TITLE,t,[],!1);i.childGroups.push(e)}}getOrCreateChipListGroupById(e,t){let i=this.chipListGroups.find(e=>e.id===t);return i||(i=new ye(e,[],[],!0,t),this.chipListGroups.push(i)),i}refreshFileSupportingInformation(){if(this.supportingInformation.Files&&this.supportingInformation.Files.length>=0){const e=this.supportingInformation.Files.map(e=>new Ue.a(new v.a(e.OBID,e.DisplayName,e.Config,e.DisplayName),!1,e.IsViewable,this.viewFile,this.isFileOrDocumentTerminateAvailable(),e=>{this.terminateRelatedFile(e)},this.transformChildRelationships(e.Relationships)));this.chipListGroups=this.chipListGroups.filter(e=>e.title!==this.REVIEW_SUPPORTING_INFORMATION_FILES_HEADER);const t=new ye(this.REVIEW_SUPPORTING_INFORMATION_FILES_HEADER,e,void 0,!0,this.FILES_SECTION_ID);this.chipListGroups.unshift(t)}}transformChildRelationships(e,t=!1,i,n,o=!0,s=!1){const r=[];return e&&e.forEach(e=>{r.push(new Ue.a(new v.a(e.OBID,e.DisplayName,e.Config,e.DisplayName),s,e.IsViewable,i,o,n,[],t))}),r}refreshPrimaryFileRenditionSupportingInformation(){if(this.primaryFileRenditions&&this.primaryFileRenditions.length>0){const e=this.primaryFileRenditions.map(e=>new Ue.a(new v.a(e.OBID,e.DisplayName,e.Config),!1,!0,this.viewFile,!1));e.length>0&&this.getOrCreateChipListGroupById(this.REVIEW_SUPPORTING_INFORMATION_RENDITIONS_HEADER,this.RENDITIONED_FILES_SECTION_ID).childGroups.push(new ye(this.PRIMARY_DOCUMENT_TITLE,e,void 0,!0))}}refreshReferenceFileRenditionSupportingInformation(){if(this.referenceFileRenditions&&this.referenceFileRenditions.length>0){const e=this.referenceFileRenditions.map(e=>new Ue.a(new v.a(e.OBID,e.DisplayName,e.Config),!1,!0,this.viewFile,!1));e.length>0&&this.getOrCreateChipListGroupById(this.REVIEW_SUPPORTING_INFORMATION_RENDITIONS_HEADER,this.RENDITIONED_FILES_SECTION_ID).childGroups.push(new ye(this.REFERENCE_DOCUMENTS_TITLE,e,[],!1))}}isFileOrDocumentTerminateAvailable(){return this.mode===D.a.Review&&this.isEditable||this.mode===D.a.Consolidate||this.mode===D.a.Reconsolidate}sortSupportingInformation(){const e=this.chipListGroups.find(e=>e.title===this.REVIEW_SUPPORTING_INFORMATION_FILES_HEADER);this.chipListGroups=this.chipListGroups.filter(e=>e.title!==this.REVIEW_SUPPORTING_INFORMATION_FILES_HEADER),this.chipListGroups=this.chipListGroups.sort((e,t)=>Ne.a.sortByString(e.title,t.title)),this.chipListGroups.unshift(e)}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(S.a),n.Sb(O.a),n.Sb(u.a),n.Sb(Be.a),n.Sb(d.a),n.Sb(m.a),n.Sb(A.a),n.Sb(n.j),n.Sb(n.s),n.Sb(R.a),n.Sb(N.a),n.Sb(Le.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-supporting-information-view"]],inputs:{supportingInformation:"supportingInformation",primaryFileRenditions:"primaryFileRenditions",referenceFileRenditions:"referenceFileRenditions",parentOBID:"parentOBID",documentOBID:"documentOBID",config:"config",workflowStep:"workflowStep",relatedPrimaryDocumentRelDef:"relatedPrimaryDocumentRelDef",relatedPrimaryDocumentRelDefIs12:"relatedPrimaryDocumentRelDefIs12",relatedReferenceDocumentRelDef:"relatedReferenceDocumentRelDef",relatedReferenceDocumentRelDefIs12:"relatedReferenceDocumentRelDefIs12",relatedFileRelDef:"relatedFileRelDef",relatedFileRelDefIs12:"relatedFileRelDefIs12",relatedOtherObjectRelDef:"relatedOtherObjectRelDef",relatedOtherObjectRelDefIs12:"relatedOtherObjectRelDefIs12",isEditable:"isEditable",mode:"mode",isConsolidator:"isConsolidator"},outputs:{onFileClicked:"onFileClicked",onObjectClicked:"onObjectClicked",onManageItems:"onManageItems",onRelBuilderClosed:"onRelBuilderClosed"},decls:1,vars:1,consts:[["class","sdaAccordion__wrapper sda-p-accordion",3,"multiple",4,"ngIf"],[1,"sdaAccordion__wrapper","sda-p-accordion",3,"multiple"],[1,"object-details-content",3,"header"],["class","support-info support-info--controls",4,"ngIf"],["class","support-info",4,"ngFor","ngForOf"],[1,"support-info","support-info--controls"],["type","button",1,"sda-button","support-info__button",3,"title","click"],["aria-hidden","true",1,"fa","fa-upload"],[1,"support-info__text"],["aria-hidden","true",1,"fa","fa-plus"],[1,"support-info"],["class","support-info__title",4,"ngIf"],[3,"chips",4,"ngIf"],["class","support-info__accordion",3,"multiple",4,"ngIf"],[1,"support-info__title"],[3,"chips"],[1,"support-info__accordion",3,"multiple"],[3,"selected","header",4,"ngFor","ngForOf"],[3,"selected","header"]],template:function(e,t){1&e&&n.Sc(0,$e,4,4,"p-accordion",0),2&e&&n.sc("ngIf",t.showSupportingInfo())},directives:[y.t,Y.a,Y.c,y.s,xe.a],styles:["[_nghost-%COMP%]{display:flex;align-items:center;padding:0;background:#fff}[_nghost-%COMP%]     p-accordion{flex:1}[_nghost-%COMP%]     .ui-accordion-header{background-color:initial;border-top:1px solid #dbe0e4}[_nghost-%COMP%]     .ui-accordion-header.ui-state-active{background-color:#e7eaed;border-bottom:1px solid #d9dde2}[_nghost-%COMP%]     .ui-accordion-content-wrapper{max-height:255px;overflow-x:hidden}[_nghost-%COMP%]     .ui-accordion-content{padding:12px 12px 5px!important}.support-info[_ngcontent-%COMP%]{padding:10px 0}.support-info__title[_ngcontent-%COMP%]{font-size:16px;font-weight:500;padding:0 0 10px}.support-info__button[_ngcontent-%COMP%]{margin-bottom:10px;padding:8px 10px 6px;font-size:14px!important;box-shadow:none}.support-info__button[_ngcontent-%COMP%]:not(:only-child):not(:last-of-type){margin-right:10px}.support-info__text[_ngcontent-%COMP%]{margin-left:5px}.support-info__accordion[_ngcontent-%COMP%]     .ui-accordion-header{background-color:#86d8ff}.support-info__accordion[_ngcontent-%COMP%]     .ui-accordion-header.ui-state-active{background-color:#e7eaed;border-bottom:1px solid #d9dde2}.support-info__accordion[_ngcontent-%COMP%]     .ui-accordion-header.ui-state-active+.ui-accordion-content-wrapper{margin-bottom:10px}"]}),e})();var ze=i("Y+ZO"),Je=i("3Pt+"),Ze=i("dO6S"),qe=i("8OmR");function et(e,t){if(1&e&&(n.Yb(0,"div",21),n.Tb(1,"mat-icon",22),n.Xb()),2&e){const e=n.lc();n.Ib("card-user__icon--you",e.user.IsCurrentUser),n.sc("title",e.QA_DOCUMENT_REVIEW_REVIEWER_ICON)}}function tt(e,t){if(1&e&&(n.Yb(0,"div",23),n.Tb(1,"mat-icon",24),n.Xb()),2&e){const e=n.lc();n.Ib("card-user__icon--you",e.user.IsCurrentUser),n.sc("title",e.QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON)}}function it(e,t){if(1&e&&(n.Yb(0,"span",25),n.Uc(1),n.Xb()),2&e){const e=n.lc();n.Eb(1),n.Wc(" ",e.YOU," ")}}function nt(e,t){if(1&e&&(n.Yb(0,"span",26),n.Tb(1,"i",27),n.Uc(2),n.Xb()),2&e){const e=n.lc();n.Eb(2),n.Wc(" ",e.REVIEW_ACTION_SIGNED_OFF," ")}}function ot(e,t){if(1&e){const e=n.Zb();n.Yb(0,"button",31),n.hc("click",(function(){return n.Kc(e),n.lc(2).cancelSave()})),n.Uc(1),n.Xb()}if(2&e){const e=n.lc(2);n.Eb(1),n.Wc(" ",e.CANCEL," ")}}function st(e,t){if(1&e){const e=n.Zb();n.Yb(0,"p-toggleButton",32),n.hc("ngModelChange",(function(t){return n.Kc(e),n.lc(2).isInEditMode=t}))("click",(function(){return n.Kc(e),n.lc(2).save()})),n.Xb()}if(2&e){const e=n.lc(2);n.sc("ngModel",e.isInEditMode)("onLabel",e.SAVE_UPPERCASE)("offLabel",e.EDIT_UPPERCASE)}}function rt(e,t){if(1&e&&(n.Yb(0,"aside",28),n.Sc(1,ot,2,1,"button",29),n.Sc(2,st,1,3,"p-toggleButton",30),n.Xb()),2&e){const e=n.lc();n.Eb(1),n.sc("ngIf",e.isInEditMode),n.Eb(1),n.sc("ngIf",e.user.IsCurrentUser)}}function at(e,t){if(1&e&&(n.Yb(0,"div",13),n.Tb(1,"i",33),n.Yb(2,"p",34),n.Uc(3),n.Xb(),n.Xb()),2&e){const e=n.lc();n.Eb(3),n.Vc(e.review.StatusDisplay)}}function ct(e,t){if(1&e){const e=n.Zb();n.Yb(0,"textarea",35,36),n.hc("blur",(function(){n.Kc(e);const t=n.Hc(1);return n.lc().onLeaveDetails(t)}))("ngModelChange",(function(t){return n.Kc(e),n.lc().review.Details=t})),n.Uc(2,"            "),n.Xb()}if(2&e){const e=n.lc();n.sc("sdaFocus",e.isInEditMode)("ngModel",e.review.Details)}}function lt(e,t){if(1&e&&(n.Tb(0,"div",37),n.mc(1,"sdaConvertURLsToHREF")),2&e){const e=n.lc();n.sc("innerHTML",n.nc(1,1,e.review.Details),n.Lc)}}let dt=(()=>{class e{constructor(e,t,i,o,s,r,a){this.exceptionService=e,this.notificationService=t,this.crudService=i,this.dataService=o,this.configService=s,this.sdaTranslateService=r,this.reviewProvider=a,this.onSaved=new n.o,this.onFileClicked=new n.o,this.onManageReviewRelatedItems=new n.o,this.onRelBuilderClosed=new n.o,this.YOU=this.sdaTranslateService.get("YOU","You"),this.QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON=this.sdaTranslateService.get("QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON","Document Review Consolidator"),this.QA_DOCUMENT_REVIEW_REVIEWER_ICON=this.sdaTranslateService.get("QA_DOCUMENT_REVIEW_REVIEWER_ICON","Document Reviewer"),this.relatedPrimaryDocumentRelDef="SDAObservationPrimaryDocVersion",this.relatedPrimaryDocumentRelDefIs12=!1,this.relatedReferenceDocumentRelDef="SDAObservationDocVersions",this.relatedReferenceDocumentRelDefIs12=!1,this.relatedFileRelDef="SPFFileComposition",this.relatedFileRelDefIs12=!1,this.relatedOtherObjectRelDef="SDAObservationNonDocItems",this.relatedOtherObjectRelDefIs12=!1,this.REVIEW_ACTION_SIGNED_OFF=this.sdaTranslateService.get("REVIEW_ACTION_SIGNED_OFF","Consolidated"),this.SAVE_UPPERCASE=this.sdaTranslateService.get("SAVE_UPPERCASE","SAVE"),this.UPDATED=this.sdaTranslateService.get("UPDATED","Updated"),this.EDIT_UPPERCASE=this.sdaTranslateService.get("EDIT_UPPERCASE","EDIT"),this.CANCEL=this.sdaTranslateService.get("CANCEL","Cancel"),this.REVIEW_NO_LONGER_AVAILABLE_FOR_EDITING=this.sdaTranslateService.get("REVIEW_NO_LONGER_AVAILABLE_FOR_EDITING","The review is no longer available for editing because the document review process has been completed. <BR/>You will now be returned to the To Do List."),this.detailsHistory=""}save(){this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{if(e)if(this.isInEditMode)this.detailsHistory=this.review.Details.slice(0);else{const e=new c.a(void 0);e.properties.push(new l.a("SDAObservationDetails",this.review.Details)),this.crudService.update(this.review.OBID,e).subscribe(e=>{if(!e)throw new de.a(this.sdaTranslateService.get("REVIEW_DETAIL_UPDATE_FAILED","Failed to save review"));this.dataService.get("Objects('"+this.review.OBID+"')/?$select=LastUpdatedDate",this.configService.selectedCreateConfig,!0).subscribe(e=>{if(!e||!e.LastUpdatedDate)throw new de.a(this.sdaTranslateService.get("REVIEW_DETAIL_UPDATE_FAILED","Failed to save review"));this.review.ModifiedDate=e.LastUpdatedDate,this.review.isDirty=!1,this.notificationService.success(this.sdaTranslateService.get("REVIEW_DETAIL_UPDATE_SUCCESS","Review successfully saved")),this.onSaved.emit(this.review)})},e=>{this.exceptionService.handleException(e)})}else this.reviewProvider.reviewCompletedMessageAndEjectUser()})}cancelSave(){this.isInEditMode=!1,this.review.isDirty=!1,this.review.Details=this.detailsHistory}onLeaveDetails(e){this.review.isDirty=e.dirty}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(u.a),n.Sb(S.a),n.Sb(d.a),n.Sb(Pe.a),n.Sb(w.a),n.Sb(O.a),n.Sb(A.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-review-view"]],inputs:{review:"review",user:"user",documentOBID:"documentOBID",config:"config",mode:"mode",workflowStep:"workflowStep"},outputs:{onSaved:"onSaved",onFileClicked:"onFileClicked",onManageReviewRelatedItems:"onManageReviewRelatedItems",onRelBuilderClosed:"onRelBuilderClosed"},features:[n.Db([A.a])],decls:25,vars:30,consts:[[1,"card-item","card-item--review"],[1,"card-header"],[1,"card-heading"],[1,"card-user"],[1,"card-user__body"],[3,"card-user__icon--you","title",4,"ngIf","ngIfElse"],["yesToConsolidator",""],[1,"card-user__name"],[1,"card-user__name__title"],["class","card-user__name__title__you",4,"ngIf"],["class","card-badge card-badge--completed",4,"ngIf"],["class","card-actions",4,"ngIf"],[1,"card-section","card-section--info"],[1,"card-info"],["aria-hidden","true",1,"card-info__icon","fa","fa-clock-o"],[1,"card-info__data"],["class","card-info",4,"ngIf"],[1,"card-section","card-section--main"],["class","card-section__textarea","rows","5",3,"sdaFocus","ngModel","blur","ngModelChange",4,"ngIf"],["class","card-section__content",3,"innerHTML",4,"ngIf"],[3,"supportingInformation","parentOBID","isEditable","mode","config","documentOBID","relatedFileRelDef","relatedFileRelDefIs12","relatedPrimaryDocumentRelDef","relatedPrimaryDocumentRelDefIs12","relatedReferenceDocumentRelDef","relatedReferenceDocumentRelDefIs12","relatedOtherObjectRelDef","relatedOtherObjectRelDefIs12","workflowStep","onFileClicked","onManageItems","onRelBuilderClosed"],[3,"title"],["svgIcon","user",1,"class.card-user__icon"],[1,"card-user__body",3,"title"],["svgIcon","user-hardhat",1,"class.card-user__icon"],[1,"card-user__name__title__you"],[1,"card-badge","card-badge--completed"],["aria-hidden","true",1,"fa","fa-check"],[1,"card-actions"],["class","card-actions__button sda-button sda-button--clear",3,"click",4,"ngIf"],["class","card-actions__toggle",3,"ngModel","onLabel","offLabel","ngModelChange","click",4,"ngIf"],[1,"card-actions__button","sda-button","sda-button--clear",3,"click"],[1,"card-actions__toggle",3,"ngModel","onLabel","offLabel","ngModelChange","click"],["aria-hidden","true",1,"card-info__icon","fa","fa-circle-o-notch"],[1,"stats-bar__data"],["rows","5",1,"card-section__textarea",3,"sdaFocus","ngModel","blur","ngModelChange"],["details","ngModel"],[1,"card-section__content",3,"innerHTML"]],template:function(e,t){if(1&e&&(n.Yb(0,"div",0),n.Yb(1,"header",1),n.Yb(2,"div",2),n.Yb(3,"div",3),n.Yb(4,"div",4),n.Sc(5,et,2,3,"div",5),n.Sc(6,tt,2,3,"ng-template",null,6,n.Tc),n.Yb(8,"div",7),n.Yb(9,"h4",8),n.Uc(10),n.Sc(11,it,2,1,"span",9),n.Xb(),n.Sc(12,nt,3,1,"span",10),n.Xb(),n.Xb(),n.Xb(),n.Xb(),n.Sc(13,rt,3,2,"aside",11),n.Xb(),n.Yb(14,"section",12),n.Yb(15,"div",13),n.Tb(16,"i",14),n.Yb(17,"p",15),n.Uc(18),n.mc(19,"sdaConvertToLocalDateTime"),n.Xb(),n.Xb(),n.Sc(20,at,4,1,"div",16),n.Xb(),n.Yb(21,"section",17),n.Sc(22,ct,3,2,"textarea",18),n.Sc(23,lt,2,3,"div",19),n.Xb(),n.Yb(24,"sda-supporting-information-view",20),n.hc("onFileClicked",(function(e){return t.onFileClicked.emit(e)}))("onManageItems",(function(){return t.onManageReviewRelatedItems.emit(t.review)}))("onRelBuilderClosed",(function(){return t.onRelBuilderClosed.emit()})),n.Xb(),n.Xb()),2&e){const e=n.Hc(7);n.Ib("card-item--approved",t.review.HasReviewBeenConsolidated),n.Eb(5),n.sc("ngIf",t.review&&!t.review.IsConsolidatedReview)("ngIfElse",e),n.Eb(5),n.Wc(" ",t.user.DisplayName," "),n.Eb(1),n.sc("ngIf",t.user.IsCurrentUser),n.Eb(1),n.sc("ngIf",t.review.HasReviewBeenConsolidated),n.Eb(1),n.sc("ngIf",t.mode>0),n.Eb(5),n.Xc("",t.UPDATED,": ",n.nc(19,28,t.review.ModifiedDate),""),n.Eb(2),n.sc("ngIf",t.review.StatusDisplay),n.Eb(2),n.sc("ngIf",t.isInEditMode),n.Eb(1),n.sc("ngIf",!t.isInEditMode),n.Eb(1),n.sc("supportingInformation",t.review.SupportingInformation)("parentOBID",t.review.OBID)("isEditable",t.user.IsCurrentUser)("mode",t.mode)("config",t.config)("documentOBID",t.documentOBID)("relatedFileRelDef",t.relatedFileRelDef)("relatedFileRelDefIs12",t.relatedFileRelDefIs12)("relatedPrimaryDocumentRelDef",t.relatedPrimaryDocumentRelDef)("relatedPrimaryDocumentRelDefIs12",t.relatedPrimaryDocumentRelDefIs12)("relatedReferenceDocumentRelDef",t.relatedReferenceDocumentRelDef)("relatedReferenceDocumentRelDefIs12",t.relatedReferenceDocumentRelDefIs12)("relatedOtherObjectRelDef",t.relatedOtherObjectRelDef)("relatedOtherObjectRelDefIs12",t.relatedOtherObjectRelDefIs12)("workflowStep",t.workflowStep)}},directives:[y.t,Qe,he.a,ze.a,Je.p,Je.s,Je.c,Ze.a],pipes:[_e.a,qe.a],styles:["[_nghost-%COMP%]{display:flex;justify-content:center}"]}),e})();function ut(e,t){if(1&e){const e=n.Zb();n.Yb(0,"div",1),n.Yb(1,"div",2),n.Yb(2,"sda-review-view",3),n.hc("onSaved",(function(t){return n.Kc(e),n.lc().onReviewSaved.emit(t)}))("onFileClicked",(function(t){return n.Kc(e),n.lc().onFileClicked.emit(t)}))("onManageReviewRelatedItems",(function(t){return n.Kc(e),n.lc().onManageReviewRelatedItems.emit(t)}))("onRelBuilderClosed",(function(){return n.Kc(e),n.lc().onRelBuilderClosed.emit()})),n.Xb(),n.Xb(),n.Xb()}if(2&e){const e=t.$implicit,i=n.lc();n.Eb(2),n.sc("review",e.value)("mode",i.mode)("user",e.key)("config",i.config)("documentOBID",i.documentOBID)("workflowStep",i.workflowStep)}}let ht=(()=>{class e{constructor(){this.onReviewSaved=new n.o,this.onFileClicked=new n.o,this.onManageReviewRelatedItems=new n.o,this.onRelBuilderClosed=new n.o,this.userReviews=new Array}ngOnInit(){let e;const t=new Array;this.reviews.forEach((i,n)=>{if(!i.IsWaived){const n=this.reviewers.filter(e=>i.UserOBID===e.OBID)[0];n.IsCurrentUser?e=new T.a(n,i):t.push(new T.a(n,i))}n===this.reviews.length-1&&(this.userReviews=t.sort((e,t)=>Ne.a.sortByString(e.key.DisplayName,t.key.DisplayName)),e&&this.userReviews.unshift(e))})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-review-group-view"]],inputs:{reviews:"reviews",reviewers:"reviewers",documentOBID:"documentOBID",config:"config",mode:"mode",workflowStep:"workflowStep"},outputs:{onReviewSaved:"onReviewSaved",onFileClicked:"onFileClicked",onManageReviewRelatedItems:"onManageReviewRelatedItems",onRelBuilderClosed:"onRelBuilderClosed"},decls:1,vars:1,consts:[["class","grid",4,"ngFor","ngForOf"],[1,"grid"],[1,"col-50"],[3,"review","mode","user","config","documentOBID","workflowStep","onSaved","onFileClicked","onManageReviewRelatedItems","onRelBuilderClosed"]],template:function(e,t){1&e&&n.Sc(0,ut,3,6,"div",0),2&e&&n.sc("ngForOf",t.userReviews)},directives:[y.s,dt],encapsulation:2}),e})();var _t=i("8ihU"),ft=i("IUya"),mt=i("DJR3"),Et=i("hqbt");let It=(()=>{class e extends _t.a{constructor(e,t,i,n,o,s,r,a,c){super(r),this.notificationService=e,this.exceptionService=t,this.sdaTranslateService=i,this.crudService=n,this.dateFormatService=o,this.securityService=s,this.dataService=a,this.configService=c,this.REVIEW_ACTION_REJECT_COMMENT=this.sdaTranslateService.get("REVIEW_ACTION_REJECT_COMMENT","Please enter a comment"),this.actionRejectStatusParam="",setTimeout(()=>this.disableOkayButton(),0)}ngOnInit(){const e=this.getData();e&&(this.action=e.action,this.actionRejectStatusParam=e.actionRejectStatusParam)}onValueChanged(){this.rejectReason&&this.rejectReason.length>0?this.enableOkayButton():this.disableOkayButton()}ok(){this.showLoadingIndicator();const e=new Date(Date.now()).toString(),t=new c.a(void 0);t.properties.push(new l.a("SPFXmtlIssueState",this.actionRejectStatusParam),new l.a("SDAProjComsRejectReason",this.rejectReason),new l.a("SDAProjComsRejectedByUser",this.securityService.getUserId()),new l.a("SDAProjComsRejectDate",this.dateFormatService.convertToSPFDateFormat(e))),this.crudService.update(this.action.OBID,t).subscribe(()=>{this.dataService.get("SelectLists('e1XmtlIssueStates')/Items?$filter=Id eq '"+this.actionRejectStatusParam+"'",this.configService.selectedCreateConfig).subscribe(t=>{const i=new ft.a(!0);this.action.Status=this.actionRejectStatusParam,this.action.RejectDetails={RejectReason:this.rejectReason,RejectUser:this.securityService.getUserId(),RejectDate:e},t&&t.length>0&&(this.action.StatusDisplay=t[0].DisplayAs),this.notificationService.success(this.sdaTranslateService.get("REVIEW_ACTION_STATUS_SUCCESS","Action status updated")),i.setData(this.action),this.hideLoadingIndicator(),this.closeModal.next(i)},e=>{this.exceptionService.handleException(e),this.hideLoadingIndicator()})},e=>{this.exceptionService.handleException(e),this.hideLoadingIndicator()})}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(S.a),n.Sb(u.a),n.Sb(O.a),n.Sb(d.a),n.Sb(mt.a),n.Sb(Et.a),n.Sb(m.a),n.Sb(Pe.a),n.Sb(w.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["ng-component"]],features:[n.Bb],decls:3,vars:2,consts:[[1,"reject-action__title"],["pInputTextarea","","rows","3",1,"reject-action__content",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(n.Yb(0,"label",0),n.Uc(1),n.Xb(),n.Yb(2,"textarea",1),n.hc("ngModelChange",(function(e){return t.rejectReason=e}))("ngModelChange",(function(){return t.onValueChanged()})),n.Xb()),2&e&&(n.Eb(1),n.Vc(t.REVIEW_ACTION_REJECT_COMMENT),n.Eb(1),n.sc("ngModel",t.rejectReason))},directives:[Je.c,Je.p,Je.s],styles:[".reject-action__title[_ngcontent-%COMP%]{margin-left:10px}.reject-action__content[_ngcontent-%COMP%]{width:95%;margin:10px 20px auto 10px}"]}),e})();var pt=i("dLJk");function bt(e,t){if(1&e){const e=n.Zb();n.Yb(0,"input",24,25),n.hc("ngModelChange",(function(t){return n.Kc(e),n.lc().action.Title=t}))("blur",(function(){n.Kc(e);const t=n.Hc(1);return n.lc().onLeaveInput(t)})),n.Xb()}if(2&e){const e=n.lc();n.sc("ngModel",e.action.Title)}}function Rt(e,t){if(1&e&&(n.Tb(0,"h3",26),n.mc(1,"sdaConvertURLsToHREF")),2&e){const e=n.lc();n.sc("innerHTML",n.nc(1,1,e.action.Title),n.Lc)}}function gt(e,t){if(1&e){const e=n.Zb();n.Yb(0,"button",27),n.hc("click",(function(){return n.Kc(e),n.lc().cancelSave()})),n.Uc(1),n.Xb()}if(2&e){const e=n.lc();n.Eb(1),n.Wc(" ",e.CANCEL," ")}}function Ot(e,t){if(1&e){const e=n.Zb();n.Yb(0,"p-toggleButton",28),n.hc("ngModelChange",(function(t){return n.Kc(e),n.lc().isInEditMode=t}))("click",(function(){return n.Kc(e),n.lc().save()})),n.Xb()}if(2&e){const e=n.lc();n.sc("ngModel",e.isInEditMode)("onLabel",e.SAVE_UPPERCASE)("offLabel",e.EDIT_UPPERCASE)}}function vt(e,t){if(1&e){const e=n.Zb();n.Yb(0,"button",29),n.hc("click",(function(){return n.Kc(e),n.lc(),n.Hc(10).toggle()})),n.Xb()}}function Tt(e,t){if(1&e){const e=n.Zb();n.Yb(0,"a",30),n.hc("click",(function(i){return n.Kc(e),t.$implicit.action(i)})),n.Uc(1),n.Xb()}if(2&e){const e=t.$implicit;n.Eb(1),n.Wc(" ",e.title," ")}}function St(e,t){if(1&e&&(n.Yb(0,"span",42),n.Tb(1,"mat-icon",43),n.Xb()),2&e){const e=n.lc(2);n.Ib("card-status__user__icon--you",e.isRejectUserCurrentUser),n.sc("title",e.QA_DOCUMENT_REVIEW_REVIEWER_ICON)}}function wt(e,t){if(1&e&&(n.Yb(0,"span",42),n.Tb(1,"mat-icon",44),n.Xb()),2&e){const e=n.lc(2);n.Ib("card-status__user__icon--you",e.isRejectUserCurrentUser),n.sc("title",e.QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON)}}function Ct(e,t){if(1&e&&(n.Yb(0,"span",45),n.Uc(1),n.Xb()),2&e){const e=n.lc(2);n.Eb(1),n.Wc(" ",e.YOU," ")}}function Mt(e,t){if(1&e){const e=n.Zb();n.Yb(0,"button",46),n.hc("click",(function(){return n.Kc(e),n.lc(2).undoReject()})),n.Uc(1),n.Xb()}if(2&e){const e=n.lc(2);n.Eb(1),n.Wc(" ",e.REVIEW_ACTION_UNDO_BUTTON," ")}}function Dt(e,t){if(1&e&&(n.Yb(0,"div",31),n.Yb(1,"span",32),n.Uc(2),n.Xb(),n.Yb(3,"span",33),n.Sc(4,St,2,3,"span",34),n.Sc(5,wt,2,3,"ng-template",null,35,n.Tc),n.Yb(7,"span",36),n.Uc(8),n.Sc(9,Ct,2,1,"span",37),n.Xb(),n.Xb(),n.Yb(10,"span",38),n.Tb(11,"i",39),n.Uc(12),n.mc(13,"sdaConvertToLocalDate"),n.Xb(),n.Sc(14,Mt,2,1,"button",40),n.Yb(15,"div",41),n.Uc(16),n.Xb(),n.Xb()),2&e){const e=n.Hc(6),t=n.lc();n.Eb(2),n.Vc(t.REVIEW_ACTION_REJECTED_BUTTON),n.Eb(2),n.sc("ngIf",!t.isRejectUserConsolidator)("ngIfElse",e),n.Eb(4),n.Wc(" ",t.action.RejectDetails.RejectUser," "),n.Eb(1),n.sc("ngIf",t.isRejectUserCurrentUser),n.Eb(3),n.Wc(" ",n.nc(13,8,t.action.RejectDetails.RejectDate)," "),n.Eb(2),n.sc("ngIf",!t.action.IsReferenceAction&&0!==t.mode&&1!==t.mode),n.Eb(2),n.Vc(t.action.RejectDetails.RejectReason)}}function At(e,t){if(1&e&&(n.Yb(0,"div",31),n.Yb(1,"span",32),n.Uc(2),n.Xb(),n.Yb(3,"div",41),n.Uc(4),n.Xb(),n.Xb()),2&e){const e=n.lc();n.Eb(2),n.Vc(e.WARNING),n.Eb(2),n.Vc(e.REVIEW_MARKUPS_INVALID_ACTIONS_WARNING)}}function Nt(e,t){if(1&e&&(n.Yb(0,"div",16),n.Tb(1,"i",17),n.Yb(2,"p",18),n.Uc(3),n.mc(4,"sdaConvertToLocalDate"),n.Xb(),n.Xb()),2&e){const e=n.lc();n.Eb(3),n.Xc("",e.TARGET,": ",n.nc(4,2,e.action.TargetDate),"")}}function Pt(e,t){if(1&e&&(n.Yb(0,"div",16),n.Tb(1,"i",47),n.Yb(2,"p",48),n.Uc(3),n.Xb(),n.Xb()),2&e){const e=n.lc();n.Eb(3),n.Vc(e.action.StatusDisplay)}}function yt(e,t){if(1&e&&(n.Yb(0,"div",16),n.Tb(1,"i",49),n.Yb(2,"p",50),n.Uc(3),n.Xb(),n.Xb()),2&e){const e=n.lc();n.Eb(2),n.sc("title",e.REVIEW_ACTION_MARKUPS_IDENTIFIED_TOOLTIP),n.Eb(1),n.Wc(" ",e.REVIEW_ACTION_MARKUPS_IDENTIFIED," ")}}function Ut(e,t){if(1&e){const e=n.Zb();n.Yb(0,"textarea",51,52),n.hc("blur",(function(){n.Kc(e);const t=n.Hc(1);return n.lc().onLeaveInput(t)}))("ngModelChange",(function(t){return n.Kc(e),n.lc().action.Details=t})),n.Xb()}if(2&e){const e=n.lc();n.sc("sdaFocus",e.isInEditMode)("ngModel",e.action.Details)("disabled",(!e.user.IsCurrentUser||0===e.mode||"e1XmtlIssueStateISSUED"===e.action.Status)&&(2!==e.mode&&4!==e.mode||"e1XmtlIssueStateINITIATED"!==e.action.Status))}}function Bt(e,t){if(1&e&&(n.Tb(0,"p",53),n.mc(1,"sdaConvertURLsToHREF")),2&e){const e=n.lc();n.sc("innerHTML",n.nc(1,1,e.action.Details),n.Lc)}}let Ft=(()=>{class e{constructor(e,t,i,o,s,r,a,c,l,d,u){this.exceptionService=e,this.notificationService=t,this.crudService=i,this.modalService=o,this.dataService=s,this.sdaTranslateService=r,this.configService=a,this.reviewProvider=c,this.componentFactoryResolver=l,this.injector=d,this.objectDetailsService=u,this.onTerminated=new n.o,this.onEditAction=new n.o,this.onRejectAction=new n.o,this.onManageMarkupLayers=new n.o,this.onFileClicked=new n.o,this.onViewAndMarkup=new n.o,this.onManageActionRelatedItems=new n.o,this.onRelBuilderClosed=new n.o,this.REVIEW_ACTION_TERMINATE_BUTTON=this.sdaTranslateService.get("REVIEW_ACTION_TERMINATE_BUTTON","Terminate"),this.REVIEW_ACTION_UPDATE_BUTTON=this.sdaTranslateService.get("REVIEW_ACTION_UPDATE_BUTTON","Update"),this.REVIEW_ACTION_REJECT_BUTTON=this.sdaTranslateService.get("REVIEW_ACTION_REJECT_BUTTON","Reject"),this.REVIEW_ACTION_MANAGE_LAYERS_BUTTON=this.sdaTranslateService.get("REVIEW_ACTION_MANAGE_LAYERS_BUTTON","Manage Layers"),this.REVIEW_ACTION_UNDO_BUTTON=this.sdaTranslateService.get("REVIEW_ACTION_UNDO_BUTTON","undo"),this.REVIEW_ACTION_REJECTED_BUTTON=this.sdaTranslateService.get("REVIEW_ACTION_REJECTED_BUTTON","Rejected"),this.REVIEW_ACTION_MARKUPS_IDENTIFIED=this.sdaTranslateService.get("REVIEW_ACTION_MARKUPS_IDENTIFIED","MARKUPS IDENTIFIED"),this.REVIEW_ACTION_MARKUPS_IDENTIFIED_TOOLTIP=this.sdaTranslateService.get("REVIEW_ACTION_MARKUPS_IDENTIFIED_TOOLTIP","Markups to be transmitted have been selected."),this.REVIEW_NO_LONGER_AVAILABLE_FOR_EDITING=this.sdaTranslateService.get("REVIEW_NO_LONGER_AVAILABLE_FOR_EDITING","The review is no longer available for editing because the document review process has been completed. <BR/>You will now be returned to the To Do List."),this.WARNING=this.sdaTranslateService.get("WARNING","Warning"),this.REVIEW_MARKUPS_INVALID_ACTIONS_WARNING=this.sdaTranslateService.get("REVIEW_MARKUPS_INVALID_ACTIONS_WARNING","One or more selected markup layers contain an action that is Rejected or Reserved. If the markup layer is selected the review cannot be completed."),this.YOU=this.sdaTranslateService.get("YOU","You"),this.QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON=this.sdaTranslateService.get("QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON","Document Review Consolidator"),this.QA_DOCUMENT_REVIEW_REVIEWER_ICON=this.sdaTranslateService.get("QA_DOCUMENT_REVIEW_REVIEWER_ICON","Document Reviewer"),this.relatedPrimaryDocumentRelDef="SCLBActionPrimaryDocVersion",this.relatedPrimaryDocumentRelDefIs12=!1,this.relatedReferenceDocumentRelDef="SCLBActionReferenceDocVersions",this.relatedReferenceDocumentRelDefIs12=!1,this.relatedFileRelDef="SPFFileComposition",this.relatedFileRelDefIs12=!1,this.relatedOtherObjectRelDef="SDAProjectComsReferenceData",this.relatedOtherObjectRelDefIs12=!1,this.REVIEW_ACTION_TITLE=this.sdaTranslateService.get("REVIEW_ACTION_TITLE","Action"),this.UPDATED=this.sdaTranslateService.get("UPDATED","Updated"),this.TARGET=this.sdaTranslateService.get("TARGET","Target"),this.SAVE_UPPERCASE=this.sdaTranslateService.get("SAVE_UPPERCASE","SAVE"),this.EDIT_UPPERCASE=this.sdaTranslateService.get("EDIT_UPPERCASE","EDIT"),this.CANCEL=this.sdaTranslateService.get("CANCEL","Cancel"),this.DETAILS=this.sdaTranslateService.get("DETAILS","Details"),this.NAVIGATE_ACTION_PIN_BUTTON=this.sdaTranslateService.get("NAVIGATE_ACTION_PIN_BUTTON","View Action Pin"),this.overflowButtonOptions=new Array,this.detailsHistory="",this.titleHistory=""}ngOnInit(){this.setRejectActionUserAsCurrentUserOrConsolidator(),this.initialiseOverflowOptions()}terminate(){this.user&&this.user.IsCurrentUser&&this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{e?this.modalService.confirm(this.sdaTranslateService.get("REVIEW_ACTION_TERMINATE_TITLE","Terminate Action"),this.sdaTranslateService.get("REVIEW_ACTION_TERMINATE_MSG","Would you like to terminate the action?")).then(e=>{e&&this.crudService.terminate(this.action.OBID).subscribe(()=>{this.notificationService.success(this.sdaTranslateService.get("REVIEW_ACTION_TERMINATE_SUCCESS","Action successfully terminated")),this.onTerminated.emit(this.action)},e=>{this.exceptionService.handleException(e)})}):this.reviewProvider.reviewCompletedMessageAndEjectUser()})}reject(){const e=new Fe.a(this.sdaTranslateService.get("REVIEW_ACTION_REJECT_TITLE","Reject Action"),It,this.componentFactoryResolver,this.injector);e.data={action:this.action,actionRejectStatusParam:this.actionRejectStatusParam},this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(t=>{t?this.modalService.showModal(e).then(e=>{e.ok&&(this.action=e.getData(),this.initialiseOverflowOptions(),this.setRejectActionUserAsCurrentUserOrConsolidator(),this.onRejectAction.emit(this.action))}):this.reviewProvider.reviewCompletedMessageAndEjectUser()})}save(){this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{if(e)if(this.isInEditMode)this.detailsHistory=this.action.Details.slice(0),this.titleHistory=this.action.Title.slice(0);else{const e=new c.a(void 0);e.properties.push(new l.a("SDAProjComsDetails",this.action.Details),new l.a("Description",this.action.Title)),this.crudService.update(this.action.OBID,e).subscribe(()=>{this.dataService.get("Objects('"+this.action.OBID+"')/?$select=LastUpdatedDate",this.configService.selectedCreateConfig,!0).subscribe(e=>{if(!e||!e.LastUpdatedDate)throw new de.a(this.sdaTranslateService.get("REVIEW_ACTION_UPDATE_FAILED","Failed to save action"));this.action.ModifiedDate=e.LastUpdatedDate,this.action.isDirty=!1,this.notificationService.success(this.sdaTranslateService.get("REVIEW_ACTION_UPDATE_SUCCESS","Action successfully saved"))})},e=>{this.exceptionService.handleException(e)})}else this.reviewProvider.reviewCompletedMessageAndEjectUser()})}cancelSave(){this.isInEditMode=!1,this.action.isDirty=!1,this.action.Details=this.detailsHistory,this.action.Title=this.titleHistory}update(){this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{e?this.onEditAction.emit(this.action):this.reviewProvider.reviewCompletedMessageAndEjectUser()})}undoReject(){this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{if(e){const e=new c.a(void 0);e.properties.push(new l.a("SPFXmtlIssueState","e1XmtlIssueStateINITIATED"),new l.a("SDAProjComsRejectReason",""),new l.a("SDAProjComsRejectedByUser",""),new l.a("SDAProjComsRejectDate","")),this.crudService.update(this.action.OBID,e).subscribe(()=>{this.dataService.get("SelectLists('e1XmtlIssueStates')/Items?$filter=Id eq 'e1XmtlIssueStateINITIATED'",this.configService.selectedCreateConfig).subscribe(e=>{this.action.Status="e1XmtlIssueStateINITIATED",e&&e.length>0&&(this.action.StatusDisplay=e[0].DisplayAs),this.initialiseOverflowOptions(),this.notificationService.success(this.sdaTranslateService.get("REVIEW_ACTION_STATUS_SUCCESS","Action status updated")),this.onRejectAction.emit(this.action)},e=>{this.exceptionService.handleException(e)})},e=>{this.exceptionService.handleException(e)})}else this.reviewProvider.reviewCompletedMessageAndEjectUser()})}manageLayers(){this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{e?this.onManageMarkupLayers.emit(this.action):this.reviewProvider.reviewCompletedMessageAndEjectUser()})}onLeaveInput(e){this.action.isDirty=e.dirty||this.action.isDirty}navigateToPin(){this.onViewAndMarkup.emit(this.action)}initialiseOverflowOptions(){this.overflowButtonOptions=[],this.addDetailsOption(),this.action.IsReferenceAction||(this.addRejectOption(),this.addManageLayersOption()),this.addNavigationOption(),(this.user&&this.user.IsCurrentUser&&this.mode!==D.a.ViewOnly&&this.action&&"e1XmtlIssueStateISSUED"!==this.action.Status||(this.mode===D.a.Consolidate||this.mode===D.a.Reconsolidate)&&"e1XmtlIssueStateINITIATED"===this.action.Status)&&!this.action.IsReferenceAction&&(this.addUpdateOption(),this.addTerminateOption())}addRejectOption(){this.mode!==D.a.Consolidate&&this.mode!==D.a.Compliance&&this.mode!==D.a.Reconsolidate||!this.action||"e1XmtlIssueStateINITIATED"!==this.action.Status||this.overflowButtonOptions.push({title:this.REVIEW_ACTION_REJECT_BUTTON,action:()=>{this.reject()}})}showObjectDetails(){this.objectDetailsService.showObjectDetailsModal(this.componentFactoryResolver,this.injector,new v.a(this.action.OBID,"",this.action.Config))}addManageLayersOption(){this.userCanManageMarkupLayers&&this.overflowButtonOptions.push({title:this.REVIEW_ACTION_MANAGE_LAYERS_BUTTON,action:()=>{this.manageLayers()}})}addUpdateOption(){this.userCanUpdateAction&&this.overflowButtonOptions.push({title:this.REVIEW_ACTION_UPDATE_BUTTON,action:()=>{this.update()}})}addTerminateOption(){!this.fileAction&&this.user&&this.user.IsCurrentUser&&this.overflowButtonOptions.push({title:this.REVIEW_ACTION_TERMINATE_BUTTON,action:()=>{this.terminate()}})}addNavigationOption(){this.action.HasRelatedPin&&this.overflowButtonOptions.push({title:this.NAVIGATE_ACTION_PIN_BUTTON,action:()=>{this.navigateToPin()}})}addDetailsOption(){this.overflowButtonOptions.push({title:this.DETAILS,action:()=>{this.showObjectDetails()}})}setRejectActionUserAsCurrentUserOrConsolidator(){if(this.user=this.users.filter(e=>e.OBID===this.action.UserOBID)[0],this.action&&this.action.RejectDetails&&this.action.RejectDetails.RejectUser){const e=this.users.filter(e=>e.DisplayName.toUpperCase()===this.action.RejectDetails.RejectUser.toUpperCase());e.length>0&&(this.isRejectUserCurrentUser=e[0].IsCurrentUser,this.isRejectUserConsolidator=e[0].IsConsolidator)}}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(u.a),n.Sb(S.a),n.Sb(d.a),n.Sb(m.a),n.Sb(Pe.a),n.Sb(O.a),n.Sb(w.a),n.Sb(A.a),n.Sb(n.j),n.Sb(n.s),n.Sb(Be.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-action-view"]],inputs:{action:"action",users:"users",documentOBID:"documentOBID",config:"config",mode:"mode",fileAction:"fileAction",userCanUpdateAction:"userCanUpdateAction",userCanManageMarkupLayers:"userCanManageMarkupLayers",workflowStep:"workflowStep",actionRejectStatusParam:"actionRejectStatusParam"},outputs:{onTerminated:"onTerminated",onEditAction:"onEditAction",onRejectAction:"onRejectAction",onManageMarkupLayers:"onManageMarkupLayers",onFileClicked:"onFileClicked",onViewAndMarkup:"onViewAndMarkup",onManageActionRelatedItems:"onManageActionRelatedItems",onRelBuilderClosed:"onRelBuilderClosed"},features:[n.Db([A.a])],decls:29,vars:41,consts:[[1,"card-item"],[1,"card-header"],[1,"card-heading"],["type","text","class","card-heading__edit",3,"ngModel","ngModelChange","blur",4,"ngIf"],["class","card-heading__title",3,"innerHTML",4,"ngIf"],[1,"card-actions"],["class","card-actions__button sda-button sda-button--clear",3,"click",4,"ngIf"],["class","card-actions__toggle",3,"ngModel","onLabel","offLabel","ngModelChange","click",4,"ngIf"],["class","card-actions__button sda-button sda-button--clear fa fa-ellipsis-v",3,"click",4,"ngIf"],[3,"closeOnAllClicks"],["overlay",""],[1,"sda-overlay-content-hook"],[1,"comp-overflow"],["class","comp-overflow__item",3,"click",4,"ngFor","ngForOf"],["class","card-status",4,"ngIf"],[1,"card-section","card-section--info"],[1,"card-info"],["aria-hidden","true",1,"card-info__icon","fa","fa-clock-o"],[1,"card-info__data"],["class","card-info",4,"ngIf"],[1,"card-section","card-section--main"],["class","card-section__textarea",3,"sdaFocus","ngModel","disabled","blur","ngModelChange",4,"ngIf"],["class","card-section__content",3,"innerHTML",4,"ngIf"],[3,"supportingInformation","primaryFileRenditions","referenceFileRenditions","parentOBID","isEditable","config","documentOBID","mode","relatedFileRelDef","relatedFileRelDefIs12","relatedPrimaryDocumentRelDef","relatedPrimaryDocumentRelDefIs12","relatedReferenceDocumentRelDef","relatedReferenceDocumentRelDefIs12","relatedOtherObjectRelDef","relatedOtherObjectRelDefIs12","workflowStep","onFileClicked","onManageItems","onRelBuilderClosed"],["type","text",1,"card-heading__edit",3,"ngModel","ngModelChange","blur"],["title","ngModel"],[1,"card-heading__title",3,"innerHTML"],[1,"card-actions__button","sda-button","sda-button--clear",3,"click"],[1,"card-actions__toggle",3,"ngModel","onLabel","offLabel","ngModelChange","click"],[1,"card-actions__button","sda-button","sda-button--clear","fa","fa-ellipsis-v",3,"click"],[1,"comp-overflow__item",3,"click"],[1,"card-status"],[1,"card-status__title"],[1,"card-status__user"],["class","card-status__user",3,"card-status__user__icon--you","title",4,"ngIf","ngIfElse"],["yesToConsolidator",""],[1,"card-status__user__title"],["class","card-status__user__title__you",4,"ngIf"],[1,"card-status__date"],["aria-hidden","true",1,"fa","fa-clock-o","card-status__icon"],["class","card-status__button sda-button",3,"click",4,"ngIf"],[1,"card-status__reason"],[1,"card-status__user",3,"title"],["svgIcon","user",1,"class.card-status__user__icon"],["svgIcon","user-hardhat",1,"class.card-status__user__icon"],[1,"card-status__user__title__you"],[1,"card-status__button","sda-button",3,"click"],["aria-hidden","true",1,"card-info__icon","fa","fa-circle-o-notch"],[1,"stats-bar__data"],["aria-hidden","true",1,"card-info__icon","fa","fa-th"],[1,"card-info__data","card-info__data--tooltip",3,"title"],[1,"card-section__textarea",3,"sdaFocus","ngModel","disabled","blur","ngModelChange"],["details","ngModel"],[1,"card-section__content",3,"innerHTML"]],template:function(e,t){1&e&&(n.Yb(0,"div",0),n.Yb(1,"header",1),n.Yb(2,"div",2),n.Sc(3,bt,2,1,"input",3),n.Sc(4,Rt,2,3,"h3",4),n.Xb(),n.Yb(5,"aside",5),n.Sc(6,gt,2,1,"button",6),n.Sc(7,Ot,1,3,"p-toggleButton",7),n.Sc(8,vt,1,0,"button",8),n.Yb(9,"sda-overlay",9,10),n.Yb(11,"div",11),n.Yb(12,"nav",12),n.Sc(13,Tt,2,1,"a",13),n.Xb(),n.Xb(),n.Xb(),n.Xb(),n.Xb(),n.Sc(14,Dt,17,10,"div",14),n.Sc(15,At,5,2,"div",14),n.Yb(16,"section",15),n.Yb(17,"div",16),n.Tb(18,"i",17),n.Yb(19,"p",18),n.Uc(20),n.mc(21,"sdaConvertToLocalDateTime"),n.Xb(),n.Xb(),n.Sc(22,Nt,5,4,"div",19),n.Sc(23,Pt,4,1,"div",19),n.Sc(24,yt,4,2,"div",19),n.Xb(),n.Yb(25,"section",20),n.Sc(26,Ut,2,3,"textarea",21),n.Sc(27,Bt,2,3,"p",22),n.Xb(),n.Yb(28,"sda-supporting-information-view",23),n.hc("onFileClicked",(function(e){return t.onFileClicked.emit(e)}))("onManageItems",(function(){return t.onManageActionRelatedItems.emit(t.action)}))("onRelBuilderClosed",(function(){return t.onRelBuilderClosed.emit()})),n.Xb(),n.Xb()),2&e&&(n.Ib("card-item--approved",t.user.HasContentBeenConsolidated&&t.action.Status!==t.actionRejectStatusParam)("card-item--rejected",t.action.Status===t.actionRejectStatusParam)("card-item--warning",t.action.HasRejectedMarkupActions||t.action.HasReservedMarkupActions),n.Eb(3),n.sc("ngIf",t.isInEditMode),n.Eb(1),n.sc("ngIf",!t.isInEditMode),n.Eb(2),n.sc("ngIf",!t.action.IsReferenceAction&&t.isInEditMode),n.Eb(1),n.sc("ngIf",!t.action.IsReferenceAction&&(t.user.IsCurrentUser&&0!==t.mode&&"e1XmtlIssueStateISSUED"!==t.action.Status||(2===t.mode||4===t.mode)&&"e1XmtlIssueStateINITIATED"===t.action.Status)),n.Eb(1),n.sc("ngIf",(null==t.overflowButtonOptions?null:t.overflowButtonOptions.length)>0),n.Eb(1),n.sc("closeOnAllClicks",!0),n.Eb(4),n.sc("ngForOf",t.overflowButtonOptions),n.Eb(1),n.sc("ngIf",t.action.Status===t.actionRejectStatusParam),n.Eb(1),n.sc("ngIf",(t.action.HasRejectedMarkupActions||t.action.HasReservedMarkupActions)&&!(t.action.Status===t.actionRejectStatusParam)),n.Eb(5),n.Xc("",t.UPDATED,": ",n.nc(21,39,t.action.ModifiedDate),""),n.Eb(2),n.sc("ngIf",t.action.TargetDate),n.Eb(1),n.sc("ngIf",t.action.StatusDisplay),n.Eb(1),n.sc("ngIf",t.action.HasRelatedMarkups),n.Eb(2),n.sc("ngIf",t.isInEditMode),n.Eb(1),n.sc("ngIf",!t.isInEditMode),n.Eb(1),n.sc("supportingInformation",t.action.SupportingInformation)("primaryFileRenditions",t.action.PrimaryFileRenditions)("referenceFileRenditions",t.action.ReferenceFileRenditions)("parentOBID",t.action.OBID)("isEditable",t.user.IsCurrentUser)("config",t.config)("documentOBID",t.documentOBID)("mode",t.mode)("relatedFileRelDef",t.relatedFileRelDef)("relatedFileRelDefIs12",t.relatedFileRelDefIs12)("relatedPrimaryDocumentRelDef",t.relatedPrimaryDocumentRelDef)("relatedPrimaryDocumentRelDefIs12",t.relatedPrimaryDocumentRelDefIs12)("relatedReferenceDocumentRelDef",t.relatedReferenceDocumentRelDef)("relatedReferenceDocumentRelDefIs12",t.relatedReferenceDocumentRelDefIs12)("relatedOtherObjectRelDef",t.relatedOtherObjectRelDef)("relatedOtherObjectRelDefIs12",t.relatedOtherObjectRelDefIs12)("workflowStep",t.workflowStep))},directives:[y.t,U.a,y.s,Qe,Je.c,Je.p,Je.s,ze.a,he.a,Ze.a],pipes:[_e.a,qe.a,pt.a],styles:["[_nghost-%COMP%]{display:flex;justify-content:center}"]}),e})();function Lt(e,t){if(1&e){const e=n.Zb();n.Yb(0,"button",2),n.hc("click",(function(){return n.Kc(e),n.lc().onCreateAction.emit()})),n.Tb(1,"i",3),n.Tb(2,"i",4),n.Xb()}if(2&e){const e=n.lc();n.sc("title",e.REVIEW_ACTION_CREATE_BUTTON_TOOLTIP)}}function kt(e,t){if(1&e&&(n.Yb(0,"div",14),n.Tb(1,"mat-icon",15),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.Ib("card-user__icon--you",e.key.IsCurrentUser),n.sc("title",t.QA_DOCUMENT_REVIEW_REVIEWER_ICON)}}function Vt(e,t){if(1&e&&(n.Yb(0,"div",16),n.Tb(1,"mat-icon",17),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.Ib("card-user__icon--you",e.key.IsCurrentUser),n.sc("title",t.QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON)}}function xt(e,t){if(1&e&&(n.Yb(0,"span",18),n.Uc(1),n.Xb()),2&e){const e=n.lc(2);n.Eb(1),n.Wc(" ",e.YOU," ")}}function Wt(e,t){if(1&e&&(n.Yb(0,"span",19),n.Tb(1,"i",20),n.Uc(2),n.Xb()),2&e){const e=n.lc(2);n.Eb(2),n.Wc(" ",e.REVIEW_ACTION_SIGNED_OFF," ")}}function Yt(e,t){if(1&e){const e=n.Zb();n.Yb(0,"sda-action-view",21),n.hc("onTerminated",(function(){n.Kc(e);const i=t.$implicit;return n.lc(2).actionTerminated(i)}))("onEditAction",(function(t){return n.Kc(e),n.lc(2).onEditAction.emit(t)}))("onRejectAction",(function(t){return n.Kc(e),n.lc(2).onRejectAction.emit(t)}))("onManageMarkupLayers",(function(t){return n.Kc(e),n.lc(2).onManageMarkupLayers.emit(t)}))("onFileClicked",(function(t){return n.Kc(e),n.lc(2).onFileClicked.emit(t)}))("onManageActionRelatedItems",(function(t){return n.Kc(e),n.lc(2).onManageActionRelatedItems.emit(t)}))("onRelBuilderClosed",(function(){return n.Kc(e),n.lc(2).onRelBuilderClosed.emit()}))("onViewAndMarkup",(function(t){return n.Kc(e),n.lc(2).onViewAndMarkup.emit(t)})),n.Xb()}if(2&e){const e=t.$implicit,i=n.lc(2);n.sc("mode",i.mode)("actionRejectStatusParam",i.actionRejectStatusParam)("action",e)("config",i.config)("documentOBID",i.documentOBID)("fileAction",i.fileAction)("users",i.users)("userCanUpdateAction",i.userCanUpdateAction)("userCanManageMarkupLayers",i.userCanManageMarkupLayers)("workflowStep",i.workflowStep)}}function jt(e,t){if(1&e&&(n.Yb(0,"div",5),n.Yb(1,"div",6),n.Yb(2,"div",7),n.Sc(3,kt,2,3,"div",8),n.Sc(4,Vt,2,3,"ng-template",null,9,n.Tc),n.Yb(6,"h4",10),n.Uc(7),n.Sc(8,xt,2,1,"span",11),n.Xb(),n.Sc(9,Wt,3,1,"span",12),n.Xb(),n.Xb(),n.Sc(10,Yt,1,10,"sda-action-view",13),n.Xb()),2&e){const e=t.$implicit,i=n.Hc(5),o=n.lc();n.Eb(3),n.sc("ngIf",o.actions&&!e.key.IsConsolidator)("ngIfElse",i),n.Eb(4),n.Wc(" ",e.key.DisplayName," "),n.Eb(1),n.sc("ngIf",e.key.IsCurrentUser),n.Eb(1),n.sc("ngIf",e.key.HasContentBeenConsolidated),n.Eb(1),n.sc("ngForOf",e.value)}}let Xt=(()=>{class e{constructor(e){this.sdaTranslateService=e,this.onActionTerminated=new n.o,this.onCreateAction=new n.o,this.onEditAction=new n.o,this.onRejectAction=new n.o,this.onManageMarkupLayers=new n.o,this.onFileClicked=new n.o,this.onManageActionRelatedItems=new n.o,this.onRelBuilderClosed=new n.o,this.onViewAndMarkup=new n.o,this.userActions=new Array,this.YOU=this.sdaTranslateService.get("YOU","You"),this.QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON=this.sdaTranslateService.get("QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON","Document Review Consolidator"),this.QA_DOCUMENT_REVIEW_REVIEWER_ICON=this.sdaTranslateService.get("QA_DOCUMENT_REVIEW_REVIEWER_ICON","Document Reviewer"),this.REVIEW_ACTION_CREATE_BUTTON_TOOLTIP=this.sdaTranslateService.get("REVIEW_ACTION_CREATE_BUTTON_TOOLTIP","Create action"),this.REVIEW_ACTION_SIGNED_OFF=this.sdaTranslateService.get("REVIEW_ACTION_SIGNED_OFF","Consolidated")}ngOnInit(){this.initialiseView()}actionTerminated(e){e&&(this.onActionTerminated.emit(e),this.actions=this.actions.filter(t=>t.OBID!==e.OBID),this.initialiseView())}initialiseView(){if(this.actions&&this.actions.length>0&&this.users){let e;this.userActions=[],this.users.forEach((t,i)=>{const n=this.actions.filter(e=>e.UserOBID===t.OBID).sort((e,t)=>Ne.a.sortByDate(new Date(e.ModifiedDate.toString()),new Date(t.ModifiedDate.toString())));n.length>0&&(t.IsCurrentUser?e=new T.a(t,n):this.userActions.push(new T.a(t,n))),i===this.users.length-1&&(this.userActions=this.userActions.sort((e,t)=>Ne.a.sortByString(e.key.DisplayName,t.key.DisplayName)),e&&this.userActions.unshift(e))})}}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(O.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-action-group-view"]],inputs:{actions:"actions",users:"users",documentOBID:"documentOBID",config:"config",mode:"mode",fileAction:"fileAction",userCanUpdateAction:"userCanUpdateAction",userCanCreateAction:"userCanCreateAction",userCanManageMarkupLayers:"userCanManageMarkupLayers",workflowStep:"workflowStep",actionRejectStatusParam:"actionRejectStatusParam",isReferenceGroup:"isReferenceGroup"},outputs:{onActionTerminated:"onActionTerminated",onCreateAction:"onCreateAction",onEditAction:"onEditAction",onRejectAction:"onRejectAction",onManageMarkupLayers:"onManageMarkupLayers",onFileClicked:"onFileClicked",onManageActionRelatedItems:"onManageActionRelatedItems",onRelBuilderClosed:"onRelBuilderClosed",onViewAndMarkup:"onViewAndMarkup"},decls:2,vars:2,consts:[["class","action-group__button",3,"title","click",4,"ngIf"],["class","grid",4,"ngFor","ngForOf"],[1,"action-group__button",3,"title","click"],[1,"fa","fa-plus"],[1,"fa","fa-commenting","fa-lg"],[1,"grid"],[1,"card-user","col-100"],[1,"card-user__body"],[3,"card-user__icon--you","title",4,"ngIf","ngIfElse"],["yesToConsolidator",""],[1,"card-user__name"],["class","card-user__name__title__you",4,"ngIf"],["class","card-badge card-badge--completed",4,"ngIf"],["class","col-50",3,"mode","actionRejectStatusParam","action","config","documentOBID","fileAction","users","userCanUpdateAction","userCanManageMarkupLayers","workflowStep","onTerminated","onEditAction","onRejectAction","onManageMarkupLayers","onFileClicked","onManageActionRelatedItems","onRelBuilderClosed","onViewAndMarkup",4,"ngFor","ngForOf"],[3,"title"],["svgIcon","user",1,"class.card-user__icon"],[1,"card-user__body",3,"title"],["svgIcon","user-hardhat",1,"class.card-user__icon"],[1,"card-user__name__title__you"],[1,"card-badge","card-badge--completed"],["aria-hidden","true",1,"fa","fa-check"],[1,"col-50",3,"mode","actionRejectStatusParam","action","config","documentOBID","fileAction","users","userCanUpdateAction","userCanManageMarkupLayers","workflowStep","onTerminated","onEditAction","onRejectAction","onManageMarkupLayers","onFileClicked","onManageActionRelatedItems","onRelBuilderClosed","onViewAndMarkup"]],template:function(e,t){1&e&&(n.Sc(0,Lt,3,1,"button",0),n.Sc(1,jt,11,6,"div",1)),2&e&&(n.sc("ngIf",(1===t.mode||2===t.mode||4===t.mode)&&t.userCanCreateAction&&!t.fileAction&&!t.isReferenceGroup),n.Eb(1),n.sc("ngForOf",t.userActions))},directives:[y.t,y.s,he.a,Ft],styles:[".action-group__button[_ngcontent-%COMP%]{justify-content:space-around;height:auto;margin:10px;padding:6px 10px;font-size:14px}"]}),e})();function Gt(e,t){if(1&e&&(n.Yb(0,"label"),n.Uc(1),n.Xb()),2&e){const e=n.lc();n.Eb(1),n.Vc(e.MARKUP_LAYER)}}function Kt(e,t){if(1&e){const e=n.Zb();n.Yb(0,"input",24,25),n.hc("blur",(function(){n.Kc(e);const t=n.Hc(1);return n.lc().onLeaveInput(t)}))("ngModelChange",(function(t){return n.Kc(e),n.lc().comment.Title=t})),n.Xb()}if(2&e){const e=n.lc();n.sc("ngModel",e.comment.Title)}}function Ht(e,t){if(1&e&&(n.Tb(0,"div",26),n.mc(1,"sdaConvertURLsToHREF")),2&e){const e=n.lc();n.sc("innerHTML",n.nc(1,1,e.comment.Title),n.Lc)}}function $t(e,t){if(1&e){const e=n.Zb();n.Yb(0,"button",27),n.hc("click",(function(){return n.Kc(e),n.lc().cancelSave()})),n.Uc(1),n.Xb()}if(2&e){const e=n.lc();n.Eb(1),n.Wc(" ",e.CANCEL," ")}}function Qt(e,t){if(1&e){const e=n.Zb();n.Yb(0,"p-toggleButton",28),n.hc("ngModelChange",(function(t){return n.Kc(e),n.lc().isInEditMode=t}))("click",(function(){return n.Kc(e),n.lc().save()})),n.Xb()}if(2&e){const e=n.lc();n.tc("onLabel",e.SAVE_UPPERCASE),n.tc("offLabel",e.EDIT_UPPERCASE),n.sc("ngModel",e.isInEditMode)}}function zt(e,t){if(1&e){const e=n.Zb();n.Yb(0,"button",29),n.hc("click",(function(){return n.Kc(e),n.lc(),n.Hc(11).toggle()})),n.Xb()}}function Jt(e,t){if(1&e){const e=n.Zb();n.Yb(0,"a",30),n.hc("click",(function(i){return n.Kc(e),t.$implicit.action(i)})),n.Uc(1),n.Xb()}if(2&e){const e=t.$implicit;n.Eb(1),n.Wc(" ",e.title," ")}}function Zt(e,t){if(1&e&&(n.Yb(0,"div",16),n.Tb(1,"i",31),n.Yb(2,"p",18),n.Uc(3),n.Xb(),n.Xb()),2&e){const e=n.lc();n.Eb(3),n.Vc(e.comment.StatusDisplay)}}function qt(e,t){if(1&e){const e=n.Zb();n.Yb(0,"textarea",32,33),n.hc("blur",(function(){n.Kc(e);const t=n.Hc(1);return n.lc().onLeaveInput(t)}))("ngModelChange",(function(t){return n.Kc(e),n.lc().comment.Details=t})),n.Uc(2,"            "),n.Xb()}if(2&e){const e=n.lc();n.sc("sdaFocus",e.isInEditMode)("ngModel",e.comment.Details)}}function ei(e,t){if(1&e&&(n.Tb(0,"p",34),n.mc(1,"sdaConvertURLsToHREF")),2&e){const e=n.lc();n.sc("innerHTML",n.nc(1,1,e.comment.Details),n.Lc)}}function ti(e,t){if(1&e){const e=n.Zb();n.Yb(0,"sda-supporting-information-view",35),n.hc("onFileClicked",(function(t){return n.Kc(e),n.lc().onFileClicked.emit(t)}))("onManageItems",(function(){n.Kc(e);const t=n.lc();return t.onManageCommentRelatedItems.emit(t.comment)}))("onRelBuilderClosed",(function(){return n.Kc(e),n.lc().onRelBuilderClosed.emit()})),n.Xb()}if(2&e){const e=n.lc();n.sc("supportingInformation",e.comment.SupportingInformation)("parentOBID",e.comment.OBID)("isEditable",e.user.IsCurrentUser)("config",e.config)("documentOBID",e.documentOBID)("mode",e.mode)("relatedFileRelDef",e.relatedFileRelDef)("relatedFileRelDefIs12",e.relatedFileRelDefIs12)("relatedPrimaryDocumentRelDef",e.relatedPrimaryDocumentRelDef)("relatedPrimaryDocumentRelDefIs12",e.relatedPrimaryDocumentRelDefIs12)("relatedReferenceDocumentRelDef",e.relatedReferenceDocumentRelDef)("relatedReferenceDocumentRelDefIs12",e.relatedReferenceDocumentRelDefIs12)("relatedOtherObjectRelDef",e.relatedOtherObjectRelDef)("relatedOtherObjectRelDefIs12",e.relatedOtherObjectRelDefIs12)("workflowStep",e.workflowStep)}}let ii=(()=>{class e{constructor(e,t,i,o,s,r,a,c,l,d,u){this.exceptionService=e,this.notificationService=t,this.crudService=i,this.configService=o,this.dataService=s,this.modalService=r,this.sdaTranslateService=a,this.reviewProvider=c,this.objectDetailsService=l,this.componentFactoryResolver=d,this.injector=u,this.onTerminated=new n.o,this.onEditComment=new n.o,this.onFileClicked=new n.o,this.onManageCommentRelatedItems=new n.o,this.onRelBuilderClosed=new n.o,this.REVIEW_COMMENT_TERMINATE_BUTTON=this.sdaTranslateService.get("REVIEW_COMMENT_TERMINATE_BUTTON","Terminate"),this.REVIEW_COMMENT_UPDATE_BUTTON=this.sdaTranslateService.get("REVIEW_COMMENT_UPDATE_BUTTON","Update"),this.SAVE_UPPERCASE=this.sdaTranslateService.get("SAVE_UPPERCASE","SAVE"),this.EDIT_UPPERCASE=this.sdaTranslateService.get("EDIT_UPPERCASE","EDIT"),this.DETAILS=this.sdaTranslateService.get("DETAILS","Details"),this.CANCEL=this.sdaTranslateService.get("CANCEL","Cancel"),this.REVIEW_NO_LONGER_AVAILABLE_FOR_EDITING=this.sdaTranslateService.get("REVIEW_NO_LONGER_AVAILABLE_FOR_EDITING","The review is no longer available for editing because the document review process has been completed. <BR/>You will now be returned to the To Do List."),this.relatedPrimaryDocumentRelDef="SDAObservationPrimaryDocVersion",this.relatedPrimaryDocumentRelDefIs12=!1,this.relatedReferenceDocumentRelDef="SDAObservationDocVersions",this.relatedReferenceDocumentRelDefIs12=!1,this.relatedFileRelDef="SPFFileComposition",this.relatedFileRelDefIs12=!1,this.relatedOtherObjectRelDef="SDAObservationNonDocItems",this.relatedOtherObjectRelDefIs12=!1,this.REVIEW_COMMENT_TITLE=this.sdaTranslateService.get("REVIEW_COMMENT_TITLE","Comment"),this.UPDATED=this.sdaTranslateService.get("UPDATED","Updated"),this.MARKUP_LAYER=this.sdaTranslateService.get("MARKUP_LAYER","Markup Layer:"),this.overflowButtonOptions=[],this.detailsHistory="",this.titleHistory=""}ngOnInit(){this.user=this.users.filter(e=>e.OBID===this.comment.UserOBID)[0],this.overflowButtonOptions.push({title:this.DETAILS,action:()=>{this.showObjectDetails()}}),this.user&&this.user.IsCurrentUser&&this.mode!==D.a.ViewOnly&&this.comment&&"e1SDAObsStatusIssued"!==this.comment.Status&&!this.fileComment&&!this.comment.IsReferenceComment&&(this.userCanUpdateComment&&this.overflowButtonOptions.push({title:this.REVIEW_COMMENT_UPDATE_BUTTON,action:()=>{this.update()}}),this.overflowButtonOptions.push({title:this.REVIEW_COMMENT_TERMINATE_BUTTON,action:()=>{this.terminate()}}))}cancelSave(){this.isInEditMode=!1,this.comment.isDirty=!1,this.comment.Details=this.detailsHistory,this.comment.Title=this.titleHistory}terminate(){this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{e?this.modalService.confirm(this.sdaTranslateService.get("REVIEW_COMMENT_TERMINATE_TITLE","Terminate Comment"),this.sdaTranslateService.get("REVIEW_COMMENT_TERMINATE_MSG","Would you like to terminate the comment?")).then(e=>{e&&this.crudService.terminate(this.comment.OBID).subscribe(()=>{this.notificationService.success(this.sdaTranslateService.get("REVIEW_COMMENT_TERMINATE_SUCCESS","Comment successfully terminated")),this.onTerminated.emit(this.comment)},e=>{this.exceptionService.handleException(e)})}):this.reviewProvider.reviewCompletedMessageAndEjectUser()})}save(){this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{if(e)if(this.isInEditMode)this.detailsHistory=this.comment.Details.slice(0),this.titleHistory=this.comment.Title.slice(0);else{const e=new c.a(void 0);e.properties.push(new l.a("SDAObservationDetails",this.comment.Details),new l.a("Description",this.comment.Title)),this.crudService.update(this.comment.OBID,e).subscribe(()=>{this.dataService.get("Objects('"+this.comment.OBID+"')/?$select=LastUpdatedDate",this.configService.selectedCreateConfig,!0).subscribe(e=>{if(!e||!e.LastUpdatedDate)throw new de.a(this.sdaTranslateService.get("REVIEW_COMMENT_UPDATE_FAILED","Failed to save comment"));this.comment.ModifiedDate=e.LastUpdatedDate,this.comment.isDirty=!1,this.notificationService.success(this.sdaTranslateService.get("REVIEW_COMMENT_UPDATE_SUCCESS","Comment successfully saved"))})},e=>{this.exceptionService.handleException(e)})}else this.reviewProvider.reviewCompletedMessageAndEjectUser()})}onLeaveInput(e){this.comment.isDirty=e.dirty||this.comment.isDirty}update(){this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{e?this.onEditComment.emit(this.comment):this.reviewProvider.reviewCompletedMessageAndEjectUser()})}showObjectDetails(){this.objectDetailsService.showObjectDetailsModal(this.componentFactoryResolver,this.injector,new v.a(this.comment.OBID,"",this.comment.Config))}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(u.a),n.Sb(S.a),n.Sb(d.a),n.Sb(w.a),n.Sb(Pe.a),n.Sb(m.a),n.Sb(O.a),n.Sb(A.a),n.Sb(Be.a),n.Sb(n.j),n.Sb(n.s))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-comment-view"]],inputs:{comment:"comment",users:"users",documentOBID:"documentOBID",config:"config",mode:"mode",fileComment:"fileComment",userCanUpdateComment:"userCanUpdateComment",workflowStep:"workflowStep"},outputs:{onTerminated:"onTerminated",onEditComment:"onEditComment",onFileClicked:"onFileClicked",onManageCommentRelatedItems:"onManageCommentRelatedItems",onRelBuilderClosed:"onRelBuilderClosed"},features:[n.Db([A.a])],decls:26,vars:18,consts:[[1,"card-item"],[1,"card-header"],[1,"card-heading"],[4,"ngIf"],["type","text","class","card-heading__edit",3,"ngModel","blur","ngModelChange",4,"ngIf"],["class","card-heading__title",3,"innerHTML",4,"ngIf"],[1,"card-actions"],["class","card-actions__button sda-button sda-button--clear",3,"click",4,"ngIf"],["class","card-actions__toggle",3,"ngModel","onLabel","offLabel","ngModelChange","click",4,"ngIf"],["class","card-actions__button sda-button sda-button--clear fa fa-ellipsis-v",3,"click",4,"ngIf"],[3,"closeOnAllClicks"],["overlay",""],[1,"sda-overlay-content-hook"],[1,"comp-overflow"],["class","comp-overflow__item",3,"click",4,"ngFor","ngForOf"],[1,"card-section","card-section--info"],[1,"card-info"],["aria-hidden","true",1,"card-info__icon","fa","fa-clock-o"],[1,"card-info__data"],["class","card-info",4,"ngIf"],[1,"card-section","card-section--main"],["class","card-section__textarea",3,"sdaFocus","ngModel","blur","ngModelChange",4,"ngIf"],["class","card-section__content",3,"innerHTML",4,"ngIf"],[3,"supportingInformation","parentOBID","isEditable","config","documentOBID","mode","relatedFileRelDef","relatedFileRelDefIs12","relatedPrimaryDocumentRelDef","relatedPrimaryDocumentRelDefIs12","relatedReferenceDocumentRelDef","relatedReferenceDocumentRelDefIs12","relatedOtherObjectRelDef","relatedOtherObjectRelDefIs12","workflowStep","onFileClicked","onManageItems","onRelBuilderClosed",4,"ngIf"],["type","text",1,"card-heading__edit",3,"ngModel","blur","ngModelChange"],["title","ngModel"],[1,"card-heading__title",3,"innerHTML"],[1,"card-actions__button","sda-button","sda-button--clear",3,"click"],[1,"card-actions__toggle",3,"ngModel","onLabel","offLabel","ngModelChange","click"],[1,"card-actions__button","sda-button","sda-button--clear","fa","fa-ellipsis-v",3,"click"],[1,"comp-overflow__item",3,"click"],["aria-hidden","true",1,"card-info__icon","fa","fa-circle-o-notch"],[1,"card-section__textarea",3,"sdaFocus","ngModel","blur","ngModelChange"],["details","ngModel"],[1,"card-section__content",3,"innerHTML"],[3,"supportingInformation","parentOBID","isEditable","config","documentOBID","mode","relatedFileRelDef","relatedFileRelDefIs12","relatedPrimaryDocumentRelDef","relatedPrimaryDocumentRelDefIs12","relatedReferenceDocumentRelDef","relatedReferenceDocumentRelDefIs12","relatedOtherObjectRelDef","relatedOtherObjectRelDefIs12","workflowStep","onFileClicked","onManageItems","onRelBuilderClosed"]],template:function(e,t){1&e&&(n.Yb(0,"div",0),n.Yb(1,"header",1),n.Yb(2,"div",2),n.Sc(3,Gt,2,1,"label",3),n.Sc(4,Kt,2,1,"input",4),n.Sc(5,Ht,2,3,"div",5),n.Xb(),n.Yb(6,"aside",6),n.Sc(7,$t,2,1,"button",7),n.Sc(8,Qt,1,3,"p-toggleButton",8),n.Sc(9,zt,1,0,"button",9),n.Yb(10,"sda-overlay",10,11),n.Yb(12,"div",12),n.Yb(13,"nav",13),n.Sc(14,Jt,2,1,"a",14),n.Xb(),n.Xb(),n.Xb(),n.Xb(),n.Xb(),n.Yb(15,"section",15),n.Yb(16,"div",16),n.Tb(17,"i",17),n.Yb(18,"p",18),n.Uc(19),n.mc(20,"sdaConvertToLocalDateTime"),n.Xb(),n.Xb(),n.Sc(21,Zt,4,1,"div",19),n.Xb(),n.Yb(22,"section",20),n.Sc(23,qt,3,2,"textarea",21),n.Sc(24,ei,2,3,"p",22),n.Xb(),n.Sc(25,ti,1,15,"sda-supporting-information-view",23),n.Xb()),2&e&&(n.Ib("card-item--approved",t.user.HasContentBeenConsolidated),n.Eb(3),n.sc("ngIf",t.fileComment),n.Eb(1),n.sc("ngIf",t.isInEditMode),n.Eb(1),n.sc("ngIf",!t.isInEditMode),n.Eb(2),n.sc("ngIf",!t.comment.IsReferenceComment&&t.isInEditMode),n.Eb(1),n.sc("ngIf",!t.comment.IsReferenceComment&&t.user.IsCurrentUser&&0!==t.mode&&"e1SDAObsStatusIssued"!==t.comment.Status&&!t.fileComment),n.Eb(1),n.sc("ngIf",(null==t.overflowButtonOptions?null:t.overflowButtonOptions.length)>0),n.Eb(1),n.sc("closeOnAllClicks",!0),n.Eb(4),n.sc("ngForOf",t.overflowButtonOptions),n.Eb(5),n.Xc("",t.UPDATED,": ",n.nc(20,16,t.comment.ModifiedDate),""),n.Eb(2),n.sc("ngIf",t.comment.StatusDisplay),n.Eb(2),n.sc("ngIf",t.isInEditMode),n.Eb(1),n.sc("ngIf",!t.isInEditMode),n.Eb(1),n.sc("ngIf",!t.fileComment))},directives:[y.t,U.a,y.s,Je.c,Je.p,Je.s,ze.a,Ze.a,Qe],pipes:[_e.a,qe.a],styles:["[_nghost-%COMP%]{display:flex;justify-content:center}"]}),e})();function ni(e,t){if(1&e&&(n.Yb(0,"div",11),n.Tb(1,"mat-icon",12),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.Ib("card-user__icon--you",e.key.IsCurrentUser),n.sc("title",t.QA_DOCUMENT_REVIEW_REVIEWER_ICON)}}function oi(e,t){if(1&e&&(n.Yb(0,"div",13),n.Tb(1,"mat-icon",14),n.Xb()),2&e){const e=n.lc().$implicit,t=n.lc();n.Ib("card-user__icon--you",e.key.IsCurrentUser),n.sc("title",t.QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON)}}function si(e,t){if(1&e&&(n.Yb(0,"span",15),n.Uc(1),n.Xb()),2&e){const e=n.lc(2);n.Eb(1),n.Wc(" ",e.YOU," ")}}function ri(e,t){if(1&e&&(n.Yb(0,"span",16),n.Tb(1,"i",17),n.Uc(2),n.Xb()),2&e){const e=n.lc(2);n.Eb(2),n.Wc(" ",e.REVIEW_ACTION_SIGNED_OFF," ")}}function ai(e,t){if(1&e){const e=n.Zb();n.Yb(0,"div",18),n.Yb(1,"sda-comment-view",19),n.hc("onTerminated",(function(){n.Kc(e);const i=t.$implicit;return n.lc(2).commentTerminated(i)}))("onEditComment",(function(t){return n.Kc(e),n.lc(2).onEditComment.emit(t)}))("onFileClicked",(function(t){return n.Kc(e),n.lc(2).onFileClicked.emit(t)}))("onManageCommentRelatedItems",(function(t){return n.Kc(e),n.lc(2).onManageCommentRelatedItems.emit(t)}))("onRelBuilderClosed",(function(){return n.Kc(e),n.lc(2).onRelBuilderClosed.emit()})),n.Xb(),n.Xb()}if(2&e){const e=t.$implicit,i=n.lc(2);n.Eb(1),n.sc("comment",e)("config",i.config)("documentOBID",i.documentOBID)("users",i.users)("mode",i.mode)("fileComment",i.fileComment)("userCanUpdateComment",i.userCanUpdateComment)("workflowStep",i.workflowStep)}}function ci(e,t){if(1&e&&(n.Yb(0,"div",1),n.Yb(1,"div",2),n.Yb(2,"div",3),n.Sc(3,ni,2,3,"div",4),n.Sc(4,oi,2,3,"ng-template",null,5,n.Tc),n.Yb(6,"div",6),n.Yb(7,"h4",7),n.Uc(8),n.Sc(9,si,2,1,"span",8),n.Xb(),n.Sc(10,ri,3,1,"span",9),n.Xb(),n.Xb(),n.Xb(),n.Sc(11,ai,2,8,"div",10),n.Xb()),2&e){const e=t.$implicit,i=n.Hc(5),o=n.lc();n.Eb(3),n.sc("ngIf",o.userComments&&!e.key.IsConsolidator)("ngIfElse",i),n.Eb(5),n.Wc(" ",e.key.DisplayName," "),n.Eb(1),n.sc("ngIf",e.key.IsCurrentUser),n.Eb(1),n.sc("ngIf",e.key.HasContentBeenConsolidated),n.Eb(1),n.sc("ngForOf",e.value)}}let li=(()=>{class e{constructor(e){this.sdaTranslateService=e,this.onCommentTerminated=new n.o,this.onEditComment=new n.o,this.onFileClicked=new n.o,this.onManageCommentRelatedItems=new n.o,this.onRelBuilderClosed=new n.o,this.REVIEW_ACTION_SIGNED_OFF=this.sdaTranslateService.get("REVIEW_ACTION_SIGNED_OFF","Consolidated"),this.YOU=this.sdaTranslateService.get("YOU","You"),this.QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON=this.sdaTranslateService.get("QA_DOCUMENT_REVIEW_CONSOLIDATOR_ICON","Document Review Consolidator"),this.QA_DOCUMENT_REVIEW_REVIEWER_ICON=this.sdaTranslateService.get("QA_DOCUMENT_REVIEW_REVIEWER_ICON","Document Reviewer")}ngOnInit(){if(this.comments&&this.users){let e;this.userComments=[],this.users.forEach((t,i)=>{const n=this.comments.filter(e=>e.UserOBID===t.OBID).sort((e,t)=>Ne.a.sortByDate(new Date(e.ModifiedDate.toString()),new Date(t.ModifiedDate.toString())));n.length>0&&(t.IsCurrentUser?e=new T.a(t,n):this.userComments.push(new T.a(t,n))),i===this.users.length-1&&(this.userComments=this.userComments.sort((e,t)=>Ne.a.sortByString(e.key.DisplayName,t.key.DisplayName)),e&&this.userComments.unshift(e))})}}commentTerminated(e){e&&(this.onCommentTerminated.emit(e),this.comments=this.comments.filter(t=>t.OBID!==e.OBID),this.userComments.forEach(t=>{t.value=t.value.filter(t=>t.OBID!==e.OBID)}))}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(O.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-comment-group-view"]],inputs:{comments:"comments",documentOBID:"documentOBID",config:"config",users:"users",mode:"mode",fileComment:"fileComment",userCanUpdateComment:"userCanUpdateComment",workflowStep:"workflowStep"},outputs:{onCommentTerminated:"onCommentTerminated",onEditComment:"onEditComment",onFileClicked:"onFileClicked",onManageCommentRelatedItems:"onManageCommentRelatedItems",onRelBuilderClosed:"onRelBuilderClosed"},decls:1,vars:1,consts:[["class","grid",4,"ngFor","ngForOf"],[1,"grid"],[1,"card-user","col-100"],[1,"card-user__body"],[3,"card-user__icon--you","title",4,"ngIf","ngIfElse"],["yesToConsolidator",""],[1,"card-user__name"],[1,"card-user__name__title"],["class","card-user__name__title__you",4,"ngIf"],["class","card-badge card-badge--completed",4,"ngIf"],["class","col-50",4,"ngFor","ngForOf"],[3,"title"],["svgIcon","user",1,"class.card-user__icon"],[1,"card-user__body",3,"title"],["svgIcon","user-hardhat",1,"class.card-user__icon"],[1,"card-user__name__title__you"],[1,"card-badge","card-badge--completed"],["aria-hidden","true",1,"fa","fa-check"],[1,"col-50"],[3,"comment","config","documentOBID","users","mode","fileComment","userCanUpdateComment","workflowStep","onTerminated","onEditComment","onFileClicked","onManageCommentRelatedItems","onRelBuilderClosed"]],template:function(e,t){1&e&&n.Sc(0,ci,12,6,"div",0),2&e&&n.sc("ngForOf",t.userComments)},directives:[y.s,y.t,he.a,ii],encapsulation:2}),e})();function di(e,t){if(1&e&&(n.Yb(0,"p-tabPanel",20),n.Tb(1,"sda-reviewers-summary-view",21),n.Xb()),2&e){const e=n.lc();n.tc("header",e.REVIEW_REVIEWERS_SUMMARY_TITLE),n.sc("selected",!0),n.Eb(1),n.sc("reviewers",e.reviewers)("mode",e.mode)("primaryActions",e.primaryActions)("referenceActions",e.review.ReferenceActions)("reviews",e.review.Reviews)("recipientsWithNoReviews",e.review.RecipientsWithNoReviews)}}function ui(e,t){if(1&e){const e=n.Zb();n.Yb(0,"p-tabPanel",12),n.Yb(1,"sda-review-group-view",22),n.hc("onReviewSaved",(function(){return n.Kc(e),n.lc().onReviewSaved()}))("onFileClicked",(function(t){return n.Kc(e),n.lc().onViewFileForSupportingInformation(t,!1)}))("onManageReviewRelatedItems",(function(t){return n.Kc(e),n.lc().onManageReviewRelatedItems(t)}))("onRelBuilderClosed",(function(){return n.Kc(e),n.lc().onRelBuilderClosed()})),n.Xb(),n.Xb()}if(2&e){const e=n.lc();n.vc("header","",e.REVIEW_REVIEWS_TAB_TITLE," (",e.visibleReviews.length,")"),n.sc("selected",e.visibleReviews.length>0),n.Eb(1),n.sc("mode",e.mode)("config",e.review.Config)("documentOBID",e.review.OBID)("reviews",e.review.Reviews)("reviewers",e.review.Users)("workflowStep",e.workflowStep)}}function hi(e,t){if(1&e){const e=n.Zb();n.Yb(0,"p-accordionTab",23),n.Yb(1,"p-header",24),n.Yb(2,"span",25),n.Uc(3),n.Xb(),n.Xb(),n.Yb(4,"sda-action-group-view",26),n.hc("onCreateAction",(function(){return n.Kc(e),n.lc().onCreateAction()}))("onEditAction",(function(t){return n.Kc(e),n.lc().onEditAction(t)}))("onRejectAction",(function(t){return n.Kc(e),n.lc().onRejectAction(t)}))("onManageMarkupLayers",(function(t){return n.Kc(e),n.lc().onManageActionMarkupLayers(t)}))("onActionTerminated",(function(t){return n.Kc(e),n.lc().onActionTerminated(t)}))("onFileClicked",(function(t){return n.Kc(e),n.lc().onViewFileForSupportingInformation(t,!0)}))("onManageActionRelatedItems",(function(t){return n.Kc(e),n.lc().onManageActionRelatedItems(t)}))("onRelBuilderClosed",(function(){return n.Kc(e),n.lc().onRelBuilderClosed()}))("onViewAndMarkup",(function(t){return n.Kc(e),n.lc().onViewAndMarkup(t)})),n.Xb(),n.Xb()}if(2&e){const e=t.$implicit,i=n.lc();n.sc("selected",!0),n.Eb(3),n.Vc(e.key),n.Eb(1),n.sc("mode",i.mode)("actionRejectStatusParam",i.actionRejectStatusParam)("actions",e.value)("config",i.review.Config)("documentOBID",i.review.OBID)("users",i.review.Users)("fileAction",!1)("userCanUpdateAction",!!i.review.EditActionMethod)("userCanCreateAction",!!i.review.CreateActionMethod)("userCanManageMarkupLayers",!!i.review.ManageActionMarkupsMethod||!!i.review.ManageActionMarkupsMethodViewOnly)("workflowStep",i.workflowStep)("isReferenceGroup",e.key===i.REFERENCE)}}function _i(e,t){if(1&e){const e=n.Zb();n.Yb(0,"p-accordionTab",23),n.Yb(1,"p-header",24),n.Yb(2,"span",25),n.Uc(3),n.Xb(),n.Xb(),n.Yb(4,"sda-comment-group-view",28),n.hc("onCommentTerminated",(function(t){return n.Kc(e),n.lc(2).onCommentTerminated(t)}))("onEditComment",(function(t){return n.Kc(e),n.lc(2).onEditComment(t)}))("onFileClicked",(function(t){return n.Kc(e),n.lc(2).onViewFileForSupportingInformation(t,!1)}))("onManageCommentRelatedItems",(function(t){return n.Kc(e),n.lc(2).onManageCommentRelatedItems(t)}))("onRelBuilderClosed",(function(){return n.Kc(e),n.lc(2).onRelBuilderClosed()})),n.Xb(),n.Xb()}if(2&e){const e=t.$implicit,i=n.lc(2);n.sc("selected",!0),n.Eb(3),n.Vc(e.key),n.Eb(1),n.sc("mode",i.mode)("comments",e.value)("config",i.review.Config)("documentOBID",i.review.OBID)("users",i.review.Users)("fileComment",!1)("userCanUpdateComment",!!i.review.EditCommentMethod)("workflowStep",i.workflowStep)}}function fi(e,t){if(1&e&&(n.Yb(0,"p-tabPanel",27),n.Yb(1,"p-accordion",15),n.Sc(2,_i,5,10,"p-accordionTab",16),n.Xb(),n.Xb()),2&e){const e=n.lc();n.vc("header","",e.REVIEW_COMMENTS_TAB_TITLE," (",e.commentsCount,")"),n.Eb(1),n.sc("multiple",!0),n.Eb(1),n.sc("ngForOf",e.comments)}}function mi(e,t){if(1&e&&n.Tb(0,"i",34),2&e){const e=n.lc(2);n.tc("title",e.REVIEW_MARKUPS_INVALID_ACTIONS_WARNING)}}function Ei(e,t){if(1&e){const e=n.Zb();n.Yb(0,"p-accordionTab",23),n.Yb(1,"p-header",24),n.Yb(2,"span",25),n.Uc(3),n.Xb(),n.Xb(),n.Yb(4,"sda-action-group-view",35),n.hc("onFileClicked",(function(t){return n.Kc(e),n.lc(2).onViewFileForSupportingInformation(t,!0)}))("onManageMarkupLayers",(function(t){return n.Kc(e),n.lc(2).onManageActionMarkupLayers(t)}))("onManageActionRelatedItems",(function(t){return n.Kc(e),n.lc(2).onManageActionRelatedItems(t)}))("onRelBuilderClosed",(function(){return n.Kc(e),n.lc(2).onRelBuilderClosed()}))("onEditAction",(function(t){return n.Kc(e),n.lc(2).onEditAction(t)}))("onRejectAction",(function(t){return n.Kc(e),n.lc(2).onRejectAction(t)}))("onViewAndMarkup",(function(t){return n.Kc(e),n.lc(2).onViewAndMarkup(t)})),n.Xb(),n.Xb()}if(2&e){const e=t.$implicit,i=n.lc(2);n.sc("selected",!0),n.Eb(3),n.Vc(e.key),n.Eb(1),n.sc("actions",e.value)("actionRejectStatusParam",i.actionRejectStatusParam)("config",i.review.Config)("documentOBID",i.review.OBID)("users",i.review.Users)("mode",i.mode)("fileAction",!0)("userCanUpdateAction",!!i.review.EditActionMethod)("userCanCreateAction",!!i.review.CreateActionMethod)("userCanManageMarkupLayers",!!i.review.ManageActionMarkupsMethod||!!i.review.ManageActionMarkupsMethodViewOnly)("workflowStep",i.workflowStep)}}const Ii=function(e){return{"fa fa-exclamation-circle warning-icon":e}};function pi(e,t){if(1&e){const e=n.Zb();n.Yb(0,"p-accordionTab"),n.Yb(1,"p-header",29),n.Yb(2,"span",30),n.Uc(3),n.Xb(),n.Sc(4,mi,1,1,"i",31),n.Xb(),n.Yb(5,"p-tabView"),n.Yb(6,"p-tabPanel",32),n.Yb(7,"p-accordion",15),n.Sc(8,Ei,5,13,"p-accordionTab",16),n.Xb(),n.Xb(),n.Yb(9,"p-tabPanel",7),n.Yb(10,"sda-comment-group-view",33),n.hc("onManageCommentRelatedItems",(function(t){return n.Kc(e),n.lc().onManageCommentRelatedItems(t)}))("onRelBuilderClosed",(function(){return n.Kc(e),n.lc().onRelBuilderClosed()})),n.Xb(),n.Xb(),n.Xb(),n.Xb()}if(2&e){const e=t.$implicit,i=n.lc();n.Eb(3),n.Vc(e.Name),n.Eb(1),n.sc("ngIf",e.hasInvalidActionsWarning),n.Eb(2),n.tc("header",i.REVIEW_ACTIONS_TAB_TITLE),n.sc("selected",!0)("leftIcon",n.xc(15,Ii,e.hasInvalidActionsWarning)),n.Eb(1),n.sc("multiple",!0),n.Eb(1),n.sc("ngForOf",e.Actions),n.Eb(1),n.tc("header",i.REVIEW_TEXT_FROM_MARKUPS),n.Eb(1),n.sc("comments",e.Comments)("config",i.review.Config)("documentOBID",i.review.OBID)("users",i.review.Users)("mode",i.mode)("fileComment",!0)("workflowStep",i.workflowStep)}}let bi=(()=>{class e{constructor(e,t,i,o,s,r,d,u,h,_,f,m,E,I,p,b){this.loadingOverlayService=e,this.sdaTranslateService=t,this.actionMenuProvider=i,this.notificationService=o,this.featureSetNavigationService=s,this.batchRequestFactory=r,this.modalService=d,this.todoListService=u,this.crudService=h,this.exceptionService=_,this.reviewDataService=f,this.reviewProvider=m,this.configService=E,this.dataRefreshService=I,this.methodService=p,this.lockservice=b,this.REVIEW_DOCUMENT_SUMMARY_TITLE=this.sdaTranslateService.get("REVIEW_DOCUMENT_TITLE","Document"),this.REVIEW_REVIEWERS_SUMMARY_TITLE=this.sdaTranslateService.get("REVIEW_REVIEWERS_SUMMARY_TITLE","Reviewers"),this.REVIEW_CONTRIBUTOR_SUMMARY_TITLE=this.sdaTranslateService.get("REVIEW_CONTRIBUTOR_SUMMARY_TITLE","Contributors"),this.REVIEW_DOCUMENT_DETAILS_TAB_TITLE=this.sdaTranslateService.get("REVIEW_DOCUMENT_DETAILS_TAB_TITLE","Document Details"),this.REVIEW_REVIEWS_TAB_TITLE=this.sdaTranslateService.get("REVIEW_REVIEWS_TAB_TITLE","Reviews"),this.REVIEW_ACTIONS_TAB_TITLE=this.sdaTranslateService.get("REVIEW_ACTIONS_TAB_TITLE","Actions"),this.REVIEW_COMMENTS_TAB_TITLE=this.sdaTranslateService.get("REVIEW_COMMENTS_TAB_TITLE","Comments"),this.REVIEW_TEXT_FROM_MARKUPS=this.sdaTranslateService.get("REVIEW_TEXT_FROM_MARKUPS","Text from Markups"),this.REVIEW_NO_LONGER_AVAILABLE_FOR_EDITING=this.sdaTranslateService.get("REVIEW_NO_LONGER_AVAILABLE_FOR_EDITING","The review is no longer available for editing because the document review process has been completed. <BR/>You will now be returned to the To Do List."),this.REVIEW_MARKUPS_INVALID_ACTIONS_WARNING=this.sdaTranslateService.get("REVIEW_MARKUPS_INVALID_ACTIONS_WARNING","One or more selected markup layers contain an action that is Rejected or Reserved. If the markup layer is selected the review cannot be completed."),this.PRIMARY=this.sdaTranslateService.get("PRIMARY","Primary"),this.REFERENCE=this.sdaTranslateService.get("REFERENCE","Reference"),this.onApiComplete=new n.o,this.leftPowerBarButtons=new Array,this.rightPowerBarButtons=new Array,this.visibleReviews=new Array,this.actions=[],this.comments=[],this.isLoading=!1,this.onReturnCodeChanged=e=>{if(e&&e.Value!==this.review.ReturnCode&&e.Value!==a.b&&(e.Value!==a.a||""!==this.review.ReturnCode&&this.review.ReturnCode)){let t=e.Value;e.Value===a.a&&(t="");const i=new c.a(void 0);i.properties.push(new l.a("SDAReturnCode",t)),this.crudService.update(this.review.RevisionOBID,i).subscribe(()=>{this.notificationService.success(this.sdaTranslateService.get("REVIEW_DOCUMENT_SAVE_SUCCESS","Document saved successfully")),this.review.ReturnCode=e.Value},e=>{this.exceptionService.handleException(e)})}},this.saveAndWaiveReview=()=>{this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{if(e)if(this.currentUserReview&&this.currentUserReview.isDirty){const e=new c.a(void 0);e.properties.push(new l.a("SDAObservationDetails",this.currentUserReview.Details)),this.crudService.update(this.currentUserReview.OBID,e).subscribe(()=>{this.currentUserReview.isDirty=!1,this.waiveReview()},e=>{this.exceptionService.handleException(e)})}else this.waiveReview();else this.reviewProvider.reviewCompletedMessageAndEjectUser()})},this.saveAndCompleteReview=()=>{this.reviewHasRejectedOrReservedActions()?this.modalService.alert(this.sdaTranslateService.get("REVIEW_MARKUPS_REJECTED_ACTIONS_WARNING","One or more selected markup layers contain an action that is Rejected. If the markup layer is selected the review cannot be completed."),this.sdaTranslateService.get("WARNING","Warning")):this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{if(e)if(this.currentUserReview.Details.length>0){this.updateLoading(!0);const e=this.batchRequestFactory.createBatchRequest(),t=e.createChangeset(),i=this.review.Reviews.filter(e=>e.isDirty),n=this.primaryActions.filter(e=>e.isDirty),o=this.review.PrimaryComments.filter(e=>e.isDirty);i.length>0||n.length>0||o.length>0?(n.length>0&&this.addUnSavedActionsToChangeSet(t,n),i.length>0&&this.addUnSavedReviewsToChangeSet(t,i),o.length>0&&this.addUnSavedCommentsToChangeSet(t,o),e.addChangeset(t),e.execute().subscribe(e=>{let t=!0;e.forEach(e=>{(e.statusCode<200||e.statusCode>=300)&&(this.exceptionService.handleException(e.data),t=!1)}),t?this.validateReturnCodeAndCompleteReview():this.updateLoading(!1)},e=>{this.updateLoading(!1),this.exceptionService.handleException(e)})):this.validateReturnCodeAndCompleteReview()}else this.modalService.alert(this.sdaTranslateService.get("REVIEW_COMPLETE_COMMENT_WARNING","Text must be entered to complete the review"));else this.reviewProvider.reviewCompletedMessageAndEjectUser()})},this.createNewTechnicalQuery=()=>{this.onExecuteMethod(this.review.CreateTechnicalQueryMethod,new v.a(this.review.OBID,this.review.Name,this.review.Config),!0)},this.completeWorkflowStep=()=>{this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{e?(this.updateLoading(!0),this.todoListService.signOffStep([this.workflowStep.obid],"","").subscribe(()=>{this.updateLoading(!1),this.notificationService.success(this.sdaTranslateService.get("REVIEW_ACCEPT_SUCCESS","Review accepted")),this.onApiComplete.emit()},e=>{this.updateLoading(!1),this.exceptionService.handleException(e)})):this.reviewProvider.reviewCompletedMessageAndEjectUser()})}}ngOnInit(){if(this.contributors=this.review.Users.filter(e=>!e.IsReviewer),this.reviewers=this.review.Users.filter(e=>e.IsReviewer),this.primaryActions=this.review.PrimaryActions.filter(e=>!this.lockservice.isItemLocked(e.OBID)),this.review.Users.some(e=>e.IsCurrentUser)){const e=this.review.Users.filter(e=>e.IsCurrentUser)[0].OBID;this.currentUserReview=this.review.Reviews.filter(t=>t.UserOBID===e)[0]}this.actionsCount=this.review.ReferenceActions.length+this.primaryActions.length,this.commentsCount=this.review.PrimaryComments.length+this.review.ReferenceComments.length,this.initialiseLeftPowerBarButtons(),this.initialiseRightPowerBarButtons(),this.initializeActionsMenu(),this.visibleReviews=this.review.Reviews.filter(e=>!e.IsWaived),this.actions.push(new T.a(this.PRIMARY,this.primaryActions)),this.review.ReferenceActions&&this.review.ReferenceActions.length>0&&this.actions.push(new T.a(this.REFERENCE,this.review.ReferenceActions)),this.review.PrimaryComments&&this.review.PrimaryComments.length>0&&this.comments.push(new T.a(this.PRIMARY,this.review.PrimaryComments)),this.review.ReferenceComments&&this.review.ReferenceComments.length>0&&this.comments.push(new T.a(this.REFERENCE,this.review.ReferenceComments)),this.review.Files.forEach(e=>{e.Actions=[],e.PrimaryActions&&e.PrimaryActions.length>0&&e.Actions.push(new T.a(this.PRIMARY,e.PrimaryActions)),e.ReferenceActions&&e.ReferenceActions.length>0&&e.Actions.push(new T.a(this.REFERENCE,e.ReferenceActions))})}ngOnDestroy(){this.actionMenuProvider.clearAndCloseActionsMenu()}onCommentTerminated(e){this.dataRefreshService.refreshData()}onActionTerminated(e){this.dataRefreshService.refreshData()}onCreateAction(){this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{e?this.onExecuteMethod(this.review.CreateActionMethod,new v.a(this.review.OBID,this.review.Name,this.review.Config),!0):this.reviewProvider.reviewCompletedMessageAndEjectUser()})}onRejectAction(e){this.dataRefreshService.refreshData()}onEditAction(e){this.onExecuteMethod(this.review.EditActionMethod,new v.a(e.OBID,e.Title,e.Config),!1)}onManageDocumentMarkupLayers(){const e=[this.review.OBID],t=new M.a;t.files=this.review.Files,t.documentReviewVersionOBID=this.review.OBID,this.mode!==D.a.ViewOnly&&this.mode!==D.a.ViewOnlyExternal&&this.currentUserReview&&(t.currentReviewOBID=this.currentUserReview.OBID),t.currentMarkupContextOBIDs=this.review.Reviews.map(e=>e.OBID),this.onExecuteMethod(this.review.ManageDocumentMarkupsMethod,void 0,!0,e,t)}onManageActionMarkupLayers(e){let t=e.SupportingInformation.PrimaryDocuments.map(e=>e.OBID);t=t.concat(e.SupportingInformation.ReferenceDocuments.map(e=>e.OBID)),t.push(this.review.OBID);const i=new M.a;i.documentReviewVersionOBID=this.review.OBID,i.currentMarkupContextOBIDs=this.review.Reviews.map(e=>e.OBID);const n=this.isManageActionMarkupLayerGUIReadOnly(e.UserOBID);this.onExecuteMethod(n?this.review.ManageActionMarkupsMethodViewOnly:this.review.ManageActionMarkupsMethod,new v.a(e.OBID,e.Title,e.Config),!0,t,i)}onEditComment(e){this.onExecuteMethod(this.review.EditCommentMethod,new v.a(e.OBID,e.Title,e.Config),!1)}onViewFile(e,t){const i=new M.a;t?this.onExecuteMethod(this.review.LaunchMarkupFromSupportingInformationMethod,e,!1,[],i):(this.mode!==D.a.ViewOnly&&this.mode!==D.a.ViewOnlyExternal&&(i.documentReviewVersionOBID=this.review.OBID,this.currentUserReview&&(i.markupContextOBID=this.currentUserReview.OBID),i.objectOBIDForRenditionGeneration=this.review.OBID),this.onExecuteMethod(this.review.LaunchMarkupFromHyperlinkMethod,e,!1,[],i))}onViewFileForSupportingInformation(e,t){if(e){const i=new M.a;this.mode!==D.a.ViewOnly&&this.mode!==D.a.ViewOnlyExternal&&(i.documentReviewVersionOBID=this.review.OBID,this.currentUserReview&&(i.markupContextOBID=this.currentUserReview.OBID),t&&(i.objectOBIDForRenditionGeneration=e.parentOBID)),this.onExecuteMethod(this.review.LaunchMarkupFromSupportingInformationMethod,e.file,!1,[],i)}}onRelBuilderClosed(){1!==this.actionMenuProvider.length()&&this.actionMenuProvider.getItems().every(e=>e.obid!==this.review.OBID)&&this.initializeActionsMenu()}onViewAndMarkup(e){const t=new v.a(e.OBID,e.Name,e.Config);this.onViewFile(t,!1)}onManageActionRelatedItems(e){this.onExecuteMethod(this.review.ManageActionRelatedItemsMethod,new v.a(e.OBID,e.Name,e.Config),!1,[],void 0,!0)}onManageReviewRelatedItems(e){this.onManageReviewOrCommentRelatedItems(new v.a(e.OBID,e.Title,e.Config))}onManageCommentRelatedItems(e){this.onManageReviewOrCommentRelatedItems(new v.a(e.OBID,e.Name,e.Config))}onExecuteMethod(e,t,i,n,o,s=!1){if(e){const r=this.methodService.transformToFeature(e.DisplayName,e.DisplayName,e.ClientAPI,e);t&&(r.objects=[t]),r.parentObjects=this.parentObjects,r.parentMethodOBID=this.parentMethodOBID,r.parentClientAPI=this.parentClientAPI,r.contextObjectOBIDs=n&&n.length?n:i?[this.review.OBID]:[t.obid],o&&(r.data=o),r.showInModal=s,r.config=[this.configService.selectedCreateConfig],this.featureSetNavigationService.navigateToFeature(r)}}onReviewSaved(){this.initialiseRightPowerBarButtons()}reviewHasRejectedOrReservedActions(){const e=this.review.Files.some(e=>this.someActionsHaveErrors(e.PrimaryActions)),t=this.someActionsHaveErrors(this.primaryActions);return this.review.HasRejectedMarkupActions||e||t}someActionsHaveErrors(e){let t=!1;return e&&(t=e.some(e=>e.HasRejectedMarkupActions)),t}initializeActionsMenu(){this.actionMenuProvider.clearItems();const e=new v.a(this.review.OBID,this.review.Name,this.review.Config);this.actionMenuProvider.addItem(e)}isManageActionMarkupLayerGUIReadOnly(e){let t=!0;switch(this.mode){case D.a.Review:this.review.Users.some(e=>e.IsCurrentUser)&&(t=this.review.Users.filter(e=>e.IsCurrentUser)[0].OBID!==e);break;case D.a.Consolidate:case D.a.Reconsolidate:t=!1;break;default:t=!0}return t}initialiseRightPowerBarButtons(){this.rightPowerBarButtons=[],!this.currentUserReview||this.currentUserReview.IsWaived||this.currentUserReview.IsCompleted||this.mode!==D.a.Review||this.rightPowerBarButtons.push(new E.a(()=>{this.saveAndWaiveReview()},this.sdaTranslateService.get("REVIEW_POWER_BAR_WAIVE_BTN_TEXT","Waive"),"")),this.mode===D.a.Compliance&&(this.rightPowerBarButtons.push(new E.a(()=>{this.rejectReview()},this.sdaTranslateService.get("REVIEW_POWER_BAR_REJECT_BTN_TEXT","Reject"),"")),this.rightPowerBarButtons.push(new E.a(()=>{this.completeWorkflowStep()},this.sdaTranslateService.get("REVIEW_POWER_BAR_ACCEPT_BTN_TEXT","Accept"),"",void 0,r.a.Primary))),this.mode!==D.a.Review&&this.mode!==D.a.Consolidate&&this.mode!==D.a.Reconsolidate||this.rightPowerBarButtons.push(new E.a(()=>{this.saveAndCompleteReview()},this.sdaTranslateService.get("REVIEW_POWER_BAR_COMPLETE_BTN_TEXT","Complete"),"",void 0,r.a.Primary))}initialiseLeftPowerBarButtons(){if(this.leftPowerBarButtons=[],this.mode===D.a.Consolidate||this.mode===D.a.Reconsolidate){let e=this.review.ReturnCode;e&&""!==e||(e=a.a);const t={EnumListTypeUID:"e1SDAReturnCodes",IsMandatory:!1,Value:e,Config:this.review.Config};this.leftPowerBarButtons.push(new p.a(this.sdaTranslateService.get("REVIEW_DOCUMENT_RETURN_CODE_LABEL","Document return code")));const i=new I.a(t,this.onReturnCodeChanged);i.uid="DocReturnCodeDropDown",this.leftPowerBarButtons.push(i),this.leftPowerBarButtons.push(new b.a)}if(this.review.CreateTechnicalQueryMethod){let e;e=this.review.CreateTechnicalQueryMethod.SPFArgument5&&this.review.CreateTechnicalQueryMethod.SPFArgument5.length>0?this.review.CreateTechnicalQueryMethod.SPFArgument5:this.sdaTranslateService.get("REVIEW_POWER_BAR_CREATE_TQ","Technical Query"),this.configService.selectedCreateConfig===this.review.Config&&this.leftPowerBarButtons.push(new E.a(this.createNewTechnicalQuery,e,"fa-plus power-bar-button__icon"))}}rejectReview(){this.reviewProvider.isReviewWorkflowEditable(this.workflowStep).subscribe(e=>{e?(this.updateLoading(!0),this.todoListService.rejectStep([this.workflowStep.obid],this.sdaTranslateService.get("REVIEW_REJECTED_BY_COMPLIANCE","Rejected by compliance review"),"").subscribe(()=>{this.updateLoading(!1),this.notificationService.success(this.sdaTranslateService.get("REVIEW_REJECT_SUCCESS","Review rejected")),this.onApiComplete.emit()},e=>{this.updateLoading(!1),this.exceptionService.handleException(e)})):this.reviewProvider.reviewCompletedMessageAndEjectUser()})}waiveReview(){this.currentUserReview.Details&&0!==this.currentUserReview.Details.length?this.modalService.alert(this.sdaTranslateService.get("REVIEW_WAIVE_COMMENT_WARNING","Cannot waive a review that contains text")):(this.updateLoading(!0),this.reviewDataService.waiveDocumentReview(this.workflowStep.obid).subscribe(()=>{this.updateLoading(!1),this.notificationService.success(this.sdaTranslateService.get("REVIEW_WAIVE_SUCCESS","Review waived")),this.onApiComplete.emit()},e=>{this.updateLoading(!1),this.exceptionService.handleException(e)}))}isDocumentReturnCodeSet(){let e=!0,t=this.review.ReturnCode;const i=this.leftPowerBarButtons.filter(e=>"DocReturnCodeDropDown"===e.uid)[0];return i||(t=i.display.Value),t&&""!==t&&t!==a.a||(e=!1),e}addUnSavedCommentsToChangeSet(e,t){t.forEach(t=>{const i=new c.a(void 0);i.properties.push(new l.a("SDAObservationDetails",t.Details),new l.a("Description",t.Title)),e.addUpdateRequest(t.OBID,i)})}addUnSavedReviewsToChangeSet(e,t){t.forEach(t=>{const i=new c.a(void 0);i.properties.push(new l.a("SDAObservationDetails",t.Details)),e.addUpdateRequest(t.OBID,i)})}addUnSavedActionsToChangeSet(e,t){t.forEach(t=>{const i=new c.a(void 0);i.properties.push(new l.a("SDAProjComsDetails",t.Details),new l.a("Description",t.Title)),e.addUpdateRequest(t.OBID,i)})}validateReturnCodeAndCompleteReview(){this.mode!==D.a.Consolidate&&this.mode!==D.a.Reconsolidate||!0!==this.isReturnCodeMandatory||this.isDocumentReturnCodeSet()?this.completeReview():(this.updateLoading(!1),this.modalService.alert(this.sdaTranslateService.get("REVIEW_COMPLETE_RETURNCODE_WARNING","Return Code must be set to complete the review")))}completeReview(){this.reviewDataService.completeDocumentReview(this.workflowStep.obid,this.mode===D.a.Consolidate||this.mode===D.a.Reconsolidate).subscribe(()=>{this.updateLoading(!1),this.notificationService.success(this.sdaTranslateService.get("REVIEW_COMPLETE_SUCCESS","Review completed")),this.onApiComplete.emit()},e=>{this.updateLoading(!1),this.exceptionService.handleException(e)})}onManageReviewOrCommentRelatedItems(e){this.onExecuteMethod(this.review.ManageReviewOrCommentRelatedItemsMethod,e,!1,[],void 0,!0)}updateLoading(e){this.isLoading=e,e?this.loadingOverlayService.showLoadingOverlay():this.loadingOverlayService.hideLoadingOverlay()}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(_.a),n.Sb(O.a),n.Sb(s.a),n.Sb(S.a),n.Sb(h.a),n.Sb(g.a),n.Sb(m.a),n.Sb(C.a),n.Sb(d.a),n.Sb(u.a),n.Sb(N.a),n.Sb(A.a),n.Sb(w.a),n.Sb(R.a),n.Sb(o.a),n.Sb(f.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-composite-review-view"]],inputs:{review:"review",mode:"mode",workflowStep:"workflowStep",actionRejectStatusParam:"actionRejectStatusParam",parentMethodOBID:"parentMethodOBID",parentClientAPI:"parentClientAPI",parentObjects:"parentObjects",isReturnCodeMandatory:"isReturnCodeMandatory"},outputs:{onApiComplete:"onApiComplete"},decls:22,vars:33,consts:[[3,"rightControls","leftControls"],[1,"comp-review__body",3,"hidden"],[1,"comp-review__side-bar"],[3,"mode","userCanManageMarkupLayers","review","onManageMarkupLayers"],[3,"config","files","renditions","onFileClicked","onRenditionClicked"],[1,"comp-review__component"],[3,"header","selected",4,"ngIf"],[3,"header"],[3,"contributors","primaryActions","primaryComments","referenceActions","referenceComments"],[1,"comp-review__outer-content"],[1,"comp-review__content"],[1,"rm-accordion",3,"multiple"],[3,"selected","header"],[3,"selected","header",4,"ngIf"],[1,"tab-actions",3,"selected","header","leftIcon"],[1,"rm-accordion__3",3,"multiple"],[3,"selected",4,"ngFor","ngForOf"],["class","tab-comments",3,"header",4,"ngIf"],[3,"id","config"],[4,"ngFor","ngForOf"],[3,"header","selected"],[3,"reviewers","mode","primaryActions","referenceActions","reviews","recipientsWithNoReviews"],[3,"mode","config","documentOBID","reviews","reviewers","workflowStep","onReviewSaved","onFileClicked","onManageReviewRelatedItems","onRelBuilderClosed"],[3,"selected"],[1,"accordion-header"],[1,"accordion-header__text"],[3,"mode","actionRejectStatusParam","actions","config","documentOBID","users","fileAction","userCanUpdateAction","userCanCreateAction","userCanManageMarkupLayers","workflowStep","isReferenceGroup","onCreateAction","onEditAction","onRejectAction","onManageMarkupLayers","onActionTerminated","onFileClicked","onManageActionRelatedItems","onRelBuilderClosed","onViewAndMarkup"],[1,"tab-comments",3,"header"],[3,"mode","comments","config","documentOBID","users","fileComment","userCanUpdateComment","workflowStep","onCommentTerminated","onEditComment","onFileClicked","onManageCommentRelatedItems","onRelBuilderClosed"],[1,"files-accordion"],[1,"files-accordion__text"],["class","fa fa-exclamation-circle warning-icon","aria-hidden","true",3,"title",4,"ngIf"],[1,"tab-file-actions",3,"header","selected","leftIcon"],[3,"comments","config","documentOBID","users","mode","fileComment","workflowStep","onManageCommentRelatedItems","onRelBuilderClosed"],["aria-hidden","true",1,"fa","fa-exclamation-circle","warning-icon",3,"title"],[3,"actions","actionRejectStatusParam","config","documentOBID","users","mode","fileAction","userCanUpdateAction","userCanCreateAction","userCanManageMarkupLayers","workflowStep","onFileClicked","onManageMarkupLayers","onManageActionRelatedItems","onRelBuilderClosed","onEditAction","onRejectAction","onViewAndMarkup"]],template:function(e,t){1&e&&(n.Tb(0,"sda-power-bar-view",0),n.Yb(1,"div",1),n.Yb(2,"div",2),n.Yb(3,"sda-document-summary-view",3),n.hc("onManageMarkupLayers",(function(){return t.onManageDocumentMarkupLayers()})),n.Xb(),n.Yb(4,"sda-files-summary-view",4),n.hc("onFileClicked",(function(e){return t.onViewFile(e,!1)}))("onRenditionClicked",(function(e){return t.onViewFile(e,!0)})),n.Xb(),n.Yb(5,"p-tabView",5),n.Sc(6,di,2,8,"p-tabPanel",6),n.Yb(7,"p-tabPanel",7),n.Tb(8,"sda-contributors-summary-view",8),n.Xb(),n.Xb(),n.Xb(),n.Yb(9,"div",9),n.Yb(10,"div",10),n.Yb(11,"p-accordion",11),n.Yb(12,"p-accordionTab",12),n.Yb(13,"p-tabView"),n.Sc(14,ui,2,9,"p-tabPanel",13),n.Yb(15,"p-tabPanel",14),n.Yb(16,"p-accordion",15),n.Sc(17,hi,5,14,"p-accordionTab",16),n.Xb(),n.Xb(),n.Sc(18,fi,3,4,"p-tabPanel",17),n.Yb(19,"p-tabPanel",7),n.Tb(20,"sda-object-details",18),n.Xb(),n.Xb(),n.Xb(),n.Sc(21,pi,11,17,"p-accordionTab",19),n.Xb(),n.Xb(),n.Xb(),n.Xb()),2&e&&(n.sc("rightControls",t.rightPowerBarButtons)("leftControls",t.leftPowerBarButtons),n.Eb(1),n.sc("hidden",t.isLoading),n.Eb(2),n.sc("mode",t.mode)("userCanManageMarkupLayers",!!t.review.ManageDocumentMarkupsMethod)("review",t.review),n.Eb(1),n.sc("config",t.review.Config)("files",t.review.Files)("renditions",t.review.FileRenditions),n.Eb(2),n.sc("ngIf",5!==t.mode),n.Eb(1),n.tc("header",t.REVIEW_CONTRIBUTOR_SUMMARY_TITLE),n.Eb(1),n.sc("contributors",t.contributors)("primaryActions",t.primaryActions)("primaryComments",t.review.PrimaryComments)("referenceActions",t.review.ReferenceActions)("referenceComments",t.review.ReferenceComments),n.Eb(3),n.sc("multiple",!0),n.Eb(1),n.sc("selected",!0)("header",t.REVIEW_DOCUMENT_SUMMARY_TITLE),n.Eb(2),n.sc("ngIf",t.visibleReviews.length>0),n.Eb(1),n.vc("header","",t.REVIEW_ACTIONS_TAB_TITLE," (",t.actionsCount,")"),n.sc("selected",0===t.visibleReviews.length)("leftIcon",n.xc(31,Ii,t.review.HasRejectedDocumentActions||t.review.HasReservedDocumentActions)),n.Eb(1),n.sc("multiple",!0),n.Eb(1),n.sc("ngForOf",t.actions),n.Eb(1),n.sc("ngIf",5!==t.mode),n.Eb(1),n.tc("header",t.REVIEW_DOCUMENT_DETAILS_TAB_TITLE),n.Eb(1),n.sc("id",t.review.OBID)("config",t.review.Config),n.Eb(1),n.sc("ngForOf",t.review.Files))},directives:[P.a,W,te,ie.b,y.t,ie.a,ce,Y.a,Y.c,y.s,le.a,Ae,ht,j.b,Xt,li],styles:["[_nghost-%COMP%]     .card-heading__title, [_nghost-%COMP%]     .card-section__content, [_nghost-%COMP%]     .card-status__reason{overflow-wrap:break-word;word-wrap:break-word;word-break:break-word}[_nghost-%COMP%]     .overlay-panel{overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]     .comp-overflow__item{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}@-webkit-keyframes consolidated{0%{-webkit-transform:translateX(-10px);transform:translateX(-10px);opacity:0}to{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}}@keyframes consolidated{0%{-webkit-transform:translateX(-10px);transform:translateX(-10px);opacity:0}to{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}}[_nghost-%COMP%]{display:flex;flex:1;flex-direction:column;height:100%}[_nghost-%COMP%]     .overlay-panel{position:absolute;top:100%;right:0;max-width:200px;max-height:175px;padding:6px;box-shadow:0 1px 2px 0 rgba(0,0,0,.3);z-index:100!important}[_nghost-%COMP%]     .power-bar .enum-select{max-width:175px}[_nghost-%COMP%]     .comp-review__body{display:flex;flex:1;flex-direction:row;background:#ebedf0;overflow:hidden}[_nghost-%COMP%]     .comp-review__body .warning-icon{position:static;margin:0 4px;font-size:14px;color:#f56a0a}[_nghost-%COMP%]     .comp-review__side-bar{flex:0 0 300px;flex-direction:column;margin:6px;background:#fff;box-shadow:0 1px 2px #cad0d7;overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]     .comp-review__side-bar sda-files-summary-view{border-top:1px solid #cad0d7;border-bottom:1px solid #cad0d7}[_nghost-%COMP%]     .comp-review__outer-content{flex-grow:1;margin:6px 6px 6px 0;background:#fff;box-shadow:0 1px 2px #cad0d7;overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]     .comp-review__block{padding-right:5px;padding-left:5px}[_nghost-%COMP%]     .comp-review__heading{font-weight:500}[_nghost-%COMP%]     .comp-overflow{display:flex;flex-flow:column wrap}[_nghost-%COMP%]     .comp-overflow__item{display:initial;height:34px;padding:8px 10px;color:#1f2429;font-size:14px;cursor:pointer;transition:background .35s}[_nghost-%COMP%]     .comp-overflow__item:hover{background-color:#ebedf0}[_nghost-%COMP%]     .comp-overflow__item:not(:first-child):not(:only-child){border-top:1px solid #ebedf0}[_nghost-%COMP%]     p-tabview{display:block;flex-shrink:0;flex-grow:5;background-color:#fff;overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]     .ui-accordion{border:0!important;overflow:hidden}[_nghost-%COMP%]     .ui-tabview-top{border:none}[_nghost-%COMP%]     .ui-accordion-header{margin-top:0}[_nghost-%COMP%]     .ui-tabview-panels .ui-tabview{margin:0 15px 15px}[_nghost-%COMP%]     .ui-tabview-panels .ui-tabview .ui-tabview-panel{border:1px solid #cad0d7;border-top:none}@media screen and (min-width:125em){[_nghost-%COMP%]     .col-50{max-width:695px}}@media screen and (max-width:74.9375em){[_nghost-%COMP%]     .col-50{width:100%}}[_nghost-%COMP%]     .rm-accordion .ui-accordion-header{background-color:#86d8ff}[_nghost-%COMP%]     .rm-accordion__2 .ui-accordion-header{background-color:#afe5ff}[_nghost-%COMP%]     .rm-accordion__3 .ui-accordion-header{background-color:#cdefff}[_nghost-%COMP%]     .object-details{flex:auto!important}[_nghost-%COMP%]     .object-details--fixed-height{height:300px}.files-accordion[_ngcontent-%COMP%]{display:flex;flex-grow:1}.files-accordion__text[_ngcontent-%COMP%]{max-width:60%;margin-right:5px}@media screen and (max-width:74.9375em){.files-accordion__text[_ngcontent-%COMP%]{max-width:100%}}.files-accordion[_ngcontent-%COMP%]   .warning-icon[_ngcontent-%COMP%]{margin-top:1px}[_nghost-%COMP%]     .card-item{width:100%;margin-bottom:30px;padding:0 10px;border:1px solid #cad0d7}[_nghost-%COMP%]     .card-item .ui-accordion-header, [_nghost-%COMP%]     .card-item .ui-accordion-header.ui-state-hover{background:#fff}[_nghost-%COMP%]     .card-item .ui-menuitem .ui-menuitem-link{border:none!important}[_nghost-%COMP%]     .card-item .ui-menu .ui-menuitem{text-align:left}[_nghost-%COMP%]     .card-item--review{margin-top:20px}[_nghost-%COMP%]     .card-item--review .card-user{width:auto;height:auto;margin:0;padding:0;border:none;line-height:1}[_nghost-%COMP%]     .card-item--approved{border-color:#559d39;border-top-left-radius:0;box-shadow:none}[_nghost-%COMP%]     .card-item--approved .card-status{background:#d7edce;color:#fff;border-top:1px solid #559d39}[_nghost-%COMP%]     .card-item--approved .card-status__icon{margin-right:5px;color:#fff}[_nghost-%COMP%]     .card-item--approved .card-status__title{background:#559d39;color:#fff}[_nghost-%COMP%]     .card-item--warning{border-color:#f56a0a}[_nghost-%COMP%]     .card-item--warning .card-status{background:#fbd5da;color:#1f2429;border-top:1px solid #f56a0a}[_nghost-%COMP%]     .card-item--warning .card-status .card-status__title{background:#f56a0a;color:#fff}[_nghost-%COMP%]     .card-item--warning .card-status .card-status__user{margin-right:8px}[_nghost-%COMP%]     .card-item--warning .card-status .card-status__reason{padding:10px;font-size:15px}[_nghost-%COMP%]     .card-item--rejected{border-color:#d7142c}[_nghost-%COMP%]     .card-item--rejected .card-status{background:#fbd5da;color:#1f2429;border-top:1px solid #d7142c}[_nghost-%COMP%]     .card-item--rejected .card-status .card-status__title{background:#d7142c;color:#fff}[_nghost-%COMP%]     .card-item--rejected .card-status .card-status__user{margin-right:8px}[_nghost-%COMP%]     .card-item--rejected .card-status .card-status__user__icon{margin-right:1px;color:#515e6b}[_nghost-%COMP%]     .card-item--rejected .card-status .card-status__user__icon--you{color:#00608f}[_nghost-%COMP%]     .card-item--rejected .card-status .card-status__user__title{height:100%;justify-content:center;font-weight:500}[_nghost-%COMP%]     .card-item--rejected .card-status .card-status__user__title__you{color:#697a8b;font-style:italic;font-size:12px}[_nghost-%COMP%]     .card-item--rejected .card-status .card-status__reason{padding:10px;font-size:15px;color:#6e0a17}[_nghost-%COMP%]     .card-header{display:flex;align-items:center;justify-content:space-between;margin:3px 0;padding:5px 0;border:none;background:#fff}[_nghost-%COMP%]     .card-heading{flex-grow:1;padding-right:10px}[_nghost-%COMP%]     .card-heading__edit, [_nghost-%COMP%]     .card-heading__title{padding-left:6px;font-weight:500;font-size:16px;line-height:1;color:#546e7a}[_nghost-%COMP%]     .card-heading__edit{width:100%;min-width:110px!important;height:35px;-webkit-appearance:none;appearance:none}[_nghost-%COMP%]     .card-heading__edit:hover{border-color:#a9b4be}[_nghost-%COMP%]     .card-heading__edit:focus{border-color:#02adff}[_nghost-%COMP%]     .card-heading__edit[disabled]{background:#fff;border-color:#fff}[_nghost-%COMP%]     .card-badge{margin-left:10px;padding:3px 6px;font-size:13px;color:#fff;font-weight:500;text-transform:uppercase;border-radius:3px}[_nghost-%COMP%]     .card-badge--completed{background:#559d39;-webkit-animation:consolidated .35s ease;animation:consolidated .35s ease}[_nghost-%COMP%]     .card-actions{position:relative;display:flex;flex:0 0 auto;justify-content:flex-end;align-self:flex-start}[_nghost-%COMP%]     .card-actions__button{text-transform:uppercase;font-size:14px!important;display:inline-block}[_nghost-%COMP%]     .card-actions__toggle .ui-button{display:block;height:auto;padding:8px 18px 6px;background-color:#f6f8fb;color:#1f2429;border:1px solid #a9b4be;line-height:18px;outline:none;transition:none;box-shadow:none;cursor:pointer;text-transform:uppercase;font-size:16px!important;font-weight:500}[_nghost-%COMP%]     .card-actions__toggle .ui-button-text{padding:0!important}[_nghost-%COMP%]     .card-actions__toggle .ui-button.ui-state-active{background-color:#1a98e1;border-color:#157db9;color:#fff}[_nghost-%COMP%]     .card-actions__toggle .ui-button.ui-state-active.ui-state-hover{background-color:#2ea3e7}[_nghost-%COMP%]     .card-status{display:flex;flex-wrap:wrap;align-items:flex-start}[_nghost-%COMP%]     .card-status__title{display:inline-block;margin-right:8px;padding:8px 15px;font-size:16px;border-bottom-right-radius:2px}[_nghost-%COMP%]     .card-status__date, [_nghost-%COMP%]     .card-status__user{padding:8px 0}[_nghost-%COMP%]     .card-status__button{margin:5px 10px 5px auto;padding:5px 10px;text-transform:uppercase;font-size:12px!important;color:#1f2429;box-shadow:none}[_nghost-%COMP%]     .card-status__reason{flex-basis:100%}[_nghost-%COMP%]     .card-info{position:relative;display:flex;align-items:center}[_nghost-%COMP%]     .card-info:not(:first-child){margin-left:15px}[_nghost-%COMP%]     .card-info__icon{flex-shrink:0;margin-right:5px}[_nghost-%COMP%]     .card-info__data{font-size:13px;line-height:1;color:#515e6b!important}[_nghost-%COMP%]     .card-info__data--tooltip{cursor:help;border-bottom:1px dotted #75d2ff}[_nghost-%COMP%]     .card-section{display:flex;align-items:center;padding:15px 0;border-top:1px solid #cad0d7;background:#fff}[_nghost-%COMP%]     .card-section--main{padding-top:0;border:none}[_nghost-%COMP%]     .card-section__content{width:100%;padding:5px;border:1px solid #fff;font-size:15px;line-height:1.4;white-space:pre-line}[_nghost-%COMP%]     .card-section__textarea{width:100%;min-height:200px;margin-top:0;padding:5px;color:#070809;white-space:pre-wrap;line-height:1.4;font-size:15px;-webkit-appearance:none;appearance:none}[_nghost-%COMP%]     .card-section__textarea:hover{border-color:#a9b4be}[_nghost-%COMP%]     .card-section__textarea:focus{border-color:#02adff}[_nghost-%COMP%]     .card-section__textarea[disabled]{background:#fff;border-color:#fff}[_nghost-%COMP%]     .card-user{width:100%;margin:10px 20px 30px;padding:10px 0;border-bottom:1px solid #a9b4be}[_nghost-%COMP%]     .card-user__body{align-items:center;display:flex;justify-content:flex-start}[_nghost-%COMP%]     .card-user__name{display:inline-flex;justify-content:center;margin:5px;font-size:16px;font-weight:500}[_nghost-%COMP%]     .card-user__name__title{height:100%;padding-left:8px}[_nghost-%COMP%]     .card-user__name__title__you{margin:5px;color:#697a8b;font-size:12px;font-style:italic}[_nghost-%COMP%]     .card-user__icon{font-size:18px;margin:5px;color:#515e6b}[_nghost-%COMP%]     .card-user__icon--you{color:#00608f}"]}),e})()}}]);