(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"90cJ":function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));class o{constructor(){this.enablePaging=!0,this.enableSorting=!0,this.enableFiltering=!0,this.enableColumnMenu=!0,this.enableDetailsSelection=!0,this.objectModalView=!0,this.showIcon=!0}}},YlIq:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));class o{constructor(t,e,i,o=60){this.headerComponent=t,this.cellComponent=e,this.title=i,this.defaultWidth=o}}},jc7h:function(t,e,i){"use strict";i.d(e,"a",(function(){return O}));var o=i("tk/3"),n=i("itXk"),s=i("LRne"),r=i("lJxs"),a=i("IzEk"),c=i("yRyI"),d=i("ONOH"),h=i("Z9D8"),l=i("LUpO"),u=i("I2fW"),g=i("kx0E"),p=i("A1MZ"),b=i("DG5G"),S=i("A3La"),m=i("hqbt"),C=i("OdF/"),f=i("fXoL");let O=(()=>{class t{constructor(t,e,i,o,n,s,r,a,c){this.securityService=t,this.dataFormatService=e,this.configService=i,this.guidService=o,this.filterQueryService=n,this.objectIconService=s,this.exceptionService=r,this.dataService=a,this.odataLoadingService=c,this.odataFilters={eq:"eq",neq:"ne",gt:"gt",gte:"ge",lt:"lt",lte:"le",contains:"contains",doesnotcontain:"substringof",endswith:"endswith",startswith:"startswith"}}getDataSource(t,e){const i=this;return this.currentRequestObj=t,this.filterQueryService.generateModel(t).pipe(Object(r.a)(o=>{const n=t.pageSize;let s=Settings.odata.url+"/";return s+=this.filterQueryService.getEndpointPath(t),{type:"odata-v4",schema:{model:o,total:t=>t?t["@odata.count"]:1,parse:t=>(t&&t.value&&t.value.forEach(t=>{t["SDA-GUID"]=i.guidService.getGuid()}),i.localizeResultUoms(t,o))},transport:{read:{cache:!1,url:s,xhrFields:{withCredentials:!0},beforeSend:(e,i)=>{t.noSupportForAsyncCount||(i.url=this.setCountState(i.url,!1)),this.currentUrl=i.url;const o=this.securityService.getAuthenticationDetails();if(o&&e.setRequestHeader("Authorization","Bearer "+o.authResponse.accessToken),t.config&&e.setRequestHeader("SPFConfigUID",encodeURIComponent(t.config.key)),t.securityRuleDefinition&&e.setRequestHeader("SecurityRuleDefinition",encodeURIComponent(t.securityRuleDefinition)),t.includeAnnotation&&e.setRequestHeader("Prefer","odata.include-annotations="+t.includeAnnotation),!1===t.resolveDocumentsToVersion&&e.setRequestHeader("SPFResolveDocumentsToVersion","false"),t.columnSet&&e.setRequestHeader("Accept",`application/json,application/vnd.intergraph.columnset.${encodeURIComponent(t.columnSet)}+json`),this.configService.queryBySelectedConfigs&&!t.ignoreQueryBySelectedConfig&&e.setRequestHeader("SPFQuerySelectedConfigOnly",this.configService.queryBySelectedConfigs.toString()),this.objectIconService.showIcons){const e=i.success;i.success=i=>{this.OnSuccessRequest(i,t,e)}}}},parameterMap:(e,i)=>{const n=kendo.data.transports["odata-v4"].parameterMap(e,i),s=this.filterQueryService.getURLFromFilters(e.filter,o,t);return s&&(n.$filter=s),n}},error:t=>{this.handleGridDataSourceError(t,e)},sort:t.orderBy,filter:t.filters,page:t.page,serverPaging:!0,serverFiltering:!0,serverSorting:!0,pageSize:n}}))}setObjectIcons(t,e,i){const o=t[e].map(t=>this.getObjectOBID(t));return this.objectIconService.getIconNames(o,i).pipe(Object(r.a)(i=>(t[e].forEach(t=>{const e=i.filter(e=>e.OBID===this.getObjectOBID(t));let o="default";e&&e.length&&e[0].IconName&&(o=e[0].IconName),t.iconName=o}),t)))}OnSuccessRequest(t,e,i){let o=!1;if(t?Array.isArray(t.value)||(t={value:[t],"@odata.count":1},o=!0):t={value:[]},t.value&&t.value.length){let s,r;if(e.config&&(s=e.config.key),e.securityRuleDefinition&&(r=e.securityRuleDefinition),t.value[0].hasOwnProperty("DynIconName")){let n=this.updateIcons(t,"value");o&&(n=Object.assign(Object.assign({},n.value[0]),{"@odata.count":1})),this.getDataCount(!e.noSupportForAsyncCount&&!o,n,s,e.columnSet,r).pipe(Object(a.a)(1)).subscribe(t=>{n["@odata.count"]=t,i(n,"success",void 0),this.odataLoadingService.isODataGridPagerLoading.next(!1)})}else Object(n.a)(this.setObjectIcons(t,"value",s),this.getDataCount(!e.noSupportForAsyncCount&&!o,t,s,e.columnSet,r)).pipe(Object(a.a)(1)).subscribe(([t,e])=>{o&&(t=t.value[0]),t["@odata.count"]=e,i(t,"success",void 0),this.odataLoadingService.isODataGridPagerLoading.next(!1)},e=>{const n=new h.a(e,void 0,"GridService","OnSuccessRequest");this.exceptionService.handleException(n),o&&(t=t.value[0]),i(t,"success",void 0),this.odataLoadingService.isODataGridPagerLoading.next(!1)})}else i(t,"success",void 0),this.odataLoadingService.isODataGridPagerLoading.next(!1)}updateIcons(t,e){return t[e].forEach(t=>{let e="default";t.DynIconName&&(e=t.DynIconName),t.iconName=e}),t}getDataCount(t,e,i,n,a){if(t){const t=this.countOnly(this.setCountState(this.currentUrl,!0)).replace(/http.+\/v2\/SDA\//,"");let e;return a?(e=new o.d({SecurityRuleDefinition:a}),this.dataService.get(t,i,!1,n,e).pipe(Object(r.a)(t=>t.count))):this.dataService.get(t,i,!1,n).pipe(Object(r.a)(t=>t.count))}return Object(s.a)(e["@odata.count"])}setCountState(t,e){return t.replace("count="+!e,"count="+e)}countOnly(t){return t.replace(/top=\d+/,"top=0")}getObjectOBID(t){return t.Id?t.Id:t.OBID}handleGridDataSourceError(t,e){if(t.xhr&&401===t.xhr.status&&!this.securityService.IsAuthorized){const e=this.securityService.refreshToken().subscribe(()=>{e.unsubscribe(),t.sender.read()})}else{let o;try{o=JSON.parse(t.xhr.responseText)}catch(i){o=t.xhr.responseText}e&&this.exceptionService.handleException(new h.a(e)),o&&o.error?(o=o.error,this.exceptionService.handleException(new h.a(o.message))):this.exceptionService.handleException(new h.a(o)),this.hideLoadingIndicator()}}localizeResultUoms(t,e){if(t.value)for(let i=0;i<t.value.length;i++){const o=t.value[i];if(o)for(const t in o)if(o.hasOwnProperty(t)){const i=t.toString();i.indexOf("_SIValue")>-1&&this.localizeSIValues(o,i,e)}}return t}localizeSIValues(t,e,i){const o=i.fields[e];let n;if(this.filterQueryService.verifyDoubleType(o.edmModelType)?n=C.a.DOUBLE:this.filterQueryService.verifyIntegerType(o.edmModelType)&&(n=C.a.INTEGER),n){const i=t[e.substring(0,e.indexOf("_SIValue"))];i&&(t[e.substring(0,e.indexOf("_SIValue"))]=this.dataFormatService.convertToLocalUom(i,n))}}hideLoadingIndicator(){const t=$(".k-loading-mask");t&&t.hide()}}return t.\u0275fac=function(e){return new(e||t)(f.dc(m.a),f.dc(g.a),f.dc(d.a),f.dc(p.a),f.dc(b.a),f.dc(u.a),f.dc(l.a),f.dc(S.a),f.dc(c.a))},t.\u0275prov=f.Ob({token:t,factory:t.\u0275fac}),t})()},yISo:function(t,e,i){"use strict";i.d(e,"a",(function(){return Rt}));var o=i("fXoL"),n=i("quSY"),s=i("itXk"),r=i("LRne"),a=i("xgIS"),c=i("IzEk"),d=i("eIep"),h=i("vkgz"),l=i("lJxs"),u=i("/uUt"),g=i("Kj3r"),p=i("GJmQ"),b=i("2LzU"),S=i("cooZ"),m=i("yRyI"),C=i("4B5/"),f=i("Z9D8"),O=i("PEjJ"),v=i("dEBh"),w=i("PuHP"),P=i("NYVZ"),I=i("A1MZ"),k=i("DgwV"),_=i("8IK6"),x=i("PoZZ"),T=(i("blvr"),i("Ejbi")),B=i("+eYH"),A=i("XwBL"),M=i("pLZG"),E=function(t){return t[t.ActionsGroupButton=0]="ActionsGroupButton",t[t.ActionsGroupSpacer=1]="ActionsGroupSpacer",t}({});class y{constructor(t){this.disabled=!1,t&&(this.action=t.action,this.icon=t.icon,this.matIcon=t.matIcon,this.tooltip=t.tooltip,this.disabled=!!t.disabled)}getType(){return E[this.ACTIONS_GROUP_CONTROL_TYPE]}}class R extends y{constructor(t){super(t),this.ACTIONS_GROUP_CONTROL_TYPE=E.ActionsGroupButton}}class D extends y{constructor(){super(),this.ACTIONS_GROUP_CONTROL_TYPE=E.ActionsGroupSpacer}}var G=i("LUpO"),L=i("C4gn"),j=i("xc+7"),N=i("jNCI"),H=i("JSP6"),q=i("Qi+w"),U=i("UPSG"),F=i("hGER"),W=i("ofXK"),z=i("NFeN"),X=i("TLn4");function V(t,e){if(1&t&&o.Tb(0,"mat-icon",9),2&t){const t=o.lc(2).$implicit;o.sc("svgIcon",t.matIcon)}}function Y(t,e){if(1&t&&o.Tb(0,"img",10),2&t){const t=o.lc(2).$implicit;o.sc("src",t.icon,o.Mc)("alt",t.tooltip)}}function Q(t,e){if(1&t){const t=o.Zb();o.Yb(0,"div",6),o.hc("click",(function(e){o.Kc(t);const i=o.lc().$implicit;return o.lc().onButtonClick(i,e)})),o.Sc(1,V,1,1,"mat-icon",7),o.Sc(2,Y,1,2,"img",8),o.Xb()}if(2&t){const t=o.lc().$implicit;o.Ib("actions-group-actions__button--disabled",t.disabled),o.sc("title",t.tooltip),o.Eb(1),o.sc("ngIf",t.matIcon),o.Eb(1),o.sc("ngIf",t.icon)}}function J(t,e){1&t&&o.Tb(0,"div",11)}function Z(t,e){1&t&&(o.Yb(0,"div",3),o.Sc(1,Q,3,5,"div",4),o.Sc(2,J,1,0,"div",5),o.Xb()),2&t&&(o.sc("ngSwitch",e.$implicit.getType()),o.Eb(1),o.sc("ngSwitchCase","ActionsGroupButton"),o.Eb(1),o.sc("ngSwitchCase","ActionsGroupSpacer"))}function K(t,e){1&t&&o.Tb(0,"sda-loading-indicator",12),2&t&&o.sc("size",14)}let tt=(()=>{class t{constructor(){this.actionsButtons=[],this.isLoading=!1}onButtonClick(t,e){t.action&&!t.disabled&&t.action(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Mb({type:t,selectors:[["sda-actions-group"]],inputs:{actionsButtons:"actionsButtons",isLoading:"isLoading"},decls:3,vars:2,consts:[[1,"actions-group"],["class","actions-group-actions",3,"ngSwitch",4,"ngFor","ngForOf"],[3,"size",4,"ngIf"],[1,"actions-group-actions",3,"ngSwitch"],["class","actions-group-actions__button",3,"actions-group-actions__button--disabled","title","click",4,"ngSwitchCase"],["class","actions-group-actions__spacer",4,"ngSwitchCase"],[1,"actions-group-actions__button",3,"title","click"],[3,"svgIcon",4,"ngIf"],["height","24","width","24",3,"src","alt",4,"ngIf"],[3,"svgIcon"],["height","24","width","24",3,"src","alt"],[1,"actions-group-actions__spacer"],[3,"size"]],template:function(t,e){1&t&&(o.Yb(0,"div",0),o.Sc(1,Z,3,3,"div",1),o.Sc(2,K,1,1,"sda-loading-indicator",2),o.Xb()),2&t&&(o.Eb(1),o.sc("ngForOf",e.actionsButtons),o.Eb(1),o.sc("ngIf",e.isLoading))},directives:[W.s,W.t,W.x,W.y,z.a,X.a],styles:[".actions-group[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap;min-height:24px;padding:0 6px 6px;background-color:#fff;color:rgba(0,0,0,.54);border:1px solid rgba(0,0,0,.54);border-radius:5px;box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.actions-group-actions[_ngcontent-%COMP%]{margin-top:6px}.actions-group-actions__button[_ngcontent-%COMP%]{height:24px;cursor:pointer}.actions-group-actions__button--disabled[_ngcontent-%COMP%]{opacity:.4}.actions-group-actions__spacer[_ngcontent-%COMP%]{width:1px;height:15px;background-color:rgba(0,0,0,.54)}.actions-group-actions[_ngcontent-%COMP%]:not(:last-child){margin-right:6px}sda-loading-indicator[_ngcontent-%COMP%]{margin:6px 5px 0}"]}),t})(),et=(()=>{class t{constructor(t,e,i,o,n,s,r,a,c){this.infomapNavigationService=t,this.sdaTranslateService=e,this.pinsMenuService=i,this.pinsHelperService=o,this.featureSetNavigationService=n,this.exceptionService=s,this.modalService=r,this.featureSetService=a,this.gridShortcutService=c,this.shortcutsButtons=[],this.isAdditionalButtonsLoading=!1,this.ACTIONS_MENU_INFOMAP_SHORTCUT=this.sdaTranslateService.get("ACTIONS_MENU_INFOMAP_SHORTCUT","Show Info Map"),this.ACTIONS_BAR_ADD_TO_PINBOARD=this.sdaTranslateService.get("ACTIONS_BAR_ADD_TO_PINBOARD","Add to Pinboard"),this.ACTIONS_MENU_SHORCUT_NOT_VALID_FOR_CONDITION=this.sdaTranslateService.get("ACTIONS_MENU_SHORCUT_NOT_VALID_FOR_CONDITION","One or more selected items are not valid for this action")}ngOnInit(){this.setPinsGroup(),this.createShortcutsButtons(),this.selectedPinGroupPinsChangesSubscription=this.pinsMenuService.selectedPinGroupPinsChanges$.subscribe(()=>{this.setPinsGroup()})}ngOnDestroy(){this.selectedPinGroupPinsChangesSubscription&&this.selectedPinGroupPinsChangesSubscription.unsubscribe()}setObject(t){this.selectedObject=t}createShortcutsButtons(){this.createInitialButtons(),this.createAdditionalButtons()}createInitialButtons(){const t=new R({action:t=>{this.openInfomap(t)},matIcon:"nodemap",tooltip:this.ACTIONS_MENU_INFOMAP_SHORTCUT});this.shortcutsButtons.push(t),this.targetPinsGroupObid&&(this.pinButton=new R({action:t=>{this.addToPinboard(t)},matIcon:"pin",tooltip:this.pinsTitle}),this.shortcutsButtons.push(this.pinButton))}createAdditionalButtons(){this.gridShortcutService.hoveredRowObjectChanged$.pipe(Object(M.a)(t=>t.Id===this.selectedObject.obid),Object(c.a)(1),Object(d.a)(()=>(this.isAdditionalButtonsLoading=!0,this.featureSetService.getShortcutFeaturesByObject([this.selectedObject])))).subscribe(t=>{if(t&&t.length){const e=new D;this.shortcutsButtons.push(e),t.forEach(t=>{this.shortcutsButtons.push(this.convertFeatureToButton(t))})}this.isAdditionalButtonsLoading=!1},t=>{const e=new f.a(t,"grid error","ShortcutsColumnCellComponent","getAsyncShortcuts");this.exceptionService.handleException(e),this.isAdditionalButtonsLoading=!1})}convertFeatureToButton(t){return new R({action:e=>{this.onShortcutSelected(e,t)},icon:t.shortcut.icon,tooltip:t.shortcut.tooltip})}openInfomap(t){t.stopPropagation(),this.infomapNavigationService.navigateToInfoMap(this.selectedObject.obid,this.selectedObject.config,!1)}addToPinboard(t){t.stopPropagation(),this.pinsMenuService.pinToPinGroup(this.selectedObject,this.targetPinsGroupObid)}onShortcutSelected(t,e){t.stopPropagation(),this.featureSetService.getShortcutConditionResult(e).pipe(Object(c.a)(1)).subscribe(t=>{t&&t.length?this.modalService.alert(this.ACTIONS_MENU_SHORCUT_NOT_VALID_FOR_CONDITION,e.displayName):this.featureSetNavigationService.navigateToFeature(e)},t=>{const e=new f.a(t,"Shortcuts error","ShortcutsColumnCellComponent","onShortcutSelected");this.exceptionService.handleException(e)})}setPinsGroup(){this.pinsGroup=this.pinsHelperService.getSoloPinGroup([this.selectedObject]),this.setTargetPinsGroupObid(),this.setPinsTitle()}setTargetPinsGroupObid(){this.targetPinsGroupObid=this.pinsGroup?this.pinsGroup.obid:void 0}setPinsTitle(){let t="";this.pinsGroup?(this.pinsGroup.name&&(t=this.pinsGroup.name),this.pinsGroup.configName&&(t+="\n"+this.pinsGroup.configName),t=this.sdaTranslateService.getFormatted("PIN_TO","Pin to {0}",[t])):t=this.ACTIONS_BAR_ADD_TO_PINBOARD,this.pinsTitle=t,this.pinButton&&(this.pinButton.tooltip=this.pinsTitle)}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(U.a),o.Sb(T.a),o.Sb(q.a),o.Sb(H.a),o.Sb(L.a),o.Sb(G.a),o.Sb(N.a),o.Sb(j.a),o.Sb(F.a))},t.\u0275cmp=o.Mb({type:t,selectors:[["sda-grid-shortcuts"]],decls:2,vars:2,consts:[[1,"grid-shortcuts"],[3,"actionsButtons","isLoading"]],template:function(t,e){1&t&&(o.Yb(0,"div",0),o.Tb(1,"sda-actions-group",1),o.Xb()),2&t&&(o.Eb(1),o.sc("actionsButtons",e.shortcutsButtons)("isLoading",e.isAdditionalButtonsLoading))},directives:[tt],styles:['[_nghost-%COMP%]{display:none}[_nghost-%COMP%]   .grid-shortcuts[_ngcontent-%COMP%]{position:absolute;left:0}[_nghost-%COMP%]   .grid-shortcuts[_ngcontent-%COMP%]:after, [_nghost-%COMP%]   .grid-shortcuts[_ngcontent-%COMP%]:before{content:"";position:absolute;left:14px;width:0;height:0;border-color:transparent;border-style:solid;border-width:8px 6px}[_nghost-%COMP%]   .grid-shortcuts.grid-shortcuts--bottom[_ngcontent-%COMP%]{top:38px}[_nghost-%COMP%]   .grid-shortcuts.grid-shortcuts--bottom[_ngcontent-%COMP%]:before{top:-17px;border-bottom-color:rgba(0,0,0,.54)}[_nghost-%COMP%]   .grid-shortcuts.grid-shortcuts--bottom[_ngcontent-%COMP%]:after{top:-15px;border-bottom-color:#fff}@media only screen and (min-width:950px){[_nghost-%COMP%]   .grid-shortcuts.grid-shortcuts--bottom[_ngcontent-%COMP%]{top:26px}}[_nghost-%COMP%]   .grid-shortcuts.grid-shortcuts--top[_ngcontent-%COMP%]{bottom:38px}[_nghost-%COMP%]   .grid-shortcuts.grid-shortcuts--top[_ngcontent-%COMP%]:before{bottom:-16px;border-top-color:rgba(0,0,0,.54)}[_nghost-%COMP%]   .grid-shortcuts.grid-shortcuts--top[_ngcontent-%COMP%]:after{bottom:-14px;border-top-color:#fff}@media only screen and (min-width:950px){[_nghost-%COMP%]   .grid-shortcuts.grid-shortcuts--top[_ngcontent-%COMP%]{bottom:26px}}']}),t})();var it=i("ayYE"),ot=i("tce7"),nt=i("JgG9");class st{constructor(t,e,i){this.name=t,this.rowData=e,this.configKey=i}}i("YlIq"),i("90cJ");var rt=i("icSO"),at=i("jc7h"),ct=i("STbY"),dt=i("XNiG"),ht=i("UETY"),lt=i("6JPj"),ut=i("2ufx"),gt=i("bSwM");function pt(t,e){if(1&t){const t=o.Zb();o.Yb(0,"div",3),o.hc("click",(function(){return o.Kc(t),o.lc().showActionsMenu()})),o.Tb(1,"mat-icon",4),o.Xb()}if(2&t){const t=o.lc();o.Eb(1),o.sc("title",t.ACTIONS_MENU_ACTION_TITLE)}}function bt(t,e){if(1&t){const t=o.Zb();o.Wb(0),o.Tb(1,"div",5,6),o.Yb(3,"div",3),o.hc("click",(function(){return o.Kc(t),o.lc().openShortcutsMenu()})),o.Tb(4,"mat-icon",7),o.Xb(),o.Yb(5,"mat-menu",8,9),o.Tb(7,"sda-actions-group",10),o.Xb(),o.Vb()}if(2&t){const t=o.Hc(6),e=o.lc();o.Eb(1),o.sc("matMenuTriggerFor",t),o.Eb(4),o.sc("yPosition",e.menuYPosition),o.Eb(2),o.sc("actionsButtons",e.shortcutsButtons)("isLoading",e.isAdditionalButtonsLoading)}}let St=(()=>{class t{constructor(t,e,i,o,n,s,r,a,c,d,l,u,p){this.contentMenuService=t,this.actionMenuProvider=e,this.actionsMenuService=i,this.sdaTranslateService=o,this.exceptionService=n,this.featureSetService=s,this.infomapNavigationService=r,this.pinsMenuService=a,this.pinsHelperService=c,this.modalService=d,this.featureSetNavigationService=l,this.documentService=u,this.elementRef=p,this.showActionsMenuButton=!0,this.showShortcutsButton=!1,this.shortcutsButtons=[],this.isSelected=!1,this.isAdditionalButtonsLoading=!1,this.menuYPosition="below",this.ACTIONS_MENU_ACTION_TITLE=this.sdaTranslateService.get("ACTIONS_MENU_ACTION_TITLE","Actions"),this.SELECT_THIS_ITEM=this.sdaTranslateService.get("SELECT_THIS_ITEM","Select this item"),this.showToDoActionsMenuSubject=new dt.a,this.showAdditionalShortcutButtonsSubject=new dt.a,this.itemChangeSubscription=e.itemChange.subscribe(t=>{t.forEach((e,i)=>{this.object.obid===e.id&&this.object.data.uid===e.uid&&(this.isSelected=e.selected,this.isSelected?this.actionMenuProvider.addItem(this.object,i===t.length-1):this.actionMenuProvider.removeItem(this.object,i===t.length-1))})}),this.actionMenuProviderSubscription=e.hasItemsSubject.subscribe(t=>{!1===t&&(this.isSelected=!1)}),this.showToDoActionsMenuSubjectSubscription=this.showToDoActionsMenuSubject.pipe(Object(g.a)(250),Object(h.a)(()=>{this.contentMenuService.showToDoActionsMenu()})).subscribe()}ngOnInit(){this.showShortcutsButton&&(this.setTargetPinsGroupObid(),this.initializeShortcutsButtons(),this.selectedPinGroupPinsChangesSubscription=this.pinsMenuService.selectedPinGroupPinsChanges$.subscribe(()=>{this.setTargetPinsGroupObid()}))}ngOnDestroy(){this.itemChangeSubscription&&this.itemChangeSubscription.unsubscribe(),this.actionMenuProviderSubscription&&this.actionMenuProviderSubscription.unsubscribe(),this.showToDoActionsMenuSubject&&this.showToDoActionsMenuSubject.unsubscribe(),this.showToDoActionsMenuSubjectSubscription&&this.showToDoActionsMenuSubjectSubscription.unsubscribe(),this.selectedPinGroupPinsChangesSubscription&&this.selectedPinGroupPinsChangesSubscription.unsubscribe()}setObject(t,e){this.object=t,e&&this.selectItem()}selectItem(){this.actionMenuProvider.itemChange.next([{id:this.object.obid,uid:this.object.data.uid,selected:!this.isSelected}])}showActionsMenu(){this.actionMenuProvider.clearItems(),this.selectItem(),this.actionMenuButtonClicked?this.actionMenuButtonClicked():this.actionsMenuService.canShowToDoActionsMenu()?this.contentMenuService.isToDoActionsMenuOpen()?this.contentMenuService.showToDoActionsMenu():this.showToDoActionsMenuSubject.next():this.contentMenuService.showActionsMenu()}openShortcutsMenu(){this.showAdditionalShortcutButtonsSubject.next(),this.getMenuYPosition(),this.openMatMenu()}getMenuYPosition(){const t=this.documentService.bottomCollideCheck(this.elementRef.nativeElement.querySelector(".actions-group-trigger"),80);this.menuYPosition=t?"above":"below"}openMatMenu(){setTimeout(()=>{this.menuTrigger.openMenu()})}initializeShortcutsButtons(){this.createInitialButtons(),this.createAdditionalButtons()}createInitialButtons(){const t=new R({action:()=>{this.openInfomap()},matIcon:"nodemap"});if(this.shortcutsButtons.push(t),this.targetPinsGroupObid){const t=new R({action:()=>{this.addToPinboard()},matIcon:"pin"});this.shortcutsButtons.push(t)}}createAdditionalButtons(){this.showAdditionalShortcutButtonsSubject.pipe(Object(c.a)(1),Object(d.a)(()=>(this.isAdditionalButtonsLoading=!0,this.featureSetService.getShortcutFeaturesByObject([this.object])))).subscribe(t=>{if(t&&t.length){const e=new D;this.shortcutsButtons.push(e),t.forEach(t=>{this.shortcutsButtons.push(this.convertFeatureToButton(t))})}this.isAdditionalButtonsLoading=!1},t=>{const e=new f.a(t,"grid error","ActionsColumnCellComponent","getAsyncShortcuts");this.exceptionService.handleException(e),this.isAdditionalButtonsLoading=!1})}convertFeatureToButton(t){return new R({action:()=>{this.onShortcutSelected(t)},icon:t.shortcut.icon})}setTargetPinsGroupObid(){const t=this.pinsHelperService.getSoloPinGroup([this.object]);this.targetPinsGroupObid=t?t.obid:void 0}openInfomap(){this.infomapNavigationService.navigateToInfoMap(this.object.obid,this.object.config,!1)}addToPinboard(){this.pinsMenuService.pinToPinGroup(this.object,this.targetPinsGroupObid)}onShortcutSelected(t){this.featureSetService.getShortcutConditionResult(t).pipe(Object(c.a)(1)).subscribe(e=>{e&&e.length?this.modalService.alert("One or more selected items are not valid for this action",t.displayName):this.featureSetNavigationService.navigateToFeature(t)},t=>{const e=new f.a(t,"Shortcuts error","ActionsColumnCellComponent","onShortcutSelected");this.exceptionService.handleException(e)})}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(lt.a),o.Sb(C.a),o.Sb(ht.a),o.Sb(T.a),o.Sb(G.a),o.Sb(j.a),o.Sb(U.a),o.Sb(q.a),o.Sb(H.a),o.Sb(N.a),o.Sb(L.a),o.Sb(ut.a),o.Sb(o.l))},t.\u0275cmp=o.Mb({type:t,selectors:[["sda-actions-column-cell"]],viewQuery:function(t,e){var i;1&t&&o.bd(ct.d,!0),2&t&&o.Gc(i=o.ic())&&(e.menuTrigger=i.first)},inputs:{showActionsMenuButton:"showActionsMenuButton",showShortcutsButton:"showShortcutsButton"},decls:3,vars:4,consts:[[3,"checked","title","checkedChange","change"],["class","action-cell-button",3,"click",4,"ngIf"],[4,"ngIf"],[1,"action-cell-button",3,"click"],["svgIcon","list",1,"action-cell-button__icon",3,"title"],[1,"actions-group-trigger",3,"matMenuTriggerFor"],["menuTrigger",""],["svgIcon","overflow",1,"action-cell-button__icon"],["backdropClass","actions-group-backdrop-menu",1,"actions-group-wrapper",3,"yPosition"],["shortcutsMenu","matMenu"],[3,"actionsButtons","isLoading"]],template:function(t,e){1&t&&(o.Yb(0,"mat-checkbox",0),o.hc("checkedChange",(function(t){return e.isSelected=t}))("change",(function(){return e.selectItem()})),o.Xb(),o.Sc(1,pt,2,1,"div",1),o.Sc(2,bt,8,4,"ng-container",2)),2&t&&(o.sc("checked",e.isSelected)("title",e.SELECT_THIS_ITEM),o.Eb(1),o.sc("ngIf",e.showActionsMenuButton),o.Eb(1),o.sc("ngIf",e.showShortcutsButton))},directives:[gt.a,W.t,z.a,ct.d,ct.e,tt],styles:["[_nghost-%COMP%]{display:flex;align-items:center;height:100%}[_nghost-%COMP%]     .mat-checkbox-inner-container{width:14px;height:14px}.action-cell-button[_ngcontent-%COMP%], mat-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:30px;height:28px}.action-cell-button[_ngcontent-%COMP%]{color:rgba(0,0,0,.54);cursor:pointer}.action-cell-button__icon[_ngcontent-%COMP%]{width:20px;height:20px}.actions-group-trigger[_ngcontent-%COMP%]{width:1px;height:28px}.actions-group-backdrop-menu[_ngcontent-%COMP%]{background-color:initial;opacity:1!important}"]}),t})();function mt(t,e){if(1&t){const t=o.Zb();o.Yb(0,"mat-checkbox",1),o.hc("checkedChange",(function(e){return o.Kc(t),o.lc().checked=e}))("change",(function(e){return o.Kc(t),o.lc().selectionChange(e)})),o.Uc(1),o.Xb()}if(2&t){const t=o.lc();o.sc("checked",t.checked),o.Eb(1),o.Vc(t.ALL)}}let Ct=(()=>{class t{constructor(t,e){this.actionMenuProvider=t,this.sdaTranslateService=e,this.hideSelectAll=!1,this.ALL=this.sdaTranslateService.get("ALL","All"),this.itemChangeSubscription=this.actionMenuProvider.itemChange.subscribe(t=>{const e=this.actionMenuProvider.getItems().map(t=>t.obid),i=new Set(e);t.forEach(t=>{t.selected?i.add(t.id):i.delete(t.id)});const o=this.grid.dataSource.view().map(t=>this.getId(t)).every(t=>i.has(t));this.checked=o})}ngOnDestroy(){this.itemChangeSubscription&&this.itemChangeSubscription.unsubscribe()}selectionChange(t){const e=[];this.grid.dataSource.view().forEach(i=>{const o={id:this.getId(i),uid:i.uid,selected:t.checked};e.push(o)}),this.selectAllClicked&&this.selectAllClicked(),this.actionMenuProvider.itemChange.next(e)}getId(t){let e=t.Id?t.Id:t.OBID;return e||(e=t["SDA-GUID"]),e}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(C.a),o.Sb(T.a))},t.\u0275cmp=o.Mb({type:t,selectors:[["ng-component"]],inputs:{hideSelectAll:"hideSelectAll"},decls:1,vars:1,consts:[[3,"checked","checkedChange","change",4,"ngIf"],[3,"checked","checkedChange","change"]],template:function(t,e){1&t&&o.Sc(0,mt,2,2,"mat-checkbox",0),2&t&&o.sc("ngIf",!e.hideSelectAll)},directives:[W.t,gt.a],styles:["[_nghost-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{margin-left:8px}[_nghost-%COMP%]     .mat-checkbox-inner-container{width:14px;height:14px}"]}),t})();var ft=function(t){return t[t.ExportToExcel=0]="ExportToExcel",t[t.ExportAllToExcel=1]="ExportAllToExcel",t}({}),Ot=i("tyNb"),vt=i("JIr8"),wt=i("m8I0"),Pt=i("QkNQ"),It=i("ti2P"),kt=i("fKP2"),_t=i("Twa3"),xt=i("ONOH"),Tt=i("eruR"),Bt=i("/rTy"),At=i("lUp+");const Mt=["powerBar"];let Et=(()=>{class t{constructor(t,e,i,n,s,r,a,c,d,h){this.actionMenuProvider=t,this.sdaTranslateService=e,this.listEditSdaGridHeaderService=i,this.featureSetDataService=n,this.exceptionService=s,this.pinsMenuService=r,this.pinsHelperService=a,this.claimboardService=c,this.configService=d,this.changeDetectorRef=h,this.odataRequest=void 0,this.exportExcelHidden=!0,this.exportAllToExcelHidden=!0,this.popoutWindowHidden=!0,this.addToPinboardHidden=!0,this.enableListEdit=!1,this.gridLoading=!0,this.onActionButtonClicked=new o.o,this.onPopOutWindowClicked=new o.o,this.rightPowerBarControls=[],this.backgroundStyle=Pt.a.Transparent,this.isLoading=!0,this.displayLoadingBlanket=!0,this.headerLoading=!0,this.listEditLoading=!1,this.claimboardDisabled=!1,this.enableActions=!1,this.claimboardEnabled=!1,this.pinGroups=[],this.unfilteredPinGroups=[],this.ACTIONS_BAR_ADD_TO_PINBOARD=this.sdaTranslateService.get("ACTIONS_BAR_ADD_TO_PINBOARD","Add to pinboard"),this.NEW_LIST=this.sdaTranslateService.get("NEW_LIST","New List"),this.PIN_TO_NEW_LIST=this.sdaTranslateService.get("PIN_TO_NEW_LIST","Add to a new pins list"),this.PIN_TO_NEW_LIST_GRID_DISABLED=this.sdaTranslateService.get("PIN_TO_NEW_LIST_GRID_DISABLED","Pins Lists can only be created using data from the current create scope"),this.ACTIONS_BAR_EXPORT_ALL_TO_EXCEL=this.sdaTranslateService.get("ACTIONS_BAR_EXPORT_ALL_TO_EXCEL","Export all to Excel"),this.ACTIONS_BAR_OPEN_IN_NEW_WINDOW=this.sdaTranslateService.get("ACTIONS_BAR_OPEN_IN_NEW_WINDOW","Open in new window"),this.ACTIONS_BAR_EXPORT_TO_EXCEL=this.sdaTranslateService.get("ACTIONS_BAR_EXPORT_TO_EXCEL","Export to Excel"),this.ACTIONS_MENU_ADD_CLAIMBOARD=this.sdaTranslateService.get("ACTIONS_MENU_ADD_CLAIMBOARD","Add to Claimboard"),this.LIST_EDIT=this.sdaTranslateService.get("LIST_EDIT","List Edit"),this.LIST_EDIT_TOOLTIP=this.sdaTranslateService.get("LIST_EDIT_TOOLTIP","List edit items on current page"),this.updatePinGroups(this.pinsMenuService.allPinGroupsValues.concat()),this.initialisePowerBar(),this.setupGridBoundSubject(),this.setupApisSubject(),this.actionMenuProviderSubscription=this.actionMenuProvider.onActionMenuItemsUpdated$.subscribe(t=>{this.changeActionsButtonState(!(!t||!t.length)),this.updateAvailableApisSubject.next(t)}),this.claimEnabledSubscription=this.claimboardService.claimEnabledChange$.subscribe(t=>{this.claimboardEnabled=t,this.checkClaimboardButtonState()}),this.pinGroupChangesSubscription=this.pinsMenuService.pinGroupsChanges$.subscribe(t=>{this.updatePinsGroupButton(t||[])}),this.selectedPinGroupChangesSubscription=this.pinsMenuService.selectedPinGroupChanges$.subscribe(t=>{if(this.pinGroups.length&&t.obid!==this.selectedPinGroup){const e=this.pinGroups.find(e=>e.obid===t.obid);this.selectedPinGroup=e?e.obid:this.selectedPinGroup?this.selectedPinGroup:this.pinGroups[0].obid,this.setPinsGroupButton()}})}ngAfterViewInit(){this.powerBar.resizeToFit()}ngOnChanges(t){t.exportExcelHidden&&(this.excelExportButton.hidden=t.exportExcelHidden.currentValue),t.exportAllToExcelHidden&&(this.excelExportAllButton.hidden=t.exportAllToExcelHidden.currentValue),t.addToPinboardHidden&&(this.pinboardButton.hidden=t.addToPinboardHidden.currentValue),t.popoutWindowHidden&&this.hidePopoutWindowButton(),t.gridDataBoundEvent&&this.updateGridBoundButtonsSubject.next(),t.gridLoading&&(this.listEditButton.isDisabled=this.gridLoading||this.listEditLoading,this.excelExportButton.isDisabled=this.gridLoading,this.excelExportAllButton.isDisabled=this.gridLoading,this.checkPinboardButtonDisabled(),this.popoutWindowButton.isDisabled=this.gridLoading,this.checkClaimboardButtonDisabled(),this.checkLoadingState()),t.odataRequest&&(this.hidePopoutWindowButton(),this.checkClaimboardButtonState()),t.gridConfig&&(t.gridConfig.previousValue!==t.gridConfig.currentValue&&(this.selectedPinGroup=this.pinsMenuService.selectedPinGroupObid),this.updatePinsGroupButton(this.unfilteredPinGroups))}ngOnDestroy(){this.actionMenuProviderSubscription.unsubscribe(),this.claimEnabledSubscription.unsubscribe(),this.updateGridBoundButtonsSubscription.unsubscribe(),this.updateGridBoundButtonsSubject.unsubscribe(),this.updateAvailableApisSubscription.unsubscribe(),this.updateAvailableApisSubject.unsubscribe(),this.pinGroupChangesSubscription.unsubscribe(),this.selectedPinGroupChangesSubscription.unsubscribe()}changeActionsButtonState(t){this.enableActions=t,this.pinboardButton.isDisabled=!t||this.gridLoading,this.checkClaimboardButtonDisabled()}setHeaderLoading(t){this.headerLoading=t,this.checkLoadingState()}checkLoadingState(){this.isLoading=this.gridLoading||this.headerLoading,this.displayLoadingBlanket=this.gridLoading}setlistEditLoading(t){this.listEditLoading=t,this.listEditButton.isDisabled=t||this.gridLoading}setClaimboardDisabled(t){this.claimboardDisabled=t,this.checkClaimboardButtonDisabled()}hidePopoutWindowButton(){this.popoutWindowButton.hidden=!this.odataRequest||this.popoutWindowHidden}checkClaimboardButtonState(){this.claimboardButton.hidden=!this.claimboardEnabled||!this.odataRequest||!this.odataRequest.config||this.odataRequest.config.key!==this.configService.selectedCreateConfig}checkClaimboardButtonDisabled(){this.claimboardButton.isDisabled=this.claimboardDisabled||this.gridLoading||!this.enableActions}checkPinboardButtonDisabled(){this.pinboardButton.isDisabled=this.gridLoading||!this.enableActions}setupGridBoundSubject(){this.updateAvailableApisSubscription&&(this.updateGridBoundButtonsSubscription.unsubscribe(),this.updateGridBoundButtonsSubject.unsubscribe()),this.updateGridBoundButtonsSubject=new dt.a,this.updateGridBoundButtonsSubscription=this.updateGridBoundButtonsSubject.pipe(Object(d.a)(()=>{if(this.setHeaderLoading(!0),this.setlistEditLoading(!0),this.listEditSdaGridHeaderService.resetListEditDtoFeatures(),this.gridDataBoundEvent){const t=this.gridDataBoundEvent.sender.dataSource.data();if(t&&t.length){let e=Array.from(new Set(t.map(t=>t.Id?t.Id:t.OBID)));if(e=e.filter(t=>!!t),e.length){const t=[];if(this.checkListEditAvailability(t),t.length)return this.featureSetDataService.getFeatureSetsByObjectOBIDs(t,e,this.odataRequest.config.key)}}}return Object(r.a)(void 0)}),Object(vt.a)(t=>{const e=new f.a(t,void 0,"GridHeaderComponent","setupGridBoundSubject");return this.exceptionService.handleException(e),Object(r.a)(void 0)})).subscribe(t=>{if(t){const e=this.featureSetDataService.getFeaturesFromActionsMenus(t);this.enableListEditButton(e)}else this.listEditButton.hidden=!0;this.setlistEditLoading(!1),this.setHeaderLoading(!1),this.updateGridBoundButtonsSubject.observers.length||this.setupGridBoundSubject()})}checkListEditAvailability(t){this.enableListEdit&&this.listEditSdaGridHeaderService.isClientAPISupported()&&t.push(this.listEditSdaGridHeaderService.listEditClientAPI)}enableListEditButton(t){this.listEditButton.hidden=!this.listEditSdaGridHeaderService.enableListEditButton(t)}setupApisSubject(){this.updateAvailableApisSubscription&&(this.updateAvailableApisSubscription.unsubscribe(),this.updateAvailableApisSubject.unsubscribe()),this.updateAvailableApisSubject=new dt.a,this.updateAvailableApisSubscription=this.updateAvailableApisSubject.pipe(Object(d.a)(t=>{if(this.disableApiElements(),t&&t.length){const e=[];if(this.checkClaimboardAvailabliltyByConfigs(t,e),e.length){this.setHeaderLoading(!0);const i=t.map(t=>t.obid);return this.featureSetDataService.getFeatureSetsByObjectOBIDs(e,i,this.configService.selectedCreateConfig)}}return Object(r.a)(void 0)}),Object(vt.a)(t=>{const e=new f.a(t,void 0,"GridHeaderComponent","setupApisSubject");return this.exceptionService.handleException(e),Object(r.a)(void 0)})).subscribe(t=>{if(t&&t.length){const e=this.featureSetDataService.getFeaturesFromActionsMenus(t);this.enableClaimboardButton(e)}this.setHeaderLoading(!1),this.updateAvailableApisSubject.observers.length||this.setupApisSubject()})}disableApiElements(){this.setClaimboardDisabled(!0)}checkClaimboardAvailabliltyByConfigs(t,e){this.claimboardService.checkObjectClaimsButtonState(t)&&e.push("ClaimObj")}enableClaimboardButton(t){this.setClaimboardDisabled(!t.some(t=>"ClaimObj"===t.ClientAPI))}initialisePowerBar(){this.listEditButton=new It.a(()=>{this.showListEdit()},this.LIST_EDIT),this.listEditButton.hidden=!0,this.listEditButton.tooltip=this.LIST_EDIT_TOOLTIP,this.excelExportButton=new It.a(()=>{this.exportGridToExcel()},this.ACTIONS_BAR_EXPORT_TO_EXCEL),this.excelExportButton.hidden=this.exportExcelHidden,this.excelExportButton.tooltip=this.ACTIONS_BAR_EXPORT_TO_EXCEL,this.excelExportAllButton=new It.a(()=>{this.exportAllGridToExcel()},this.ACTIONS_BAR_EXPORT_ALL_TO_EXCEL),this.excelExportAllButton.hidden=this.exportAllToExcelHidden,this.excelExportAllButton.tooltip=this.ACTIONS_BAR_EXPORT_ALL_TO_EXCEL,this.createPinsGroupButton(),this.claimboardButton=new It.a(()=>{this.addItemsToClaimboard()},this.ACTIONS_MENU_ADD_CLAIMBOARD,void 0,void 0,wt.a.Default,!0),this.claimboardButton.hidden=!1,this.popoutWindowButton=new It.a(()=>{this.popOutWindow()},"","","external-link"),this.popoutWindowButton.hidden=this.popoutWindowHidden,this.popoutWindowButton.tooltip=this.ACTIONS_BAR_OPEN_IN_NEW_WINDOW,this.rightPowerBarControls.push(this.listEditButton,this.excelExportButton,this.excelExportAllButton,this.pinboardButton,this.claimboardButton,this.popoutWindowButton)}createPinsGroupButton(){this.defaultPinButton=new It.a(()=>{this.addItemsToPinboard(this.pinsMenuService.selectedPinGroupObid)},this.ACTIONS_BAR_ADD_TO_PINBOARD),this.defaultPinButton.uid=this.pinsMenuService.selectedPinGroupObid,this.defaultPinButton.tooltip=this.ACTIONS_BAR_ADD_TO_PINBOARD,this.defaultPinButton.isDefaultItem=!0,this.pinboardButton=new Bt.a([this.defaultPinButton]),this.pinboardButton.matIcon="pin",this.pinboardButton.defaultButtonId=this.selectedPinGroup,this.pinboardButton.hidden=this.addToPinboardHidden,this.newGroupButton=new It.a(()=>{this.createNewListModal()},this.NEW_LIST),this.newGroupButton.isDisabled=!0,this.newGroupButton.tooltip=this.PIN_TO_NEW_LIST_GRID_DISABLED,this.pinboardButton.bottomButton=this.newGroupButton}updatePinsGroupButton(t){this.updatePinGroups(t),this.setPinsGroupButton()}updatePinGroups(t){this.unfilteredPinGroups=t,this.pinGroups=this.pinsHelperService.filterPinGroupsBySpecificConfigs(t,this.gridConfig?[this.gridConfig]:[])}setPinsGroupButton(){const t=this.rightPowerBarControls.findIndex(t=>t===this.pinboardButton),e=[];if(this.pinGroups&&this.pinGroups.length){const t=this.pinGroups.find(t=>t.obid===this.selectedPinGroup);this.selectedPinGroup=t?t.obid:void 0,this.pinGroups.forEach(t=>{const i=new It.a(()=>{this.addItemsToPinboard(t.obid)},t.name,void 0,void 0,wt.a.Default,!1,void 0);i.configName=t.configName,i.uid=t.obid,i.tooltip=this.sdaTranslateService.getFormatted("PIN_TO","Pin to {0}",[t.name]),i.isDefaultItem=t.isOriginalPinboardGroup,e.push(i),t.selected&&!this.selectedPinGroup&&(this.selectedPinGroup=t.obid)}),this.selectedPinGroup=this.selectedPinGroup?this.selectedPinGroup:e[0].uid}else e.push(this.defaultPinButton),this.selectedPinGroup=void 0;if(this.pinboardButton.buttons=e,this.pinboardButton.defaultButtonId=this.selectedPinGroup,this.newGroupButton.isDisabled=this.gridConfig!==this.configService.selectedCreateConfig,this.newGroupButton.tooltip=this.newGroupButton.isDisabled?this.PIN_TO_NEW_LIST_GRID_DISABLED:this.PIN_TO_NEW_LIST,this.pinboardButton.bottomButton=this.newGroupButton,this.checkPinboardButtonDisabled(),t>-1){const e=[...this.rightPowerBarControls];this.rightPowerBarControls=[],this.changeDetectorRef.detectChanges(),e.splice(t,1,this.pinboardButton),this.rightPowerBarControls=e}}createNewListModal(){this.pinsHelperService.createNewListModal(this.actionMenuProvider.getItems().concat(),this.gridConfig).pipe(Object(c.a)(1)).subscribe(t=>{t&&(this.selectedPinGroup=t),this.setPinsGroupButton()})}exportGridToExcel(){this.onActionButtonClicked.emit(ft.ExportToExcel)}exportAllGridToExcel(){this.onActionButtonClicked.emit(ft.ExportAllToExcel)}addItemsToPinboard(t){this.selectedPinGroup=t,this.pinsMenuService.pinActionsMenuItemsToPinGroup(t,!0)}addItemsToClaimboard(){this.claimboardService.addActionsMenuItemsToClaimboard()}popOutWindow(){this.onPopOutWindowClicked.emit()}showListEdit(){this.listEditSdaGridHeaderService.navigateToListEdit(this.odataRequest)}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(C.a),o.Sb(T.a),o.Sb(_t.a),o.Sb(Tt.a),o.Sb(G.a),o.Sb(q.a),o.Sb(H.a),o.Sb(kt.a),o.Sb(xt.a),o.Sb(o.h))},t.\u0275cmp=o.Mb({type:t,selectors:[["sda-grid-header"]],viewQuery:function(t,e){var i;1&t&&o.bd(Mt,!0),2&t&&o.Gc(i=o.ic())&&(e.powerBar=i.first)},inputs:{grid:"grid",odataRequest:"odataRequest",gridDataBoundEvent:"gridDataBoundEvent",exportExcelHidden:"exportExcelHidden",exportAllToExcelHidden:"exportAllToExcelHidden",popoutWindowHidden:"popoutWindowHidden",addToPinboardHidden:"addToPinboardHidden",enableListEdit:"enableListEdit",gridLoading:"gridLoading",gridConfig:"gridConfig"},outputs:{onActionButtonClicked:"onActionButtonClicked",onPopOutWindowClicked:"onPopOutWindowClicked"},features:[o.Db([_t.a]),o.Cb],decls:2,vars:4,consts:[[1,"power-bar",3,"rightControls","background","isLoading","disableBar"],["powerBar",""]],template:function(t,e){1&t&&o.Tb(0,"sda-power-bar-view",0,1),2&t&&o.sc("rightControls",e.rightPowerBarControls)("background",e.backgroundStyle)("isLoading",e.isLoading)("disableBar",e.displayLoadingBlanket)},directives:[At.a],styles:["[_nghost-%COMP%]{position:relative;border-bottom:1px solid #d0d0d0}[_nghost-%COMP%]     .power-bar__overlay .overlay-panel--active{top:50px!important;right:0!important}[_nghost-%COMP%]     .power-bar__overlay .overlay-panel--active .powerbar-button-switch{width:100%}[_nghost-%COMP%]     .power-bar__overlay .overlay-panel--active .button{width:100%;background-color:#fff;border:none}[_nghost-%COMP%]     .power-bar__overlay .overlay-panel--active .button:hover{background-color:#ebedf0}[_nghost-%COMP%]     .power-bar .power-bar{padding:0 6px}"]}),t})();function yt(t,e){if(1&t){const t=o.Zb();o.Yb(0,"sda-grid-header",3),o.hc("onActionButtonClicked",(function(e){return o.Kc(t),o.lc().onActionButtonClicked(e)}))("onPopOutWindowClicked",(function(){return o.Kc(t),o.lc().onPopOutWindowClicked()})),o.Xb()}if(2&t){const t=o.lc();o.sc("odataRequest",t.odataRequest)("grid",t.grid)("exportExcelHidden",t.exportExcelHidden)("exportAllToExcelHidden",t.exportAllToExcelHidden)("enableListEdit",t.enableListEdit)("popoutWindowHidden",t.popoutWindowHidden)("addToPinboardHidden",t.addToPinboardHidden)("gridDataBoundEvent",t.gridDataBoundEvent)("gridLoading",t.isLoading)("gridConfig",t.headerConfig)}}let Rt=(()=>{class t{constructor(t,e,i,s,r,a,c,d,h,l,u,g,p,b,S,m,C,f,O,v,w,P,I,k){this.gridDataService=t,this.metaDataService=e,this.columnService=i,this.elementRef=s,this.componentFactoryResolver=r,this.router=a,this.filterService=c,this.dataRefreshService=d,this.actionMenuProvider=h,this.columnSetRepository=l,this.windowService=u,this.guidService=g,this.sdaTranslateService=p,this.changeDetection=b,this.gridExportService=S,this.location=m,this.route=C,this.defaultMethodService=f,this.objectItemsHelperService=O,this.dynamicLoaderService=v,this.oDataGridLoadingService=w,this.launchUrlWithDynamicArgsService=P,this.launchUrlService=I,this.gridShortcutService=k,this.configDataProperty="Config",this.enableSelection=!0,this.disableSelectAll=!1,this.showActions=!0,this.enableDetailsSelection=!0,this.freezeFirstColumn=!0,this.enablePaging=!0,this.exportAllToExcelHidden=!0,this.enableListEdit=!1,this.sortable=!0,this.filterable=!0,this.columnMenu=!0,this.showIcon=!0,this.autoResize=!0,this.expandableDetails=!1,this.objectModalView=!1,this.requiredAdditionalRowData=[],this.showActionsMenuButton=!0,this.showCustomColumnComponeAfterGridActionButtons=!1,this.enableRowSelection=!1,this.columnIndexToShowIcon=0,this.supportsShareUrl=!1,this.clickableURLs=!1,this.showShorcutsOnHover=!1,this.showShortcutsOnTablet=!1,this.actionMenuButtonClicked=new o.o,this.onPopOutWindowClickedWithParams=new o.o,this.onItemSelected=new o.o,this.selectAllChanged=new o.o,this.isLoading=!0,this.isPagerLoading=!0,this.nestedGridHierachy=[],this.hasActions=!1,this.gridInitialized=!1,this.hasWrapped=!1,this.IS_EQUAL_TO=this.sdaTranslateService.get("IS_EQUAL_TO","Is equal to"),this.masterPopulateGridSubscription=new n.a,this.itemSelected=()=>{(this.enableDetailsSelection||this.enableRowSelection)&&this.grid.select().each((t,e)=>{this.enableDetailsSelection?this.itemSelectedRow(e):this.enableRowSelection&&this.getSelectedRowData(e)})},this.resizeGrid=()=>{this.autoResize?this.columnService.resizeColumns(this.grid,this.actionButtons,this.hasActions,this.enableSelection,!!this.customColumnComponent,this.hasNestedGrid(),!!this.gridCustomColumnCellComponentUpdateFunction):this.columnService.resizeLockedColumns(this.grid,this.hasNestedGrid(),!!this.customColumnComponent,!!this.gridCustomColumnCellComponentUpdateFunction)},this.actionButtonClicked=new o.o}ngOnInit(){if(this.queryParamMapSubcription=this.route.queryParamMap.subscribe(t=>{t.has("selected")&&(this.highlightRowOBIDs=JSON.parse(t.get("selected")),this.gridInitialized&&this.highlightSelectedItems(this.highlightRowOBIDs))}),this.shortcutClickedSubscription=this.actionMenuProvider.shortcutClickedForItemSubject.subscribe(t=>this.updateUrl(t)),this.freezeFirstColumn&&this.nestedGridModel)throw new f.a("You cannot combine frozen columns with nested grids");if(this.hasActions=this.actionButtons&&this.actionButtons.length>0,this.gridOptions&&this.odataRequest)throw new f.a("You cannot set gridOptions and odataRequest on the same grid");if(!this.gridId){const t=this.getRequestConfig();this.gridId=t?A.a.encodeSpecialCharactersToUnicode(t)+this.guidService.getGuid():"sdaGrid"+this.guidService.getGuid()}this.triggerGridResize&&(this.gridResizeSubscription=this.triggerGridResize.subscribe(this.resizeGrid)),this.hilightSelectedRows&&(this.hilightSelectedRowsSubcription=this.hilightSelectedRows.subscribe(t=>this.highlightSelectedItems(t))),this.autoScrollToSelectedRow&&(this.autoScrollToSelectedRowSubscription=this.autoScrollToSelectedRow.subscribe(()=>{this.scrollToSelectedRow()})),this.windowService.Window.addEventListener("resize",this.resizeGrid)}ngOnChanges(t){if(t.gridOptions&&t.gridOptions.currentValue||t.odataRequest&&t.odataRequest.currentValue){if(this.grid)if(this.removeGrid(),this.grid=new kendo.ui.Grid($("#"+this.gridId)[0]),this.hasWrapped=!1,this.grid.resize=()=>{},this.gridInitialized=!1,this.odataRequest){const t=this.setGridOptionsFromRequest().subscribe();this.masterPopulateGridSubscription.add(t)}else this.gridOptions&&this.setupGridFromOptions();const t=this.getRequestConfig();this.headerConfig=t||this.configUID}}ngAfterViewInit(){if(this.gridLoading(),this.grid=new kendo.ui.Grid($("#"+this.gridId)[0]),this.hasWrapped=!1,this.grid.resize=()=>{},this.odataRequest){const t=this.setGridOptionsFromRequest().subscribe();this.masterPopulateGridSubscription.add(t)}else this.gridOptions&&(this.setupGridFromOptions(),this.gridLoaded());this.refreshGridsSubscription=this.dataRefreshService.refreshData$.subscribe(t=>{t&&!t.refreshResultsGrid||this.refresh()}),this.changeDetection.detectChanges()}ngOnDestroy(){this.masterPopulateGridSubscription&&this.masterPopulateGridSubscription.unsubscribe(),this.refreshGridsSubscription&&this.refreshGridsSubscription.unsubscribe(),this.gridResizeSubscription&&this.gridResizeSubscription.unsubscribe(),this.showActions&&this.actionMenuProvider.clearAndCloseActionsMenu(),this.shortcutClickedSubscription&&this.shortcutClickedSubscription.unsubscribe(),this.queryParamMapSubcription&&this.queryParamMapSubcription.unsubscribe(),this.hilightSelectedRowsSubcription&&this.hilightSelectedRowsSubcription.unsubscribe(),this.autoScrollToSelectedRowSubscription&&this.autoScrollToSelectedRowSubscription.unsubscribe(),this.mouseEnterSubscription&&this.mouseEnterSubscription.unsubscribe(),this.grid&&this.removeGrid(),this.windowService.Window.removeEventListener("resize",this.resizeGrid)}onActionButtonClicked(t){switch(String(t)){case ft.ExportToExcel.toString():this.saveToExcel();break;case ft.ExportAllToExcel.toString():this.exportAllToExcel(this.grid.dataSource.total())}}onPopOutWindowClicked(){const t=this.getRequestConfig();this.onPopOutWindowClickedWithParams.emit(t||"")}itemSelectedRow(t){const e=this.getSelectedRowIndex(t),i=this.getSelectedColumnIndex(t);this.clickableURLs&&this.detectURLClick(e,i);let o=0;if(this.enableSelection&&(o+=1),this.hasActions&&(o+=1),this.nestedGridModel&&(o+=2),this.columnIndexToShowIcon&&(o+=this.columnIndexToShowIcon),i===o){const t=this.grid.dataSource.data()[e];if(this.objectModalView){const e=this.getObjectFromRowData(t);this.onItemSelected.emit(e)}else this.odataRequest&&this.executeDefaultAction(t)}}detectURLClick(t,e){if(this.nestedGridModel&&(e-=1),this.columnSet&&this.columnSet.length>0&&this.columnSet[e]){const i=this.grid.dataSource.data()[t],o=this.getObjectFromRowData(i),n=this.columnSet[e];n&&this.columnSetProperties&&this.columnSetProperties[n.field]&&this.columnSetProperties[n.field].isURL&&i&&i[n.field]&&this.launchUrlWithDynamicArgsService.getDynamicLaunchURL(o.obid,i[n.field],o.config).pipe(Object(c.a)(1)).subscribe(t=>{this.launchUrlService.launchURL(t,!1,!1)})}}getSelectedRowData(t){const e=this.getSelectedRowIndex(t),i=this.getSelectedColumnIndex(t),o=this.grid.dataSource.data()[e],n=this.getObjectFromRowData(o);i>1&&(this.highlightSelectedItems([n.obid]),this.onItemSelected.emit(n))}scrollToSelectedRow(){const t=this.grid.tbody.offset().top,e=this.grid.select().offset().top-t;this.grid.wrapper.find(".k-grid-content").animate({scrollTop:e},100)}getSelectedRowIndex(t){let e;return this.retrieveParentRow($(t)).removeClass("selection-highlight"),$(t).removeClass("selection-highlight"),e=this.nestedGridModel?$(t).closest("tr.k-master-row").prevAll("tr.k-master-row").length:$(t).closest("tr").index(),e}getSelectedColumnIndex(t){let e,i=0;const o=$(t).closest("td").index();return this.grid.columns.forEach(t=>{t.locked&&i++}),e=this.isColumnUnderLockedTable(t)?o:o+i,e}isColumnUnderLockedTable(t){return!!$(t).closest(".k-grid-content-locked").length}getObjectFromRowData(t){return{obid:this.getItemId(t),name:t.NAME,config:this.getObjectConfig(t),data:this.getRequiredAdditionalRowData(t)}}executeDefaultAction(t){const e=this.getItemId(t);this.defaultMethodService.tryExecuteDefaultAction(e,this.getObjectConfig(t)).subscribe(i=>{if(!i){const i=this.filterService.createObjectFromAnotherOdataSettings(this.grid.dataSource,this.odataRequest),o=[this.getGridConfig(t)];this.actionMenuProvider.notifyShortcutClickedForItem([e]),this.router.navigate(["/objects",{queryFilter:JSON.stringify(i),config:JSON.stringify(o),fromGrid:!0},"detail",e])}})}exportAllToExcel(t){const e=this.getRequestConfig();this.gridExportService.exportAllToExcel(this.gridDataService.currentUrl,this.odataRequest?this.odataRequest:this.gridDataService.currentRequestObj,e||this.configUID,t)}refreshBrowserUrl(){this.dataChangeEvent&&this.dataChangeEvent(this.grid),this.isLoading&&this.actionMenuProvider.clearAndCloseActionsMenu()}setGridOptionsFromRequest(){return this.gridDataService.getDataSource(this.odataRequest).pipe(Object(d.a)(t=>Object(s.a)(Object(r.a)(t),this.getColumnSetProperties())),Object(d.a)(([t,e])=>Object(s.a)(Object(r.a)(t),this.setUpGridColumns(e))),Object(h.a)(([t,e])=>this.setGridOptions(t,e)),Object(l.a)(()=>!0))}getColumnSetProperties(){return this.odataRequest.columnSet?this.columnSetRepository.getColumnSetByUID(this.odataRequest.columnSet).pipe(Object(l.a)(t=>this.columnService.setupColumnProperties(t))):this.odataRequest.hasLink?this.columnSetRepository.getColumnSetByRel(this.odataRequest.navigation).pipe(Object(l.a)(t=>this.columnService.setupColumnProperties(t))):this.odataRequest.endInterface?this.columnSetRepository.getColumnSetByInterfaceDefUID(this.odataRequest.endInterface).pipe(Object(l.a)(t=>this.columnService.setupColumnProperties(t))):this.getColumnSetPropertiesForEntityType()}getColumnSetPropertiesForEntityType(){return this.metaDataService.getEntitySetByName(this.odataRequest.entityType).isOpenType?this.metaDataService.getObjectPropertiesByConfig(this.odataRequest.entityType,this.getRequestConfig()).pipe(Object(l.a)(t=>{let e=t;return e||(e=this.metaDataService.getObjectProperties(this.odataRequest.entityType)),e})):Object(r.a)(this.metaDataService.getObjectProperties(this.odataRequest.entityType))}setUpGridColumns(t){let e;return this.columnSetProperties=t,this.odataRequest.entityType&&(e=this.metaDataService.getEntitySetByName(this.odataRequest.entityType)),this.odataRequest.columnSet||this.odataRequest.hasLink||this.odataRequest.endInterface||e&&e.isOpenType?this.columnService.create(t,this.enableDetailsSelection,this.freezeFirstColumn,this.showIcon,!1,this.columnIndexToShowIcon,this.clickableURLs):this.columnService.create(t,this.enableDetailsSelection,this.freezeFirstColumn,void 0,void 0,void 0,this.clickableURLs)}setGridOptions(t,e){this.columnSet=e,this.setOptions(t),this.grid.setOptions(this.gridOptions),this.grid.getOptions().dataBound(void 0)}setOptions(e){this.columnSet=this.columnService.addAdditionalColumns(this.columnSet,this.actionButtons,this.hasActions,this.enableSelection,this.showCustomColumnComponeAfterGridActionButtons,this.customColumnComponent,this.showShortcutsOnTablet),this.gridOptions={scrollable:!0,dataSource:e,columns:this.columnSet,pageable:this.enablePaging?{input:!0,numeric:!1,refresh:!0}:void 0,excel:{fileName:"SDA Grid Export.xlsx"},change:this.itemSelected,selectable:"cell",sortable:this.sortable,filterable:!!this.filterable&&{operators:{nullableBoolean:{eq:this.IS_EQUAL_TO}}},columnMenu:{columns:this.columnMenu},resizable:!0,detailTemplate:this.nestedGridModel&&this.nestedGridModel.child?"":void 0,detailInit:e=>{setTimeout(()=>{const i=this.componentFactoryResolver.resolveComponentFactory(t),o=this.elementRef.createComponent(i);let n=e.data.Id;n||(n=e.data.OBID),o.instance.nestedGridModel=this.nestedGridModel.child,o.instance.odataRequest=o.instance.nestedGridModel.odataRequest,o.instance.nestedGridModel.createDynamicRequest(o.instance.odataRequest,e.data),o.instance.gridId="GRID_"+this.guidService.getGuid(),o.instance.showActions=this.showActions,o.instance.enableSelection=this.enableSelection,o.instance.enableDetailsSelection=this.nestedGridModel.child.enableDetailsSelection,o.instance.objectModalView=this.nestedGridModel.child.objectModalView,o.instance.showIcon=this.nestedGridModel.child.showIcon,o.instance.freezeFirstColumn=this.freezeFirstColumn,o.instance.nestedGridHierachy=this.nestedGridHierachy.concat([n]),o.instance.enablePaging=this.nestedGridModel.child.enablePaging,o.instance.sortable=this.nestedGridModel.child.enableSorting,o.instance.filterable=this.nestedGridModel.child.enableFiltering,o.instance.columnMenu=this.nestedGridModel.child.enableSorting,o.instance.onItemSelected=this.onItemSelected,o.instance.clickableURLs=this.clickableURLs,this.nestedGridModel.child&&(o.instance.customColumnComponent=this.nestedGridModel.child.customColumnComponent),e.detailCell.append(o.location.nativeElement)})},detailCollapse:t=>{t.detailRow.remove()}},this.setCommonGridOptions()}setupGridFromOptions(){this.columnSet=this.columnService.addAdditionalColumns(this.gridOptions.columns,this.actionButtons,this.hasActions,this.enableSelection,this.showCustomColumnComponeAfterGridActionButtons,this.customColumnComponent,this.showShortcutsOnTablet,this.expandableDetails),this.setCommonGridOptions(!0),this.grid.columns=this.columnSet,this.grid.setOptions(this.gridOptions),this.grid.getOptions().dataBound(void 0)}setCommonGridOptions(t){this.gridOptions.dataBound=e=>{if(e||t){if(this.gridInitialized?(this.refreshBrowserUrl(),this.refreshCustomHeader()):(this.addCustomHeader(),this.enableSelection&&this.isLoading&&this.addHeader(),this.gridInitialized=!0),this.addCustomCells(),this.enableSelection&&this.addCells(),this.hasActions&&this.actionButtons.forEach(t=>{const i=`#${this.gridId} ${".grid-actions__item--"+t.name}`;$(i).off("click"),$(i).on("click",t=>{const i=t.currentTarget.className.split(" ")[2],o=this.getInformationFromRow(t,e),n=new st(i,o,this.getGridConfig(o));this.actionButtonClicked.emit(n)})}),e&&(this.gridDataBoundEvent=e),this.showShorcutsOnHover){const t=`#${this.gridId} .k-grid-container tr`;this.mouseEnterSubscription=Object(a.a)($(t),"mouseenter").pipe(Object(u.a)((t,e)=>$(t.currentTarget).closest("tr").attr("data-uid")===$(e.currentTarget).closest("tr").attr("data-uid")),Object(g.a)(250)).subscribe(t=>{t.stopPropagation();const i=this.getInformationFromRow(t,e);this.gridShortcutService.updateHoveredRow(i)})}this.gridLoaded()}this.setupCustomGridHandlers(),this.resizeGrid()},this.gridOptions.page=()=>{this.gridLoading()},this.gridOptions.sort=()=>{this.gridLoading()},this.gridOptions.filter=()=>{this.gridLoading()},this.gridOptions.columnShow=()=>{this.resizeGrid()},this.gridOptions.columnMenuInit=t=>{this.selectedColumnHeader=t},this.gridOptions.change=t=>{this.itemSelected()},this.gridOptions.columnHide=t=>{this.resizeGrid(),this.selectedColumnHeader&&this.selectedColumnHeader.field===t.column.field&&$(".k-animation-container").css("display","none")}}setupCustomGridHandlers(){const t=$("tr[data-uid]",this.grid.element);t.off("mouseover"),t.on("mouseover",t=>{const e=$(`tr[data-uid='${$(t.currentTarget).attr("data-uid")}']`);e.addClass("hover"),this.showShorcutsOnHover&&(this.gridShortcutService.manageElementClasses(e,!0),$(document).keyup(t=>{27===t.keyCode&&this.gridShortcutService.manageElementClasses(e,!1)}))}),t.off("mouseout"),t.on("mouseout",t=>{const e=$(`tr[data-uid='${$(t.currentTarget).attr("data-uid")}']`);e.removeClass("hover"),this.showShorcutsOnHover&&this.gridShortcutService.manageElementClasses(e,!1)}),this.hasWrapped||($(".k-grid-content-locked, .k-grid-content",this.grid.element).wrapAll('<div class="k-grid-container" />'),this.hasWrapped=!0)}getInformationFromRow(t,e){const i=$(t.target).closest("tr")[0].rowIndex,o=e.sender.dataSource.data()[i],n={Id:o.Id?o.Id:o.OBID,UID:o.UID};for(let s=0;s<this.columnSet.length;s++){const t=this.columnSet[s];t.field&&o.hasOwnProperty(t.field)&&(n[t.field]=o[t.field])}return this.requiredAdditionalRowData.length>0&&this.requiredAdditionalRowData.forEach(t=>{o[t]&&(n[t]=o[t])}),!n.hasOwnProperty(this.configDataProperty)&&o.hasOwnProperty(this.configDataProperty)&&(n[this.configDataProperty]=o[this.configDataProperty]),n}addHeader(){let t,e=this.grid.wrapper.find(".k-grid-header-locked");0===e.length?(e=this.grid.wrapper.find(".k-grid-header"),t=this.hasNestedGrid()?e.find("th").eq(1):e.find("th").eq(0)):t=e.find("th").eq(0),setTimeout(()=>{const e=this.componentFactoryResolver.resolveComponentFactory(Ct),i=this.elementRef.createComponent(e);i.instance.grid=this.grid,i.instance.odataRequest=this.odataRequest,i.instance.hideSelectAll=this.disableSelectAll,i.instance.selectAllClicked=()=>{this.selectAllChanged.emit()},t.append(i.location.nativeElement)})}addCells(){const t=this.grid.tbody.children(),e=this.grid.wrapper.find(".grid-action-menu-column");$.each(e,(e,i)=>{this.addCellsToRow(jQuery(t[e]),jQuery(i))})}addCellsToRow(t,e){const i=this.grid.dataItem(t),o=this.getItemId(i);setTimeout(()=>{let n=!1;const s=i.DynWorkflowItemOBID;this.highlightRowOBIDs&&this.highlightRowOBIDs.find(t=>o===t||s&&s===t)&&(this.toggleRowHighlight(t,"selection-highlight"),n=!0);const r=this.componentFactoryResolver.resolveComponentFactory(St),a=this.elementRef.createComponent(r);a.instance.showActionsMenuButton=this.showActionsMenuButton,a.instance.showShortcutsButton=this.showShortcutsOnTablet;const c={};for(const t in i)i.hasOwnProperty(t)&&(c[t]=i[t]);c.supportsShareUrl=this.supportsShareUrl.toString();const d=new B.a(o,i.Name,this.getObjectConfig(i),i.Description||i.CI_Description,i.Class,c,this.getGridConfig(i));a.instance.setObject(d,n),this.actionMenuButtonClicked.observers&&this.actionMenuButtonClicked.observers.length>0&&(a.instance.actionMenuButtonClicked=()=>{this.actionMenuButtonClicked.emit()}),this.showShorcutsOnHover&&this.addShortcutsOverlayRow(t,d),e.append(a.location.nativeElement)})}addShortcutsOverlayRow(t,e){const i=this.componentFactoryResolver.resolveComponentFactory(et),o=this.elementRef.createComponent(i);o.instance.setObject(e),t.append(o.location.nativeElement)}refreshCustomHeader(){this.customColumnHeaderComponentInstance&&(this.customColumnHeaderComponentInstance.hasOwnProperty("data")&&(this.customColumnHeaderComponentInstance.data=this.grid.dataSource.data()),this.customColumnHeaderComponentInstance.hasOwnProperty("dataUrl")&&(this.customColumnHeaderComponentInstance.dataUrl=this.gridDataService.currentUrl.substring(0)),this.customColumnHeaderComponentInstance.hasOwnProperty("dataTotal")&&(this.customColumnHeaderComponentInstance.dataTotal=this.grid.dataSource.total()))}addCustomHeader(){if(this.customColumnComponent&&this.customColumnComponent.headerComponent){const t=this.grid.wrapper.find(".grid-custom-header");setTimeout(()=>{const e=this.componentFactoryResolver.resolveComponentFactory(this.customColumnComponent.headerComponent),i=this.elementRef.createComponent(e);i.instance.hasOwnProperty("nestedGridHierachy")&&(i.instance.nestedGridHierachy=this.nestedGridHierachy),this.grid.dataSource&&(i.instance.hasOwnProperty("dataUrl")&&(i.instance.dataUrl=this.gridDataService.currentUrl.substring(0)),i.instance.hasOwnProperty("dataTotal")&&(i.instance.dataTotal=this.grid.dataSource.total()),i.instance.hasOwnProperty("data")&&(i.instance.data=this.grid.dataSource.data()),this.customColumnHeaderComponentInstance=i.instance),t.prepend(i.location.nativeElement)})}}addCustomCells(){if(this.customColumnComponent&&this.customColumnComponent.cellComponent){const t=this.grid.tbody.children(),e=this.grid.wrapper.find(".grid-custom-column");$.each(e,(e,i)=>{const o=jQuery(t[e]),n=jQuery(i),s=this.grid.dataItem(o),r=this.componentFactoryResolver.resolveComponentFactory(this.customColumnComponent.cellComponent),a=this.elementRef.createComponent(r);a.instance.hasOwnProperty("dataItem")&&(a.instance.dataItem=s),a.instance.hasOwnProperty("config")&&(a.instance.config=this.getGridConfig(s)),a.instance.hasOwnProperty("nestedGridHierachy")&&(a.instance.nestedGridHierachy=this.nestedGridHierachy),this.gridCustomColumnCellComponentUpdateFunction&&"function"==typeof a.instance[this.gridCustomColumnCellComponentUpdateFunction]&&a.instance[this.gridCustomColumnCellComponentUpdateFunction](),n.append(a.location.nativeElement)})}}refresh(){this.gridLoading(),this.odataRequest&&this.odataRequest.expandFromObjectId?this.objectItemsHelperService.doesObjectExist(this.odataRequest.expandFromObjectId,this.getRequestConfig()).subscribe(t=>{t?this.grid.dataSource.read():this.grid.dataSource.data([])}):this.grid.dataSource.read(),this.actionMenuProvider.clearItems()}hasNestedGrid(){return!!this.nestedGridModel&&!!this.nestedGridModel.child}resetSelectallButton(){this.actionMenuProvider.clearMultiSelectedItemHighlights()}getGridConfig(t){let e=this.getRequestConfig();return e||(e=this.getConfigFromDataItem(t)),e}getObjectConfig(t){let e=this.getConfigFromDataItem(t);return e||(e=this.getRequestConfig()),e}getRequiredAdditionalRowData(t){const e={};return this.requiredAdditionalRowData.forEach(i=>{e[i]=t[i]}),e}getRequestConfig(){return this.odataRequest&&this.odataRequest.config?this.odataRequest.config.key:void 0}getConfigFromDataItem(t){return t[this.configDataProperty]?t[this.configDataProperty]:this.configUID}toggleRowHighlight(t,e="selected",i=!1){const o=this.retrieveParentRow(t);t.hasClass(e)&&o.hasClass(e)&&!i?(o.removeClass(e),t.removeClass(e)):(o.addClass(e),t.addClass(e))}retrieveParentRow(t){return $(`tr[data-uid='${$(t).closest("[data-uid]").attr("data-uid")}']`,this.grid.element)}getItemId(t){let e=t.Id;return e||(e=t.OBID),e||(e=t["SDA-GUID"]),e}highlightSelectedItems(t){if(this.grid&&this.grid.tbody){const e=this.grid.tbody.children(),i=this.grid.wrapper.find(".grid-action-menu-column");$.each(i,(i,o)=>{const n=jQuery(e[i]),s=this.grid.dataItem(n),r=this.getItemId(s),a=s.DynWorkflowItemOBID,c=this.retrieveParentRow(n);t&&t.find(t=>r===t||a&&a===t)?(c.addClass("selection-highlight"),n.addClass("selection-highlight")):(c.removeClass("selection-highlight"),n.removeClass("selection-highlight"))})}}updateUrl(t){this.highlightSelectedItems(t);const e=this.router.parseUrl(location.hash.substring(1));e.queryParams.selected=t?JSON.stringify(t):JSON.stringify([]),this.location.replaceState(e.toString())}removeGrid(){const t=$("#"+this.gridId);kendo.destroy(t),t.empty()}saveToExcel(){this.dynamicLoaderService.lazyLoadGlobalScript("./content/scripts/jszip.min.js").subscribe(()=>{this.grid.columns.map((t,e)=>{t.width=0===e?"100px":(t.field.length+100).toString()+"px"}),this.grid.saveAsExcel()})}gridLoading(){this.isLoading=!0,this.isPagerLoading=!0,this.oDataGridLoadingService.isODataGridLoading.next(!0),this.oDataGridLoadingService.isODataGridPagerLoading.next(!0),this.resetSelectallButton()}gridLoaded(){this.resizeGrid(),$(`#${this.gridId} .k-pager-refresh`).on("click",t=>{this.gridLoading()}),this.isPagerLoading&&this.odataRequest&&($(`#${this.gridId} .k-pager-wrap`).addClass("pager-loading"),this.oDataGridLoadingService.isODataGridPagerLoading.pipe(Object(p.a)(()=>this.isPagerLoading)).subscribe(t=>{this.isPagerLoading=t,$(`#${this.gridId} .k-pager-wrap`).removeClass("pager-loading")})),this.isLoading=!1,this.oDataGridLoadingService.isODataGridLoading.next(!1)}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(at.a),o.Sb(k.a),o.Sb(nt.a),o.Sb(o.Q),o.Sb(o.j),o.Sb(Ot.g),o.Sb(x.a),o.Sb(O.a),o.Sb(C.a),o.Sb(it.a),o.Sb(v.a),o.Sb(I.a),o.Sb(T.a),o.Sb(o.h),o.Sb(rt.a),o.Sb(W.n),o.Sb(Ot.a),o.Sb(w.a),o.Sb(_.a),o.Sb(P.a),o.Sb(m.a),o.Sb(b.a),o.Sb(S.a),o.Sb(F.a))},t.\u0275cmp=o.Mb({type:t,selectors:[["sda-kendo-grid"]],inputs:{gridOptions:"gridOptions",dataChangeEvent:"dataChangeEvent",odataRequest:"odataRequest",actionButtons:"actionButtons",configDataProperty:"configDataProperty",configUID:"configUID",triggerGridResize:"triggerGridResize",enableSelection:"enableSelection",disableSelectAll:"disableSelectAll",showActions:"showActions",enableDetailsSelection:"enableDetailsSelection",customColumnComponent:"customColumnComponent",freezeFirstColumn:"freezeFirstColumn",enablePaging:"enablePaging",gridId:"gridId",exportExcelHidden:"exportExcelHidden",exportAllToExcelHidden:"exportAllToExcelHidden",enableListEdit:"enableListEdit",popoutWindowHidden:"popoutWindowHidden",addToPinboardHidden:"addToPinboardHidden",nestedGridModel:"nestedGridModel",sortable:"sortable",filterable:"filterable",columnMenu:"columnMenu",showIcon:"showIcon",autoResize:"autoResize",expandableDetails:"expandableDetails",objectModalView:"objectModalView",requiredAdditionalRowData:"requiredAdditionalRowData",showActionsMenuButton:"showActionsMenuButton",showCustomColumnComponeAfterGridActionButtons:"showCustomColumnComponeAfterGridActionButtons",gridCustomColumnCellComponentUpdateFunction:"gridCustomColumnCellComponentUpdateFunction",enableRowSelection:"enableRowSelection",hilightSelectedRows:"hilightSelectedRows",autoScrollToSelectedRow:"autoScrollToSelectedRow",columnIndexToShowIcon:"columnIndexToShowIcon",supportsShareUrl:"supportsShareUrl",columnSetProperties:"columnSetProperties",clickableURLs:"clickableURLs",showShorcutsOnHover:"showShorcutsOnHover",showShortcutsOnTablet:"showShortcutsOnTablet"},outputs:{actionButtonClicked:"actionButtonClicked",actionMenuButtonClicked:"actionMenuButtonClicked",onPopOutWindowClickedWithParams:"onPopOutWindowClickedWithParams",onItemSelected:"onItemSelected",selectAllChanged:"selectAllChanged"},features:[o.Db([x.a,ot.a,at.a]),o.Cb],decls:3,vars:2,consts:[["show-Count","true",3,"odataRequest","grid","exportExcelHidden","exportAllToExcelHidden","enableListEdit","popoutWindowHidden","addToPinboardHidden","gridDataBoundEvent","gridLoading","gridConfig","onActionButtonClicked","onPopOutWindowClicked",4,"ngIf"],[1,"grid-body"],[3,"id"],["show-Count","true",3,"odataRequest","grid","exportExcelHidden","exportAllToExcelHidden","enableListEdit","popoutWindowHidden","addToPinboardHidden","gridDataBoundEvent","gridLoading","gridConfig","onActionButtonClicked","onPopOutWindowClicked"]],template:function(t,e){1&t&&(o.Sc(0,yt,1,10,"sda-grid-header",0),o.Yb(1,"div",1),o.Tb(2,"div",2),o.Xb()),2&t&&(o.sc("ngIf",e.showActions),o.Eb(2),o.sc("id",e.gridId))},directives:[W.t,Et],styles:['[_nghost-%COMP%]     .k-grid .grid-object__name, [_nghost-%COMP%]     .k-grid tr td{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}[_nghost-%COMP%]     .k-grid tr:not(.k-detail-row), [_nghost-%COMP%]     .k-grid tr td{height:40px!important}@media screen and (min-width:59.375em){[_nghost-%COMP%]     .k-grid tr:not(.k-detail-row), [_nghost-%COMP%]     .k-grid tr td{height:29px!important}}[_nghost-%COMP%], [_nghost-%COMP%]     .k-grid tr.k-detail-row .sda-kendo-grid-container{display:flex;flex:1;flex-direction:column;overflow:hidden}.grid-body[_ngcontent-%COMP%]{display:flex;flex:1;height:100%;min-height:0}[_nghost-%COMP%]{position:relative}[_nghost-%COMP%]     .k-grid{display:flex;flex:1 1 auto;flex-direction:column;width:100%;font-size:14px;border:none}[_nghost-%COMP%]     .k-grid .k-grid-header{display:flex;height:35px}[_nghost-%COMP%]     .k-grid .k-grid-header-locked{flex-grow:0;flex-shrink:0;border:none}[_nghost-%COMP%]     .k-grid .k-grid-header-locked th.k-header{border-right:none}[_nghost-%COMP%]     .k-grid .k-grid-header-locked+.k-grid-header-wrap{border-left:1px solid #c9c9c9}[_nghost-%COMP%]     .k-grid .k-grid-header-wrap{width:auto!important;border:none}[_nghost-%COMP%]     .k-grid .k-grid-header-wrap .k-header{border-color:#c9c9c9}[_nghost-%COMP%]     .k-grid .k-grid-header th.k-header{position:relative;vertical-align:middle;height:35px;padding:0;background:#f5f5f5;font-size:16px;font-weight:500;border-width:0 1px 0 0;border-right-color:#d0d0d0}[_nghost-%COMP%]     .k-grid .k-grid-header th.k-header .k-header-column-menu{display:inline-flex;align-items:center;justify-content:center;width:15px;height:36px;margin:0;padding:0}[_nghost-%COMP%]     .k-grid .k-grid-header th.k-header .k-header-column-menu.k-state-active{width:30px;background:transparent}[_nghost-%COMP%]     .k-grid .k-grid-header th.k-header .k-header-column-menu.k-state-active:before{content:"\\f0b0";display:inline-flex;align-items:center;justify-content:center;width:15px;height:36px;font:normal normal normal 14px/1 FontAwesome;color:rgba(0,0,0,.5)}[_nghost-%COMP%]     .k-grid .k-grid-header th.k-header .k-header-column-menu .k-icon{height:36px}[_nghost-%COMP%]     .k-grid .k-grid-header th.k-header .k-header-column-menu .k-i-arrowhead-s{background-position:0 -160px}[_nghost-%COMP%]     .k-grid .k-grid-header th.k-header>.k-link .k-icon{position:absolute;margin-top:1px;margin-left:10px}[_nghost-%COMP%]     .k-grid .k-grid-header th.k-header .k-link{margin:8px 0 0 6px!important;padding:0!important;line-height:21px!important}[_nghost-%COMP%]     .k-grid .k-grid-header th.k-header__empty-col{background-color:#f2f2f2;border:none}[_nghost-%COMP%]     .k-grid .k-grid-header th.k-header:nth-last-child(2){padding-right:12px}[_nghost-%COMP%]     .k-grid .k-grid-header .grid-custom-header{padding:0 8px!important}[_nghost-%COMP%]     .k-grid .k-grid-container{display:flex;flex:1;justify-content:space-between;min-height:0}[_nghost-%COMP%]     .k-grid .k-grid-container .k-grid-content-locked{flex-grow:0;flex-shrink:0;height:100%!important;border:none}[_nghost-%COMP%]     .k-grid .k-grid-container .k-grid-content-locked table{padding-bottom:100%}[_nghost-%COMP%]     .k-grid .k-grid-container .k-grid-content-locked+.k-grid-content{border-left:1px solid #c9c9c9}[_nghost-%COMP%]     .k-grid .k-grid-container .k-grid-content-locked td{border:none}[_nghost-%COMP%]     .k-grid .k-grid-container .k-grid-content{flex-grow:1;width:auto!important;overflow:scroll}[_nghost-%COMP%]     .k-grid .k-grid-container .k-grid-content__empty-col{background-color:#fff;border:none}[_nghost-%COMP%]     .k-grid .k-grid-container .k-grid-content .k-grid-content{overflow-x:auto}[_nghost-%COMP%]     .k-grid .k-pager-wrap{flex:0 0 auto;height:35px;min-height:0;padding:5px 0 0;background-color:#ebedf0}[_nghost-%COMP%]     .k-grid .k-pager-wrap .k-pager-input .k-textbox{display:inline-block;width:60px!important;margin:0 10px}[_nghost-%COMP%]     .k-grid .k-pager-wrap.pager-loading{transition:opacity .1s ease-in-out;opacity:.2;pointer-events:none}[_nghost-%COMP%]     .k-grid tr{box-sizing:initial;padding-top:0!important;padding-bottom:0!important}[_nghost-%COMP%]     .k-grid tr.k-alt{background-color:rgba(0,0,0,.04)}[_nghost-%COMP%]     .k-grid tr.hover{background-color:#afe5ff;-webkit-animation:none;animation:none}[_nghost-%COMP%]     .k-grid tr.shortcuts{-webkit-transform:scale(1);transform:scale(1)}[_nghost-%COMP%]     .k-grid tr.shortcuts sda-grid-shortcuts{display:block}[_nghost-%COMP%]     .k-grid tr.k-detail-row{height:auto;background:#fff}[_nghost-%COMP%]     .k-grid tr.k-detail-row .k-detail-cell{background-color:#f5f5f5;padding:0}[_nghost-%COMP%]     .k-grid tr.k-detail-row .sda-kendo-grid-container .k-master-row.hover>td, [_nghost-%COMP%]     .k-grid tr.k-detail-row .sda-kendo-grid-container .sda-kendo-grid-container tr.hover>td{background-color:#afe5ff!important}[_nghost-%COMP%]     .k-grid tr td{box-sizing:initial;padding:0 8px;border-right:1px solid rgba(0,0,0,.08)}[_nghost-%COMP%]     .k-grid tr td.grid-action-menu-column{position:relative;width:60px!important;min-width:60px!important;max-width:60px!important;height:29px;min-height:29px;padding:0}[_nghost-%COMP%]     .k-grid tr td.grid-action-btn-column .grid-actions{display:flex;flex-shrink:0;flex-flow:row nowrap}[_nghost-%COMP%]     .k-grid tr td.grid-action-btn-column .grid-actions__item{box-sizing:border-box;display:flex;flex:0 0 auto;align-items:center;justify-content:center;width:29px;height:28px;margin:0;cursor:pointer}[_nghost-%COMP%]     .k-grid tr td.grid-action-btn-column .grid-actions__item__icon{box-sizing:border-box;width:100%;max-width:17px}[_nghost-%COMP%]     .k-grid tr td.linked-data-item{text-decoration:underline;color:#02adff;cursor:pointer}[_nghost-%COMP%]     .k-grid tr.selection-highlight>td{background-color:#0fb1ff;color:#fff}[_nghost-%COMP%]     .k-grid .grid-object{display:flex;align-content:center;flex-direction:row}[_nghost-%COMP%]     .k-grid .grid-object__icon{box-sizing:border-box;flex-shrink:0;width:24px;height:24px;margin-right:5px}[_nghost-%COMP%]     .k-grid .grid-object__name{flex:1}[_nghost-%COMP%]     .k-grid .k-state-selected{background-color:initial}[_nghost-%COMP%]     .k-grid .k-grid-content col:nth-last-of-type(2), [_nghost-%COMP%]     .k-grid .k-grid-header-wrap col:nth-last-of-type(2){width:200px!important}[_nghost-%COMP%]     .k-grid .k-grid-content col:last-of-type, [_nghost-%COMP%]     .k-grid .k-grid-header-wrap col:last-of-type{width:auto!important}[_nghost-%COMP%]     .k-grid .k-auto-scrollable>table[role] tbody{height:100%!important}[_nghost-%COMP%]     .k-grid .k-auto-scrollable>table[role] tbody:empty{display:block;height:1px}[_nghost-%COMP%]     .k-grid .k-grid-content__empty-col{box-sizing:border-box!important;width:auto!important;padding:0!important;pointer-events:none!important}[_nghost-%COMP%]     .k-grid .k-grid, [_nghost-%COMP%]     .k-grid .sda-kendo-grid-container, [_nghost-%COMP%]     .k-grid sda-kendo-grid{display:block}[_nghost-%COMP%]     .k-grid .action-column-header .action-button-container{color:#000!important}[_nghost-%COMP%]     .k-treeview-lines .k-minus{display:none}']}),t})()}}]);