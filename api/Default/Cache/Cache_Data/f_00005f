(window.webpackJsonp=window.webpackJsonp||[]).push([[204],{"+T9e":function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n=i("mrSG"),s=i("IzEk"),a=i("ONOH"),o=i("Z9D8"),c=i("LUpO"),r=i("PoZZ"),l=i("d74k"),h=i("Ejbi"),d=i("W5cs"),g=i("gBNM"),u=i("UVhF"),b=i("zewe"),p=i("fXoL"),f=i("ofXK"),v=i("TLn4"),m=i("qx4N"),T=i("+qkj");function S(e,t){if(1&e&&p.Tb(0,"sda-loading-indicator",3),2&e){const e=p.lc();p.sc("message",e.OBJECT_DETAILS_LOADING)("centered",!0)}}function _(e,t){if(1&e&&(p.Yb(0,"div",4),p.Tb(1,"sda-form-controls",5),p.Xb()),2&e){const e=p.lc();p.Ib("object-details--fixed-height",e.relatedItemTabs.length>0),p.Eb(1),p.sc("form",e.form)("isEditable",!1)}}function E(e,t){if(1&e&&p.Tb(0,"sda-related-items-section",6),2&e){const e=p.lc();p.sc("tabs",e.relatedItemTabs)}}let w=(()=>{class e{constructor(e,t,i,n,s,a,o){this.formService=e,this.exceptionService=t,this.filterService=i,this.objectDetailsService=n,this.sdaTranslateService=s,this.changeDetection=a,this.configService=o,this.relatedItemTabs=[],this.initialized=!1,this.OBJECT_DETAILS_LOADING=this.sdaTranslateService.get("OBJECT_DETAILS_LOADING","Loading object details, please wait..."),this.OBJECT_DETAILS_ERROR=this.sdaTranslateService.get("INITIALISATION_ERROR","An error occurred whilst initializing"),this.showTodoListForm=!1}ngOnChanges(){this.getFormSubscription&&this.getFormSubscription.unsubscribe(),this.buildForm()}ngOnDestroy(){this.getFormSubscription&&this.getFormSubscription.unsubscribe()}buildForm(){try{this.id&&this.config&&(this.initialized=!1,this.getFormSubscription=this.formService.getForm(this.id,this.config,this.methodOBID,this.showTodoListForm).pipe(Object(s.a)(1)).subscribe(e=>{this.relatedItemTabs=[];const t=this.formService.filterDisplayItemsByDisplayType(e,"RelationshipMaintenance"),{filteredItems:i=[]}=t,s=Object(n.a)(t,["filteredItems"]);this.form=s,this.generateGridTabs(i),this.initialized=!0,this.changeDetection.detectChanges()}))}catch(e){const t=new o.a(e,this.OBJECT_DETAILS_ERROR,"ObjectDetailsComponent","buildForm");this.exceptionService.handleException(t)}}generateGridTabs(e){e.forEach(e=>{const t=e.navigation?new g.a(e.name,`Objects('${e.obid}')/${e.navigation}?$count=true`,this.config,void 0,e.obid,e.navigation):new g.a(e.name,void 0,this.config);t.isRowSelectable=!0,t.config=this.config,t.onCellClicked=e=>this.routeToDetailsView(e),this.relatedItemTabs.push(t)})}routeToDetailsView(e){this.objectDetailsService.showObjectDetailsForm(this.filterService.createLinkOdataQueryFilter(this.getDataSource(e),e.parentTab.parentOBID,e.parentTab.parentRelDef,void 0),e.object.OBID,this.configService.selectedQueryConfigs,e.parentTab.columnSetUID)}getDataSource(e){const t=new kendo.data.DataSource,i=new d.a,n=[new l.a(e.parentTab.state.sort[0].field,e.parentTab.state.sort[0].dir)];return t.filter(i),t.page=()=>e.parentTab.currentPageNumber,t.sort=()=>n,t}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(u.a),p.Sb(c.a),p.Sb(r.a),p.Sb(b.a),p.Sb(h.a),p.Sb(p.h),p.Sb(a.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["sda-object-details"]],inputs:{id:"id",config:"config",methodOBID:"methodOBID",showTodoListForm:"showTodoListForm"},features:[p.Cb],decls:3,vars:3,consts:[[3,"message","centered",4,"ngIf"],["class","object-details",3,"object-details--fixed-height",4,"ngIf"],[3,"tabs",4,"ngIf"],[3,"message","centered"],[1,"object-details"],[3,"form","isEditable"],[3,"tabs"]],template:function(e,t){1&e&&(p.Sc(0,S,1,2,"sda-loading-indicator",0),p.Sc(1,_,2,4,"div",1),p.Sc(2,E,1,1,"sda-related-items-section",2)),2&e&&(p.sc("ngIf",!t.initialized),p.Eb(1),p.sc("ngIf",t.initialized),p.Eb(1),p.sc("ngIf",t.initialized&&t.relatedItemTabs.length>0))},directives:[f.t,v.a,m.a,T.a],styles:[".object-details[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]{display:flex;flex:1;flex-direction:column;height:100%}.object-details[_ngcontent-%COMP%]{display:flex;flex:1 1 100%;flex-direction:column;border-bottom:1px solid #cad0d7}"]}),e})()},"+qkj":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("Ejbi"),s=i("fXoL"),a=i("7EHt"),o=i("HXFx");let c=(()=>{class e{constructor(e){this.sdaTranslateService=e,this.FORM_RELATED_ITEMS=this.sdaTranslateService.get("FORM_RELATED_ITEMS","Related Items")}}return e.\u0275fac=function(t){return new(t||e)(s.Sb(n.a))},e.\u0275cmp=s.Mb({type:e,selectors:[["sda-related-items-section"]],inputs:{tabs:"tabs"},decls:6,vars:5,consts:[["displayMode","flat"],[1,"related-items-panel",3,"expanded"],["collapsedHeight","38px","expandedHeight","38px"],[3,"tabs","openInfoMapInNewTab","showItemCount"]],template:function(e,t){1&e&&(s.Yb(0,"mat-accordion",0),s.Yb(1,"mat-expansion-panel",1),s.Yb(2,"mat-expansion-panel-header",2),s.Yb(3,"mat-panel-title"),s.Uc(4),s.Xb(),s.Xb(),s.Tb(5,"sda-tabbed-grid-view",3),s.Xb(),s.Xb()),2&e&&(s.Eb(1),s.sc("expanded",!0),s.Eb(3),s.Wc(" ",t.FORM_RELATED_ITEMS," "),s.Eb(1),s.sc("tabs",t.tabs)("openInfoMapInNewTab",!0)("showItemCount",!0))},directives:[a.a,a.c,a.g,a.h,o.a],styles:[".related-items-panel[_ngcontent-%COMP%]{border-radius:0!important;box-shadow:none!important}.related-items-panel.mat-expanded[_ngcontent-%COMP%]{overflow:visible;-webkit-animation:delay-overflow 1s;animation:delay-overflow 1s}.related-items-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{background-color:#ebedf0!important}.related-items-panel[_ngcontent-%COMP%]     .mat-expansion-panel-body{padding:0}.related-items-panel[_ngcontent-%COMP%]     sda-tabbed-grid-view{flex:none;height:auto}.related-items-panel[_ngcontent-%COMP%]     sda-tabbed-grid-view mat-tab-group{height:40vh;min-height:250px;border-top:1px solid #cad0d7}"]}),e})()},"3aMR":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("ofXK"),s=i("NFeN"),a=i("F+hv"),o=i("mQCr"),c=i("69YF"),r=i("fXoL");let l=(()=>{class e{}return e.\u0275mod=r.Qb({type:e}),e.\u0275inj=r.Pb({factory:function(t){return new(t||e)},imports:[[n.c,a.a,s.b,o.a,c.a]]}),e})()},GW71:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("R0Ic"),s=i("fXoL"),a=i("WPJx"),o=i("ofXK"),c=i("qKxU");function r(e,t){if(1&e){const e=s.Zb();s.Yb(0,"uxt-icon-button",12),s.hc("click",(function(){return s.Kc(e),s.lc().handleSubmit()})),s.Xb()}}function l(e,t){if(1&e){const e=s.Zb();s.Yb(0,"uxt-icon-button",13),s.hc("click",(function(){return s.Kc(e),s.lc().handleCancel()})),s.Xb()}}function h(e,t){if(1&e){const e=s.Zb();s.Yb(0,"button",14),s.hc("click",(function(){return s.Kc(e),s.lc().handleSubmit()})),s.Uc(1),s.Xb()}if(2&e){const e=s.lc();s.Eb(1),s.Wc(" ",e.submitText," ")}}function d(e,t){if(1&e){const e=s.Zb();s.Yb(0,"button",15),s.hc("click",(function(){return s.Kc(e),s.lc().handleCancel()})),s.Uc(1),s.Xb()}if(2&e){const e=s.lc();s.Eb(1),s.Wc(" ",e.cancelText," ")}}const g=["*"];let u=(()=>{class e{constructor(){this.cancelText="Cancel",this.showCancelButton=!0,this.submitText="Ok",this.enableSubmitButton=!0,this.cancel=new s.o,this.submit=new s.o,this.className=!0}get isOpenClass(){return this.isOpen}handleCancel(){this.cancel.emit()}handleSubmit(){this.submit.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Mb({type:e,selectors:[["uxt-modal"]],hostVars:4,hostBindings:function(e,t){2&e&&s.Ib("uxt-modal",t.className)("uxt-modal--open",t.isOpenClass)},inputs:{isOpen:"isOpen",cancelText:"cancelText",showCancelButton:"showCancelButton",submitText:"submitText",titleText:"titleText",enableSubmitButton:"enableSubmitButton"},outputs:{cancel:"cancel",submit:"submit"},ngContentSelectors:g,decls:15,vars:9,consts:[[1,"uxt-modal__overlay"],[1,"uxt-modal__window"],["position","top",1,"uxt-modal__header"],["class","uxt-modal__header__button__close uxt-modal__header__button__close__back","iconName","arrow-left",3,"click",4,"ngIf"],["class","uxt-modal__header__button__close uxt-modal__header__button__close__close","iconName","close",3,"click",4,"ngIf"],[1,"uxt-modal__header__title"],["class","uxt-modal__header__button__submit",3,"click",4,"ngIf"],[1,"uxt-modal__content"],[1,"uxt-modal__actions"],[1,"uxt-modal__actions__buttons"],["class","uxt-modal__actions__button uxt-modal__actions__button__cancel",3,"click",4,"ngIf"],[1,"uxt-modal__actions__button","uxt-modal__actions__button__submit",3,"disabled","click"],["iconName","arrow-left",1,"uxt-modal__header__button__close","uxt-modal__header__button__close__back",3,"click"],["iconName","close",1,"uxt-modal__header__button__close","uxt-modal__header__button__close__close",3,"click"],[1,"uxt-modal__header__button__submit",3,"click"],[1,"uxt-modal__actions__button","uxt-modal__actions__button__cancel",3,"click"]],template:function(e,t){1&e&&(s.rc(),s.Tb(0,"div",0),s.Yb(1,"div",1),s.Yb(2,"uxt-toolbar",2),s.Sc(3,r,1,0,"uxt-icon-button",3),s.Sc(4,l,1,0,"uxt-icon-button",4),s.Yb(5,"h1",5),s.Uc(6),s.Xb(),s.Sc(7,h,2,1,"button",6),s.Xb(),s.Yb(8,"div",7),s.qc(9),s.Xb(),s.Yb(10,"uxt-toolbar",8),s.Yb(11,"div",9),s.Sc(12,d,2,1,"button",10),s.Yb(13,"button",11),s.hc("click",(function(){return t.handleSubmit()})),s.Uc(14),s.Xb(),s.Xb(),s.Xb(),s.Xb()),2&e&&(s.sc("@overlay",t.isOpen?"open":"closed"),s.Eb(1),s.sc("@window",t.isOpen?"open":"closed"),s.Eb(2),s.sc("ngIf",!t.showCancelButton),s.Eb(1),s.sc("ngIf",t.showCancelButton),s.Eb(2),s.Wc(" ",t.titleText," "),s.Eb(1),s.sc("ngIf",t.showCancelButton),s.Eb(5),s.sc("ngIf",t.showCancelButton),s.Eb(1),s.sc("disabled",!t.enableSubmitButton),s.Eb(1),s.Wc(" ",t.submitText," "))},directives:[a.a,o.t,c.a],styles:[".uxt-modal{position:fixed;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;z-index:450}.uxt-modal:not(.uxt-modal--open){pointer-events:none}.uxt-modal__overlay{position:absolute;top:0;left:0;right:0;bottom:0;background-color:#000}.uxt-modal__window{display:flex;flex-direction:column;background-color:#fff;box-shadow:1px 1px 10px rgba(0,0,0,.25)}.uxt-modal__header{display:flex;align-items:center;height:56px;padding-right:8px;padding-left:8px;background-color:#fff!important}.uxt-modal__header__title{font-size:1.25rem;font-weight:500}.uxt-modal__content{display:flex;flex-grow:1;flex-direction:column;width:100%;min-height:100%;padding:16px;overflow-x:hidden;overflow-y:scroll}@media (max-height:300px){.uxt-modal__content{height:140px}}@media (max-width:768px){.uxt-modal__window{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;max-width:none;min-height:inherit}.uxt-modal__header{margin-top:56px;box-shadow:0 2px 5px rgba(0,0,0,.15)}.uxt-modal__header__title{flex-grow:1;margin-left:8px;padding-left:40px!important}.uxt-modal__header__button__close,.uxt-modal__header__button__submit{display:none!important}.uxt-modal__content{min-height:inherit;padding-left:56px}.uxt-modal textarea{overflow-y:scroll}.uxt-modal__actions{border-bottom-left-radius:2px;border-bottom-right-radius:2px;background-color:#fff!important;display:flex!important}.uxt-modal__actions__buttons{display:flex;margin-left:auto}.uxt-modal__actions__button{color:#02adff!important;border:none!important}}@media (min-width:769px){.uxt-modal__window{flex-shrink:1;min-width:420px;max-width:768px;max-height:90vh;border-radius:2px;z-index:451}.uxt-modal__header{border-top-left-radius:2px;border-top-right-radius:2px;padding-right:16px;padding-left:16px}.uxt-modal__header__button__close,.uxt-modal__header__button__submit{display:none!important}.uxt-modal__content{padding-right:24px;padding-left:24px;overflow-y:inherit}.uxt-modal__actions{border-bottom-left-radius:2px;border-bottom-right-radius:2px;background-color:#fff!important}.uxt-modal__actions__buttons{display:flex;margin-left:auto}.uxt-modal__actions__button{color:#02adff!important;border:none!important}}"],encapsulation:2,data:{animation:[Object(n.o)("overlay",[Object(n.l)("open",Object(n.m)({opacity:"0.5"})),Object(n.l)("closed",Object(n.m)({opacity:"0.0"})),Object(n.n)("open <=> closed",Object(n.e)("0.125s ease"))]),Object(n.o)("window",[Object(n.l)("open",Object(n.m)({marginTop:"0px"})),Object(n.l)("closed",Object(n.m)({marginTop:"2000px"})),Object(n.n)("open <=> closed",Object(n.e)("0.250s ease"))])]}}),e})()},IHjd:function(e,t,i){"use strict";i.r(t),i.d(t,"ROUTES",(function(){return Xt})),i.d(t,"TruviewScanRoutingModule",(function(){return Rt}));var n=i("ofXK"),s=i("3Pt+"),a=i("bSwM"),o=i("tyNb"),c=i("fXoL"),r=i("YyRF");let l=(()=>{let e=class{constructor(e,t){this.el=e,this.zone=t,this.onDragStart=new c.o,this.onDragEnd=new c.o,this.onDrag=new c.o}get pDraggableDisabled(){return this._pDraggableDisabled}set pDraggableDisabled(e){this._pDraggableDisabled=e,this._pDraggableDisabled?this.unbindMouseListeners():(this.el.nativeElement.draggable=!0,this.bindMouseListeners())}ngAfterViewInit(){this.pDraggableDisabled||(this.el.nativeElement.draggable=!0,this.bindMouseListeners())}bindDragListener(){this.dragListener||this.zone.runOutsideAngular(()=>{this.dragListener=this.drag.bind(this),this.el.nativeElement.addEventListener("drag",this.dragListener)})}unbindDragListener(){this.dragListener&&this.zone.runOutsideAngular(()=>{this.el.nativeElement.removeEventListener("drag",this.dragListener),this.dragListener=null})}bindMouseListeners(){this.mouseDownListener||this.mouseUpListener||this.zone.runOutsideAngular(()=>{this.mouseDownListener=this.mousedown.bind(this),this.mouseUpListener=this.mouseup.bind(this),this.el.nativeElement.addEventListener("mousedown",this.mouseDownListener),this.el.nativeElement.addEventListener("mouseup",this.mouseUpListener)})}unbindMouseListeners(){this.mouseDownListener&&this.mouseUpListener&&this.zone.runOutsideAngular(()=>{this.el.nativeElement.removeEventListener("mousedown",this.mouseDownListener),this.el.nativeElement.removeEventListener("mouseup",this.mouseUpListener),this.mouseDownListener=null,this.mouseUpListener=null})}drag(e){this.onDrag.emit(e)}dragStart(e){this.allowDrag()&&!this.pDraggableDisabled?(this.dragEffect&&(e.dataTransfer.effectAllowed=this.dragEffect),e.dataTransfer.setData("text",this.scope),this.onDragStart.emit(e),this.bindDragListener()):e.preventDefault()}dragEnd(e){this.onDragEnd.emit(e),this.unbindDragListener()}mousedown(e){this.handle=e.target}mouseup(e){this.handle=null}allowDrag(){return!this.dragHandle||!this.handle||r.a.matches(this.handle,this.dragHandle)}ngOnDestroy(){this.unbindDragListener(),this.unbindMouseListeners()}};return e.\u0275fac=function(t){return new(t||e)(c.Sb(c.l),c.Sb(c.B))},e.\u0275dir=c.Nb({type:e,selectors:[["","pDraggable",""]],hostBindings:function(e,t){1&e&&c.hc("dragstart",(function(e){return t.dragStart(e)}))("dragend",(function(e){return t.dragEnd(e)}))},inputs:{pDraggableDisabled:"pDraggableDisabled",scope:["pDraggable","scope"],dragEffect:"dragEffect",dragHandle:"dragHandle"},outputs:{onDragStart:"onDragStart",onDragEnd:"onDragEnd",onDrag:"onDrag"}}),e})(),h=(()=>{let e=class{constructor(e,t){this.el=e,this.zone=t,this.onDragEnter=new c.o,this.onDragLeave=new c.o,this.onDrop=new c.o}ngAfterViewInit(){this.pDroppableDisabled||this.bindDragOverListener()}bindDragOverListener(){this.dragOverListener||this.zone.runOutsideAngular(()=>{this.dragOverListener=this.dragOver.bind(this),this.el.nativeElement.addEventListener("dragover",this.dragOverListener)})}unbindDragOverListener(){this.dragOverListener&&this.zone.runOutsideAngular(()=>{this.el.nativeElement.removeEventListener("dragover",this.dragOverListener),this.dragOverListener=null})}dragOver(e){e.preventDefault()}drop(e){this.allowDrop(e)&&(e.preventDefault(),this.onDrop.emit(e))}dragEnter(e){e.preventDefault(),this.dropEffect&&(e.dataTransfer.dropEffect=this.dropEffect),this.onDragEnter.emit(e)}dragLeave(e){e.preventDefault(),this.onDragLeave.emit(e)}allowDrop(e){let t=e.dataTransfer.getData("text");if("string"==typeof this.scope&&t==this.scope)return!0;if(this.scope instanceof Array)for(let i=0;i<this.scope.length;i++)if(t==this.scope[i])return!0;return!1}ngOnDestroy(){this.unbindDragOverListener()}};return e.\u0275fac=function(t){return new(t||e)(c.Sb(c.l),c.Sb(c.B))},e.\u0275dir=c.Nb({type:e,selectors:[["","pDroppable",""]],hostBindings:function(e,t){1&e&&c.hc("drop",(function(e){return t.drop(e)}))("dragenter",(function(e){return t.dragEnter(e)}))("dragleave",(function(e){return t.dragLeave(e)}))},inputs:{scope:["pDroppable","scope"],pDroppableDisabled:"pDroppableDisabled",dropEffect:"dropEffect"},outputs:{onDragEnter:"onDragEnter",onDragLeave:"onDragLeave",onDrop:"onDrop"}}),e})(),d=(()=>{let e=class{};return e.\u0275mod=c.Qb({type:e}),e.\u0275inj=c.Pb({factory:function(t){return new(t||e)},imports:[[n.c]]}),e})();var g=i("K9v4"),u=i("5iMO"),b=i("3aMR"),p=i("F+hv"),f=i("GDd0"),v=i("sRnt"),m=i("YsCO"),T=i("VG3f"),S=i("LRne"),_=i("Cfvw"),E=i("eIep"),w=i("vkgz"),C=i("JIr8"),O=i("5+tZ"),P=i("lJxs"),D=i("IzEk"),x=i("4B5/"),I=i("YwUS"),M=i("6JPj"),y=i("8NKS"),A=i("WjcW"),B=i("k/hs"),V=i("wN6G"),L=i("Z9D8"),G=i("LUpO"),k=i("C4gn"),N=i("xc+7"),X=i("c+03"),R=i("+ooB"),Y=i("jNCI"),U=i("9iV3"),z=i("ECFu"),j=i("ti2P"),F=i("g++2"),H=i("mqkv"),W=i("/oMx"),K=i("7Ekh"),Z=i("lUp+"),q=i("PEjJ"),$=i("2ufx"),Q=i("cee5"),J=i("A1MZ"),ee=i("iwlc"),te=i("F8JD"),ie=i("Ejbi"),ne=i("+eYH"),se=i("NEWU"),ae=i("U7l/"),oe=i("41Lq"),ce=i("N9DE"),re=i("ONOH"),le=i("n5Jy"),he=i("jwzS"),de=i("+XGO"),ge=i("8ihU"),ue=i("IUya");let be=(()=>{class e extends ge.a{constructor(e,t,i){super(t),this.sdaTranslateService=e,this.helpService=i,this.isSelected=!1,this.DELETE_DB_TAG=this.sdaTranslateService.get("DELETE_DB_TAG","Delete GeoTag from database"),this.helpService.setHandlers(le.b)}ngOnInit(){this.enableOkayButton()}ok(){const e=new ue.a(!0);e.setData(this.isSelected),this.closeModal.next(e)}cancel(){this.closeModal.next(void 0)}}return e.\u0275fac=function(t){return new(t||e)(c.Sb(ie.a),c.Sb(Y.a),c.Sb(ee.a))},e.\u0275cmp=c.Mb({type:e,selectors:[["ng-component"]],features:[c.Bb],decls:3,vars:3,consts:[[1,"tvg-deletetag"],[3,"ngModel","title","ngModelChange"]],template:function(e,t){1&e&&(c.Yb(0,"div",0),c.Yb(1,"mat-checkbox",1),c.hc("ngModelChange",(function(e){return t.isSelected=e})),c.Uc(2),c.Xb(),c.Xb()),2&e&&(c.Eb(1),c.sc("ngModel",t.isSelected)("title",t.DELETE_DB_TAG),c.Eb(1),c.Wc("",t.DELETE_DB_TAG," "))},directives:[a.a,s.p,s.s],styles:[".tvg-deletetag[_ngcontent-%COMP%]{padding:0 20px}"]}),e})();var pe=i("Qi+w"),fe=i("TvZe"),ve=i("ghPn"),me=i("xgIS"),Te=i("NFeN");let Se=(()=>{class e{constructor(e){this.documentService=e,this.panelMinWidth=0,this.panelMaxWidth=0,this.isResizeBarRight=!1,this.onResizeWidth=new c.o,this.isGrabModeOn=new c.o,this.latestXPosition=0,this.isGrabbed=!1}autoResize(){this.panelWidth=this.panelWidth<this.panelMaxWidth?this.panelMaxWidth:this.panelMinWidth,this.onResizeWidth.emit(this.panelWidth)}startResize(e){e.preventDefault(),this.isGrabbed=!0,this.isGrabModeOn.emit(this.isGrabbed),this.latestXPosition=e.clientX,this.mouseMoveSubscription$=this.isResizeBarRight?Object(me.a)(this.documentService.Document,"mousemove").subscribe(e=>this.widthResizingRight(e)):Object(me.a)(this.documentService.Document,"mousemove").subscribe(e=>this.widthResizing(e)),this.mouseUpSubscription$=Object(me.a)(this.documentService.Document,"mouseup").subscribe(e=>this.blockResize(e))}widthResizing(e){e.preventDefault();let t=0;t=e.currentTarget.documentElement.clientWidth;const i=t-this.panelMinWidth,n=t-this.panelMaxWidth;this.isGrabbed&&(e.clientX>t-this.panelMinWidth?this.panelWidth=this.panelMinWidth:e.clientX<=i&&e.clientX>=n?(this.onResize(e.clientX-this.latestXPosition),this.latestXPosition=e.clientX):e.clientX<n&&(this.panelWidth=this.panelMaxWidth),this.onResizeWidth.emit(this.panelWidth))}widthResizingRight(e){e.preventDefault(),this.isGrabbed&&(e.clientX<this.panelMinWidth?this.panelWidth=this.panelMinWidth:e.clientX>=this.panelMinWidth&&e.clientX<=this.panelMaxWidth?(this.onResizeRight(e.clientX-this.latestXPosition),this.latestXPosition=e.clientX):e.clientX>this.panelMaxWidth&&(this.panelWidth=this.panelMaxWidth))}onResize(e){this.panelWidth-=e}onResizeRight(e){this.panelWidth+=e}blockResize(e){this.isGrabbed=!1,this.isGrabModeOn.emit(this.isGrabbed),this.mouseMoveSubscription$&&this.mouseMoveSubscription$.unsubscribe(),this.mouseUpSubscription$&&this.mouseUpSubscription$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(c.Sb($.a))},e.\u0275cmp=c.Mb({type:e,selectors:[["sda-resize-bar"]],inputs:{panelWidth:"panelWidth",panelMinWidth:"panelMinWidth",panelMaxWidth:"panelMaxWidth",isResizeBarRight:"isResizeBarRight"},outputs:{onResizeWidth:"onResizeWidth",isGrabModeOn:"isGrabModeOn"},decls:3,vars:0,consts:[[1,"resize-bar-handle",3,"mousedown"],[1,"resize-bar-icon-container",3,"dblclick"],["svgIcon","overflow",1,"resize-bar-icon"]],template:function(e,t){1&e&&(c.Yb(0,"div",0),c.hc("mousedown",(function(e){return t.startResize(e)})),c.Yb(1,"div",1),c.hc("dblclick",(function(){return t.autoResize()})),c.Tb(2,"mat-icon",2),c.Xb(),c.Xb())},directives:[Te.a],styles:[".resize-bar-handle[_ngcontent-%COMP%]{display:none}@media screen and (min-width:1200px){.resize-bar-handle[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:#cad0d7;width:10px;height:100%;cursor:col-resize;z-index:100!important}}.resize-bar-icon-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:inherit;color:#515e6b}.resize-bar-icon[_ngcontent-%COMP%]{width:20px;height:20px}"]}),e})();var _e=i("wZkO"),Ee=i("QibW"),we=i("YVwg"),Ce=i("Qcck");function Oe(e,t){if(1&e){const e=c.Zb();c.Yb(0,"mat-icon",22),c.hc("click",(function(){c.Kc(e);const t=c.lc().$implicit;return c.lc().addSelectedTagToScan(t.geoTag.name)})),c.Xb()}if(2&e){const e=c.lc(2);c.tc("title",e.ADD_GEOTAG)}}function Pe(e,t){if(1&e){const e=c.Zb();c.Yb(0,"mat-icon",23),c.hc("click",(function(){c.Kc(e);const t=c.lc().$implicit;return c.lc().navigateToSelectedTag(t.geoTag.name)})),c.Xb()}if(2&e){const e=c.lc(2);c.tc("title",e.TAGS_LOCATE)}}function De(e,t){if(1&e&&(c.Yb(0,"li",18),c.Yb(1,"label",19),c.Uc(2),c.Xb(),c.Sc(3,Oe,1,1,"mat-icon",20),c.Sc(4,Pe,1,1,"mat-icon",21),c.Xb()),2&e){const e=t.$implicit;c.Eb(2),c.Vc(e.geoTag.name),c.Eb(1),c.sc("ngIf",!e.isRelated),c.Eb(1),c.sc("ngIf",e.isRelated)}}function xe(e,t){if(1&e&&(c.Yb(0,"p",24),c.Uc(1),c.Xb()),2&e){const e=c.lc();c.Eb(1),c.Wc(" ",e.TVG_NO_TAGS_FOUND," ")}}function Ie(e,t){if(1&e){const e=c.Zb();c.Yb(0,"ul"),c.Yb(1,"li",18),c.Yb(2,"label",19),c.Uc(3),c.Xb(),c.Yb(4,"mat-icon",23),c.hc("click",(function(){c.Kc(e);const i=t.$implicit;return c.lc().navigateToSelectedTag(i)})),c.Xb(),c.Xb(),c.Xb()}if(2&e){const e=t.$implicit,i=c.lc();c.Eb(3),c.Vc(e),c.Eb(1),c.tc("title",i.TAGS_LOCATE)}}function Me(e,t){if(1&e){const e=c.Zb();c.Yb(0,"sda-pagination",25),c.hc("changePage",(function(t){return c.Kc(e),c.lc().changePageNumber(t)})),c.Xb()}if(2&e){const e=c.lc();c.sc("totalPages",e.totalPages)("currentPage",e.pageNumber)}}let ye=(()=>{class e{constructor(e,t,i,n,s,a){this.sdaTranslateService=e,this.tvgSiteService=t,this.pinsMenuService=i,this.helpService=n,this.exceptionService=s,this.configService=a,this.addSelectedTag=new c.o,this.zoomToTag=new c.o,this.closeGeoTag=new c.o,this.panelWidthOnResize=new c.o,this.resizeBarGrabChange=new c.o,this.geotagPanelWidth=256,this.geotagPanelMinWidth=256,this.geotagPanelMaxWidth=500,this.isResizeBarRight=!1,this.TVG_NO_TAGS_FOUND=this.sdaTranslateService.get("TVG_NO_TAGS_FOUND","No tags found..."),this.PINNED_TAGS=this.sdaTranslateService.get("TVG_PINNED_TAGS","Pinned Tags"),this.ALL_TAGS=this.sdaTranslateService.get("TVG_ALL_TAGS","All Tags"),this.TVG_SEARCH_TAGS=this.sdaTranslateService.get("TVG_SEARCH_TAGS","Search Tags"),this.TAGS_ON_SCAN=this.sdaTranslateService.get("TVG_TAGS_ON_SCAN","Tags on scan"),this.ADD_GEOTAG=this.sdaTranslateService.get("TVG_ADD_GEOTAG","Add GeoTag"),this.TAGS_LOCATE=this.sdaTranslateService.get("TVG_TAGS_LOCATE","Locate"),this.CLOSE=this.sdaTranslateService.get("CLOSE","Close"),this.tagsOnScan=new Array,this.retrievedTagNames=[],this.isPinnedTagsSearch=!1,this.noTagsFound=!1,this.pageNumber=0,this.showPaging=!1,this.peekResults=[],this.peekCount=0,this.displayCount=0,this.config="",this.totalTagsCount=0,this.helpService.setHandlers(le.a)}ngOnInit(){this.config=this.configService.selectedCreateConfig,this.peekFunction=e=>this.peekSearchQuery(e),this.getTagsOnScan()}ngOnChanges(e){e.tagInterfaceDef&&(this.searchPlaceholder=this.sdaTranslateService.getFormatted("SEARCH_BAR_SEARCH_BY_PLACEHOLDER","Search {0}...",[this.tagInterfaceDef]))}navigateToSelectedTag(e){this.zoomToTag.emit(e)}addSelectedTagToScan(e){if(this.retrievedTags.length>0){const t=this.retrievedTags.find(t=>t.geoTag.name===e);this.addSelectedTag.emit(t.geoTag)}}onCategoryChange(){this.retrievedTags=[]}search(e){const t=e.searchTerm;this.retrievedTags=[];const i=encodeURIComponent(t+"*");this.isPinnedTagsSearch?(this.isLoading=!0,this.pinsMenuService.getPinnedObjectsByCriteria(this.tagInterfaceDef,i,100,"LScanScanGeoTags_21").subscribe(e=>{e&&e.value.map(e=>[new ne.a(e.OBID,e.Name,e.Config),e.LScanScanGeoTags_21]).forEach(e=>{const t=this.isTagRelatedToCurrentScan(e[0].name,e[1]);this.retrievedTags.push({geoTag:e[0],isRelated:t})}),this.noTagsFound=this.retrievedTags.length<=0,this.isLoading=!1},e=>{this.noTagsFound=this.retrievedTags.length<=0,this.isLoading=!1,this.exceptionService.handleException(e)})):(this.isLoading=!0,this.tvgSiteService.getObjectsByInterface(this.tagInterfaceDef,i,100).subscribe(e=>{e&&e.value.map(e=>[new ne.a(e.OBID,e.Name,e.Config),e.LScanScanGeoTags_21]).forEach(e=>{const t=this.isTagRelatedToCurrentScan(e[0].name,e[1]);this.retrievedTags.push({geoTag:e[0],isRelated:t})}),this.noTagsFound=this.retrievedTags.length<=0,this.isLoading=!1},e=>{this.noTagsFound=this.retrievedTags.length<=0,this.isLoading=!1,this.exceptionService.handleException(e)}))}onCloseClick(){this.closeGeoTag.emit(!1)}onPanelResize(e){this.geotagPanelWidth=e,this.panelWidthOnResize.emit(this.geotagPanelWidth)}resizeBarGrabMode(e){this.resizeBarGrabChange.emit(e)}changePageNumber(e){e>=this.totalPages&&(e=0),this.pageNumber=e,this.tagsOnScan=[],this.getTagsOnScan()}refreshTagList(e){const t=this.retrievedTags.findIndex(t=>t.geoTag.name===e);-1!==t&&(this.retrievedTags[t].isRelated=!0),this.totalTagsCount+=1;const i=Settings.application.defaultPageSize;this.tagsOnScan.length<i?this.tagsOnScan.push(e):this.tagsOnScan.length===i&&(this.totalPages=0,this.showPaging=!1,this.setPagingInfo())}peekSearchQuery(e){return this.isPinnedTagsSearch?(this.displayCount=0,this.peekResponse((e,t,i)=>this.pinsMenuService.getPinnedObjectsByCriteria(e,t,i),e)):this.peekResponse((e,t,i)=>this.tvgSiteService.getObjectsByInterface(e,t,i),e)}peekResponse(e,t){return e(this.tagInterfaceDef,encodeURIComponent(t.searchTerm+"*"),100).pipe(Object(O.a)(e=>e?(this.displayCount=e.count,this.convertPeekSearchFunctionResults(e.value.map(e=>new ne.a(e.OBID,e.Name,e.Config)))):this.convertPeekSearchFunctionResults([])))}convertPeekSearchFunctionResults(e){const t=new fe.a(void 0),i=new Array,n=e.length>4?4:e.length;return t.totalCount=this.displayCount>0?this.displayCount:e.length,e.slice(0,n).forEach(e=>{i.push(new ve.b(e.name))}),t.results=i,Object(S.a)(t)}getTagsOnScan(){const e=Settings.application.defaultPageSize;this.tvgSiteService.getMatchingTags("*",this.currentScanOBID,this.config,e,this.pageNumber).subscribe(e=>{this.totalTagsCount=e.value[0]["LScanScanGeoTags_12@odata.count"],this.setPagingInfo(),e.value[0].LScanScanGeoTags_12.forEach(e=>{this.tagsOnScan.push(e.Name)})})}isTagRelatedToCurrentScan(e,t){return!!(t&&t.length>0)&&t.findIndex(e=>e.OBID===this.currentScanOBID)>-1}setPagingInfo(){const e=Settings.application.defaultPageSize;this.totalPages=Math.ceil(this.totalTagsCount/e),this.showPaging=this.totalPages>1}}return e.\u0275fac=function(t){return new(t||e)(c.Sb(ie.a),c.Sb(de.a),c.Sb(pe.a),c.Sb(ee.a),c.Sb(G.a),c.Sb(re.a))},e.\u0275cmp=c.Mb({type:e,selectors:[["sda-tvg-geotag"]],inputs:{tagInterfaceDef:"tagInterfaceDef",currentScanOBID:"currentScanOBID"},outputs:{addSelectedTag:"addSelectedTag",zoomToTag:"zoomToTag",closeGeoTag:"closeGeoTag",panelWidthOnResize:"panelWidthOnResize",resizeBarGrabChange:"resizeBarGrabChange"},features:[c.Cb],decls:25,vars:23,consts:[[1,"geotag-container"],[3,"panelWidth","panelMinWidth","panelMaxWidth","isResizeBarRight","onResizeWidth","isGrabModeOn"],["resizeBar",""],[1,"geotag-panel"],[1,"geotag-panel-header"],[1,"geotag-panel-header__title"],["svgIcon","close",1,"geotag-panel-header__icon",3,"title","click"],[1,"geotag-content"],[3,"label"],[1,"geotag-content__radio-group",3,"ngModel","ngModelChange","change"],[1,"geotag-content__radio",3,"value"],[3,"searchTerm","placeholder","isLoading","peekFunction","onSearch"],[1,"geotag-results"],[1,"geotag-results__list"],["class","geotag-results__item",4,"ngFor","ngForOf"],["class","geotag-results__message",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"totalPages","currentPage","changePage",4,"ngIf"],[1,"geotag-results__item"],[1,"geotag-results__label"],["svgIcon","add","class","geotag-results__icon",3,"title","click",4,"ngIf"],["svgIcon","location","class","geotag-results__icon",3,"title","click",4,"ngIf"],["svgIcon","add",1,"geotag-results__icon",3,"title","click"],["svgIcon","location",1,"geotag-results__icon",3,"title","click"],[1,"geotag-results__message"],[3,"totalPages","currentPage","changePage"]],template:function(e,t){1&e&&(c.Yb(0,"div",0),c.Yb(1,"sda-resize-bar",1,2),c.hc("onResizeWidth",(function(e){return t.onPanelResize(e)}))("isGrabModeOn",(function(e){return t.resizeBarGrabMode(e)})),c.Xb(),c.Yb(3,"div",3),c.Yb(4,"div",4),c.Yb(5,"h4",5),c.Uc(6),c.Xb(),c.Yb(7,"mat-icon",6),c.hc("click",(function(){return t.onCloseClick()})),c.Xb(),c.Xb(),c.Yb(8,"div",7),c.Yb(9,"mat-tab-group"),c.Yb(10,"mat-tab",8),c.Yb(11,"mat-radio-group",9),c.hc("ngModelChange",(function(e){return t.isPinnedTagsSearch=e}))("change",(function(){return t.onCategoryChange()})),c.Yb(12,"mat-radio-button",10),c.Uc(13),c.Xb(),c.Yb(14,"mat-radio-button",10),c.Uc(15),c.Xb(),c.Xb(),c.Yb(16,"sda-peek-and-filters-search",11),c.hc("onSearch",(function(e){return t.search(e)})),c.Xb(),c.Yb(17,"div",12),c.Yb(18,"ul",13),c.Sc(19,De,5,3,"li",14),c.Xb(),c.Sc(20,xe,2,1,"p",15),c.Xb(),c.Xb(),c.Yb(21,"mat-tab",8),c.Yb(22,"div",12),c.Sc(23,Ie,5,2,"ul",16),c.Xb(),c.Sc(24,Me,1,2,"sda-pagination",17),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Xb()),2&e&&(c.Eb(1),c.sc("panelWidth",t.geotagPanelWidth)("panelMinWidth",t.geotagPanelMinWidth)("panelMaxWidth",t.geotagPanelMaxWidth)("isResizeBarRight",t.isResizeBarRight),c.Eb(2),c.Rc("width",t.geotagPanelWidth,"px"),c.Eb(3),c.Wc(" ",t.ADD_GEOTAG," "),c.Eb(1),c.tc("title",t.CLOSE),c.Eb(3),c.tc("label",t.TVG_SEARCH_TAGS),c.Eb(1),c.sc("ngModel",t.isPinnedTagsSearch),c.Eb(1),c.sc("value",!0),c.Eb(1),c.Vc(t.PINNED_TAGS),c.Eb(1),c.sc("value",!1),c.Eb(1),c.Vc(t.ALL_TAGS),c.Eb(1),c.sc("searchTerm","*")("placeholder",t.searchPlaceholder)("isLoading",t.isLoading)("peekFunction",t.peekFunction),c.Eb(3),c.sc("ngForOf",t.retrievedTags),c.Eb(1),c.sc("ngIf",t.noTagsFound),c.Eb(1),c.tc("label",t.TAGS_ON_SCAN),c.Eb(2),c.sc("ngForOf",t.tagsOnScan),c.Eb(1),c.sc("ngIf",t.showPaging))},directives:[Se,Te.a,_e.c,_e.a,Ee.b,s.p,s.s,Ee.a,we.a,n.s,n.t,Ce.a],styles:[".geotag-results[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]     .mat-tab-body-content{display:flex;flex-direction:column;overflow:hidden}.geotag-container[_ngcontent-%COMP%]{display:flex;flex:1 0 100%;height:100%}.geotag-panel[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.geotag-panel-header[_ngcontent-%COMP%]{display:flex;flex-shrink:0;align-items:center;width:100%;height:49px;padding:0 15px;background-color:#6b8cad;border-bottom:1px solid rgba(31,36,41,.5);color:#fff;overflow:hidden;cursor:pointer}.geotag-panel-header__icon[_ngcontent-%COMP%]{height:40px}.geotag-panel-header__title[_ngcontent-%COMP%]{flex:1;margin:0 7px;font-size:24px;color:#fff;line-height:1.2;overflow:hidden}.geotag-content[_ngcontent-%COMP%]{height:100%;overflow:hidden}.geotag-content__radio-group[_ngcontent-%COMP%]{display:inline-flex;flex-direction:column;margin:5px}.geotag-content__radio[_ngcontent-%COMP%]{margin:5px}.geotag-results[_ngcontent-%COMP%]{flex:1}.geotag-results__item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 10px}.geotag-results__label[_ngcontent-%COMP%]{color:#38414a}.geotag-results__icon[_ngcontent-%COMP%]{flex-shrink:0;height:40px;margin-left:auto;color:#02adff;cursor:pointer}.geotag-results__message[_ngcontent-%COMP%]{padding:20px;text-align:center}"]}),e})();var Ae=i("GW71"),Be=i("BLbD"),Ve=i("+T9e");let Le=(()=>{class e{constructor(){this.detailsShrink=new c.o}tagDetailsShrink(e){this.preventDefaultForTouch(e),this.detailsShrink.emit(e)}preventDefaultForTouch(e){"touchstart"===e.type.toLowerCase()&&e.preventDefault()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Mb({type:e,selectors:[["sda-tag-details"]],inputs:{selectedTagName:"selectedTagName",selectedTagOBID:"selectedTagOBID",config:"config"},outputs:{detailsShrink:"detailsShrink"},decls:7,vars:5,consts:[[3,"toggle"],["id","tag-properties-container",1,"tag-properties"],[1,"properties-nav"],[1,"properties-nav__title",3,"title"],["svgIcon","shrink",1,"properties-nav__icon",3,"click","touchstart"],[3,"id","config"]],template:function(e,t){1&e&&(c.Tb(0,"sda-blanket",0),c.Yb(1,"div",1),c.Yb(2,"div",2),c.Yb(3,"h2",3),c.Uc(4),c.Xb(),c.Yb(5,"mat-icon",4),c.hc("click",(function(e){return t.tagDetailsShrink(e)}))("touchstart",(function(e){return t.tagDetailsShrink(e)})),c.Xb(),c.Xb(),c.Tb(6,"sda-object-details",5),c.Xb()),2&e&&(c.sc("toggle",!0),c.Eb(3),c.tc("title",t.selectedTagName),c.Eb(1),c.Vc(t.selectedTagName),c.Eb(2),c.sc("id",t.selectedTagOBID)("config",t.config))},directives:[Be.a,Te.a,Ve.a],styles:["sda-object-details[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto}.properties-nav__title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}[_nghost-%COMP%]     .blanket--fixed{z-index:100!important}.tag-properties[_ngcontent-%COMP%]{position:fixed;top:100px;left:24.5%;right:24.5%;bottom:6%;display:flex;flex-direction:column;overflow:hidden;background-color:#fff;border:3px solid #069;border-radius:15px;z-index:200!important}.tag-properties[_ngcontent-%COMP%]     .form__content{width:100%}.properties-nav[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:space-between;margin-bottom:4px;padding:8px 16px}.properties-nav__title[_ngcontent-%COMP%]{width:95%;font-size:20px;font-weight:500}.properties-nav__icon[_ngcontent-%COMP%]{align-self:flex-start;cursor:pointer;fill:#1f8cdf}"]}),e})();var Ge=i("pUtL"),ke=i("ZEu8");const Ne=["tvgMeasurement"];function Xe(e,t){if(1&e&&(c.Yb(0,"option",13),c.Uc(1),c.Xb()),2&e){const e=t.$implicit,i=c.lc();c.sc("ngValue",i.uomList.indexOf(e)),c.Eb(1),c.Wc(" ",e," ")}}function Re(e,t){if(1&e&&(c.Yb(0,"div",14),c.Yb(1,"span",7),c.Uc(2),c.Xb(),c.Yb(3,"span",8),c.Uc(4),c.Xb(),c.Yb(5,"span",8),c.Uc(6),c.Xb(),c.Yb(7,"span",8),c.Uc(8),c.Xb(),c.Xb()),2&e){const e=t.$implicit,i=t.index,n=c.lc();c.Eb(2),c.Vc(i+1),c.Eb(2),c.Vc(e.X.toFixed(n.precision)),c.Eb(2),c.Vc(e.Y.toFixed(n.precision)),c.Eb(2),c.Vc(e.Z.toFixed(n.precision))}}function Ye(e,t){if(1&e&&(c.Yb(0,"div",15),c.Yb(1,"span"),c.Uc(2),c.Xb(),c.Yb(3,"span"),c.Uc(4),c.Xb(),c.Yb(5,"span"),c.Uc(6),c.Xb(),c.Yb(7,"span"),c.Uc(8),c.Xb(),c.Xb()),2&e){const e=c.lc();c.Eb(2),c.Vc(e.TVG_LINEAR_MEASUREMENT_DISTANCE),c.Eb(2),c.Vc(e.TVG_LINEAR_MEASUREMENT_DELTAX),c.Eb(2),c.Vc(e.TVG_LINEAR_MEASUREMENT_DELTAY),c.Eb(2),c.Vc(e.TVG_LINEAR_MEASUREMENT_DELTAZ)}}function Ue(e,t){if(1&e&&(c.Yb(0,"div",16),c.Yb(1,"span"),c.Uc(2),c.Xb(),c.Yb(3,"span"),c.Uc(4),c.Xb(),c.Yb(5,"span"),c.Uc(6),c.Xb(),c.Yb(7,"span"),c.Uc(8),c.Xb(),c.Xb()),2&e){const e=c.lc();c.Eb(2),c.Xc("",e.result.Distance," ",e.selectedUOM,""),c.Eb(2),c.Xc("",e.result.DeltaX," ",e.selectedUOM,""),c.Eb(2),c.Xc("",e.result.DeltaY," ",e.selectedUOM,""),c.Eb(2),c.Xc("",e.result.DeltaZ," ",e.selectedUOM,"")}}function ze(e,t){if(1&e&&(c.Yb(0,"div",15),c.Yb(1,"span"),c.Uc(2),c.Xb(),c.Xb()),2&e){const e=c.lc();c.Eb(2),c.Vc(e.TVG_ANGULAR_MEASUREMENT_ANGLE)}}function je(e,t){if(1&e&&(c.Yb(0,"div",16),c.Yb(1,"span"),c.Uc(2),c.Xb(),c.Xb()),2&e){const e=c.lc();c.Eb(2),c.Xc("",e.result.Angle," ",e.TVG_ANGULAR_MEASUREMENT_DEG,"")}}let Fe=(()=>{class e{constructor(e,t,i){this.sdaTranslateService=e,this.helpService=t,this.tvgSharedProvider=i,this.precision=3,this.uomId=0,this.TVG_LINEAR_MEASUREMENT_DISTANCE=this.sdaTranslateService.get("TVG_LINEAR_MEASUREMENT_DISTANCE","Distance"),this.TVG_LINEAR_MEASUREMENT_DELTAX=this.sdaTranslateService.get("TVG_LINEAR_MEASUREMENT_DELTAX","Delta X"),this.TVG_LINEAR_MEASUREMENT_DELTAY=this.sdaTranslateService.get("TVG_LINEAR_MEASUREMENT_DELTAY","Delta Y"),this.TVG_LINEAR_MEASUREMENT_DELTAZ=this.sdaTranslateService.get("TVG_LINEAR_MEASUREMENT_DELTAZ","Delta Z"),this.TVG_ANGULAR_MEASUREMENT_ANGLE=this.sdaTranslateService.get("TVG_ANGULAR_MEASUREMENT_ANGLE","Angle"),this.TVG_ANGULAR_MEASUREMENT_DEG=this.sdaTranslateService.get("TVG_ANGULAR_MEASUREMENT_DEG","deg"),this.TVG_MEASUREMENT_X=this.sdaTranslateService.get("TVG_MEASUREMENT_X","X"),this.TVG_MEASUREMENT_Y=this.sdaTranslateService.get("TVG_MEASUREMENT_Y","Y"),this.TVG_MEASUREMENT_Z=this.sdaTranslateService.get("TVG_MEASUREMENT_Z","Z"),this.TVG_UNITS=this.sdaTranslateService.get("TVG_UNITS","Units"),this.deltaXY=[],this.helpService.setHandlers(le.d),this.uomList=this.tvgSharedProvider.getUoMList(),this.getUOMDetails()}ngOnInit(){this.calculateDistance(),this.setMeasurementVisible()}DragStart(e){this.deltaXY.splice(0),this.deltaXY.push(e.pageX-this.measurementPopupPosX),this.deltaXY.push(e.pageY-this.measurementPopupPosY)}DragEnd(e){this.measurementPopupPosX=e.pageX-this.deltaXY[0],this.measurementPopupPosY=e.pageY-this.deltaXY[1]}touchDragStart(e){this.deltaXY.splice(0),this.deltaXY.push(e.touches[0].pageX-this.measurementPopupPosX),this.deltaXY.push(e.touches[0].pageY-this.measurementPopupPosY)}touchDragEnd(e){this.measurementPopupPosX=e.changedTouches[0].pageX-this.deltaXY[0],this.measurementPopupPosY=e.changedTouches[0].pageY-this.deltaXY[1]}onChangeUOM(){this.getUOMDetails(),this.calculateDistance()}getUOMDetails(){const e=this.tvgSharedProvider.getMeasurementUoM(this.uomId);e&&(this.conversionValue=e.conversionValue,this.selectedUOM=e.shortName)}calculateDistance(){if(this.pickPointCollection&&this.pickPointCollection.length>0)if(this.pickPointsToBeShown=this.tvgSharedProvider.convertPickPoints(this.pickPointCollection,this.conversionValue),2===this.requiredPickPoints)this.result=this.tvgSharedProvider.calculateLinearDistance(this.pickPointsToBeShown,this.precision);else if(3===this.requiredPickPoints){const e=this.tvgSharedProvider.calculateAngularDistance(this.pickPointsToBeShown,this.precision);this.result={Distance:0,DeltaX:0,DeltaY:0,DeltaZ:0,Angle:e}}}setMeasurementVisible(){const e=this.tvgMeasurement.nativeElement;if(e&&this.parentElement){const t=e.getBoundingClientRect(),i=this.parentElement.getBoundingClientRect();this.measurementPopupPosX=i.width/2-t.width/2,this.measurementPopupPosY=i.height/2-t.height/2}}}return e.\u0275fac=function(t){return new(t||e)(c.Sb(ie.a),c.Sb(ee.a),c.Sb(ke.a))},e.\u0275cmp=c.Mb({type:e,selectors:[["sda-tvg-mesurement"]],viewQuery:function(e,t){var i;1&e&&c.Qc(Ne,!0),2&e&&c.Gc(i=c.ic())&&(t.tvgMeasurement=i.first)},inputs:{pickPointCollection:"pickPointCollection",requiredPickPoints:"requiredPickPoints",measurementPopupPosX:"measurementPopupPosX",measurementPopupPosY:"measurementPopupPosY",parentElement:"parentElement"},decls:22,vars:15,consts:[["pDraggable","measurement",1,"hotspot",3,"onDragStart","onDragEnd","touchstart","touchend"],["tvgMeasurement",""],[1,"hotspot__units"],[1,"hotspot__label"],[1,"hotspot__select",3,"ngModel","ngModelChange","change"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"hotspot__header"],[1,"hotspot__index"],[1,"hotspot__co-ordinates"],["class","hotspot__data",4,"ngFor","ngForOf"],[1,"hotspot__result"],["class","hotspot__result-item",4,"ngIf"],["class","hotspot__result-value",4,"ngIf"],[3,"ngValue"],[1,"hotspot__data"],[1,"hotspot__result-item"],[1,"hotspot__result-value"]],template:function(e,t){1&e&&(c.Yb(0,"div",0,1),c.hc("onDragStart",(function(e){return t.DragStart(e)}))("onDragEnd",(function(e){return t.DragEnd(e)}))("touchstart",(function(e){return t.touchDragStart(e)}))("touchend",(function(e){return t.touchDragEnd(e)})),c.Yb(2,"div",2),c.Yb(3,"label",3),c.Uc(4),c.Xb(),c.Yb(5,"select",4),c.hc("ngModelChange",(function(e){return t.uomId=e}))("change",(function(){return t.onChangeUOM()})),c.Sc(6,Xe,2,2,"option",5),c.Xb(),c.Xb(),c.Yb(7,"div",6),c.Yb(8,"span",7),c.Uc(9,"#"),c.Xb(),c.Yb(10,"span",8),c.Uc(11),c.Xb(),c.Yb(12,"span",8),c.Uc(13),c.Xb(),c.Yb(14,"span",8),c.Uc(15),c.Xb(),c.Xb(),c.Sc(16,Re,9,4,"div",9),c.Yb(17,"div",10),c.Sc(18,Ye,9,4,"div",11),c.Sc(19,Ue,9,8,"div",12),c.Sc(20,ze,3,1,"div",11),c.Sc(21,je,3,2,"div",12),c.Xb(),c.Xb()),2&e&&(c.Rc("left",t.measurementPopupPosX,"px")("top",t.measurementPopupPosY,"px"),c.Eb(4),c.Vc(t.TVG_UNITS),c.Eb(1),c.sc("ngModel",t.uomId),c.Eb(1),c.sc("ngForOf",t.uomList),c.Eb(5),c.Vc(t.TVG_MEASUREMENT_X),c.Eb(2),c.Vc(t.TVG_MEASUREMENT_Y),c.Eb(2),c.Vc(t.TVG_MEASUREMENT_Z),c.Eb(1),c.sc("ngForOf",t.pickPointsToBeShown),c.Eb(2),c.sc("ngIf",2===t.requiredPickPoints),c.Eb(1),c.sc("ngIf",2===t.requiredPickPoints),c.Eb(1),c.sc("ngIf",3===t.requiredPickPoints),c.Eb(1),c.sc("ngIf",3===t.requiredPickPoints))},directives:[l,s.B,s.p,s.s,n.s,n.t,s.u,s.E],styles:[".hotspot[_ngcontent-%COMP%]{position:absolute;display:flex;flex-flow:column nowrap;border-radius:15px;border:2px solid #00608f;background-color:#fff;opacity:.9;padding:5px;z-index:100!important}.hotspot__units[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:15px}.hotspot__label[_ngcontent-%COMP%]{line-height:1.7em;font-size:large}.hotspot__select[_ngcontent-%COMP%]{height:26px}.hotspot__header[_ngcontent-%COMP%]{display:flex;text-align:center;min-width:300px;border-bottom:3px solid #ebedf0;font-weight:500;font-size:15px;padding:3px}.hotspot__index[_ngcontent-%COMP%]{flex-basis:30px;width:45px;padding:3px}.hotspot__co-ordinates[_ngcontent-%COMP%]{flex-basis:90px;padding:3px}.hotspot__data[_ngcontent-%COMP%]{display:flex;text-align:center;min-width:300px;border-bottom:3px solid #ebedf0;font-size:14px;padding:3px}.hotspot__result[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around;padding:12px}.hotspot__result-item[_ngcontent-%COMP%], .hotspot__result-value[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),e})();const He=["sliderHandle"],We=["sliderHandleStart"],Ke=["sliderHandleEnd"],Ze=function(e,t){return{left:e,width:t}};function qe(e,t){if(1&e&&c.Tb(0,"span",5),2&e){const e=c.lc();c.sc("ngStyle",c.yc(1,Ze,e.handleValues[0]+"%",e.handleValues[1]-e.handleValues[0]+"%"))}}const $e=function(e,t){return{bottom:e,height:t}};function Qe(e,t){if(1&e&&c.Tb(0,"span",5),2&e){const e=c.lc();c.sc("ngStyle",c.yc(1,$e,e.handleValues[0]+"%",e.handleValues[1]-e.handleValues[0]+"%"))}}const Je=function(e){return{height:e}};function et(e,t){if(1&e&&c.Tb(0,"span",6),2&e){const e=c.lc();c.sc("ngStyle",c.xc(1,Je,e.handleValue+"%"))}}const tt=function(e){return{width:e}};function it(e,t){if(1&e&&c.Tb(0,"span",6),2&e){const e=c.lc();c.sc("ngStyle",c.xc(1,tt,e.handleValue+"%"))}}const nt=function(e,t){return{left:e,bottom:t}};function st(e,t){if(1&e){const e=c.Zb();c.Yb(0,"span",7,8),c.hc("keydown",(function(t){return c.Kc(e),c.lc().onHandleKeydown(t)}))("mousedown",(function(t){return c.Kc(e),c.lc().onMouseDown(t)}))("touchstart",(function(t){return c.Kc(e),c.lc().onTouchStart(t)}))("touchmove",(function(t){return c.Kc(e),c.lc().onTouchMove(t)}))("touchend",(function(t){return c.Kc(e),c.lc().onTouchEnd(t)})),c.Xb()}if(2&e){const e=c.lc();c.Rc("transition",e.dragging?"none":null),c.sc("ngStyle",c.yc(8,nt,"horizontal"==e.orientation?e.handleValue+"%":null,"vertical"==e.orientation?e.handleValue+"%":null)),c.Fb("tabindex",e.tabindex)("aria-valuemin",e.min)("aria-valuenow",e.value)("aria-valuemax",e.max)("aria-labelledby",e.ariaLabelledBy)}}const at=function(e){return{"ui-slider-handle-active":e}};function ot(e,t){if(1&e){const e=c.Zb();c.Yb(0,"span",9,10),c.hc("keydown",(function(t){return c.Kc(e),c.lc().onHandleKeydown(t,0)}))("mousedown",(function(t){return c.Kc(e),c.lc().onMouseDown(t,0)}))("touchstart",(function(t){return c.Kc(e),c.lc().onTouchStart(t,0)}))("touchmove",(function(t){return c.Kc(e),c.lc().onTouchMove(t,0)}))("touchend",(function(t){return c.Kc(e),c.lc().onTouchEnd(t)})),c.Xb()}if(2&e){const e=c.lc();c.Rc("transition",e.dragging?"none":null),c.sc("ngStyle",c.yc(9,nt,e.rangeStartLeft,e.rangeStartBottom))("ngClass",c.xc(12,at,0==e.handleIndex)),c.Fb("tabindex",e.tabindex)("aria-valuemin",e.min)("aria-valuenow",e.value?e.value[0]:null)("aria-valuemax",e.max)("aria-labelledby",e.ariaLabelledBy)}}function ct(e,t){if(1&e){const e=c.Zb();c.Yb(0,"span",9,11),c.hc("keydown",(function(t){return c.Kc(e),c.lc().onHandleKeydown(t,1)}))("mousedown",(function(t){return c.Kc(e),c.lc().onMouseDown(t,1)}))("touchstart",(function(t){return c.Kc(e),c.lc().onTouchStart(t,1)}))("touchmove",(function(t){return c.Kc(e),c.lc().onTouchMove(t,1)}))("touchend",(function(t){return c.Kc(e),c.lc().onTouchEnd(t)})),c.Xb()}if(2&e){const e=c.lc();c.Rc("transition",e.dragging?"none":null),c.sc("ngStyle",c.yc(9,nt,e.rangeEndLeft,e.rangeEndBottom))("ngClass",c.xc(12,at,1==e.handleIndex)),c.Fb("tabindex",e.tabindex)("aria-valuemin",e.min)("aria-valuenow",e.value?e.value[1]:null)("aria-valuemax",e.max)("aria-labelledby",e.ariaLabelledBy)}}const rt=function(e,t,i,n){return{"ui-slider ui-widget ui-widget-content ui-corner-all":!0,"ui-state-disabled":e,"ui-slider-horizontal":t,"ui-slider-vertical":i,"ui-slider-animate":n}},lt={provide:s.n,useExisting:Object(c.W)(()=>ht),multi:!0};let ht=(()=>{let e=class{constructor(e,t,i,n){this.el=e,this.renderer=t,this.ngZone=i,this.cd=n,this.min=0,this.max=100,this.orientation="horizontal",this.tabindex=0,this.onChange=new c.o,this.onSlideEnd=new c.o,this.handleValues=[],this.onModelChange=()=>{},this.onModelTouched=()=>{},this.handleIndex=0}onMouseDown(e,t){this.disabled||(this.dragging=!0,this.updateDomData(),this.sliderHandleClick=!0,this.handleIndex=t,this.bindDragListeners(),e.target.focus(),e.preventDefault())}onTouchStart(e,t){if(!this.disabled){var i=e.changedTouches[0];this.startHandleValue=this.range?this.handleValues[t]:this.handleValue,this.dragging=!0,this.handleIndex=t,"horizontal"===this.orientation?(this.startx=parseInt(i.clientX,10),this.barWidth=this.el.nativeElement.children[0].offsetWidth):(this.starty=parseInt(i.clientY,10),this.barHeight=this.el.nativeElement.children[0].offsetHeight),e.preventDefault()}}onTouchMove(e,t){if(!this.disabled){var i,n=e.changedTouches[0];i="horizontal"===this.orientation?Math.floor(100*(parseInt(n.clientX,10)-this.startx)/this.barWidth)+this.startHandleValue:Math.floor(100*(this.starty-parseInt(n.clientY,10))/this.barHeight)+this.startHandleValue,this.setValueFromHandle(e,i),e.preventDefault()}}onTouchEnd(e,t){this.disabled||(this.dragging=!1,this.onSlideEnd.emit(this.range?{originalEvent:e,values:this.values}:{originalEvent:e,value:this.value}),e.preventDefault())}onBarClick(e){this.disabled||(this.sliderHandleClick||(this.updateDomData(),this.handleChange(e)),this.sliderHandleClick=!1)}onHandleKeydown(e,t){38==e.which||39==e.which?this.spin(e,1,t):37!=e.which&&40!=e.which||this.spin(e,-1,t)}spin(e,t,i){let n=(this.step||1)*t;this.range?(this.handleIndex=i,this.updateValue(this.values[this.handleIndex]+n),this.updateHandleValue()):(this.updateValue(this.value+n),this.updateHandleValue()),e.preventDefault()}handleChange(e){let t=this.calculateHandleValue(e);this.setValueFromHandle(e,t)}bindDragListeners(){this.ngZone.runOutsideAngular(()=>{this.dragListener||(this.dragListener=this.renderer.listen("document","mousemove",e=>{this.dragging&&this.ngZone.run(()=>{this.handleChange(e)})})),this.mouseupListener||(this.mouseupListener=this.renderer.listen("document","mouseup",e=>{this.dragging&&(this.dragging=!1,this.ngZone.run(()=>{this.onSlideEnd.emit(this.range?{originalEvent:e,values:this.values}:{originalEvent:e,value:this.value})}))}))})}unbindDragListeners(){this.dragListener&&this.dragListener(),this.mouseupListener&&this.mouseupListener()}setValueFromHandle(e,t){let i=this.getValueFromHandle(t);this.range?this.step?this.handleStepChange(i,this.values[this.handleIndex]):(this.handleValues[this.handleIndex]=t,this.updateValue(i,e)):this.step?this.handleStepChange(i,this.value):(this.handleValue=t,this.updateValue(i,e))}handleStepChange(e,t){let i=e-t,n=t;i<0?n=t+Math.ceil(e/this.step-t/this.step)*this.step:i>0&&(n=t+Math.floor(e/this.step-t/this.step)*this.step),this.updateValue(n),this.updateHandleValue()}writeValue(e){this.range?this.values=e||[0,0]:this.value=e||0,this.updateHandleValue(),this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e}get rangeStartLeft(){return this.isVertical()?"auto":this.handleValues[0]+"%"}get rangeStartBottom(){return this.isVertical()?this.handleValues[0]+"%":"auto"}get rangeEndLeft(){return this.isVertical()?"auto":this.handleValues[1]+"%"}get rangeEndBottom(){return this.isVertical()?this.handleValues[1]+"%":"auto"}isVertical(){return"vertical"===this.orientation}updateDomData(){let e=this.el.nativeElement.children[0].getBoundingClientRect();this.initX=e.left+r.a.getWindowScrollLeft(),this.initY=e.top+r.a.getWindowScrollTop(),this.barWidth=this.el.nativeElement.children[0].offsetWidth,this.barHeight=this.el.nativeElement.children[0].offsetHeight}calculateHandleValue(e){return"horizontal"===this.orientation?100*(e.pageX-this.initX)/this.barWidth:100*(this.initY+this.barHeight-e.pageY)/this.barHeight}updateHandleValue(){this.range?(this.handleValues[0]=100*(this.values[0]<this.min?0:this.values[0]-this.min)/(this.max-this.min),this.handleValues[1]=100*(this.values[1]>this.max?100:this.values[1]-this.min)/(this.max-this.min)):this.handleValue=this.value<this.min?0:this.value>this.max?100:100*(this.value-this.min)/(this.max-this.min)}updateValue(e,t){if(this.range){let i=e;0==this.handleIndex?(i<this.min?(i=this.min,this.handleValues[0]=0):i>this.values[1]&&(i=this.values[1],this.handleValues[0]=this.handleValues[1]),this.sliderHandleStart.nativeElement.focus()):(i>this.max?(i=this.max,this.handleValues[1]=100):i<this.values[0]&&(i=this.values[0],this.handleValues[1]=this.handleValues[0]),this.sliderHandleEnd.nativeElement.focus()),this.values[this.handleIndex]=this.getNormalizedValue(i),this.values=this.values.slice(),this.onModelChange(this.values),this.onChange.emit({event:t,values:this.values})}else e<this.min?(e=this.min,this.handleValue=0):e>this.max&&(e=this.max,this.handleValue=100),this.value=this.getNormalizedValue(e),this.onModelChange(this.value),this.onChange.emit({event:t,value:this.value}),this.sliderHandle.nativeElement.focus()}getValueFromHandle(e){return e/100*(this.max-this.min)+this.min}getDecimalsCount(e){return e&&Math.floor(e)!==e&&e.toString().split(".")[1].length||0}getNormalizedValue(e){let t=this.getDecimalsCount(this.step);return t>0?+e.toFixed(t):Math.floor(e)}ngOnDestroy(){this.unbindDragListeners()}};return e.\u0275fac=function(t){return new(t||e)(c.Sb(c.l),c.Sb(c.G),c.Sb(c.B),c.Sb(c.h))},e.\u0275cmp=c.Mb({type:e,selectors:[["p-slider"]],viewQuery:function(e,t){var i;1&e&&(c.bd(He,!0),c.bd(We,!0),c.bd(Ke,!0)),2&e&&(c.Gc(i=c.ic())&&(t.sliderHandle=i.first),c.Gc(i=c.ic())&&(t.sliderHandleStart=i.first),c.Gc(i=c.ic())&&(t.sliderHandleEnd=i.first))},inputs:{min:"min",max:"max",orientation:"orientation",tabindex:"tabindex",disabled:"disabled",animate:"animate",step:"step",range:"range",style:"style",styleClass:"styleClass",ariaLabelledBy:"ariaLabelledBy"},outputs:{onChange:"onChange",onSlideEnd:"onSlideEnd"},features:[c.Db([lt])],decls:8,vars:16,consts:[[3,"ngStyle","ngClass","click"],["class","ui-slider-range ui-widget-header ui-corner-all",3,"ngStyle",4,"ngIf"],["class","ui-slider-range ui-slider-range-min ui-widget-header ui-corner-all",3,"ngStyle",4,"ngIf"],["class","ui-slider-handle ui-state-default ui-corner-all ui-clickable",3,"transition","ngStyle","keydown","mousedown","touchstart","touchmove","touchend",4,"ngIf"],["class","ui-slider-handle ui-state-default ui-corner-all ui-clickable",3,"transition","ngStyle","ngClass","keydown","mousedown","touchstart","touchmove","touchend",4,"ngIf"],[1,"ui-slider-range","ui-widget-header","ui-corner-all",3,"ngStyle"],[1,"ui-slider-range","ui-slider-range-min","ui-widget-header","ui-corner-all",3,"ngStyle"],[1,"ui-slider-handle","ui-state-default","ui-corner-all","ui-clickable",3,"ngStyle","keydown","mousedown","touchstart","touchmove","touchend"],["sliderHandle",""],[1,"ui-slider-handle","ui-state-default","ui-corner-all","ui-clickable",3,"ngStyle","ngClass","keydown","mousedown","touchstart","touchmove","touchend"],["sliderHandleStart",""],["sliderHandleEnd",""]],template:function(e,t){1&e&&(c.Yb(0,"div",0),c.hc("click",(function(e){return t.onBarClick(e)})),c.Sc(1,qe,1,4,"span",1),c.Sc(2,Qe,1,4,"span",1),c.Sc(3,et,1,3,"span",2),c.Sc(4,it,1,3,"span",2),c.Sc(5,st,2,11,"span",3),c.Sc(6,ot,2,14,"span",4),c.Sc(7,ct,2,14,"span",4),c.Xb()),2&e&&(c.Gb(t.styleClass),c.sc("ngStyle",t.style)("ngClass",c.Ac(11,rt,t.disabled,"horizontal"==t.orientation,"vertical"==t.orientation,t.animate)),c.Eb(1),c.sc("ngIf",t.range&&"horizontal"==t.orientation),c.Eb(1),c.sc("ngIf",t.range&&"vertical"==t.orientation),c.Eb(1),c.sc("ngIf",!t.range&&"vertical"==t.orientation),c.Eb(1),c.sc("ngIf",!t.range&&"horizontal"==t.orientation),c.Eb(1),c.sc("ngIf",!t.range),c.Eb(1),c.sc("ngIf",t.range),c.Eb(1),c.sc("ngIf",t.range))},directives:[n.w,n.q,n.t],encapsulation:2}),e})(),dt=(()=>{let e=class{};return e.\u0275mod=c.Qb({type:e}),e.\u0275inj=c.Pb({factory:function(t){return new(t||e)},imports:[[n.c]]}),e})();var gt=i("1jcm");const ut=["tvgNeighbors"];function bt(e,t){if(1&e&&(c.Yb(0,"option",14),c.Uc(1),c.Xb()),2&e){const e=t.$implicit,i=c.lc();c.sc("ngValue",i.uomList.indexOf(e)),c.Eb(1),c.Wc(" ",e," ")}}function pt(e,t){if(1&e){const e=c.Zb();c.Yb(0,"div",17),c.hc("click",(function(){c.Kc(e);const i=t.$implicit;return c.lc(2).changeColor(i)})),c.Xb()}2&e&&c.Rc("background-color",t.$implicit)}function ft(e,t){if(1&e&&(c.Yb(0,"div",15),c.Sc(1,pt,1,2,"div",16),c.Xb()),2&e){const e=c.lc();c.Rc("left",e.neighborsColorPickerX,"px")("top",e.neighborsColorPickerY,"px"),c.Eb(1),c.sc("ngForOf",e.availableColors)}}let vt=(()=>{class e{constructor(e,t,i){this.sdaTranslateService=e,this.helpService=t,this.tvgSharedProvider=i,this.propertiesChange=new c.o,this.sizeChange=new c.o,this.colorChange=new c.o,this.uomId=0,this.distance=[0,200],this.displayDistance=[0,20],this.elevation=[0,2e3],this.displayElevation=[-100,100],this.originalDistance=[0,20],this.originalElevation=[-100,100],this.originalDistancePoints=[0,200],this.originalElevationPoints=[0,2e3],this.visible=0,this.size=0,this.convertedSize=0,this.availableColors=["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],this.selectedColor="blue",this.displaySize=0,this.totalNeighbors=0,this.minElevation=0,this.maxElevation=2e3,this.minDistance=0,this.maxDistance=200,this.showColors=!1,this.isDistanceEnabled=!1,this.isElevationEnabled=!1,this.isPositionEnabled=!1,this.isLabelEnabled=!1,this.TVG_UNITS=this.sdaTranslateService.get("TVG_UNITS","Units"),this.TVG_NEIGHBORS_VISIBLE=this.sdaTranslateService.get("TVG_NEIGHBORS_VISIBLE","Visible"),this.TVG_NEIGHBORS_SIZE=this.sdaTranslateService.get("TVG_NEIGHBORS_SIZE","Size"),this.TVG_NEIGHBORS_COLOR=this.sdaTranslateService.get("TVG_NEIGHBORS_COLOR","Color"),this.TVG_NEIGHBORS_DISTANCE=this.sdaTranslateService.get("TVG_NEIGHBORS_DISTANCE","Distance"),this.TVG_NEIGHBORS_ELEVATION=this.sdaTranslateService.get("TVG_NEIGHBORS_ELEVATION","Elevation"),this.TVG_NEIGHBORS_POSITION=this.sdaTranslateService.get("TVG_NEIGHBORS_POSITION","Position"),this.TVG_NEIGHBORS_LABEL=this.sdaTranslateService.get("TVG_NEIGHBORS_LABEL","Label"),this.deltaXY=[],this.helpService.setHandlers(le.e),this.uomList=this.tvgSharedProvider.getUoMList(),this.getUOMDetails()}ngOnInit(){this.setNeighborsProperties(),this.setPopupCoordinates()}handleVisibleChange(e){e&&this.propertiesChange.emit({neighbors:{max:e.value}})}handleShowLabelChange(e){this.isLabelEnabled=e.checked,this.propertiesChange.emit({neighbors:{showLabels:this.isLabelEnabled}})}handleShowPositionChange(e){this.isPositionEnabled=e.checked,this.isPositionEnabled||this.handleShowLabelChange({checked:!1}),this.propertiesChange.emit({neighbors:{showLabels:this.isLabelEnabled,showPosition:this.isPositionEnabled}})}handleSizeChange(e){e&&(this.displaySize=e.value<=50?2*e.value/50:78*(e.value-50)/50+2,this.sizeChange.emit(this.displaySize))}handleDistanceChange(e){e&&(this.displayDistance[0]=+(e.values[0]/10).toFixed(2),this.displayDistance[1]=+(e.values[1]/10).toFixed(2),this.originalDistance=this.displayDistance,this.propertiesChange.emit({units:this.selectedUOM,neighbors:{distance:{min:this.displayDistance[0],max:this.displayDistance[1],enable:!0}}}))}handleElevationChange(e){e&&(this.displayElevation[0]=+(e.values[0]/10-100*this.conversionValue).toFixed(2),this.displayElevation[1]=+(e.values[1]/10-100*this.conversionValue).toFixed(2),this.originalElevation=this.displayElevation,this.propertiesChange.emit({units:this.selectedUOM,neighbors:{elevation:{min:this.displayElevation[0],max:this.displayElevation[1],enable:!0}}}))}onChangeUOM(){this.getUOMDetails(),this.calculateConversion()}colorPicker(){if(this.showColors=!this.showColors,!0===this.showColors){const e=this.tvgNeighbors.nativeElement.getBoundingClientRect();this.neighborsColorPickerX=e.width-309,this.neighborsColorPickerY=e.height-249}}changeColor(e){this.selectedColor=e;const t=e.replace("#",""),i={red:parseInt(t.substring(0,2),16),green:parseInt(t.substring(2,4),16),blue:parseInt(t.substring(4,6),16),alpha:1};this.showColors=!1,this.colorChange.emit(i)}changeElevationState(e){this.isElevationEnabled=e.checked,this.propertiesChange.emit({units:this.selectedUOM,neighbors:{elevation:{min:this.displayElevation[0],max:this.displayElevation[1],enable:this.isElevationEnabled}}})}changeDistanceState(e){this.isDistanceEnabled=e.checked,this.propertiesChange.emit({units:this.selectedUOM,neighbors:{distance:{min:this.displayDistance[0],max:this.displayDistance[1],enable:this.isDistanceEnabled}}})}DragStart(e){this.deltaXY.splice(0),this.deltaXY.push(e.pageX-this.neighborsPopupPosX),this.deltaXY.push(e.pageY-this.neighborsPopupPosY)}DragEnd(e){this.neighborsPopupPosX=e.pageX-this.deltaXY[0],this.neighborsPopupPosY=e.pageY-this.deltaXY[1]}touchDragStart(e){this.deltaXY.splice(0),this.deltaXY.push(e.touches[0].pageX-this.neighborsPopupPosX),this.deltaXY.push(e.touches[0].pageY-this.neighborsPopupPosY)}touchDragEnd(e){this.neighborsPopupPosX=e.changedTouches[0].pageX-this.deltaXY[0],this.neighborsPopupPosY=e.changedTouches[0].pageY-this.deltaXY[1]}sliderTouchEnd(e){e.stopPropagation()}setNeighborsProperties(){this.totalNeighbors=this.viewerProperties.neighbors.all.count,this.displaySize=this.viewerProperties.neighbors.size,this.size=this.displaySize<=2?50*this.displaySize/2:50*(this.displaySize-2)/78+50,this.visible=this.viewerProperties.neighbors.max,this.isPositionEnabled=this.viewerProperties.neighbors.showPosition,this.isLabelEnabled=this.viewerProperties.neighbors.showLabels,this.selectedColor=this.tvgSharedProvider.convertRGBToHex(this.viewerProperties.neighbors.color)}getUOMDetails(){const e=this.tvgSharedProvider.getMeasurementUoM(this.uomId);e&&(this.conversionValue=e.conversionValue,this.selectedUOM=e.shortName)}calculateConversion(){this.displayDistance=[+(this.originalDistance[0]*this.conversionValue).toFixed(2),+(this.originalDistance[1]*this.conversionValue).toFixed(2)],this.displayElevation=[+(this.originalElevation[0]*this.conversionValue).toFixed(2),+(this.originalElevation[1]*this.conversionValue).toFixed(2)],this.minDistance=this.originalDistancePoints[0]*this.conversionValue,this.maxDistance=this.originalDistancePoints[1]*this.conversionValue,this.minElevation=this.originalElevationPoints[0]*this.conversionValue,this.maxElevation=this.originalElevationPoints[1]*this.conversionValue}setPopupCoordinates(){const e=this.tvgNeighbors.nativeElement.getBoundingClientRect(),t=this.parentElement.getBoundingClientRect();this.neighborsPopupPosX=t.width/2-e.width/2,this.neighborsPopupPosY=t.height/2-e.height/2}}return e.\u0275fac=function(t){return new(t||e)(c.Sb(ie.a),c.Sb(ee.a),c.Sb(ke.a))},e.\u0275cmp=c.Mb({type:e,selectors:[["sda-tvg-neighbors"]],viewQuery:function(e,t){var i;1&e&&c.Qc(ut,!0),2&e&&c.Gc(i=c.ic())&&(t.tvgNeighbors=i.first)},inputs:{parentElement:"parentElement",viewerProperties:"viewerProperties"},outputs:{propertiesChange:"propertiesChange",sizeChange:"sizeChange",colorChange:"colorChange"},decls:52,vars:53,consts:[["pDraggable","neighbors",1,"neighbors",3,"onDragStart","onDragEnd","touchstart","touchend"],["tvgNeighbors",""],[1,"neighbors__wrapper"],[1,"neighbors__label"],[1,"neighbors__select",3,"ngModel","ngModelChange","change"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"neighbors__slider",3,"ngModel","min","max","ngModelChange","onChange","touchend"],[1,"neighbors__input",3,"value","readonly"],[1,"neighbors__input",3,"ngModel","readonly"],[1,"neighbors__colorPicker",3,"click"],[1,"neighbors__switch",3,"checked","change"],[1,"neighbors__rangeSlider",3,"ngModel","range","min","max","disabled","ngModelChange","onChange","touchend"],[1,"neighbors__input",3,"ngModel","readonly","ngModelChange"],["class","neighbors__colorSelector",3,"left","top",4,"ngIf"],[3,"ngValue"],[1,"neighbors__colorSelector"],["class","neighbors__color",3,"background-color","click",4,"ngFor","ngForOf"],[1,"neighbors__color",3,"click"]],template:function(e,t){1&e&&(c.Yb(0,"div",0,1),c.hc("onDragStart",(function(e){return t.DragStart(e)}))("onDragEnd",(function(e){return t.DragEnd(e)}))("touchstart",(function(e){return t.touchDragStart(e)}))("touchend",(function(e){return t.touchDragEnd(e)})),c.Yb(2,"div",2),c.Yb(3,"label",3),c.Uc(4),c.Xb(),c.Yb(5,"select",4),c.hc("ngModelChange",(function(e){return t.uomId=e}))("change",(function(){return t.onChangeUOM()})),c.Sc(6,bt,2,2,"option",5),c.Xb(),c.Xb(),c.Yb(7,"div",2),c.Yb(8,"label",3),c.Uc(9),c.Xb(),c.Xb(),c.Yb(10,"div",2),c.Yb(11,"p-slider",6),c.hc("ngModelChange",(function(e){return t.visible=e}))("onChange",(function(e){return t.handleVisibleChange(e)}))("touchend",(function(e){return t.sliderTouchEnd(e)})),c.Xb(),c.Tb(12,"input",7),c.Xb(),c.Yb(13,"div",2),c.Yb(14,"label",3),c.Uc(15),c.Xb(),c.Xb(),c.Yb(16,"div",2),c.Yb(17,"p-slider",6),c.hc("ngModelChange",(function(e){return t.size=e}))("onChange",(function(e){return t.handleSizeChange(e)}))("touchend",(function(e){return t.sliderTouchEnd(e)})),c.Xb(),c.Tb(18,"input",8),c.Xb(),c.Yb(19,"div",2),c.Yb(20,"label",3),c.Uc(21),c.Xb(),c.Yb(22,"div",9),c.hc("click",(function(){return t.colorPicker()})),c.Xb(),c.Xb(),c.Yb(23,"div",2),c.Yb(24,"label",3),c.Uc(25),c.Xb(),c.Yb(26,"mat-slide-toggle",10),c.hc("change",(function(e){return t.changeDistanceState(e)})),c.Xb(),c.Xb(),c.Yb(27,"div",2),c.Yb(28,"p-slider",11),c.hc("ngModelChange",(function(e){return t.distance=e}))("onChange",(function(e){return t.handleDistanceChange(e)}))("touchend",(function(e){return t.sliderTouchEnd(e)})),c.Xb(),c.Yb(29,"input",12),c.hc("ngModelChange",(function(e){return t.displayDistance[0]=e})),c.Xb(),c.Yb(30,"label"),c.Uc(31,"-"),c.Xb(),c.Yb(32,"input",12),c.hc("ngModelChange",(function(e){return t.displayDistance[1]=e})),c.Xb(),c.Xb(),c.Yb(33,"div",2),c.Yb(34,"label",3),c.Uc(35),c.Xb(),c.Yb(36,"mat-slide-toggle",10),c.hc("change",(function(e){return t.changeElevationState(e)})),c.Xb(),c.Xb(),c.Yb(37,"div",2),c.Yb(38,"p-slider",11),c.hc("ngModelChange",(function(e){return t.elevation=e}))("onChange",(function(e){return t.handleElevationChange(e)}))("touchend",(function(e){return t.sliderTouchEnd(e)})),c.Xb(),c.Yb(39,"input",12),c.hc("ngModelChange",(function(e){return t.displayElevation[0]=e})),c.Xb(),c.Yb(40,"label"),c.Uc(41,"-"),c.Xb(),c.Yb(42,"input",12),c.hc("ngModelChange",(function(e){return t.displayElevation[1]=e})),c.Xb(),c.Xb(),c.Yb(43,"div",2),c.Yb(44,"label",3),c.Uc(45),c.Xb(),c.Yb(46,"mat-slide-toggle",10),c.hc("change",(function(e){return t.handleShowPositionChange(e)})),c.Xb(),c.Xb(),c.Yb(47,"div",2),c.Yb(48,"label",3),c.Uc(49),c.Xb(),c.Yb(50,"mat-slide-toggle",10),c.hc("change",(function(e){return t.handleShowLabelChange(e)})),c.Xb(),c.Xb(),c.Sc(51,ft,2,5,"div",13),c.Xb()),2&e&&(c.Rc("left",t.neighborsPopupPosX,"px")("top",t.neighborsPopupPosY,"px"),c.Eb(4),c.Vc(t.TVG_UNITS),c.Eb(1),c.sc("ngModel",t.uomId),c.Eb(1),c.sc("ngForOf",t.uomList),c.Eb(3),c.Vc(t.TVG_NEIGHBORS_VISIBLE),c.Eb(2),c.sc("ngModel",t.visible)("min",0)("max",t.totalNeighbors),c.Eb(1),c.tc("value",t.visible+"/"+t.totalNeighbors),c.sc("readonly",!0),c.Eb(3),c.Vc(t.TVG_NEIGHBORS_SIZE),c.Eb(2),c.sc("ngModel",t.size)("min",0)("max",100),c.Eb(1),c.sc("ngModel",t.displaySize)("readonly",!0),c.Eb(3),c.Vc(t.TVG_NEIGHBORS_COLOR),c.Eb(1),c.Rc("background-color",t.selectedColor),c.Eb(3),c.Vc(t.TVG_NEIGHBORS_DISTANCE),c.Eb(1),c.sc("checked",t.isDistanceEnabled),c.Eb(2),c.Ib("neighbors__rangeSlider--disabled",!t.isDistanceEnabled),c.sc("ngModel",t.distance)("range",!0)("min",t.minDistance)("max",t.maxDistance)("disabled",0==t.isDistanceEnabled),c.Eb(1),c.sc("ngModel",t.displayDistance[0])("readonly",!0),c.Eb(3),c.sc("ngModel",t.displayDistance[1])("readonly",!0),c.Eb(3),c.Vc(t.TVG_NEIGHBORS_ELEVATION),c.Eb(1),c.sc("checked",t.isElevationEnabled),c.Eb(2),c.Ib("neighbors__rangeSlider--disabled",!t.isElevationEnabled),c.sc("ngModel",t.elevation)("range",!0)("min",t.minElevation)("max",t.maxElevation)("disabled",0==t.isElevationEnabled),c.Eb(1),c.sc("ngModel",t.displayElevation[0])("readonly",!0),c.Eb(3),c.sc("ngModel",t.displayElevation[1])("readonly",!0),c.Eb(3),c.Vc(t.TVG_NEIGHBORS_POSITION),c.Eb(1),c.sc("checked",t.isPositionEnabled),c.Eb(3),c.Vc(t.TVG_NEIGHBORS_LABEL),c.Eb(1),c.sc("checked",t.isLabelEnabled),c.Eb(1),c.sc("ngIf",t.showColors))},directives:[l,s.B,s.p,s.s,n.s,ht,s.c,gt.a,n.t,s.u,s.E],styles:[".neighbors[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:column;border-radius:15px;border:2px solid #00608f;background-color:hsla(0,0%,100%,.9);padding:15px;z-index:100!important}.neighbors[_ngcontent-%COMP%]     .ui-slider{background-color:#a9b4be}.neighbors[_ngcontent-%COMP%]     .ui-slider-range{background-color:#00608f}.neighbors[_ngcontent-%COMP%]     .uxt-switch--inactive .uxt-switch-core__track{background-color:#a9b4be}.neighbors__select[_ngcontent-%COMP%]{height:26px;margin-left:auto}.neighbors__label[_ngcontent-%COMP%]{line-height:1.7;font-size:18px;width:auto;margin-right:30px}.neighbors__wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}.neighbors__slider[_ngcontent-%COMP%]{width:224px;margin-right:5px}.neighbors__rangeSlider[_ngcontent-%COMP%]{width:160px;margin-right:5px}.neighbors__rangeSlider--disabled[_ngcontent-%COMP%]{pointer-events:none}.neighbors__switch[_ngcontent-%COMP%]{margin-left:auto}.neighbors__input[_ngcontent-%COMP%]{font-size:12px;width:60px;height:20px;text-align:center;margin-left:auto}.neighbors__colorSelector[_ngcontent-%COMP%]{position:absolute;display:flex;flex-flow:row wrap;width:290px;border:1px solid #00608f;background-color:#fff;z-index:100!important}.neighbors__color[_ngcontent-%COMP%]{width:20px;height:20px;margin:2px;border:1px solid #00608f;cursor:pointer}.neighbors__colorPicker[_ngcontent-%COMP%]{width:30px;height:30px;margin-top:7px;margin-left:auto;border:2px solid #0087c8}"]}),e})();const mt=["tvgContainer"],Tt=["powerBar"],St=["geoTag"];function _t(e,t){if(1&e){const e=c.Zb();c.Yb(0,"sda-tag-details",14),c.hc("detailsShrink",(function(t){return c.Kc(e),c.lc().tagDetailsShrink(t)})),c.Xb()}if(2&e){const e=c.lc();c.sc("selectedTagName",e.selectedTagName)("selectedTagOBID",e.selectedTagOBID)("config",e.config)}}function Et(e,t){if(1&e){const e=c.Zb();c.Yb(0,"sda-hotspot-bubble",15),c.hc("toggleActionsMenu",(function(){return c.Kc(e),c.lc().toggleTagActionsMenu()}))("deleteTag",(function(t){return c.Kc(e),c.lc().deleteGeoTag(t)}))("detailsExpand",(function(t){return c.Kc(e),c.lc().tagDetailsExpand(t)})),c.Xb()}if(2&e){const e=c.lc();c.sc("bubbleText",e.bubbleText)("bubblePositionX",e.bubblePositionX)("bubblePositionY",e.bubblePositionY)("isMenuActive",e.isMenuActive)("showDelete",e.showDelete)("showActionsMenuButton",e.isConnectedTag)("showDetailsButton",e.isConnectedTag)("showPinButton",e.isConnectedTag)("selectedObject",e.selectedBubbleTag)}}function wt(e,t){if(1&e&&c.Tb(0,"sda-tvg-mesurement",16),2&e){const e=c.lc(),t=c.Hc(5);c.sc("measurementPopupPosX",e.measurementPopupPosX)("measurementPopupPosY",e.measurementPopupPosY)("requiredPickPoints",e.requiredPickPoints)("pickPointCollection",e.pickPointCollection)("parentElement",t)}}function Ct(e,t){if(1&e){const e=c.Zb();c.Yb(0,"sda-tvg-neighbors",17),c.hc("propertiesChange",(function(t){return c.Kc(e),c.lc().setNeighborProperties(t)}))("sizeChange",(function(t){return c.Kc(e),c.lc().setNeighborSize(t)}))("colorChange",(function(t){return c.Kc(e),c.lc().setNeighborColor(t)})),c.Xb()}if(2&e){const e=c.lc(),t=c.Hc(5);c.sc("viewerProperties",e.viewerProperties)("parentElement",t)}}function Ot(e,t){if(1&e){const e=c.Zb();c.Yb(0,"sda-tvg-geotag",18,19),c.hc("closeGeoTag",(function(t){return c.Kc(e),c.lc().closeGeoTagPanel(t)}))("zoomToTag",(function(t){return c.Kc(e),c.lc().zoomToTag(t)}))("addSelectedTag",(function(t){return c.Kc(e),c.lc().addGeotagToScan(t)}))("panelWidthOnResize",(function(t){return c.Kc(e),c.lc().OnGeoTagPanelResize(t)}))("resizeBarGrabChange",(function(t){return c.Kc(e),c.lc().isResizeBarGrabOn(t)})),c.Xb()}if(2&e){const e=c.lc();c.sc("tagInterfaceDef",e.tagInterfaceDef)("currentScanOBID",e.selectedScan.ScanOBID)}}const Pt=function(e){return{width:e}};let Dt=(()=>{class e{constructor(e,t,i,n,s,a,o,c,r,l,h,d,g,u,b,p,f,v,m,T,S,_,E,w,C,O,P){this.router=e,this.sdaTranslateService=t,this.truviewService=i,this.tvgSiteService=n,this.route=s,this.modalService=a,this.exceptionService=o,this.applicationSettingsService=c,this.guidService=r,this.actionMenuProvider=l,this.contentMenuService=h,this.loadingOverlayService=d,this.dataRefreshService=g,this.featureSetService=u,this.crudService=b,this.locationService=p,this.timeOutService=f,this.helpService=v,this.notificationService=m,this.configService=T,this.documentService=S,this.zone=_,this.componentFactoryResolver=E,this.injector=w,this.featureSetNavigationService=C,this.methodService=O,this.embeddedSnapshotService=P,this.TVG_SCANS=this.sdaTranslateService.get("TVG_SCANS","Select a Scan to View"),this.TVG_TAGS=this.sdaTranslateService.get("TVG_TAGS","Select a Pinned Tag to Add"),this.TVG_SITEMAP=this.sdaTranslateService.get("TVG_SITEMAP","Site Map"),this.TVG_TAG_NOT_EXIST=this.sdaTranslateService.get("TVG_TAG_NOT_EXIST","Tag doesnot exist in the TruView Server"),this.TVG_TAG_NOT_EXIST_DB=this.sdaTranslateService.get("TVG_TAG_NOT_EXIST_DB","Tag does not exist in the Database"),this.TVG_LOADING_SCAN=this.sdaTranslateService.get("TVG_LOADING_SCAN","Loading Scan "),this.TVG_INITIALIZING_SCAN=this.sdaTranslateService.get("TVG_INITIALIZING_SCAN","Initializing Scan"),this.TVG_TAGS_SEARCH_WATERMARK=this.sdaTranslateService.get("TVG_TAGS_SEARCH_WATERMARK","Search for tags"),this.TVG_SCAN_TITLE=this.sdaTranslateService.get("TVG_SCAN_TITLE","Scan : "),this.TVG_TAG_TITLE=this.sdaTranslateService.get("TVG_TAG_TITLE","Tag : "),this.CLOSE_TEXT=this.sdaTranslateService.get("CLOSE","Close"),this.TITLE_TEXT=this.sdaTranslateService.get("LEICA_SERVER_INFORMATION","Leica TruView Server Information"),this.SERVER_VERSION_TITLE=this.sdaTranslateService.get("SERVER_VERSION_TITLE","Version"),this.SERVER_URL_TITLE=this.sdaTranslateService.get("SERVER_URL_TITLE","Url"),this.TVG_DELETE_HOT_LINK=this.sdaTranslateService.get("TVG_DELETE_HOT_LINK","Delete HotLink"),this.TVG_DELETE_GEO_TAG=this.sdaTranslateService.get("TVG_DELETE_GEO_TAG","Do you want to delete the GeoTag HotLink?"),this.TVG_DELETE_SUCCESS=this.sdaTranslateService.get("TVG_DELETE_SUCCESS","Successfully deleted the HotLink"),this.TVG_DELETE_FAILURE=this.sdaTranslateService.get("TVG_DELETE_FAILURE","Failed to delete the HotLink"),this.TVG_INVALID_PARAM=this.sdaTranslateService.get("TVG_INVALID_PARAM","Invalid argument provided for the DeleteConnectedGeoTag, Please contact administrator"),this.TVG_SCAN_TAG_TERMINATE_REL_SUCCESS=this.sdaTranslateService.get("TVG_SCAN_TAG_TERMINATE_REL_SUCCESS","Tag and Scan Relationship successfully terminated"),this.tvgViewer=void 0,this.isScanShown=!1,this.siteName="",this.selectedScanTags={},this.leftPowerBarControls=new Array,this.rightPowerBarControls=new Array,this.accessToken="",this.tagInterfaceDef="",this.initialized=!1,this.showBubble=!1,this.isMenuActive=!1,this.isConnectedTag=!1,this.showDelete=!1,this.isEditMode=!1,this.showTagDetails=!1,this.config="",this.isEditorRole=!1,this.currentScanTagDictionary={},this.isTagSelected=!1,this.tagLabelsDictionary={},this.isMeasurementsActive=!1,this.isNeighborsActive=!1,this.isMiniMapActive=!1,this.isVersionInfoBtnActive=!1,this.showVersionInfoDiv=!1,this.isGeotagPanelActive=!1,this.isResizeBarGrabbed=!1,this.authenticationApproachList=[],this.destroyCalled=!1,this.isScanClicked=!1,this.layerInfo={},this.initialGeoTagPanelWidth=256,this.sideBarWidth=44,this.resizeBarWidth=10,this.helpService.setHandlers(le.c),this.itemsRemovedSubscription=this.dataRefreshService.itemsRemoved$.subscribe(e=>this.processPostDelete(e))}ngOnInit(){this.loadingOverlayService.showLoadingOverlay(),this.getDataFromRouteAndViewScan().subscribe()}ngAfterViewInit(){if(this.tvgContainer&&this.tvgContainer.nativeElement){const e=this.tvgContainer.nativeElement.getBoundingClientRect();e&&(this.bubblePositionX=e.width/2,this.bubblePositionY=e.height/2)}}ngOnDestroy(){this.showBubble=!1,this.actionMenuProvider.clearAndCloseActionsMenu(),this.itemsRemovedSubscription.unsubscribe(),this.showTagDetails=!1,this.destroyCalled=!0,this.tvgViewer&&this.tvgViewer.dispose(),this.snapshotRemote&&this.snapshotRemote.dispose()}scanClicked(e){return this.isScanClicked||("tag"===e.type?(this.bubbleText=void 0,this.showGeoTagBubble(e).subscribe()):(this.isScanClicked=!0,this.showBubble=!1,this.showTagDetails=!1,this.isNeighborsActive=!1,this.isGeotagPanelActive=!1,this.actionMenuProvider.clearAndCloseActionsMenu(),this.loadingOverlayService.showLoadingOverlay(this.TVG_INITIALIZING_SCAN),"Tag"===this.objectType&&(this.objectType="Scan"),this.initialized=!1,e&&e.guid?this.navigateToNeighborScan(e.name):this.isScanClicked=!1)),!1}viewerInit(e){this.tvgViewer&&(this.tvgViewer.dispose(),this.tvgViewer=void 0,this.currentScanTagDictionary={}),this.truviewService.viewerControl(e).then(e=>{if(this.destroyCalled)e&&e.dispose();else{if(this.tvgViewer=e,this.selectedScan=this.selectedTruviewSiteDetails.ScanDetails.filter(e=>e.ScanID===this.selectedScanId)[0],this.tvgViewer.mouseClick(e=>this.zone.run(()=>this.scanClicked(e)),!0),this.tvgViewer.loadProgres(e=>this.zone.run(()=>this.loadingViewer(e)),!0),this.initialisePowerBar(),this.tvgViewer.geotags)for(const[e,t]of Object.entries(this.tvgViewer.geotags))this.tagLabelsDictionary[t.label]=e;"Scan"===this.objectType&&this.applicationSettingsService.setPageTitle(this.TVG_SCAN_TITLE+this.selectedScan.Scan),this.snapshotRemote=this.embeddedSnapshotService.initializeSnapshotHandler(()=>this.takeSnapshot()),this.snapshotRemote&&this.snapshotRemote.ready(!0)}},e=>{this.loadingOverlayService.hideLoadingOverlay(),this.locationService.back(),this.exceptionService.handleException(e)}).catch(e=>{throw this.loadingOverlayService.hideLoadingOverlay(),new L.a(e)})}loadingViewer(e){100===e?(this.tvgViewer.loadProgres(this.loadingViewer.bind(this),!1),this.viewerProperties=this.tvgViewer.getProps(),this.isScanClicked=!1,"Tag"===this.objectType&&this.tvgViewer.geotags&&this.timeOutService.setTimeout(()=>{this.tvgViewer.cameraFocusOnGeotag(this.tagLabelsDictionary[this.selectedTagName]),this.tvgViewer.selectGeotag(this.tagLabelsDictionary[this.selectedTagName]),this.applicationSettingsService.setPageTitle(this.TVG_TAG_TITLE+this.selectedTagName)},1e3),this.loadingOverlayService.hideLoadingOverlay()):this.loadingOverlayService.showLoadingOverlay(this.TVG_LOADING_SCAN+Math.ceil(e)+"%")}onTruViewMouseMove(e){this.isResizeBarGrabbed||e.stopPropagation()}initialisePowerBar(){this.leftPowerBarControls=new Array,this.rightPowerBarControls=new Array,this.truviewActionButtons=new Array;const e=new j.a(()=>{this.showBubble=!1,this.showTagDetails=!1,this.actionMenuProvider.clearAndCloseActionsMenu(),this.navigateToSite()},this.TVG_SITEMAP,"fa-chevron-left power-bar-button__icon");this.leftPowerBarControls.push(e),this.leftPowerBarControls.push(new K.a),this.powerBarAutoComplete=new z.a(e=>this.getTagSuggestions(e),e=>this.zoomToTag(e),e=>this.zoomToTag(e),this.TVG_TAGS_SEARCH_WATERMARK),this.leftPowerBarControls.push(this.powerBarAutoComplete),this.leftPowerBarControls.push(new K.a);const t=new j.a(()=>this.disablePickpoint(),"","fa-mouse-pointer power-bar-button__icon");if(t.tooltip=this.sdaTranslateService.get("TVG_SELECT","Select"),this.leftPowerBarControls.push(t),this.isEditorRole){const e=new j.a(()=>{this.highlightSelectedBtn(0),this.clickViewer()},"","fa-tags power-bar-button__icon");e.tooltip=this.sdaTranslateService.get("TVG_ADD_GEOTAG","Add GeoTag"),this.truviewActionButtons.push(e),this.leftPowerBarControls.push(e)}this.leftPowerBarControls.push(new K.a);let i=new j.a(()=>{this.highlightSelectedBtn(1),this.requiredPickPoints=2,this.takeMeasurement()},"","fa-arrows-h power-bar-button__icon");i.tooltip=this.sdaTranslateService.get("TVG_LINEAR_MEASUREMENT","Linear Measurement"),this.truviewActionButtons.push(i);const n=new H.a(U.a.Horizontal);n.controls.push(i),i=new j.a(()=>{this.highlightSelectedBtn(2),this.requiredPickPoints=3,this.takeMeasurement()},"","fa-chevron-down power-bar-button__icon"),i.tooltip=this.sdaTranslateService.get("TVG_ANGULAR_MEASUREMENT","Angular Measurement"),this.truviewActionButtons.push(i),n.controls.push(i),i=new j.a(()=>{this.highlightSelectedBtn(3),this.requiredPickPoints=1,this.takeMeasurement()},"","fa-dot-circle-o power-bar-button__icon"),i.tooltip=this.sdaTranslateService.get("TVG_POINT_MEASUREMENT","Point Measurement"),this.truviewActionButtons.push(i),n.controls.push(i),this.leftPowerBarControls.push(n),this.leftPowerBarControls.push(new K.a);const s=new j.a(()=>{this.isNeighborsActive||this.highlightSelectedBtn(4),this.getNeighbors()},"","fa-map-marker power-bar-button__icon");s.tooltip=this.sdaTranslateService.get("TVG_NEIGHBORS","Neighbors"),this.truviewActionButtons.push(s);const a=new H.a(U.a.Horizontal);a.controls.push(s);const o=new j.a(()=>{this.isMiniMapActive?this.hideMiniMap():this.showMiniMap()},"","fa-eye power-bar-button__icon");this.truviewHideMapButton=o,o.tooltip=this.sdaTranslateService.get("TVG_MINI_MAP","Mini Map"),a.controls.push(o),this.leftPowerBarControls.push(a),this.leftPowerBarControls.push(new K.a);const c=new W.a(this.sdaTranslateService.get("TVG_LAYERS","Layers"));this.getLayers();const r={selectedItemOBID:this.tvgViewer.dataset,items:this.layers.map(e=>new ne.a(e,e,e,this.layerInfo[e]))},l=new F.a(r,e=>{this.setLayers(e)});l.tooltip=this.sdaTranslateService.get("TVG_ALL_LAYERS","View Layers");const h=new H.a(U.a.Horizontal);h.controls.push(c),h.controls.push(l),this.leftPowerBarControls.push(h);const d=new j.a(()=>{this.isVersionInfoBtnActive||this.highlightSelectedBtn(5),this.displayVersionInfo()},"","fa-info-circle power-bar-button__icon");d.tooltip=this.sdaTranslateService.get("LEICA_SERVER_INFORMATION","Leica Truview Server Information"),this.rightPowerBarControls.push(d),this.truviewActionButtons.push(d),this.powerBar.resizeToFit()}navigateToSite(){this.router.navigate(["/tvgSiteView"],{queryParams:{siteDetails:JSON.stringify(this.selectedTruviewSiteDetails),config:JSON.stringify(this.config)},relativeTo:this.route}).catch(e=>{this.exceptionService.handleException(e)})}clickViewer(){this.showTagDetails=!1,this.isMeasurementsActive=!1,this.isNeighborsActive=!1,this.isEditMode=!0,this.isGeotagPanelActive=!this.isGeotagPanelActive,this.isGeotagPanelActive?this.isResizeBarActive()&&(this.geoTagPanelWidth=this.geoTagPanelWidth+this.resizeBarWidth):(this.geoTagPanelWidth=this.initialGeoTagPanelWidth+this.sideBarWidth,this.disablePickpoint())}disablePickpoint(){this.isEditMode&&this.resetPickingMode(),this.isNeighborsActive=!1,this.isGeotagPanelActive||this.resetTruViewActionBtnsStyle()}viewScan(){return this.tvgSiteService.getAccessToken(this.selectedTruviewSiteDetails.ServerOBID).pipe(Object(E.a)(e=>e?e.GenerateAuthorizationCode?(this.loadingOverlayService.hideLoadingOverlay(),this.tvgSiteService.authorizeAndGetAccessToken(e,this.selectedTruviewSiteDetails.ServerOBID)):Object(S.a)(e):Object(S.a)(void 0)),Object(w.a)(e=>{e&&e.AccessToken&&(this.loadingOverlayService.showLoadingOverlay(),this.setServerDetailsAndView(e))}),Object(C.a)(e=>(this.exceptionService.handleException(e),Object(S.a)(void 0))))}OnGeoTagPanelResize(e){this.isResizeBarActive()&&(e+=this.resizeBarWidth),this.geoTagPanelWidth=e+this.sideBarWidth}isResizeBarGrabOn(e){this.isResizeBarGrabbed=e}setServerDetailsAndView(e){this.accessToken=e.AccessToken,this.tagInterfaceDef=e.TagInterfaceDef,this.tvgTagClassDef=e.TagClassDef,this.initialized=!1;const t=this.selectedTruviewSiteDetails.IsHostSecure?"https://":"http://";this.serverVersion=e.ServerVersion,this.serverUrl=t+e.HostName;const i={scanid:this.selectedScanId,id:this.guidService.getGuid(),server:t+this.selectedTruviewSiteDetails.Host,sidebar:!1,containerid:"tvg-container",access:this.accessToken};this.viewerInit(i)}toggleTagActionsMenu(){if(this.selectedTagOBID)if(this.actionsMenuContainsOBID(this.selectedTagOBID))this.contentMenuService.showActionsMenu(!0);else{const e={OBID:this.selectedTagOBID};this.actionMenuProvider.clearItems(),this.actionMenuProvider.addItem(new ne.a(this.selectedTagOBID,this.selectedTagName,this.config,void 0,void 0,e)),this.contentMenuService.showActionsMenu()}}actionsMenuContainsOBID(e){return!!this.actionMenuProvider.getItems().find(t=>t.obid===e)}onTruViewKeyUp(e){e.keyCode===ae.c&&(this.showBubble=!1)}tagDetailsExpand(e){this.selectedTagName&&(this.showTagDetails=!0)}deleteGeoTag(e){this.isConnectedTag&&this.canDelConnectedTag?this.methodService.getMethodByUID("MTH_DeleteConnectedGeoTag").pipe(Object(E.a)(e=>e&&e.SPFArgument1&&e.SPFArgument1.length>0?(this.paramMethodObject=void 0,this.getMethodAndCheckAccess(e.SPFArgument1)):this.showDeleteHotLinkPopUp()),Object(E.a)(e=>this.paramMethodObject?e?this.openDeleteGeoTagModal():this.showDeleteHotLinkPopUp():Object(S.a)(void 0))).subscribe():this.showDeleteHotLinkPopUp().subscribe()}tagDetailsShrink(e){this.preventDefaultForTouch(e),this.showTagDetails=!1}moveScan(e){this.resetButtonsAndPopups(),this.setupBubblePosition(e.touches[0].pageX,e.touches[0].pageY),this.isTagSelected=!0,this.powerBar.overlay.open&&this.powerBar.overlay.toggle()}onTruViewMouseWheel(e){this.showBubble=!1,e.stopPropagation()}onTruViewMouseDown(e){this.resetButtonsAndPopups(),this.setupBubblePosition(e.pageX,e.pageY),this.isTagSelected=!0,e.stopPropagation()}onTruViewMouseUp(e){this.isResizeBarGrabbed||e.stopPropagation()}addGeotagToScan(e){this.selectedTag=e,this.selectedTagOBID=e.obid,this.selectedTagName=e.name,this.tvgViewer.pickPoint(this.createGeoTag.bind(this))}createGeoTag(e,t){e?this.modalService.alert(e.message):this.addGeoTagToLaserScan(this.selectedTag,t.point)}zoomToTag(e){if(e&&e.length>0)if(this.tagLabelsDictionary){let t;Object.keys(this.tagLabelsDictionary).forEach(i=>{i.toLowerCase()===e.toLowerCase()&&(t=this.tagLabelsDictionary[i])}),t?(this.showBubble=!1,this.showTagDetails=!1,this.isMeasurementsActive&&(this.resetPickingMode(),this.resetTruViewActionBtnsStyle()),this.actionMenuProvider.clearAndCloseActionsMenu(),this.tvgViewer.cameraFocusOnGeotag(t),this.tvgViewer.selectGeotag(t),this.applicationSettingsService.setPageTitle(this.TVG_TAG_TITLE+e)):this.modalService.alert(this.sdaTranslateService.get("TVG_TAG_NOT_EXIST","Tag does not exist in the TruView Server"))}else this.modalService.alert(this.sdaTranslateService.get("TVG_TAG_NOT_EXIST","Tag does not exist in the TruView Server"))}closeGeoTagPanel(e){e||this.clickViewer()}addTagtoCurrentScan(e,t){if(e)this.modalService.alert(e.message);else{this.resetPickingMode(),this.tvgViewer.cameraFocusOnGeotag(t.name);const e=new A.a(this.tvgTagClassDef);e.interfaces.push(new y.a("ILScanGeoTag",!0)),e.relationships.push(new B.a("LScanScanGeoTags",!1,[this.selectedScan.ScanOBID])),this.crudService.update(this.selectedTagOBID,e,!0).subscribe(e=>{-1===Object.keys(this.currentScanTagDictionary).indexOf(this.selectedScan.ScanOBID)&&(this.currentScanTagDictionary[this.selectedScan.ScanOBID]={}),this.tagLabelsDictionary[t.label]=t.name,this.currentScanTagDictionary[this.selectedScan.ScanOBID][t.label]=this.selectedTagOBID,this.isGeotagPanelActive&&this.geotagComp&&this.geotagComp.refreshTagList(t.label)},e=>{this.exceptionService.handleException(e)})}return!1}collectPickpoints(e,t){if(e)return this.tvgViewer.pickPoints(this.collectPickpoints.bind(this),!1);{const e=t.point;return this.pickPointCollection.push({X:+e[0],Y:+e[1],Z:+e[2]}),this.pickPointCollection.length===this.requiredPickPoints?(this.zone.run(()=>{this.isMeasurementsActive=!0}),!1):this.tvgViewer.pickPoints(this.collectPickpoints.bind(this),!1)}}setNeighborProperties(e){this.tvgViewer.setProps(e,!0),this.viewerProperties=this.tvgViewer.getProps()}setNeighborSize(e){this.tvgViewer.setMarkerScaleFactor(e),this.viewerProperties=this.tvgViewer.getProps()}setNeighborColor(e){this.tvgViewer.setMarkerColor(e.red,e.green,e.blue,e.alpha,!0),this.tvgViewer.setProps({neighbors:{color:e}},!0),this.viewerProperties=this.tvgViewer.getProps()}setGeoTagPanelMinWidth(){const e=this.initialGeoTagPanelWidth+this.sideBarWidth;this.isGeotagPanelActive&&(this.isResizeBarActive()?this.geoTagPanelWidth===e&&(this.geoTagPanelWidth=e+this.resizeBarWidth):(this.geoTagPanelWidth=e,this.geotagComp&&(this.geotagComp.geotagPanelWidth=this.initialGeoTagPanelWidth)))}displayVersionInfo(){this.isVersionInfoBtnActive&&this.resetTruViewActionBtnsStyle(),this.isVersionInfoBtnActive=!this.isVersionInfoBtnActive,this.showVersionInfoDiv=this.isVersionInfoBtnActive}onResize(){this.showBubble=!1}openDeleteGeoTagModal(){const e=new R.a(this.TVG_DELETE_GEO_TAG,be,this.componentFactoryResolver,this.injector),t=this.paramMethodObject.SPFClientAPIMethods_21.Name;return Object(_.a)(this.modalService.showModal(e)).pipe(Object(E.a)(e=>{if(e){if(e.getData()){const e=[new ne.a(this.selectedTagOBID,"",this.config)],i=this.methodService.transformToFeature(this.paramMethodObject.SPFGUIDisplayAs,this.paramMethodObject.Name,t,this.paramMethodObject);return i.objects=e,this.featureSetNavigationService.navigateToFeature(i,!1),this.deleteHotLink()}return this.deleteHotLink()}return Object(S.a)(!1)}),Object(C.a)(e=>(this.exceptionService.handleException(new L.a(e)),Object(S.a)(!1))))}showDeleteHotLinkPopUp(){return Object(_.a)(this.modalService.confirm(this.TVG_DELETE_HOT_LINK,this.TVG_DELETE_GEO_TAG)).pipe(Object(E.a)(e=>e?this.deleteHotLink():Object(S.a)(!1)))}deleteHotLink(){return this.tvgViewer.removeGeotag(this.tagLabelsDictionary[this.selectedTagName],this.removeGeotagCB.bind(this)),Object(S.a)(!0)}removeGeotagCB(e,t){e?this.notificationService.error(this.TVG_DELETE_FAILURE):(this.selectedTagOBID&&(this.processPostDelete([this.selectedTagOBID]),this.crudService.unrelate(this.selectedTagOBID,this.selectedScan.ScanOBID,"LScanScanGeoTags",!1,!0).subscribe(()=>{this.notificationService.success(this.TVG_SCAN_TAG_TERMINATE_REL_SUCCESS)})),this.zone.run(()=>{this.showBubble=!1}),this.notificationService.success(this.TVG_DELETE_SUCCESS))}getTagSuggestions(e){this.suggestedTags=new Array;const t=Settings.application.defaultPageSize;return this.tvgSiteService.getMatchingTags(e+="*",this.selectedScan.ScanOBID,this.config,t).pipe(Object(O.a)(e=>{const t=new Array,i=e.value[0].LScanScanGeoTags_12;return i&&i.length>0&&(-1===Object.keys(this.currentScanTagDictionary).indexOf(this.selectedScan.ScanOBID)&&(this.currentScanTagDictionary[this.selectedScan.ScanOBID]={}),i.forEach(e=>{t.push(e.Name),this.currentScanTagDictionary[this.selectedScan.ScanOBID][e.Name]=e.OBID})),Object(S.a)(t)}))}setupLScanViewScan(e,t){return this.objectType="Scan",this.getScanInfo(t||this.objects[0].config,e,e?void 0:this.objects[0].obid).pipe(Object(E.a)(e=>e&&e.length>0?(this.selectedScanName=e[0].ScanDetails[0].Scan,this.truviewSiteDetails=e,this.selectedTruviewSiteDetails=e[0],this.selectedScanId=this.selectedTruviewSiteDetails.ScanDetails[0].ScanID,this.viewScan()):Object(S.a)(void 0)),Object(C.a)(e=>(this.loadingOverlayService.hideLoadingOverlay(),this.exceptionService.handleException(new L.a(e.message)),this.locationService.back(),Object(S.a)(void 0))))}getScanInfo(e,t,i){return i?this.tvgSiteService.getScanInfoByOBID(e,i):t?this.tvgSiteService.getScanInfoByName(e,t):Object(S.a)(void 0)}preventDefaultForTouch(e){"touchstart"===e.type.toLowerCase()&&e.preventDefault()}checkIfTagExists(e){return Object.keys(this.currentScanTagDictionary).indexOf(this.selectedScan.ScanOBID)>-1&&Object.keys(this.currentScanTagDictionary[this.selectedScan.ScanOBID]).indexOf(e)>-1?(this.selectedTagOBID=this.currentScanTagDictionary[this.selectedScan.ScanOBID][e],this.selectedTagName=e,Object(S.a)(!0)):this.tvgSiteService.getMatchingTags(e,this.selectedScan.ScanOBID,this.config,1).pipe(Object(O.a)(t=>{const i=t.value[0].LScanScanGeoTags_12;return i&&i.length>0?(this.selectedTagName=e,this.selectedTagOBID=i[0].OBID,this.currentScanTagDictionary[this.selectedScan.ScanOBID]={},this.currentScanTagDictionary[this.selectedScan.ScanOBID][e]=i[0].OBID,Object(S.a)(!0)):Object(S.a)(!1)}))}isTagEditor(){this.config===this.configService.selectedCreateConfig&&this.featureSetService.getClientApiMethods("LScanSynchronizeSiteData").subscribe(e=>{e&&e.length&&(this.isEditorRole=!0)})}addGeoTagToLaserScan(e,t){this.tvgViewer.setGeotag({name:e.name+"_"+this.selectedScanName,category:"Misc",label:e.name,link:"URI",volume:{type:"Sphere",center:{x:t[0],y:t[1],z:t[2]},diameter:1}},!1,this.addTagtoCurrentScan.bind(this))}processPostDelete(e){if(e.filter(e=>e===this.selectedTagOBID).length>0&&(this.showBubble=!1,this.initialisePowerBar(),delete this.currentScanTagDictionary[this.selectedScan.ScanOBID][this.selectedTagName],this.isGeotagPanelActive&&this.geotagComp)){if(this.geotagComp.tagsOnScan.length>0&&this.geotagComp.tagsOnScan.indexOf(this.selectedTagName)>-1){const e=this.geotagComp.tagsOnScan.indexOf(this.selectedTagName);this.geotagComp.tagsOnScan.splice(e,1)}const e=this.geotagComp.retrievedTags.findIndex(e=>e.geoTag.name===this.selectedTagName);e>-1&&this.geotagComp.retrievedTags.splice(e,1)}}getDataFromRouteAndViewScan(){return this.route.queryParamMap.pipe(Object(E.a)(e=>(this.geoTagPanelWidth=this.initialGeoTagPanelWidth+this.sideBarWidth,e.has("objectdata")?this.viewLScanSiteScan(e):this.route.snapshot.data[se.z]?(this.objects=this.route.snapshot.data[se.z],this.config=this.objects[0].config,this.isTagEditor(),"Tag"!==this.objectType?(this.loadingOverlayService.showLoadingOverlay(this.TVG_INITIALIZING_SCAN),this.setupLScanViewScan()):Object(S.a)(void 0)):Object(S.a)(void 0))))}viewLScanSiteScan(e){const t=JSON.parse(e.get("objectdata"));return this.resetControls(t.config),t.isScan?this.setupLScanViewScan(t.scanName,this.config):e.has("sitedetails")?(this.setTruViewSiteDetails(JSON.parse(e.get("sitedetails")),t),this.selectedTruviewSiteDetails?this.viewScan():Object(S.a)(void 0)):Object(S.a)(void 0)}setTruViewSiteDetails(e,t){this.selectedTruviewSiteDetails=e,this.selectedScanId=this.selectedTruviewSiteDetails.ScanDetails[0].ScanID;const i=new ne.a(t.scanOBID,"",t.config);this.selectedTagName=t.tagName,this.objects=[i],this.objectType="Tag"}resetControls(e){this.config=e,this.isTagEditor(),this.showBubble=!1,this.isNeighborsActive=!1,this.isGeotagPanelActive=!1,this.actionMenuProvider.clearAndCloseActionsMenu(),this.showTagDetails=!1}navigateToNeighborScan(e){this.router.navigate(["/tvgScanView"],{queryParams:{objectdata:JSON.stringify({scanName:e,config:this.config,isScan:!0})},relativeTo:this.route}).catch(e=>{this.exceptionService.handleException(e)})}takeMeasurement(){this.isEditMode=!0,this.isNeighborsActive=!1,this.isMeasurementsActive=!1,this.pickPointCollection=new Array,this.tvgViewer.pickPoints(this.collectPickpoints.bind(this),!0)}showMiniMap(){this.tvgViewer.showMinimap(),this.isMiniMapActive=!this.isMiniMapActive,this.truviewHideMapButton.icon="fa-eye-slash power-bar-button__icon"}hideMiniMap(){this.tvgViewer.hideMinimap(),this.isMiniMapActive=!this.isMiniMapActive,this.truviewHideMapButton.icon="fa-eye power-bar-button__icon"}highlightSelectedBtn(e){this.resetTruViewActionBtnsStyle(),(e=this.isEditorRole?e:e-1)<this.truviewActionButtons.length&&(this.truviewActionButtons[e].style="button--active")}resetTruViewActionBtnsStyle(){this.truviewActionButtons&&this.truviewActionButtons.forEach(e=>{e.style=""})}setupBubblePosition(e,t){const i=this.tvgContainer.nativeElement.getBoundingClientRect();if(i&&(this.bubblePositionX=e-i.left,this.bubblePositionY=t-i.top,this.pickPointCollection&&this.pickPointCollection.length===this.requiredPickPoints-1)){const n=i.top/2;this.measurementPopupPosX=e-i.left/2,this.measurementPopupPosY=t-n}}resetPickingMode(){this.tvgViewer.resetPoints(),this.tvgViewer.pickPoints(),this.isMeasurementsActive=!1}getNeighbors(){this.isEditMode&&this.resetPickingMode(),this.isNeighborsActive&&this.resetTruViewActionBtnsStyle(),this.isNeighborsActive=!this.isNeighborsActive}resetButtonsAndPopups(){this.isTagSelected||(this.showBubble=!1,this.actionMenuProvider.clearAndCloseActionsMenu()),this.isMeasurementsActive&&(this.resetPickingMode(),this.resetTruViewActionBtnsStyle())}getLayers(){this.layers=this.tvgViewer.datasets,this.layerInfo.cube=this.sdaTranslateService.get("TVG_RGB_Layer","Red Green Blue Layer"),this.layerInfo.displayir=this.sdaTranslateService.get("TVG_IR_Layer","Infrared Layer"),this.layerInfo.hdr=this.sdaTranslateService.get("TVG_HDR_Layer","High Dynamic Range Layer"),this.layerInfo.scanintensity=this.sdaTranslateService.get("TVG_GRAYSCALE_LAYER","Intensity Grayscale Layer"),this.layerInfo.intensityhue=this.sdaTranslateService.get("TVG_HUE_LAYER","Intensity Hue Layer")}setLayers(e){this.tvgViewer.setDataset(e),this.tvgViewer.ui.refreshExposureSlider(),this.tvgViewer.ui.refreshGammaSlider(),this.tvgViewer.ui.refreshUI()}isResizeBarActive(){return!!(this.isGeotagPanelActive&&this.documentService.Document&&this.documentService.Document.documentElement&&this.documentService.Document.documentElement.clientWidth>1200)}canDeleteConnectedTag(){return void 0===this.canDelConnectedTag?this.tvgSiteService.checkMethodAccess("DeleteConnectedGeoTag","DeleteConnectedGeoTag").pipe(Object(E.a)(e=>e?(this.canDelConnectedTag=!0,Object(S.a)(e)):(this.canDelConnectedTag=!1,this.canDeleteOrphanTag()))):Object(S.a)(this.canDelConnectedTag)}canDeleteOrphanTag(){return void 0===this.canDelOrphanTag?this.tvgSiteService.checkMethodAccess("DeleteOrphanedGeoTag","DeleteOrphanedGeoTag").pipe(Object(P.a)(e=>e?(this.canDelOrphanTag=!0,e):(this.canDelOrphanTag=!1,e))):Object(S.a)(this.canDelOrphanTag)}showGeoTagBubble(e){return this.checkIfTagExists(e.name).pipe(Object(D.a)(1),Object(E.a)(t=>t?(this.isConnectedTag=!0,this.canDeleteConnectedTag()):(this.selectedTagOBID="",this.selectedTagName=e.name,this.isConnectedTag=!1,this.notificationService.info(this.TVG_TAG_NOT_EXIST_DB),this.canDeleteOrphanTag())),Object(E.a)(t=>void 0!==t?(this.selectedBubbleTag={OBID:this.selectedTagOBID,Name:this.selectedTagName,Config:this.config},this.isConnectedTag&&(this.isMenuActive=!0,this.actionMenuProvider.clearAndCloseActionsMenu(),this.actionMenuProvider.addItem(new ne.a(this.selectedTagOBID,this.selectedTagName,this.config))),this.showDelete=this.isConnectedTag&&this.canDelConnectedTag||this.canDelOrphanTag,this.isMenuActive=!0,this.isTagSelected=!1,this.showTagDetails=!1,this.bubbleText=e.name,this.showBubble=this.isConnectedTag||this.showDelete,Object(S.a)(!0)):Object(S.a)(!1)))}getMethodAndCheckAccess(e){return this.methodService.getMethodByUID(e).pipe(Object(E.a)(e=>e&&e.UID?(this.paramMethodObject=e,this.tvgSiteService.checkMethodAccess(e.SPFClientAPIMethods_21.Name,e.Name)):(this.exceptionService.handleException(new L.a(this.TVG_INVALID_PARAM)),Object(S.a)(void 0))))}takeSnapshot(){this.tvgViewer.getPictureDataURL().then(e=>this.snapshotRemote.send(e))}}return e.\u0275fac=function(t){return new(t||e)(c.Sb(o.g),c.Sb(ie.a),c.Sb(he.a),c.Sb(de.a),c.Sb(o.a),c.Sb(Y.a),c.Sb(G.a),c.Sb(I.a),c.Sb(J.a),c.Sb(x.a),c.Sb(M.a),c.Sb(X.a),c.Sb(q.a),c.Sb(N.a),c.Sb(V.a),c.Sb(n.n),c.Sb(Q.a),c.Sb(ee.a),c.Sb(oe.a),c.Sb(re.a),c.Sb($.a),c.Sb(c.B),c.Sb(c.j),c.Sb(c.s),c.Sb(k.a),c.Sb(te.a),c.Sb(ce.a))},e.\u0275cmp=c.Mb({type:e,selectors:[["sda-tvg-scan"]],viewQuery:function(e,t){var i;1&e&&(c.bd(mt,!0),c.bd(Tt,!0),c.bd(St,!0)),2&e&&(c.Gc(i=c.ic())&&(t.tvgContainer=i.first),c.Gc(i=c.ic())&&(t.powerBar=i.first),c.Gc(i=c.ic())&&(t.geotagComp=i.first))},hostBindings:function(e,t){1&e&&c.hc("resize",(function(){return t.setGeoTagPanelMinWidth()}),!1,c.Jc)},features:[c.Db([he.a,de.a])],decls:19,vars:19,consts:[[3,"leftControls","rightControls"],["powerBar",""],[1,"tvg-wrapper",3,"resize","orientationchange"],["id","truview",1,"tvg-site",3,"ngStyle"],["id","tvg-container","pDroppable","measurement",1,"tvg-container",3,"mousewheel","mousedown","mouseup","keyup","touchstart","mousemove"],["tvgContainer",""],[3,"isOpen","titleText","submitText","showCancelButton","submit"],[1,"tvg-version-info"],["target","_blank",3,"href"],[3,"selectedTagName","selectedTagOBID","config","detailsShrink",4,"ngIf"],[3,"bubbleText","bubblePositionX","bubblePositionY","isMenuActive","showDelete","showActionsMenuButton","showDetailsButton","showPinButton","selectedObject","toggleActionsMenu","deleteTag","detailsExpand",4,"ngIf"],[3,"measurementPopupPosX","measurementPopupPosY","requiredPickPoints","pickPointCollection","parentElement",4,"ngIf"],[3,"viewerProperties","parentElement","propertiesChange","sizeChange","colorChange",4,"ngIf"],[3,"tagInterfaceDef","currentScanOBID","closeGeoTag","zoomToTag","addSelectedTag","panelWidthOnResize","resizeBarGrabChange",4,"ngIf"],[3,"selectedTagName","selectedTagOBID","config","detailsShrink"],[3,"bubbleText","bubblePositionX","bubblePositionY","isMenuActive","showDelete","showActionsMenuButton","showDetailsButton","showPinButton","selectedObject","toggleActionsMenu","deleteTag","detailsExpand"],[3,"measurementPopupPosX","measurementPopupPosY","requiredPickPoints","pickPointCollection","parentElement"],[3,"viewerProperties","parentElement","propertiesChange","sizeChange","colorChange"],[3,"tagInterfaceDef","currentScanOBID","closeGeoTag","zoomToTag","addSelectedTag","panelWidthOnResize","resizeBarGrabChange"],["geoTag",""]],template:function(e,t){1&e&&(c.Tb(0,"sda-power-bar-view",0,1),c.Yb(2,"div",2),c.hc("resize",(function(){return t.onResize()}),!1,c.Jc)("orientationchange",(function(){return t.onResize()}),!1,c.Jc),c.Yb(3,"div",3),c.Yb(4,"div",4,5),c.hc("mousewheel",(function(e){return t.onTruViewMouseWheel(e)}))("mousedown",(function(e){return t.onTruViewMouseDown(e)}))("mouseup",(function(e){return t.onTruViewMouseUp(e)}))("keyup",(function(e){return t.onTruViewKeyUp(e)}))("touchstart",(function(e){return t.moveScan(e)}))("mousemove",(function(e){return t.onTruViewMouseMove(e)})),c.Xb(),c.Yb(6,"uxt-modal",6),c.hc("submit",(function(){return t.displayVersionInfo()})),c.Yb(7,"div",7),c.Yb(8,"h4"),c.Uc(9),c.Xb(),c.Yb(10,"p"),c.Uc(11),c.Yb(12,"a",8),c.Uc(13),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Sc(14,_t,1,3,"sda-tag-details",9),c.Sc(15,Et,1,9,"sda-hotspot-bubble",10),c.Sc(16,wt,1,5,"sda-tvg-mesurement",11),c.Sc(17,Ct,1,2,"sda-tvg-neighbors",12),c.Xb(),c.Sc(18,Ot,2,2,"sda-tvg-geotag",13),c.Xb()),2&e&&(c.sc("leftControls",t.leftPowerBarControls)("rightControls",t.rightPowerBarControls),c.Eb(3),c.sc("ngStyle",t.isGeotagPanelActive?c.xc(17,Pt,"calc(100vw - "+t.geoTagPanelWidth+"px)"):""),c.Eb(3),c.sc("isOpen",t.showVersionInfoDiv)("titleText",t.TITLE_TEXT)("submitText",t.CLOSE_TEXT)("showCancelButton",!1),c.Eb(3),c.Xc("",t.SERVER_VERSION_TITLE," : ",t.serverVersion,""),c.Eb(2),c.Wc("",t.SERVER_URL_TITLE," : "),c.Eb(1),c.tc("href",t.serverUrl,c.Mc),c.Eb(1),c.Vc(t.serverUrl),c.Eb(1),c.sc("ngIf",t.showTagDetails),c.Eb(1),c.sc("ngIf",t.showBubble),c.Eb(1),c.sc("ngIf",t.isMeasurementsActive),c.Eb(1),c.sc("ngIf",t.isNeighborsActive),c.Eb(1),c.sc("ngIf",t.isGeotagPanelActive))},directives:[Z.a,n.w,h,Ae.a,n.t,Le,Ge.a,Fe,vt,ye],styles:["sda-object-details[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]{display:flex;flex:1;flex-direction:column;overflow:hidden}[_nghost-%COMP%]     .uxt-modal{z-index:1100!important}[_nghost-%COMP%]     .power-bar-select{font-size:14px}.tvg-container[_ngcontent-%COMP%]{flex:1;width:100%;height:100%}.tvg-wrapper[_ngcontent-%COMP%]{overflow:hidden}.tvg-site[_ngcontent-%COMP%], .tvg-wrapper[_ngcontent-%COMP%]{display:flex;height:100%}.tvg-site[_ngcontent-%COMP%]{position:relative;flex-direction:column;width:calc(100vw - 44px)}.tvg-version-info[_ngcontent-%COMP%]{display:flex;flex-grow:1;flex-direction:column}sda-object-details[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column;border:1px solid #ccc}"]}),e})();var xt=i("8CTx"),It=i("LuMj"),Mt=i("dPl2"),yt=i("8Vnw"),At=i("LvQU");let Bt=(()=>{class e{}return e.\u0275mod=c.Qb({type:e}),e.\u0275inj=c.Pb({factory:function(t){return new(t||e)},imports:[[n.c,Te.b]]}),e})(),Vt=(()=>{class e{}return e.\u0275mod=c.Qb({type:e}),e.\u0275inj=c.Pb({factory:function(t){return new(t||e)},imports:[[n.c,s.j,d,At.a,m.a,Mt.c,Te.b,It.b,Ee.c,_e.e,Bt,yt.a]]}),e})(),Lt=(()=>{class e{}return e.\u0275mod=c.Qb({type:e}),e.\u0275inj=c.Pb({factory:function(t){return new(t||e)},providers:[ke.a],imports:[[n.c,s.j,d]]}),e})(),Gt=(()=>{class e{}return e.\u0275mod=c.Qb({type:e}),e.\u0275inj=c.Pb({factory:function(t){return new(t||e)},providers:[ke.a],imports:[[n.c,s.j,d,dt,gt.b]]}),e})();var kt=i("9Abt");let Nt=(()=>{class e{}return e.\u0275mod=c.Qb({type:e}),e.\u0275inj=c.Pb({factory:function(t){return new(t||e)},imports:[[n.c,g.a,kt.a,Te.b]]}),e})();const Xt=[{path:"",component:Dt,resolve:{objects:u.a}}];let Rt=(()=>{class e{}return e.\u0275mod=c.Qb({type:e}),e.\u0275inj=c.Pb({factory:function(t){return new(t||e)},providers:[de.a,he.a,ke.a,xt.a],imports:[[n.c,f.a,s.j,g.a,p.a,b.a,Nt,Lt,Gt,Vt,m.a,v.a,d,T.a,a.b,o.k.forChild(Xt)],o.k]}),e})()},K9v4:function(e,t,i){"use strict";i.d(t,"a",(function(){return x}));var n=i("ofXK"),s=i("3Pt+"),a=i("tyNb"),o=i("F+hv"),c=i("txXS"),r=i("Tfoa"),l=i("uD/B"),h=i("BLqR"),d=i("+T9e"),g=i("fXoL"),u=i("TLn4"),b=i("ue3H"),p=i("qx4N"),f=i("+qkj"),v=i("RY2J"),m=i("HDO1"),T=i("4dwF"),S=i("dLJk"),_=i("F8dI"),E=i("rrPm"),w=i("8OmR"),C=i("ltBE"),O=i("XwBL");let P=(()=>{class e{transform(e){return O.a.replaceUnderscore(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=g.Rb({name:"sdaFormatEntityType",type:e,pure:!0}),e})();var D=i("7Ihv");let x=(()=>{class e{}return e.\u0275mod=g.Qb({type:e}),e.\u0275inj=g.Pb({factory:function(t){return new(t||e)},imports:[[n.c,s.j,c.a,a.k,o.a,l.a,r.a]]}),e})();g.Nc(h.a,[n.q,n.r,n.s,n.t,n.A,n.w,n.x,n.y,n.z,n.u,n.v,s.F,s.u,s.E,s.c,s.v,s.y,s.a,s.B,s.C,s.x,s.p,s.q,s.A,s.l,s.k,s.w,s.b,s.d,s.s,s.t,s.r,a.l,a.h,a.j,a.i,a.n,u.a,b.a,p.a,f.a,d.a,h.a],[n.b,n.G,n.p,n.k,n.E,n.g,n.C,n.F,n.d,n.f,n.i,n.j,n.l,v.a,m.a,T.a,S.a,_.a,E.a,w.a,C.a,P,D.a])},d74k:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t){this.field=e,this.dir=t}}},dPl2:function(e,t,i){"use strict";i.d(t,"a",(function(){return P})),i.d(t,"b",(function(){return D})),i.d(t,"c",(function(){return x}));var n=i("fXoL"),s=i("ofXK"),a=i("xlun"),o=i("7zfz");const c=["p-tabViewNav",""];function r(e,t){if(1&e&&n.Tb(0,"span",9),2&e){const e=n.lc(3).$implicit;n.sc("ngClass",e.leftIcon)}}function l(e,t){if(1&e&&n.Tb(0,"span",10),2&e){const e=n.lc(3).$implicit;n.sc("ngClass",e.rightIcon)}}function h(e,t){if(1&e&&(n.Wb(0),n.Sc(1,r,1,1,"span",6),n.Yb(2,"span",7),n.Uc(3),n.Xb(),n.Sc(4,l,1,1,"span",8),n.Vb()),2&e){const e=n.lc(2).$implicit;n.Eb(1),n.sc("ngIf",e.leftIcon),n.Eb(2),n.Vc(e.header),n.Eb(1),n.sc("ngIf",e.rightIcon)}}function d(e,t){1&e&&n.Ub(0)}function g(e,t){if(1&e&&(n.Wb(0),n.Sc(1,d,1,0,"ng-container",11),n.Vb()),2&e){const e=n.lc(2).$implicit;n.Eb(1),n.sc("ngTemplateOutlet",e.headerTemplate)}}function u(e,t){if(1&e){const e=n.Zb();n.Yb(0,"span",12),n.hc("click",(function(t){n.Kc(e);const i=n.lc(2).$implicit;return n.lc().clickClose(t,i)})),n.Xb()}}const b=function(e,t){return{"ui-tabview-selected ui-state-active":e,"ui-state-disabled":t}};function p(e,t){if(1&e){const e=n.Zb();n.Yb(0,"li",2),n.hc("click",(function(t){n.Kc(e);const i=n.lc().$implicit;return n.lc().clickTab(t,i)}))("keydown.enter",(function(t){n.Kc(e);const i=n.lc().$implicit;return n.lc().clickTab(t,i)})),n.Yb(1,"a",3),n.Sc(2,h,5,3,"ng-container",4),n.Sc(3,g,2,1,"ng-container",4),n.Xb(),n.Sc(4,u,1,0,"span",5),n.Xb()}if(2&e){const e=n.lc().$implicit,t=n.lc();n.Gb(t.getDefaultHeaderClass(e)),n.sc("ngStyle",e.headerStyle)("ngClass",n.yc(16,b,e.selected,e.disabled)),n.Fb("tabindex",e.disabled?-1:0),n.Eb(1),n.sc("pTooltip",e.tooltip)("tooltipPosition",e.tooltipPosition)("positionStyle",e.tooltipPositionStyle)("tooltipStyleClass",e.tooltipStyleClass),n.Fb("id",e.id+"-label")("aria-selected",e.selected)("aria-controls",e.id)("aria-selected",e.selected),n.Eb(1),n.sc("ngIf",!e.headerTemplate),n.Eb(1),n.sc("ngIf",e.headerTemplate),n.Eb(1),n.sc("ngIf",e.closable)}}function f(e,t){1&e&&n.Sc(0,p,5,19,"li",1),2&e&&n.sc("ngIf",!t.$implicit.closed)}function v(e,t){1&e&&n.Ub(0)}function m(e,t){if(1&e&&(n.Wb(0),n.Sc(1,v,1,0,"ng-container",3),n.Vb()),2&e){const e=n.lc(2);n.Eb(1),n.sc("ngTemplateOutlet",e.contentTemplate)}}const T=function(e){return{"ui-helper-hidden":e}};function S(e,t){if(1&e&&(n.Yb(0,"div",1),n.qc(1),n.Sc(2,m,2,1,"ng-container",2),n.Xb()),2&e){const e=n.lc();n.sc("ngClass",n.xc(5,T,!e.selected)),n.Fb("id",e.id)("aria-hidden",!e.selected)("aria-labelledby",e.id+"-label"),n.Eb(2),n.sc("ngIf",e.contentTemplate&&(e.cache?e.loaded:e.selected))}}const _=["*"];function E(e,t){if(1&e){const e=n.Zb();n.Yb(0,"ul",3),n.hc("onTabClick",(function(t){return n.Kc(e),n.lc().open(t.originalEvent,t.tab)}))("onTabCloseClick",(function(t){return n.Kc(e),n.lc().close(t.originalEvent,t.tab)})),n.Xb()}if(2&e){const e=n.lc();n.sc("tabs",e.tabs)("orientation",e.orientation)}}function w(e,t){if(1&e){const e=n.Zb();n.Yb(0,"ul",3),n.hc("onTabClick",(function(t){return n.Kc(e),n.lc().open(t.originalEvent,t.tab)}))("onTabCloseClick",(function(t){return n.Kc(e),n.lc().close(t.originalEvent,t.tab)})),n.Xb()}if(2&e){const e=n.lc();n.sc("tabs",e.tabs)("orientation",e.orientation)}}let C=0,O=(()=>{let e=class{constructor(){this.orientation="top",this.onTabClick=new n.o,this.onTabCloseClick=new n.o}getDefaultHeaderClass(e){let t="ui-state-default ui-corner-"+this.orientation;return e.headerStyleClass&&(t=t+" "+e.headerStyleClass),t}clickTab(e,t){this.onTabClick.emit({originalEvent:e,tab:t})}clickClose(e,t){this.onTabCloseClick.emit({originalEvent:e,tab:t})}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Mb({type:e,selectors:[["","p-tabViewNav",""]],hostVars:10,hostBindings:function(e,t){2&e&&n.Ib("ui-tabview-nav",!0)("ui-helper-reset",!0)("ui-helper-clearfix",!0)("ui-widget-header",!0)("ui-corner-all",!0)},inputs:{orientation:"orientation",tabs:"tabs"},outputs:{onTabClick:"onTabClick",onTabCloseClick:"onTabCloseClick"},attrs:c,decls:1,vars:1,consts:[["ngFor","",3,"ngForOf"],["role","presentation","tabindex","0",3,"class","ngStyle","ngClass","click","keydown.enter",4,"ngIf"],["role","presentation","tabindex","0",3,"ngStyle","ngClass","click","keydown.enter"],["role","tab",3,"pTooltip","tooltipPosition","positionStyle","tooltipStyleClass"],[4,"ngIf"],["class","ui-tabview-close pi pi-times",3,"click",4,"ngIf"],["class","ui-tabview-left-icon",3,"ngClass",4,"ngIf"],[1,"ui-tabview-title"],["class","ui-tabview-right-icon",3,"ngClass",4,"ngIf"],[1,"ui-tabview-left-icon",3,"ngClass"],[1,"ui-tabview-right-icon",3,"ngClass"],[4,"ngTemplateOutlet"],[1,"ui-tabview-close","pi","pi-times",3,"click"]],template:function(e,t){1&e&&n.Sc(0,f,1,1,"ng-template",0),2&e&&n.sc("ngForOf",t.tabs)},directives:[s.s,s.t,s.w,s.q,a.a,s.A],encapsulation:2}),e})(),P=(()=>{let e=class{constructor(e,t){this.viewContainer=e,this.cd=t,this.cache=!0,this.tooltipPosition="top",this.tooltipPositionStyle="absolute",this.id="ui-tabpanel-"+C++}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"header":this.headerTemplate=e.template;break;case"content":default:this.contentTemplate=e.template}})}get selected(){return this._selected}set selected(e){this._selected=e,this.loaded||this.cd.detectChanges(),this.loaded=!0}ngOnDestroy(){this.view=null}};return e.\u0275fac=function(t){return new(t||e)(n.Sb(n.Q),n.Sb(n.h))},e.\u0275cmp=n.Mb({type:e,selectors:[["p-tabPanel"]],contentQueries:function(e,t,i){var s;1&e&&n.Kb(i,o.d,!1),2&e&&n.Gc(s=n.ic())&&(t.templates=s)},inputs:{cache:"cache",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",selected:"selected",header:"header",disabled:"disabled",closable:"closable",headerStyle:"headerStyle",headerStyleClass:"headerStyleClass",leftIcon:"leftIcon",rightIcon:"rightIcon",tooltip:"tooltip",tooltipStyleClass:"tooltipStyleClass"},ngContentSelectors:_,decls:1,vars:1,consts:[["class","ui-tabview-panel ui-widget-content","role","tabpanel",3,"ngClass",4,"ngIf"],["role","tabpanel",1,"ui-tabview-panel","ui-widget-content",3,"ngClass"],[4,"ngIf"],[4,"ngTemplateOutlet"]],template:function(e,t){1&e&&(n.rc(),n.Sc(0,S,3,7,"div",0)),2&e&&n.sc("ngIf",!t.closed)},directives:[s.t,s.q,s.A],encapsulation:2}),e})(),D=(()=>{let e=class{constructor(e){this.el=e,this.orientation="top",this.onChange=new n.o,this.onClose=new n.o,this.activeIndexChange=new n.o}ngAfterContentInit(){this.initTabs(),this.tabPanels.changes.subscribe(e=>{this.initTabs()})}initTabs(){this.tabs=this.tabPanels.toArray(),!this.findSelectedTab()&&this.tabs.length&&(null!=this.activeIndex&&this.tabs.length>this.activeIndex?this.tabs[this.activeIndex].selected=!0:this.tabs[0].selected=!0)}open(e,t){if(t.disabled)e&&e.preventDefault();else{if(!t.selected){let i=this.findSelectedTab();i&&(i.selected=!1),t.selected=!0;let n=this.findTabIndex(t);this.preventActiveIndexPropagation=!0,this.activeIndexChange.emit(n),this.onChange.emit({originalEvent:e,index:n})}e&&e.preventDefault()}}close(e,t){this.controlClose?this.onClose.emit({originalEvent:e,index:this.findTabIndex(t),close:()=>{this.closeTab(t)}}):(this.closeTab(t),this.onClose.emit({originalEvent:e,index:this.findTabIndex(t)})),e.stopPropagation()}closeTab(e){if(!e.disabled){if(e.selected){e.selected=!1;for(let t=0;t<this.tabs.length;t++){let i=this.tabs[t];if(!i.closed&&!e.disabled){i.selected=!0;break}}}e.closed=!0}}findSelectedTab(){for(let e=0;e<this.tabs.length;e++)if(this.tabs[e].selected)return this.tabs[e];return null}findTabIndex(e){let t=-1;for(let i=0;i<this.tabs.length;i++)if(this.tabs[i]==e){t=i;break}return t}getBlockableElement(){return this.el.nativeElement.children[0]}get activeIndex(){return this._activeIndex}set activeIndex(e){this._activeIndex=e,this.preventActiveIndexPropagation?this.preventActiveIndexPropagation=!1:this.tabs&&this.tabs.length&&null!=this._activeIndex&&this.tabs.length>this._activeIndex&&(this.findSelectedTab().selected=!1,this.tabs[this._activeIndex].selected=!0)}};return e.\u0275fac=function(t){return new(t||e)(n.Sb(n.l))},e.\u0275cmp=n.Mb({type:e,selectors:[["p-tabView"]],contentQueries:function(e,t,i){var s;1&e&&n.Kb(i,P,!1),2&e&&n.Gc(s=n.ic())&&(t.tabPanels=s)},inputs:{orientation:"orientation",activeIndex:"activeIndex",style:"style",styleClass:"styleClass",controlClose:"controlClose"},outputs:{onChange:"onChange",onClose:"onClose",activeIndexChange:"activeIndexChange"},ngContentSelectors:_,decls:5,vars:6,consts:[[3,"ngClass","ngStyle"],["p-tabViewNav","","role","tablist",3,"tabs","orientation","onTabClick","onTabCloseClick",4,"ngIf"],[1,"ui-tabview-panels"],["p-tabViewNav","","role","tablist",3,"tabs","orientation","onTabClick","onTabCloseClick"]],template:function(e,t){1&e&&(n.rc(),n.Yb(0,"div",0),n.Sc(1,E,1,2,"ul",1),n.Yb(2,"div",2),n.qc(3),n.Xb(),n.Sc(4,w,1,2,"ul",1),n.Xb()),2&e&&(n.Gb(t.styleClass),n.sc("ngClass","ui-tabview ui-widget ui-widget-content ui-corner-all ui-tabview-"+t.orientation)("ngStyle",t.style),n.Eb(1),n.sc("ngIf","bottom"!=t.orientation),n.Eb(3),n.sc("ngIf","bottom"==t.orientation))},directives:[s.q,s.w,s.t,O],encapsulation:2}),e})(),x=(()=>{let e=class{};return e.\u0275mod=n.Qb({type:e}),e.\u0275inj=n.Pb({factory:function(t){return new(t||e)},imports:[[s.c,o.e,a.b],o.e]}),e})()},ltBE:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");let s=(()=>{class e{transform(e,t,i){return e?i?e.filter(e=>e[t].toLowerCase().includes(i.toLowerCase())):e:[]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=n.Rb({name:"sdaFilter",type:e,pure:!0}),e})()},pUtL:function(e,t,i){"use strict";i.d(t,"a",(function(){return C}));var n=i("fXoL"),s=i("cee5"),a=i("Ejbi"),o=i("+eYH"),c=i("ofXK"),r=i("TLn4"),l=i("NFeN"),h=i("YkmU"),d=i("Jgl7");function g(e,t){1&e&&n.Tb(0,"sda-loading-indicator",3),2&e&&n.sc("size",18)}function u(e,t){if(1&e){const e=n.Zb();n.Yb(0,"div",9),n.Yb(1,"mat-icon",10),n.hc("click",(function(t){return n.Kc(e),n.lc(2).onCloseIconClick(t)})),n.Xb(),n.Xb()}if(2&e){const e=n.lc(2);n.Eb(1),n.sc("title",e.HOTSPOT_BUBBLE_CLOSE)}}function b(e,t){if(1&e){const e=n.Zb();n.Yb(0,"mat-icon",17),n.hc("click",(function(t){return n.Kc(e),n.lc(3).onActionsMenuIconClick(t)})),n.Xb()}if(2&e){const e=n.lc(3);n.sc("title",e.HOTSPOT_BUBBLE_ACTIONS)}}function p(e,t){if(1&e){const e=n.Zb();n.Yb(0,"mat-icon",18),n.hc("click",(function(t){return n.Kc(e),n.lc(3).onViewOffPageDocumentIconClick(t)})),n.Xb()}if(2&e){const e=n.lc(3);n.sc("title",e.HOTSPOT_BUBBLE_VIEW_OPC_DOC)}}function f(e,t){if(1&e){const e=n.Zb();n.Yb(0,"mat-icon",19),n.hc("click",(function(t){return n.Kc(e),n.lc(3).onDeleteTagIconClick(t)})),n.Xb()}if(2&e){const e=n.lc(3);n.sc("title",e.HOTSPOT_BUBBLE_DELETE)}}function v(e,t){if(1&e&&n.Tb(0,"sda-pins-group-selector",20),2&e){const e=n.lc(3);n.sc("isDisabled",!e.objectsToPin.length)("pinToGroupMode",!0)("iconOnlyMode",!0)("fixedWidth",230)("itemsToPin",e.objectsToPin)}}function m(e,t){if(1&e){const e=n.Zb();n.Yb(0,"mat-icon",21),n.hc("click",(function(t){return n.Kc(e),n.lc(3).onDetailsExpandIconClick(t)})),n.Xb()}if(2&e){const e=n.lc(3);n.sc("title",e.HOTSPOT_BUBBLE_DETAILS)}}function T(e,t){if(1&e&&(n.Yb(0,"div",11),n.Sc(1,b,1,1,"mat-icon",12),n.Sc(2,p,1,1,"mat-icon",13),n.Sc(3,f,1,1,"mat-icon",14),n.Sc(4,v,1,5,"sda-pins-group-selector",15),n.Sc(5,m,1,1,"mat-icon",16),n.Xb()),2&e){const e=n.lc(2);n.Eb(1),n.sc("ngIf",e.showActionsMenuButton),n.Eb(1),n.sc("ngIf",e.showViewOPCDocButton),n.Eb(1),n.sc("ngIf",e.showDelete),n.Eb(1),n.sc("ngIf",e.showPinButton),n.Eb(1),n.sc("ngIf",e.showDetailsButton)}}function S(e,t){if(1&e&&(n.Yb(0,"p",22),n.Uc(1),n.Xb()),2&e){const e=n.lc(2);n.Eb(1),n.Vc(e.bubbleDisplayText)}}function _(e,t){if(1&e){const e=n.Zb();n.Yb(0,"li",24),n.hc("click",(function(){n.Kc(e);const i=t.$implicit;return n.lc(3).onBubbleItemClick(i)})),n.Tb(1,"sda-object-icon",25),n.Yb(2,"div",26),n.Yb(3,"label",27),n.Uc(4),n.Xb(),n.Yb(5,"label",28),n.Uc(6),n.Xb(),n.Xb(),n.Xb()}if(2&e){const e=t.$implicit,i=t.index,s=n.lc(3);n.Eb(1),n.sc("imageName",e.IconName),n.Eb(1),n.Ib("hotspot-list--selected",i===s.selectedBubbleItem),n.Eb(2),n.Vc(e.ClassDisplayName),n.Eb(2),n.Vc(e.Name)}}function E(e,t){if(1&e&&(n.Yb(0,"ul"),n.Sc(1,_,7,5,"li",23),n.Xb()),2&e){const e=n.lc(2);n.Eb(1),n.sc("ngForOf",e.bubbleItems)}}function w(e,t){if(1&e){const e=n.Zb();n.Yb(0,"div",4),n.hc("click",(function(t){return n.Kc(e),n.lc().onHotspotBubbleClick(t)}))("touchstart",(function(t){return n.Kc(e),n.lc().onHotspotBubbleClick(t)})),n.Sc(1,u,2,1,"div",5),n.Sc(2,T,6,5,"div",6),n.Sc(3,S,2,1,"p",7),n.Sc(4,E,2,1,"ul",8),n.Xb()}if(2&e){const e=n.lc();n.Eb(1),n.sc("ngIf",e.showCloseButton),n.Eb(1),n.sc("ngIf",e.isMenuActive),n.Eb(1),n.sc("ngIf",e.bubbleDisplayText),n.Eb(1),n.sc("ngIf",(null==e.bubbleItems?null:e.bubbleItems.length)>0)}}let C=(()=>{class e{constructor(e,t,i){this.elementRef=e,this.timeoutService=t,this.sdaTranslateService=i,this.showDelete=!1,this.showActionsMenuButton=!0,this.showDetailsButton=!0,this.showPinButton=!0,this.showViewOPCDocButton=!1,this.showCloseButton=!1,this.toggleActionsMenu=new n.o,this.detailsExpand=new n.o,this.deleteTag=new n.o,this.viewOffPageDocument=new n.o,this.bubbleItemSelected=new n.o,this.closeBubble=new n.o,this.selectedBubbleItem=0,this.objectsToPin=[],this.HOTSPOT_BUBBLE_ACTIONS=this.sdaTranslateService.get("HOTSPOT_BUBBLE_ACTIONS","Actions"),this.HOTSPOT_BUBBLE_DETAILS=this.sdaTranslateService.get("HOTSPOT_BUBBLE_DETAILS","Details"),this.HOTSPOT_BUBBLE_DELETE=this.sdaTranslateService.get("HOTSPOT_BUBBLE_DELETE","Delete"),this.HOTSPOT_BUBBLE_VIEW_OPC_DOC=this.sdaTranslateService.get("HOTSPOT_BUBBLE_VIEW_OPC_DOC","View Continuation Drawing"),this.HOTSPOT_BUBBLE_CLOSE=this.sdaTranslateService.get("HOTSPOT_BUBBLE_CLOSE","Close"),this.HOTSPOT_BUBBLE_BLANK_TAG_DISPLAY_NAME=this.sdaTranslateService.get("HOTSPOT_BUBBLE_BLANK_TAG_DISPLAY_NAME","")}ngAfterViewInit(){this.timeoutService.setTimeout(()=>{this.ensureBubbleIsVisible()},1)}ngOnChanges(e){e.bubbleText&&(this.bubbleDisplayText=""===this.bubbleText?this.HOTSPOT_BUBBLE_BLANK_TAG_DISPLAY_NAME:this.bubbleText,void 0===e.bubbleText.previousValue&&this.timeoutService.setTimeout(()=>{this.ensureBubbleIsVisible()},10)),e.bubbleItems&&void 0!==e.bubbleItems.currentValue&&this.timeoutService.setTimeout(()=>{this.ensureBubbleIsVisible()},10),e.selectedObject&&(this.objectsToPin=this.selectedObject?[new o.a(this.selectedObject.OBID,this.selectedObject.Name,this.selectedObject.Config)]:[])}onActionsMenuIconClick(e){this.toggleActionsMenu.emit(e)}onDetailsExpandIconClick(e){this.detailsExpand.emit(e)}onViewOffPageDocumentIconClick(e){this.viewOffPageDocument.emit(e)}onHotspotBubbleClick(e){e.stopPropagation()}onBubbleItemClick(e){e&&this.selectedObject&&e.OBID===this.selectedObject.OBID||(this.objectsToPin=[]),this.selectedBubbleItem=this.bubbleItems.indexOf(e),this.bubbleItemSelected.emit(e)}onDeleteTagIconClick(e){this.deleteTag.emit(e)}onCloseIconClick(e){this.closeBubble.emit(e)}ensureBubbleIsVisible(){const e=this.elementRef.nativeElement;if(void 0!==e){const t=e.firstChild.getBoundingClientRect(),i=$(e.parentElement),n=i.height(),s=i.width();n-this.bubblePositionY<t.height+10&&(this.bubblePositionY=Math.max(n-t.height-10,0)),s-this.bubblePositionX<t.width+10&&(this.bubblePositionX=Math.max(s-t.width-10,0))}}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(n.l),n.Sb(s.a),n.Sb(a.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-hotspot-bubble"]],inputs:{bubbleText:"bubbleText",bubbleItems:"bubbleItems",bubblePositionX:"bubblePositionX",bubblePositionY:"bubblePositionY",isMenuActive:"isMenuActive",showDelete:"showDelete",showActionsMenuButton:"showActionsMenuButton",showDetailsButton:"showDetailsButton",showPinButton:"showPinButton",showViewOPCDocButton:"showViewOPCDocButton",showCloseButton:"showCloseButton",selectedObject:"selectedObject"},outputs:{toggleActionsMenu:"toggleActionsMenu",detailsExpand:"detailsExpand",deleteTag:"deleteTag",viewOffPageDocument:"viewOffPageDocument",bubbleItemSelected:"bubbleItemSelected",closeBubble:"closeBubble"},features:[n.Cb],decls:3,vars:6,consts:[[1,"hotspot"],[3,"size",4,"ngIf"],[3,"click","touchstart",4,"ngIf"],[3,"size"],[3,"click","touchstart"],["class","hotspot-toptools",4,"ngIf"],["class","hotspot-menu",4,"ngIf"],["class","hotspot__data",4,"ngIf"],[4,"ngIf"],[1,"hotspot-toptools"],["svgIcon","close",1,"hotspot-toptools__button",3,"title","click"],[1,"hotspot-menu"],["svgIcon","list","class","hotspot-menu__action",3,"title","click",4,"ngIf"],["svgIcon","view-continuation","class","hotspot-menu__action",3,"title","click",4,"ngIf"],["svgIcon","location-remove","class","hotspot-menu__action",3,"title","click",4,"ngIf"],[3,"isDisabled","pinToGroupMode","iconOnlyMode","fixedWidth","itemsToPin",4,"ngIf"],["svgIcon","expand","class","hotspot-menu__action",3,"title","click",4,"ngIf"],["svgIcon","list",1,"hotspot-menu__action",3,"title","click"],["svgIcon","view-continuation",1,"hotspot-menu__action",3,"title","click"],["svgIcon","location-remove",1,"hotspot-menu__action",3,"title","click"],[3,"isDisabled","pinToGroupMode","iconOnlyMode","fixedWidth","itemsToPin"],["svgIcon","expand",1,"hotspot-menu__action",3,"title","click"],[1,"hotspot__data"],["class","hotspot__items",3,"click",4,"ngFor","ngForOf"],[1,"hotspot__items",3,"click"],[1,"hotspot__img",3,"imageName"],[1,"hotspot-list"],[1,"hotspot-list__label","hotspot-list__label--smaller"],[1,"hotspot-list__label"]],template:function(e,t){1&e&&(n.Yb(0,"div",0),n.Sc(1,g,1,1,"sda-loading-indicator",1),n.Sc(2,w,5,4,"div",2),n.Xb()),2&e&&(n.Rc("left",t.bubblePositionX,"px")("top",t.bubblePositionY,"px"),n.Eb(1),n.sc("ngIf",void 0===t.bubbleText&&void 0===t.bubbleItems),n.Eb(1),n.sc("ngIf",void 0!==t.bubbleText||(null==t.bubbleItems?null:t.bubbleItems.length)>0))},directives:[c.t,r.a,l.a,h.a,c.s,d.a],styles:["[_nghost-%COMP%]   .hotspot[_ngcontent-%COMP%], [_nghost-%COMP%]   .hotspot-menu__action[_ngcontent-%COMP%], [_nghost-%COMP%]   .hotspot-toptools__button[_ngcontent-%COMP%]{transition:background-color .25s cubic-bezier(.18,.9,.18,.9)}[_nghost-%COMP%]   .hotspot[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:column;padding:10px;border-radius:20px;background-color:rgba(0,96,143,.7);z-index:100!important}[_nghost-%COMP%]   .hotspot[_ngcontent-%COMP%]:hover{background-color:rgba(0,96,143,.9)}[_nghost-%COMP%]   .hotspot__data[_ngcontent-%COMP%]{color:#fff;padding:0 6px}[_nghost-%COMP%]   .hotspot__items[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .hotspot__items[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#003e5c}[_nghost-%COMP%]   .hotspot__img[_ngcontent-%COMP%]{display:inline-flex;flex-shrink:0;align-items:center;padding-right:5px}[_nghost-%COMP%]   .hotspot-list[_ngcontent-%COMP%]{color:#fff;display:flex;flex-direction:column;margin:4px 0}[_nghost-%COMP%]   .hotspot-list__label[_ngcontent-%COMP%]{cursor:inherit}[_nghost-%COMP%]   .hotspot-list__label--smaller[_ngcontent-%COMP%]{font-size:11px}[_nghost-%COMP%]   .hotspot-list--selected[_ngcontent-%COMP%]{color:#28eaea}[_nghost-%COMP%]   .hotspot-toptools[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse}[_nghost-%COMP%]   .hotspot-toptools__button[_ngcontent-%COMP%]{display:flex;align-items:center;width:16px;height:16px;border-radius:3px;fill:#fff}[_nghost-%COMP%]   .hotspot-toptools__button[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#003e5c}[_nghost-%COMP%]   .hotspot-menu[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;justify-content:space-between;width:100%;min-width:150px;margin-bottom:8px}[_nghost-%COMP%]   .hotspot-menu__action[_ngcontent-%COMP%]{display:flex;align-items:center;width:40px;height:40px;padding:8px;border-radius:3px;color:#fff}[_nghost-%COMP%]   .hotspot-menu__action[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#003e5c}[_nghost-%COMP%]   sda-pins-group-selector[_ngcontent-%COMP%]     .quick-select-toggle{padding:0;border:1px solid transparent;border-radius:5px;color:#fff}[_nghost-%COMP%]   sda-pins-group-selector[_ngcontent-%COMP%]     .quick-select-toggle__text{display:flex;align-items:center;height:100%;padding:0}[_nghost-%COMP%]   sda-pins-group-selector[_ngcontent-%COMP%]     .quick-select-toggle__text:hover{background-color:#003e5c}[_nghost-%COMP%]   sda-pins-group-selector[_ngcontent-%COMP%]     .quick-select-toggle__button{width:14px;height:100%}[_nghost-%COMP%]   sda-pins-group-selector[_ngcontent-%COMP%]     .quick-select-toggle__button:hover{background-color:#003e5c}[_nghost-%COMP%]   sda-pins-group-selector[_ngcontent-%COMP%]     .quick-select-toggle--selected{border-color:#003e5c}[_nghost-%COMP%]   sda-pins-group-selector[_ngcontent-%COMP%]     .quick-select-toggle--selected .quick-select-toggle__button{background-color:#003e5c}[_nghost-%COMP%]   sda-pins-group-selector[_ngcontent-%COMP%]     .quick-select-toggle:not(.quick-select-toggle--disabled):hover{border-color:#003e5c}"]}),e})()}}]);