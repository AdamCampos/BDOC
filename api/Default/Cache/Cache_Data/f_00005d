(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{"2C+J":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("ofXK"),s=n("fXoL");let a=(()=>{class e{}return e.\u0275mod=s.Qb({type:e}),e.\u0275inj=s.Pb({factory:function(t){return new(t||e)},imports:[[r.c]]}),e})()},Q4nN:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("Z9D8"),s=n("fXoL");let a=(()=>{class e{constructor(){this.validMap=!1,this.usesIntegerIds=!1,this.usesPersistentIdPrefix=!1,this.searchCaseSensitive=!1}loadGraphicsMapUrl(e){const t=this,n=$.Deferred();return $.ajax({type:"get",url:e,dataType:"xml",success:e=>{e&&t.loadGraphicsMap($(e)),n.resolve(!0)},error:(t,s)=>{const a=new r.a(`Failed to load graphics map URL ${e}:${t.statusText}`);a.debugDetails.push({key:"status",value:s}),n.reject(a)}}),n}loadGraphicsMapXml(e){const t=$.parseXML(e);return this.loadGraphicsMap($(t))}loadGraphicsMap(e){const t=this.getFirstMapNode(e);if(t){const e=this.getMapNodeGoid(t);this.usesIntegerIds=!isNaN(parseInt(e,10)),this.usesPersistentIdPrefix=!this.usesIntegerIds&&0===e.indexOf("PersistentID="),this.nameAttribute=["NAME","Name"].find(e=>this.hasMapNodeAttribute(e))}return this.$xml=e,this.validMap=!0,!0}getMapNodesByGraphicOid(e,t){return e=this.convertToGraphicMapGraphicOid(e),t?this.findMapNodesByPartialMoniker(e):this.mapNodesWhereAttributeEquals("GOID",e)}mapNodesWhereAttributeContains(e,t,n,r=!0){const s=new Array,a=new Array,i=new Array;if(!e)return[];if(r){const n=$.escapeSelector(t);this.$xml.find("Map["+e+"*='"+n+"']").each((n,r)=>{const o=r.getAttribute(e);o===t?s.push(r):o.startsWith(t)?a.push(r):o.includes(t)&&i.push(r)})}else{$.expr[":"].lowerCaseAttrValueContains||this.addLowerCaseAttrValueContainsSelector();const n=t.toLowerCase();this.$xml.find("Map:lowerCaseAttrValueContains("+e+","+escape(n)+")").each((t,r)=>{let o=r.getAttribute(e);o&&(o=o.toLowerCase(),o===n?s.push(r):o.startsWith(n)?a.push(r):o.includes(n)&&i.push(r))})}return this.mergeAllElementArrays(s,a,i,n)}mapNodesWhereNameContains(e,t){return this.mapNodesWhereAttributeContains(this.nameAttribute,e,t,this.searchCaseSensitive)}mapNodesWhereNameEquals(e){return this.mapNodesWhereAttributeEquals(this.nameAttribute,e,this.searchCaseSensitive)}mapNodesWhereUidEquals(e){return this.mapNodesWhereAttributeEquals("UID",e)}getMapNodeName(e){return this.getMapNodeAttributeValue(e,this.nameAttribute)}getMapNodeUid(e){return this.getMapNodeAttributeValue(e,"UID")}getMapNodeGoid(e){return this.getMapNodeAttributeValue(e,"GOID")}getMapNodeGroupType(e){return this.getMapNodeAttributeValue(e,"GroupType")}getMapNodeToolTag(e){return this.getMapNodeAttributeValue(e,"TOOLTAG")}getGroupMembers(e){return e.children}hasMapNodeAttribute(e){let t=!1;const n=this.getFirstMapNode(this.$xml);return n&&(t=n.hasAttribute(e)),t}hasMapNodeNameAttribute(){return void 0!==this.nameAttribute}hasMapNodeUidAttribute(){return this.hasMapNodeAttribute("UID")}getFirstMapNode(e){return this.firstMapNode||(e.find("Map[GOID]:first").each((e,t)=>(this.firstMapNode=t,!1)),this.firstMapNode||e.find("Map:first").each((e,t)=>(this.firstMapNode=t,!1))),this.firstMapNode}convertToGraphicMapGraphicOid(e){let t=e;return this.usesIntegerIds||this.usesPersistentIdPrefix||0!==e.indexOf("PersistentID=")||(t=e.substr("PersistentID=".length)),t}mergeAllElementArrays(e,t,n,r){const s=new Array;return this.mergeElementArray(e,s,r),this.mergeElementArray(t,s,r),this.mergeElementArray(n,s,r),s}mergeElementArray(e,t,n){if(t.length<n)for(let r=0;r<e.length&&(t.push(e[r]),t.length!==n);r++);}mapNodesWhereAttributeEquals(e,t,n=!0){const r=new Array;if(e)if(n){const n=$.escapeSelector(t);this.$xml.find("Map["+e+"='"+n+"']").each((e,t)=>{r.push(t)})}else{$.expr[":"].lowerCaseAttrValueEquals||this.addLowerCaseAttrValueEqualsSelector();const n=t.toLowerCase();this.$xml.find("Map:lowerCaseAttrValueEquals("+e+","+n+")").each((e,t)=>{r.push(t)})}return r}findMapNodesByPartialMoniker(e){const t=[],n=$.escapeSelector(e);return this.$xml.find("Map[GOID$='"+n+"']").each((e,n)=>{t.push(n)}),t}getMapNodeAttributeValue(e,t){let n="";return t&&e.hasAttribute(t)&&(n=e.getAttribute(t)),n}addLowerCaseAttrValueEqualsSelector(){$.expr[":"].lowerCaseAttrValueEquals=$.expr.createPseudo(e=>t=>{let n=!1;const r=e.indexOf(",");if(r>0){const s=e.substring(0,r);if(t.hasAttribute(s)){const a=t.getAttribute(s);if(a){const t=e.substring(r+1);n=a.toLowerCase()===t}}}return n})}addLowerCaseAttrValueContainsSelector(){$.expr[":"].lowerCaseAttrValueContains=$.expr.createPseudo(e=>t=>{let n=!1;const r=e.indexOf(",");if(r>0){const s=e.substring(0,r);if(t.hasAttribute(s)){const a=t.getAttribute(s);if(a){let t=e.substring(r+1);t=unescape(t),n=a.toLowerCase().includes(t)}}}return n})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Ob({token:e,factory:e.\u0275fac}),e})()},b5tu:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("ofXK"),s=n("bSwM"),a=n("M9IT"),i=n("QibW"),o=n("+0xr"),c=n("2C+J"),u=n("tAal"),h=n("fXoL");let p=(()=>{class e{}return e.\u0275mod=h.Qb({type:e}),e.\u0275inj=h.Pb({factory:function(t){return new(t||e)},imports:[[r.c,c.a,u.a,o.l,s.b,i.c,a.b]]}),e})()},fnx3:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n("LRne"),s=n("cp0P"),a=n("lJxs"),i=n("eIep"),o=n("Z9D8"),c=n("LUpO"),u=n("tqyv"),h=n("tCxB"),p=n("A3La"),d=n("Ejbi"),l=n("41Lq"),g=n("zj8V"),D=n("grnA"),f=n("h915"),m=n("jYMS"),O=n("mRmt"),v=n("cdXO"),I=n("Q4nN"),b=n("fXoL");let S=(()=>{class e{constructor(e,t,n,r,s,a,i,o,c,u,h){this.uxtNotificationService=e,this.sdaTranslateService=t,this.graphicsMapService=n,this.exceptionService=r,this.odataService=s,this.loggingService=a,this.compositeService=i,this.fdwDocumentService=o,this.publishedDocumentService=c,this.viewNativeDataService=u,this.gdsService=h,this.GOVIEW_SELECT_ITEM_NOT_FOUND=this.sdaTranslateService.get("GOVIEW_SELECT_ITEM_NOT_FOUND","The item was not found in this file")}initializeNavigation(e,t,n){let s;switch(this.config=n,this.versionOBID=t,this.navigationStrategy=e,e){case D.a.COMPOSITE:return this.compositeService.getCompositeToolDocuments(t,this.config).pipe(Object(a.a)(e=>e));case D.a.PUBLISHED:return s=`Objects('${t}')/EDG_VersionToolDocument`,this.odataService.get(s,this.config).pipe(Object(a.a)(e=>e.value));case D.a.FDW:return this.fdwDocumentService.getDocumentRevision(t,this.config).pipe(Object(a.a)(e=>[e]));default:return Object(r.a)(void 0)}}getGoidsToSelect(e){const t=[];return e.forEach(n=>{const r=this.graphicsMapService.mapNodesWhereUidEquals(n);r.length>0?r.forEach(n=>{let r=this.graphicsMapService.getMapNodeGoid(n);if(""===r)if(""!==this.graphicsMapService.getMapNodeGroupType(n)){const e=this.graphicsMapService.getGroupMembers(n);for(let n=0;n<e.length;n++)r=this.graphicsMapService.getMapNodeGoid(e[n]),""!==r&&this.addGoid(t,r)}else 1===e.length&&this.uxtNotificationService.info(this.GOVIEW_SELECT_ITEM_NOT_FOUND);else this.addGoid(t,r)}):1===e.length&&this.uxtNotificationService.info(this.GOVIEW_SELECT_ITEM_NOT_FOUND)}),t}get3DRangeForRepresentations(e,t,n,r=!1){let i,c=[];const u=[];let h;const p=t===D.a.FDW?"FDWDrawingRepresentationFDWTag_12":"DrawingItems_12";return e.forEach((t,r)=>{t&&t.OBID&&(c.push(`OBID eq '${encodeURIComponent(t.OBID)}'`),(20===c.length||r===e.length-1&&c.length>0)&&(i=c.join(" or "),h=`Objects?$top=${c.length}&$filter=(${i})&$expand=${p}($filter=contains(Interfaces,'I3DRange');$select=Range1X,Range1Y,Range1Z,Range2X,Range2Y,Range2Z)`,u.push(this.odataService.get(h,n,!1)),c=[]))}),Object(s.a)(...u).pipe(Object(a.a)(e=>{let t;const n=[];return e&&e.length>0&&e.forEach(e=>{e&&e.value&&e.value.length>0&&n.push(...e.value)}),n.length>0&&(t=this.getMinimumBoundingRange(n,p,r)),t},e=>{this.exceptionService.handleException(new o.a(e))}))}get3DRange(e,t){const n=[],r=[];return this.odataService.get(e,t,!0).pipe(Object(a.a)(e=>e&&e.value&&e.value.length>0?(r.push(e.value[0].Range1X,e.value[0].Range1Y,e.value[0].Range1Z),n.push(e.value[0].Range2X,e.value[0].Range2Y,e.value[0].Range2Z),this.build3DRangeObject(n,r)):void 0,e=>{this.exceptionService.handleException(new o.a(e))}))}queryGraphicsToSelect(e,t,n,s){switch(this.navigationStrategy){case D.a.COMPOSITE:return this.compositeService.queryGraphicsToSelect(this.versionOBID,e,this.config,t,s);case D.a.PUBLISHED:return this.publishedDocumentService.queryGraphicsToSelect(n,e,this.config,t,s);case D.a.FDW:return this.fdwDocumentService.queryGraphicsToSelect(n[0],e,this.config,t,s);case D.a.GDS:return this.gdsService.uidsToGraphicOidsAndTags(e,this.config).pipe(Object(i.a)(e=>{const t={representations:void 0,IDs:Object.keys(e)};return Object(r.a)(t)}));default:return Object(r.a)(void 0)}}getTagsFromGraphics(e,t,n){switch(this.navigationStrategy){case D.a.COMPOSITE:return this.compositeService.getTagsFromGraphics(t,this.config);case D.a.PUBLISHED:return this.publishedDocumentService.getTagsFromGraphics(e,t,n);case D.a.FDW:return this.fdwDocumentService.getTagsFromGraphics(e[0],t,n);case D.a.GDS:return this.gdsService.getTagsFromGraphics(t,n);default:return Object(r.a)(void 0)}}getUidClauseFromMapNodes(e){let t;const n=[],r=[];return e.forEach(e=>{const t=this.graphicsMapService.getMapNodeUid(e);if(t){n.push(t);const e=encodeURIComponent(t).replace(/'/g,"''");r.push(`UID eq '${e}'`)}}),r.length>0&&(t=r.join("or ")),t}removeDuplicatesFromArray(e){return e.filter((e,t,n)=>n.indexOf(e)===t)}queryForTagByInterfaceAndUid(e,t,n){return this.odataService.get(`Objects?$filter=(${e})and contains(Interfaces,'${t}')`,n)}getNavigationStrategy(e){let t=D.a.GRAPHICSMAP;return e?this.viewNativeDataService.getInterfacesForObject(e.obid,e.config).pipe(Object(i.a)(n=>{if(n.indexOf("ISPFCompositeDocumentVersion")>-1)t=D.a.COMPOSITE;else if(n.indexOf("ISPFTEFPublishedDocVersion")>-1)t=D.a.PUBLISHED;else if(n.indexOf("IFDWDocumentVersion")>-1||n.indexOf("ISPFNDocumentVersion")>-1)return this.fdwDocumentService.getNavigationStrategy(e.obid,e.config);return Object(r.a)(t)})):Object(r.a)(t)}getGraphicsByEdgeDef(e,t,n,s,a){const o=this.getGoidProperty(this.navigationStrategy),c=this.getExpandForEdgeDef(t,1e3,o);return this.odataService.get(`Objects('${e}')?${c}`,this.config).pipe(Object(i.a)(e=>{const n=this.getSelectedItemsFromResponse(e,t);if(n&&n.length>0){if(o)return Object(r.a)(n.map(e=>e[o]));{const e=[];return n.forEach(t=>{e.push(t.UID)}),this.queryGraphicsToSelect(e,s,a).pipe(Object(i.a)(e=>e.IDs?Object(r.a)(e.IDs):Object(r.a)([])))}}return Object(r.a)([])}))}addGoid(e,t){const n=this.getPartialMoniker(t);n&&(t=n),e.push(t)}getPartialMoniker(e){let t;const n=e.indexOf(g.g);return n>0&&(t=e.substr(n)),t}getMinimumBoundingRange(e,t,n){let r,s,a;return e.reduce((e,i)=>{let o;const c=i[t];return o=Array.isArray(c)?c[0]:c,o&&null!=o.Range1X&&(s=[o.Range1X,o.Range1Y,o.Range1Z],a=[o.Range2X,o.Range2Y,o.Range2Z],r=this.build3DRangeObject(a,s,n),void 0===e?e=r:(e.min=e.min.map((e,t)=>r.min[t]<e?r.min[t]:e),e.max=e.max.map((e,t)=>r.max[t]>e?r.max[t]:e))),e},void 0)}build3DRangeObject(e,t,n=!1){let r=!1;if(e.some(e=>void 0===e)||t.some(e=>void 0===e))return void this.loggingService.info("Unable to use invalid range value: undefined");e.some(e=>e.indexOf("m")>-1)&&t.some(e=>e.indexOf("m")>-1)&&(r=!0);let s=[],a=[];return r?(s=this.convertRangeInMeters(e),a=this.convertRangeInMeters(t)):(s=this.convertRangeToMeters(e,n),a=this.convertRangeToMeters(t,n)),s&&a?{max:s,min:a}:void 0}convertRangeToMeters(e,t){const n=[];let r;for(let s=0;s<3;s++){if(r=this.convertRangeValueStringToNumber(e[s]),isNaN(r))return void this.loggingService.info("Unable to use invalid range value: "+e[s]);n.push(!1===t?r/8e4:r)}return n}convertRangeInMeters(e){const t=[];let n,r;for(let s=0;s<3;s++){if(n=e[s].substring(0,e[s].indexOf("m")-1),r=this.convertRangeValueStringToNumber(n),isNaN(r))return void this.loggingService.info("Unable to use invalid range value: "+n);t.push(r)}return t}convertRangeValueStringToNumber(e){let t=Number(e);if(isNaN(t)){const n=e.lastIndexOf(",");n>0&&3!=e.length-n-1&&(e=e.substr(0,n)+"."+e.substr(n+1),t=Number(e))}return t}edgeDefToGraphDefRels(e){return e.map(e=>e.startsWith("+")?e.substr(1)+"_12":e.startsWith("-")?e.substr(1)+"_21":e)}addSelectedItemsForNode(e,t,n){const r=t.find(t=>e.hasOwnProperty(t));if(r){const s=e[r];s&&(Array.isArray(s)?s.forEach(e=>{this.addSelectedItemsForNode(e,t,n)}):this.addSelectedItemsForNode(s,t,n))}else n.push(e)}isEdgeAPath(e){return e.startsWith("+")||e.startsWith("-")}getSelectedItemsFromResponse(e,t){if(this.isEdgeAPath(t)){const n=[],r=this.edgeDefToGraphDefRels(t.split(","));return this.addSelectedItemsForNode(e.value,r,n),n}return e.value[t]}getExpandForEdgeDef(e,t,n){if(this.isEdgeAPath(e)){const r=this.edgeDefToGraphDefRels(e.split(","));let s="";r.forEach((e,t)=>{s+=`$expand=${e}(`});for(let e=0;e<r.length;e++)0===e&&n?s+=`$select=${n};`:0!==e&&(s+=";"),s+=`$top=${t})`;return s}return n?`$expand=${e}($select=${n};$top=${t})`:`$expand=${e}($top=${t})`}getGoidProperty(e){return e===D.a.GDS?"Graphics3DGUID":void 0}}return e.\u0275fac=function(t){return new(t||e)(b.dc(l.a),b.dc(d.a),b.dc(I.a),b.dc(c.a),b.dc(p.a),b.dc(h.a),b.dc(f.a),b.dc(m.a),b.dc(O.a),b.dc(u.a),b.dc(v.a))},e.\u0275prov=b.Ob({token:e,factory:e.\u0275fac}),e})()},grnA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return e[e.PUBLISHED=0]="PUBLISHED",e[e.COMPOSITE=1]="COMPOSITE",e[e.FDW=2]="FDW",e[e.GRAPHICSMAP=3]="GRAPHICSMAP",e[e.GDS=4]="GDS",e}({})},h915:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("LRne"),s=n("cp0P"),a=n("lJxs"),i=n("tCxB"),o=n("A3La"),c=n("zj8V"),u=n("fXoL");let h=(()=>{class e{constructor(e,t){this.odataService=e,this.loggingService=t,this.MAX_COMPOSITE_DOCUMENTS=1e4}filterTagNames(e,t,n,r){const s=`OBID eq '${encodeURIComponent(e)}'`;return this.odataService.get(`Objects?$filter=contains(Interfaces,'ISPFTEFPublishedObjectCollection')and ${n} and EDG_SharedTagComposites/any(d:d/${s})&${r}&$select=Name`,t).pipe(Object(a.a)(e=>{const t=[];return e.value.length>0&&e.value.forEach(e=>{t.push(e.Name)}),t}))}onSearch(e,t,n,r){const s={graphics:[],name:[],totalCount:void 0,displayCount:void 0},i=`OBID eq '${encodeURIComponent(e)}'`;return this.odataService.get(`Objects?$filter=contains(Interfaces,'IDrawingRepresentation')and EDG_RepresentationSharedObjects/any(${n})and EDG_RepresentationComposites/any(d:d/${i})${r}&$select=GraphicOID&$count=true&$expand=DwgRepresentationComposition_21,EDG_RepresentationSharedObjects`,t).pipe(Object(a.a)(e=>(s.totalCount=e.count,s.displayCount=e.value.length,this.getCompositeMonikersForRepresentationsSearch(s.graphics,e.value,s.name),s)))}getCompositeToolDocuments(e,t){return this.odataService.get(`Objects('${e}')?$expand=SPFCompositeDocVersionComposition_12($top=${this.MAX_COMPOSITE_DOCUMENTS};$count=true;$expand=EDG_VersionToolDocument,SPFFileComposition_21($filter=endswith(Name,'.zvf');$expand=SPFFileGraphicsMap_12))`,t).pipe(Object(a.a)(e=>{const t=[];this.compositeToolDocUIDsByFileBase={};const n=e.value;if(n){const e=n.SPFCompositeDocVersionComposition_12;e&&(n.hasOwnProperty("SPFCompositeDocVersionComposition_12@odata.count")&&this.loggingService.info("Composite document count="+n["SPFCompositeDocVersionComposition_12@odata.count"]),e.forEach(e=>{const n=e.EDG_VersionToolDocument;if(n&&n.length>0){const r=n[0];t.push(r);const s=e.SPFFileComposition_21;s&&s.forEach(e=>{const t=e.SPFFileGraphicsMap_12;if(t){const e=t.UID,n=r.UID;e&&n&&(this.compositeToolDocUIDsByFileBase[e]=n)}})}}))}return t}))}getTagsFromGraphics(e,t){const n={};let s,i,o;const c=[];e.forEach(e=>{s=this.splitCompositeMoniker(e),void 0!==s&&(o=s[0],i=s[1],n.hasOwnProperty(o)||(n[o]=new Array,c.push(o)),n[o].push(i))});const u=[];let h,p;if(c.forEach(e=>{this.compositeToolDocUIDsByFileBase.hasOwnProperty(e)&&(p=`UID eq '${encodeURIComponent(this.compositeToolDocUIDsByFileBase[e])}'`,h=this.getGraphicOIDClause(n[e]),u.push(`((${h})and DwgRepresentationComposition_21/any(d:d/${p}))`))}),u.length>0){const e=u.join("or");return this.odataService.get(`Objects?$filter=contains(Interfaces,'IDrawingRepresentation')and(${e})&$expand=EDG_RepresentationSharedObjects`,t).pipe(Object(a.a)(e=>{const t=[];return e.value.length>0&&e.value.forEach(e=>{e.EDG_RepresentationSharedObjects&&e.EDG_RepresentationSharedObjects.length>0&&e.EDG_RepresentationSharedObjects.forEach(e=>{t.push(e)})}),t}))}return Object(r.a)([])}queryGraphicsToSelect(e,t,n,r,i){i||(i="UID");const o={representations:[],IDs:[]};let c,u=[];const h=[];let p;const d=`OBID eq '${encodeURIComponent(e)}'`;return t.forEach((e,s)=>{u.push(`${i} eq '${encodeURIComponent(e)}'`),(5===u.length||s===t.length-1&&u.length>0)&&(c=u.join(" or "),p=`Objects?$filter=(${c}) and contains(Interfaces,'ISPFTEFPublishedObjectCollection')&$expand=EDG_SharedObjectRepresentations($top=${r};$count=true;$filter=EDG_RepresentationComposites/any(d:d/${d});$select=OBID,GraphicOID;$expand=DwgRepresentationComposition_21)`,h.push(this.odataService.get(p,n)),u=[])}),Object(s.a)(...h).pipe(Object(a.a)(e=>(e&&e.length>0&&e.forEach(e=>{e.value.length>0&&e.value.forEach(e=>{this.addCompositeMonikersForRepresentations(o.IDs,e.EDG_SharedObjectRepresentations),o.representations=o.representations.concat(e.EDG_SharedObjectRepresentations)})}),o)))}addCompositeMonikersForRepresentations(e,t){t.forEach(t=>{const n=this.getCompositeMonikerForRepresentation(t);n&&e.push(n)})}getCompositeMonikersForRepresentationsSearch(e,t,n){const r=[];t.forEach(e=>{const t=this.getCompositeMonikerForRepresentation(e);r.push(e.EDG_RepresentationSharedObjects[0].Name+"@@SPF@@"+t)}),r.sort(),r.forEach(t=>{const r=t.split("@@SPF@@");r[0]&&r[1]&&(n.push(r[0]),e.push(r[1]))})}getCompositeMonikerForRepresentation(e){let t,n;if(e&&e.DwgRepresentationComposition_21){let r;n=e.GraphicOID,r=this.getPartialMoniker(n),r&&(n=r);const s=this.getFileBaseByToolDocUID(e.DwgRepresentationComposition_21.UID);s&&(t=`${s} ${n}`)}return t}getFileBaseByToolDocUID(e){let t;return this.compositeToolDocUIDsByFileBase&&(t=Object.getOwnPropertyNames(this.compositeToolDocUIDsByFileBase).find(t=>this.compositeToolDocUIDsByFileBase[t]===e)),t}splitCompositeMoniker(e){const t=[],n=e.indexOf(" ");return n>0&&(t.push(e.substring(0,n)),t.push(e.substring(n+1))),t}getGraphicOIDClause(e){let t;const n=[];if(e&&e.length>0){const t=this.checkForPartialMonikers(e[0]);e.forEach((e,r)=>{n.push(t?`endswith(GraphicOID,'${encodeURIComponent(e)}')`:`GraphicOID eq '${encodeURIComponent(e)}'`)})}return n.length>0&&(t=n.join("or ")),t}checkForPartialMonikers(e){return e.startsWith(c.g)}getPartialMoniker(e){let t;const n=e.indexOf(c.g);return n>0&&(t=e.substr(n)),t}}return e.\u0275fac=function(t){return new(t||e)(u.dc(o.a),u.dc(i.a))},e.\u0275prov=u.Ob({token:e,factory:e.\u0275fac}),e})()},jYMS:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("tk/3"),s=n("LRne"),a=n("cp0P"),i=n("z6cu"),o=n("eIep"),c=n("JIr8"),u=n("lJxs"),h=n("Z9D8"),p=n("HLw3"),d=n("tCxB"),l=n("A3La"),g=n("grnA"),D=n("fXoL");let f=(()=>{class e{constructor(e,t,n){this.odataService=e,this.loggingService=t,this.batchRequestFactory=n}getNavigationStrategy(e,t){return this.odataService.get(`Objects('${e}')?$expand=EDG_DocumentVersionFDWRepresentations($count=true;$top=0),EDG_VersionFDWDocOPCRepresentations($count=true;$top=0)`,t).pipe(Object(o.a)(e=>{let t=g.a.GRAPHICSMAP;if(e){const n=e.value;if(n){const e="EDG_DocumentVersionFDWRepresentations@odata.count",r="EDG_VersionFDWDocOPCRepresentations@odata.count";let s=0;n.hasOwnProperty(e)&&(s=n[e]),0===s&&n.hasOwnProperty(r)&&(s=n[r]),t=s>0?g.a.FDW:g.a.GRAPHICSMAP}}return Object(s.a)(t)}),Object(c.a)(e=>(this.loggingService.error(e),Object(s.a)(g.a.GRAPHICSMAP))))}getDocumentRevision(e,t){return this.odataService.get(`Objects('${e}')?$expand=SPFRevisionVersions_21`,t).pipe(Object(u.a)(e=>{const t=e.value;let n;return t&&t.SPFRevisionVersions_21&&(n=t.SPFRevisionVersions_21),n}))}filterTagNames(e,t,n,r){const s=this.getRevisionUidClause(e);return this.odataService.get(`Objects?$filter=contains(Interfaces,'IFDWTag')and ${n} and FDWDocRevAllTags_21/any(d:d/${s})&${r}&$select=Name`,t).pipe(Object(u.a)(e=>{const t=[];return e.value.length>0&&e.value.forEach(e=>{t.push(e.Name)}),t}))}onSearch(e,t,n,r){const s={graphics:[],name:[],totalCount:void 0,displayCount:void 0};return r=r.substr(1),n=n.substr(4),this.odataService.get(`Objects('${e.OBID}')?$expand=FDWDocRevAllTags_12($filter=(${n});$orderby=Name;$count=true;${r};$expand=FDWDrawingRepresentationFDWTag_21($filter=(FDWDocumentRevisionDrawingRepresentation_21/any(x: x/OBID eq '${e.OBID}'));$select=FDWGraphicOID))`,t).pipe(Object(u.a)(e=>{const t=null==e?void 0:e.value;if(t){const e="FDWDocRevAllTags_12@odata.count";s.totalCount=t.hasOwnProperty(e)?t[e]:0;const n="FDWDocRevAllTags_12",r=t.hasOwnProperty(n)?t[n]:[];this.addGoidsForRepresentationsForSearch(s,r)}else s.displayCount=0,s.totalCount=0;return s}))}queryGraphicsToSelect(e,t,n,r,s){s||(s="UID");const i={representations:[],IDs:[]};let o,c=[];const h=this.getRevisionUidClause(e),p=[];let d;return c=[],t.forEach((e,a)=>{c.push(`${s} eq '${encodeURIComponent(e)}'`),(5===c.length||a===t.length-1&&c.length>0)&&(o=c.join(" or "),d=`Objects?$filter=(${o}) and contains(Interfaces,'IFDWTag')&$expand=FDWDrawingRepresentationFDWTag_21($top=${r};$count=true;$filter=FDWDocumentRevisionDrawingRepresentation_21/any(d:d/${h});$select=OBID,FDWGraphicOID)`,p.push(this.odataService.get(d,n)),c=[])}),Object(a.a)(...p).pipe(Object(u.a)(e=>(e&&e.length>0&&e.forEach(e=>{e.value.length>0&&e.value.forEach(e=>{this.addGoidsForRepresentations(i.IDs,e.FDWDrawingRepresentationFDWTag_21),i.representations=i.representations.concat(e.FDWDrawingRepresentationFDWTag_21)})}),i)))}getTagsFromGraphics(e,t,n){const s=this.batchRequestFactory.createBatchRequest(),a=new r.d({Prefer:'odata.include-annotations="*"'}),o=this.getRevisionUidClause(e);if(t.forEach(e=>{const t=`FDWGraphicOID eq '${encodeURIComponent(e)}'`;s.addGetRequest(`Objects?$filter=(${t})and contains(Interfaces,'IFDWDrawingRepresentation')and FDWDocumentRevisionDrawingRepresentation_21/any(d:d/${o})&$expand=FDWDrawingRepresentationFDWTag_12`,!0,n,!1,void 0,a)}),1===t.length){const e=`FDWGraphicOID eq '${encodeURIComponent(t[0])}'`;s.addGetRequest(`Objects?$filter=(${e})and contains(Interfaces,'IFDWDrawingRepresentation')and EDG_FDWDocOPCRepDocRevisions/any(x:x/${o})&$expand=FDWDocOPCDrawingRepresentation_21`)}return s.execute().pipe(Object(u.a)(e=>{const t=[];return e.forEach(e=>{e&&e.data&&e.data.value&&e.data.value.length>0&&e.data.value.forEach(e=>{e.FDWDrawingRepresentationFDWTag_12&&e.FDWDrawingRepresentationFDWTag_12.length>0?e.FDWDrawingRepresentationFDWTag_12.forEach(e=>{t.push(e)}):e.FDWDocOPCDrawingRepresentation_21&&t.push(e.FDWDocOPCDrawingRepresentation_21)})}),t}),Object(c.a)(e=>{const t=new h.a(e,e.message,"fdwDocumentService","getTagsFromGraphics");return Object(i.a)(t)}))}getRevisionUidClause(e){return`UID eq '${encodeURIComponent(e.UID)}'`}addGoidsForRepresentations(e,t){t.forEach(t=>{let n;n=t.FDWGraphicOID,n&&e.push(n)})}addGoidsForRepresentationsForSearch(e,t){const n={};t.forEach(t=>{if(t.hasOwnProperty("FDWDrawingRepresentationFDWTag_21")){const r=t.FDWDrawingRepresentationFDWTag_21;if(r&&r.length>0){const s=t.OBID;n.hasOwnProperty(s)||(n[s]=!0,e.name.push(t.Name),e.graphics.push(r[0].FDWGraphicOID))}}}),e.displayCount=e.name.length}}return e.\u0275fac=function(t){return new(t||e)(D.dc(l.a),D.dc(d.a),D.dc(p.a))},e.\u0275prov=D.Ob({token:e,factory:e.\u0275fac}),e})()},mRmt:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("tk/3"),s=n("cp0P"),a=n("lJxs"),i=n("A3La"),o=n("zj8V"),c=n("fXoL");let u=(()=>{class e{constructor(e){this.odataService=e}filterTagNames(e,t,n,r){const s=this.getToolDocUidClause(e);return this.odataService.get(`Objects?$filter=contains(Interfaces,'ISPFTEFPublishedObjectCollection')and ${n} and EDG_SharedTagDocuments/any(d:d/${s})&${r}&$select=Name`,t).pipe(Object(a.a)(e=>{const t=[];return e.value.length>0&&e.value.forEach(e=>{t.push(e.Name)}),t}))}onSearch(e,t,n,r){const s={graphics:[],name:[],totalCount:void 0,displayCount:void 0},i=this.getToolDocUidClause(e);return this.odataService.get(`Objects?$filter=contains(Interfaces,'IDrawingRepresentation')and EDG_RepresentationSharedObjects/any(${n})and DwgRepresentationComposition_21/any(d:d/${i})${r}&$select=GraphicOID&$count=true&$expand=EDG_RepresentationSharedObjects`,t).pipe(Object(a.a)(e=>(s.totalCount=e.count,s.displayCount=e.value.length,s.displayCount>0&&this.addGoidsForRepresentationsForSearch(s.graphics,e.value,s.name),s)))}queryGraphicsToSelect(e,t,n,r,i){i||(i="UID");const o={representations:[],IDs:[]};let c,u=[];const h=this.getToolDocUidClause(e),p=[];let d;return u=[],"NAME"===i.toUpperCase()?t.forEach((e,r)=>{u.push(`${i} eq '${encodeURIComponent(e)}'`),(5===u.length||r===t.length-1&&u.length>0)&&(c=u.join(" or "),d=`Objects?$filter=contains(Interfaces,'IDrawingRepresentation')and EDG_RepresentationSharedObjects/any(d:d/${c})and DwgRepresentationComposition_21/any(d:d/${h})&$top=1000&$select=OBID,GraphicOID&$count=true`,p.push(this.odataService.get(d,n)),u=[])}):t.forEach((e,s)=>{u.push(`${i} eq '${encodeURIComponent(e)}'`),(5===u.length||s===t.length-1&&u.length>0)&&(c=u.join(" or "),d=`Objects?$filter=(${c}) and contains(Interfaces,'ISPFTEFPublishedObjectCollection')&$expand=EDG_SharedObjectRepresentations($top=${r};$count=true;$filter=DwgRepresentationComposition_21/any(d:d/${h});$select=OBID,GraphicOID)`,p.push(this.odataService.get(d,n)),u=[])}),Object(s.a)(...p).pipe(Object(a.a)(e=>(e&&e.length>0&&e.forEach(e=>{e.value.length>0&&("NAME"===i.toUpperCase()?e.value.forEach(e=>{this.addGoid(o.IDs,e.GraphicOID)}):e.value.forEach(e=>{this.addGoidsForRepresentations(o.IDs,e.EDG_SharedObjectRepresentations),o.representations=o.representations.concat(e.EDG_SharedObjectRepresentations)}))}),o)))}getTagsFromGraphics(e,t,n){const s=[],i=this.getToolDocUidClause(e),o=`Objects?$filter=(${this.getGraphicOIDClause(t)})and contains(Interfaces,'IDrawingRepresentation')and DwgRepresentationComposition_21/any(d:d/${i})&$expand=EDG_RepresentationSharedObjects`,c=new r.d({Prefer:'odata.include-annotations="*"'});return this.odataService.get(o,n,!1,void 0,c).pipe(Object(a.a)(e=>(e.value.length>0&&e.value.forEach(e=>{e.EDG_RepresentationSharedObjects&&e.EDG_RepresentationSharedObjects.length>0&&e.EDG_RepresentationSharedObjects.forEach(e=>{s.push(e)})}),s)))}getToolDocUidClause(e){let t;const n=[];return e.forEach(e=>{n.push(`UID eq '${encodeURIComponent(e.UID)}'`)}),n.length>0&&(t=n.join(" or ")),t}addGoidsForRepresentations(e,t){t.forEach(t=>{let n;n=t.GraphicOID,n&&this.addGoid(e,n)})}addGoidsForRepresentationsForSearch(e,t,n){const r=[];t.forEach(e=>{r.push(e.EDG_RepresentationSharedObjects[0].Name+"@@SPF@@"+e.GraphicOID)}),r.sort(),r.forEach(t=>{const r=t.split("@@SPF@@");r[0]&&r[1]&&(n.push(r[0]),this.addGoid(e,r[1]))})}addGoid(e,t){const n=this.getPartialMoniker(t);n&&(t=n),e.push(t)}getPartialMoniker(e){let t;const n=e.indexOf(o.g);return n>0&&(t=e.substr(n)),t}getGraphicOIDClause(e){let t;const n=[];if(e&&e.length>0){const t=this.checkForPartialMonikers(e[0]);e.forEach((e,r)=>{n.push(t?`endswith(GraphicOID,'${encodeURIComponent(e)}')`:`GraphicOID eq '${encodeURIComponent(e)}'`)})}return n.length>0&&(t=n.join("or ")),t}checkForPartialMonikers(e){return e.startsWith(o.g)}}return e.\u0275fac=function(t){return new(t||e)(c.dc(i.a))},e.\u0275prov=c.Ob({token:e,factory:e.\u0275fac}),e})()},tAal:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("ofXK"),s=n("vFAW"),a=n("fXoL");let i=(()=>{class e{}return e.\u0275mod=a.Qb({type:e}),e.\u0275inj=a.Pb({factory:function(t){return new(t||e)},imports:[[r.c]]}),e})(),o=(()=>{class e{}return e.\u0275mod=a.Qb({type:e}),e.\u0275inj=a.Pb({factory:function(t){return new(t||e)},imports:[[r.c,s.a,i]]}),e})()},zj8V:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"o",(function(){return s})),n.d(t,"i",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"p",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"j",(function(){return h})),n.d(t,"m",(function(){return p})),n.d(t,"n",(function(){return d})),n.d(t,"l",(function(){return l})),n.d(t,"g",(function(){return g})),n.d(t,"a",(function(){return D})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return O}));const r=["EB9D05","FFFF66","64F54B","9999FF","64A5FF","0AFAFF","C83232","CCCC00","31B237","555596","3264C8","32B4B4","960000","808000","336600","660066","333399","006666"],s="74767A",a=1,i=3,o=5,c=99,u=97,h={materialID:u,color:[.922,.616,.02,1],transparency:0},p=98,d=.7,l={materialID:p,color:[.455,.463,.478,.5],transparency:d},g=" @",D="Class@Intergraph.SPF.Server.API.Model.ClassDisplayNameAnnotation",f="FFFFFF",m=96,O=95}}]);