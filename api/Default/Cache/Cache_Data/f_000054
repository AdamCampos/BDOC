(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{"+T9e":function(e,t,i){"use strict";i.d(t,"a",(function(){return E}));var n=i("mrSG"),o=i("IzEk"),a=i("ONOH"),s=i("Z9D8"),r=i("LUpO"),c=i("PoZZ"),l=i("d74k"),d=i("Ejbi"),h=i("W5cs"),p=i("gBNM"),u=i("UVhF"),m=i("zewe"),f=i("fXoL"),g=i("ofXK"),D=i("TLn4"),b=i("qx4N"),I=i("+qkj");function _(e,t){if(1&e&&f.Tb(0,"sda-loading-indicator",3),2&e){const e=f.lc();f.sc("message",e.OBJECT_DETAILS_LOADING)("centered",!0)}}function y(e,t){if(1&e&&(f.Yb(0,"div",4),f.Tb(1,"sda-form-controls",5),f.Xb()),2&e){const e=f.lc();f.Ib("object-details--fixed-height",e.relatedItemTabs.length>0),f.Eb(1),f.sc("form",e.form)("isEditable",!1)}}function S(e,t){if(1&e&&f.Tb(0,"sda-related-items-section",6),2&e){const e=f.lc();f.sc("tabs",e.relatedItemTabs)}}let E=(()=>{class e{constructor(e,t,i,n,o,a,s){this.formService=e,this.exceptionService=t,this.filterService=i,this.objectDetailsService=n,this.sdaTranslateService=o,this.changeDetection=a,this.configService=s,this.relatedItemTabs=[],this.initialized=!1,this.OBJECT_DETAILS_LOADING=this.sdaTranslateService.get("OBJECT_DETAILS_LOADING","Loading object details, please wait..."),this.OBJECT_DETAILS_ERROR=this.sdaTranslateService.get("INITIALISATION_ERROR","An error occurred whilst initializing"),this.showTodoListForm=!1}ngOnChanges(){this.getFormSubscription&&this.getFormSubscription.unsubscribe(),this.buildForm()}ngOnDestroy(){this.getFormSubscription&&this.getFormSubscription.unsubscribe()}buildForm(){try{this.id&&this.config&&(this.initialized=!1,this.getFormSubscription=this.formService.getForm(this.id,this.config,this.methodOBID,this.showTodoListForm).pipe(Object(o.a)(1)).subscribe(e=>{this.relatedItemTabs=[];const t=this.formService.filterDisplayItemsByDisplayType(e,"RelationshipMaintenance"),{filteredItems:i=[]}=t,o=Object(n.a)(t,["filteredItems"]);this.form=o,this.generateGridTabs(i),this.initialized=!0,this.changeDetection.detectChanges()}))}catch(e){const t=new s.a(e,this.OBJECT_DETAILS_ERROR,"ObjectDetailsComponent","buildForm");this.exceptionService.handleException(t)}}generateGridTabs(e){e.forEach(e=>{const t=e.navigation?new p.a(e.name,`Objects('${e.obid}')/${e.navigation}?$count=true`,this.config,void 0,e.obid,e.navigation):new p.a(e.name,void 0,this.config);t.isRowSelectable=!0,t.config=this.config,t.onCellClicked=e=>this.routeToDetailsView(e),this.relatedItemTabs.push(t)})}routeToDetailsView(e){this.objectDetailsService.showObjectDetailsForm(this.filterService.createLinkOdataQueryFilter(this.getDataSource(e),e.parentTab.parentOBID,e.parentTab.parentRelDef,void 0),e.object.OBID,this.configService.selectedQueryConfigs,e.parentTab.columnSetUID)}getDataSource(e){const t=new kendo.data.DataSource,i=new h.a,n=[new l.a(e.parentTab.state.sort[0].field,e.parentTab.state.sort[0].dir)];return t.filter(i),t.page=()=>e.parentTab.currentPageNumber,t.sort=()=>n,t}}return e.\u0275fac=function(t){return new(t||e)(f.Sb(u.a),f.Sb(r.a),f.Sb(c.a),f.Sb(m.a),f.Sb(d.a),f.Sb(f.h),f.Sb(a.a))},e.\u0275cmp=f.Mb({type:e,selectors:[["sda-object-details"]],inputs:{id:"id",config:"config",methodOBID:"methodOBID",showTodoListForm:"showTodoListForm"},features:[f.Cb],decls:3,vars:3,consts:[[3,"message","centered",4,"ngIf"],["class","object-details",3,"object-details--fixed-height",4,"ngIf"],[3,"tabs",4,"ngIf"],[3,"message","centered"],[1,"object-details"],[3,"form","isEditable"],[3,"tabs"]],template:function(e,t){1&e&&(f.Sc(0,_,1,2,"sda-loading-indicator",0),f.Sc(1,y,2,4,"div",1),f.Sc(2,S,1,1,"sda-related-items-section",2)),2&e&&(f.sc("ngIf",!t.initialized),f.Eb(1),f.sc("ngIf",t.initialized),f.Eb(1),f.sc("ngIf",t.initialized&&t.relatedItemTabs.length>0))},directives:[g.t,D.a,b.a,I.a],styles:[".object-details[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]{display:flex;flex:1;flex-direction:column;height:100%}.object-details[_ngcontent-%COMP%]{display:flex;flex:1 1 100%;flex-direction:column;border-bottom:1px solid #cad0d7}"]}),e})()},"+qkj":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Ejbi"),o=i("fXoL"),a=i("7EHt"),s=i("HXFx");let r=(()=>{class e{constructor(e){this.sdaTranslateService=e,this.FORM_RELATED_ITEMS=this.sdaTranslateService.get("FORM_RELATED_ITEMS","Related Items")}}return e.\u0275fac=function(t){return new(t||e)(o.Sb(n.a))},e.\u0275cmp=o.Mb({type:e,selectors:[["sda-related-items-section"]],inputs:{tabs:"tabs"},decls:6,vars:5,consts:[["displayMode","flat"],[1,"related-items-panel",3,"expanded"],["collapsedHeight","38px","expandedHeight","38px"],[3,"tabs","openInfoMapInNewTab","showItemCount"]],template:function(e,t){1&e&&(o.Yb(0,"mat-accordion",0),o.Yb(1,"mat-expansion-panel",1),o.Yb(2,"mat-expansion-panel-header",2),o.Yb(3,"mat-panel-title"),o.Uc(4),o.Xb(),o.Xb(),o.Tb(5,"sda-tabbed-grid-view",3),o.Xb(),o.Xb()),2&e&&(o.Eb(1),o.sc("expanded",!0),o.Eb(3),o.Wc(" ",t.FORM_RELATED_ITEMS," "),o.Eb(1),o.sc("tabs",t.tabs)("openInfoMapInNewTab",!0)("showItemCount",!0))},directives:[a.a,a.c,a.g,a.h,s.a],styles:[".related-items-panel[_ngcontent-%COMP%]{border-radius:0!important;box-shadow:none!important}.related-items-panel.mat-expanded[_ngcontent-%COMP%]{overflow:visible;-webkit-animation:delay-overflow 1s;animation:delay-overflow 1s}.related-items-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{background-color:#ebedf0!important}.related-items-panel[_ngcontent-%COMP%]     .mat-expansion-panel-body{padding:0}.related-items-panel[_ngcontent-%COMP%]     sda-tabbed-grid-view{flex:none;height:auto}.related-items-panel[_ngcontent-%COMP%]     sda-tabbed-grid-view mat-tab-group{height:40vh;min-height:250px;border-top:1px solid #cad0d7}"]}),e})()},K9v4:function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var n=i("ofXK"),o=i("3Pt+"),a=i("tyNb"),s=i("F+hv"),r=i("txXS"),c=i("Tfoa"),l=i("uD/B"),d=i("BLqR"),h=i("+T9e"),p=i("fXoL"),u=i("TLn4"),m=i("ue3H"),f=i("qx4N"),g=i("+qkj"),D=i("RY2J"),b=i("HDO1"),I=i("4dwF"),_=i("dLJk"),y=i("F8dI"),S=i("rrPm"),E=i("8OmR"),v=i("ltBE"),O=i("XwBL");let N=(()=>{class e{transform(e){return O.a.replaceUnderscore(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=p.Rb({name:"sdaFormatEntityType",type:e,pure:!0}),e})();var T=i("7Ihv");let P=(()=>{class e{}return e.\u0275mod=p.Qb({type:e}),e.\u0275inj=p.Pb({factory:function(t){return new(t||e)},imports:[[n.c,o.j,r.a,a.k,s.a,l.a,c.a]]}),e})();p.Nc(d.a,[n.q,n.r,n.s,n.t,n.A,n.w,n.x,n.y,n.z,n.u,n.v,o.F,o.u,o.E,o.c,o.v,o.y,o.a,o.B,o.C,o.x,o.p,o.q,o.A,o.l,o.k,o.w,o.b,o.d,o.s,o.t,o.r,a.l,a.h,a.j,a.i,a.n,u.a,m.a,f.a,g.a,h.a,d.a],[n.b,n.G,n.p,n.k,n.E,n.g,n.C,n.F,n.d,n.f,n.i,n.j,n.l,D.a,b.a,I.a,_.a,y.a,S.a,E.a,v.a,N,T.a])},R6aW:function(e,t,i){"use strict";i.r(t),i.d(t,"AdminEntryPointsRoutingModule",(function(){return ft}));var n=i("ofXK"),o=i("7EHt"),a=i("/RsI"),s=i("57Ap"),r=i("ZI9S"),c=i("F+hv"),l=i("8Vnw"),d=i("GDd0"),h=i("YsCO"),p=i("tyNb"),u=i("4B5/"),m=i("YwUS"),f=i("Z9D8"),g=i("LUpO"),D=i("C4gn"),b=i("c+03"),I=i("B5lr"),_=i("yESu"),y=i("/oMx"),S=i("7Ekh"),E=i("PEjJ"),v=i("iwlc"),O=i("Ejbi"),N=i("NEWU"),T=i("FedY"),P=i("41Lq"),w=i("yzqN"),C=i("izpr"),A=i("lJxs"),R=i("5+tZ"),M=i("I2fW"),x=i("J7mc");class F{constructor(e,t,i){this.name=e,this.type=t,this.data=i,this.children=[]}}var L=i("+eYH");class V extends L.a{constructor(e,t,i,n,o,a,s){super(e,i,n),this.obid=e,this.uid=t,this.name=i,this.config=n,this.displayAs=o,this.entityType=a,this.data=s,this.uid=t}}var k=i("fXoL");let B=(()=>{class e{constructor(e,t){this.dataService=e,this.objectIconService=t,this.editIconPath="content/images/shortcuts/edit.svg",this.pageSize=6}getAllRoles(){return this.dataService.get("Objects?$filter=Class eq 'SPFRole'&$top=1000").pipe(Object(A.a)(e=>e.map(e=>new V(e.OBID,e.UID,e.Name,e.Config))))}getNavigationUpdateForm(e){return this.dataService.get("GetNavigationUpdateForm(ObjectOBID='"+e+"')").pipe(Object(A.a)(e=>e[0]))}updateNavigationFromForm(e,t){return this.dataService.post("UpdateNavigationFromForm()",JSON.stringify({ObjectOBID:t,Form:e}))}getEntryPointMaintenanceObject(e,t,i,n,o){return this.dataService.post("GetEntryPointMaintenancePageDetails",JSON.stringify({SourceOBID:e,RoleOBID:i,InfoMapEnabled:n,ApplyAccessRestrictions:o})).pipe(Object(R.a)(e=>this.buildInfoMapTree(e)))}buildInfoMapTree(e){return this.buildIconsForOBIDs(e).pipe(Object(A.a)(t=>{const i=[];if(e.RoleHasAccess){const n=e.ChildrenNavigationObjects.sort((e,t)=>T.a.sortByString(e.DisplayName,t.DisplayName)),o=n.length;let a=0;a=o<=this.pageSize?1:Math.ceil(o/this.pageSize);const s={};t.forEach(e=>{s[e.OBID]=e.IconName});for(let t=0;t<a;t++)i.push(this.buildPageOfChildren(t,e,s,n))}return i}))}buildPageOfChildren(e,t,i,n){const o=[],a=new F(t.DisplayName,t.ClassDefUID);return a.key=t.OBID,a.image=i[t.OBID],a.count=1,n.slice(e*this.pageSize,e*this.pageSize+this.pageSize).reverse().forEach(e=>{const t=new F(e.DisplayName,e.ClassDefUID);t.image=this.editIconPath,t.key=e.OBID;const n=[];e.PossibleValidEndInterfaces&&e.PossibleValidEndInterfaces.forEach(e=>{const t=new F(e.DisplayName,e.ClassDefUID);t.key=e.OBID,t.count=1,t.image=i[e.OBID],n.push(t)}),t.children=n,o.push(t)}),a.children=o,a}buildIconsForOBIDs(e){const t=[];return t.push(e.OBID),e.ChildrenNavigationObjects&&e.ChildrenNavigationObjects.length>0&&e.ChildrenNavigationObjects.forEach(e=>{e.PossibleValidEndInterfaces.forEach(e=>{t.push(e.OBID)})}),this.objectIconService.getIconNames(t)}}return e.\u0275fac=function(t){return new(t||e)(k.dc(x.a),k.dc(M.a))},e.\u0275prov=k.Ob({token:e,factory:e.\u0275fac}),e})();var j=i("lUp+"),U=i("HDdC"),G=i("+ooB"),z=i("jNCI"),Y=i("8ihU"),H=i("IUya"),X=i("C8de"),W=function(e){return e[e.Name=0]="Name",e[e.Description=1]="Description",e[e.ColumnSetEnd1=2]="ColumnSetEnd1",e[e.ColumnSetEnd2=3]="ColumnSetEnd2",e[e.Role1=4]="Role1",e[e.Role1DisplayName=5]="Role1DisplayName",e[e.Role2=6]="Role2",e[e.Role2DisplayName=7]="Role2DisplayName",e}({});let q=(()=>{class e{constructor(e){this.sdaTranslateService=e,this.EDITNAV_REQUIRED_ACCESS_GROUPS=this.sdaTranslateService.get("EDITNAV_REQUIRED_ACCESS_GROUPS","Required Access Groups"),this.EDITNAV_END1_COLUMN_SET=this.sdaTranslateService.get("EDITNAV_END1_COLUMN_SET","End 1 Column set"),this.EDITNAV_END2_COLUMN_SET=this.sdaTranslateService.get("EDITNAV_END2_COLUMN_SET","End 2 Column set"),this.EDITNAV_ROLE1=this.sdaTranslateService.get("EDITNAV_ROLE1","Role 1"),this.EDITNAV_ROLE1_DISPLAY_NAME=this.sdaTranslateService.get("EDITNAV_ROLE1_DISPLAY_NAME","Role 1 display name"),this.EDITNAV_ROLE2=this.sdaTranslateService.get("EDITNAV_ROLE2","Role 2"),this.EDITNAV_ROLE2_DISPLAY_NAME=this.sdaTranslateService.get("EDITNAV_ROLE2_DISPLAY_NAME","Role 2 display name"),this.EDITNAV_HDR_MAIN_DETAILS=this.sdaTranslateService.get("EDITNAV_HDR_MAIN_DETAILS","Main details"),this.EDITNAV_HDR_ACCESS_GROUPS=this.sdaTranslateService.get("EDITNAV_HDR_ACCESS_GROUPS","Access Groups"),this.EDITNAV_COLUMN_SET=this.sdaTranslateService.get("EDITNAV_COLUMN_SET","Column set"),this.EDITNAV_HIDE_FROM_ACTIONS=this.sdaTranslateService.get("EDITNAV_HIDE_FROM_ACTIONS","Hide from Actions"),this.EDITNAV_HIDE_FROM_INFOMAP=this.sdaTranslateService.get("EDITNAV_HIDE_FROM_INFOMAP","Hide from InfoMap"),this.EDITNAV_NAME=this.sdaTranslateService.get("EDITNAV_NAME","Name"),this.EDITNAV_DESCRIPTION=this.sdaTranslateService.get("EDITNAV_DESCRIPTION","Description")}extractRelDefFormData(e,t){const i=e;let n;return n=t[W.ColumnSetEnd1],n&&(i.RelDefEnd1ColumnSet.OBID=this.getSelectedColumnSetOBID(n)),n=t[W.ColumnSetEnd2],n&&(i.RelDefEnd2ColumnSet.OBID=this.getSelectedColumnSetOBID(n)),n=t[W.Role1],n&&(i.Role1=n.Value),n=t[W.Role2DisplayName],n&&(i.Role2DisplayName=n.Value),n=t[W.Role2],n&&(i.Role2=n.Value),n=t[W.Role1DisplayName],n&&(i.Role1DisplayName=n.Value),i.Value=i.AccessGroupRelAttributes.map(e=>e.OBID).join("~"),i}createRelDefEditFormMainDetailsLine(e){const t=[],i={FormDisplayItems:[]};i.FormDisplayItems.push({DisplayName:this.EDITNAV_NAME,DisplayType:X.a.STRING_TYPE,UID:"DI_Name_DisplayItem",FieldSize:55,LabelSize:25,PropertyUID:"Name",Value:e.Name,ReadOnly:!0});const n={FormDisplayItems:[]};n.FormDisplayItems.push({DisplayName:this.EDITNAV_DESCRIPTION,DisplayType:X.a.STRING_TYPE,UID:"DI_Description_DisplayItem",FieldSize:55,LabelSize:25,PropertyUID:"Description",Value:e.Description,ReadOnly:!0});const o={FormDisplayItems:[]};o.FormDisplayItems.push({DisplayName:this.EDITNAV_END1_COLUMN_SET,DisplayType:X.a.RELATIONSHIP_FIND,MaxRels:"1",NavigationPath:"+SPFRelDefEnd1ColumnSet",UID:"DI_ISPFAPIEntryPoint_Column_Set_DisplayItem",Value:e.RelDefEnd1ColumnSet.OBID,FieldSize:0,LabelSize:25,DefaultDropDownOptions:[{OBID:e.RelDefEnd1ColumnSet.OBID,UID:e.RelDefEnd1ColumnSet.UID,DisplayValue:e.RelDefEnd1ColumnSet.DisplayValue,Description:e.RelDefEnd1ColumnSet.Description}],ReadOnly:!1});const a={FormDisplayItems:[]};a.FormDisplayItems.push({DisplayName:this.EDITNAV_END2_COLUMN_SET,DisplayType:X.a.RELATIONSHIP_FIND,MaxRels:"1",NavigationPath:"+SPFRelDefEnd2ColumnSet",UID:"DI_ISPFAPIEntryPoint_Column_Set_DisplayItem",Value:e.RelDefEnd2ColumnSet.OBID,FieldSize:0,LabelSize:25,DefaultDropDownOptions:[{OBID:e.RelDefEnd2ColumnSet.OBID,UID:e.RelDefEnd2ColumnSet.UID,DisplayValue:e.RelDefEnd2ColumnSet.DisplayValue,Description:e.RelDefEnd2ColumnSet.Description}],ReadOnly:!1});const s={FormDisplayItems:[]};s.FormDisplayItems.push({DisplayName:this.EDITNAV_ROLE1,DisplayType:X.a.STRING_TYPE,UID:"DI_Role1_DisplayItem",FieldSize:55,LabelSize:25,PropertyUID:"Role1",Value:e.Role1,ReadOnly:!1});const r={FormDisplayItems:[]};r.FormDisplayItems.push({DisplayName:this.EDITNAV_ROLE1_DISPLAY_NAME,DisplayType:X.a.STRING_TYPE,UID:"DI_Role1DisplayName_DisplayItem",FieldSize:55,LabelSize:25,PropertyUID:"Role1DisplayName",Value:e.Role1DisplayName,ReadOnly:!1});const c={FormDisplayItems:[]};c.FormDisplayItems.push({DisplayName:this.EDITNAV_ROLE2,DisplayType:X.a.STRING_TYPE,UID:"DI_Role2_DisplayItem",FieldSize:55,LabelSize:25,PropertyUID:"Role2",Value:e.Role2,ReadOnly:!1});const l={FormDisplayItems:[]};return l.FormDisplayItems.push({DisplayName:this.EDITNAV_ROLE2_DISPLAY_NAME,DisplayType:X.a.STRING_TYPE,UID:"DI_Role2DisplayName_DisplayItem",FieldSize:55,LabelSize:25,PropertyUID:"Role2DisplayName",Value:e.Role2DisplayName,ReadOnly:!1}),t.push(i,n,o,a,s,r,c,l),t}createRelDefEditFormAccessGroupsLine(e){const t={FormDisplayItems:[]};return t.FormDisplayItems.push({DisplayName:this.EDITNAV_REQUIRED_ACCESS_GROUPS,DisplayType:X.a.RELATIONSHIP_MAINTENANCE,MaxRels:"*",NavigationPath:e.NavigationPath,UID:e.DisplayItemUID,Value:e.Value,FieldSize:35,LabelSize:25}),t}extractEdgeDefFormData(e,t){const i=e;if(!t||!t.FormSections||0===t.FormSections.length)return i;let n=t.FormSections[1].FormDisplayLines[0].FormDisplayItems[0];if(n.DisplayType===X.a.RELATIONSHIP_MAINTENANCE){const e=n;if(e.RelObjects&&e.RelObjects.length>0){const t=e.RelObjects.filter(e=>!e.Terminate).map(e=>e.Key);i.Value=t.join("~")}}return n=t.FormSections[0].FormDisplayLines[2].FormDisplayItems[0],n.DisplayType===X.a.RELATIONSHIP_FIND&&(i.EdgeDefColumnSet.OBID=this.getSelectedColumnSetOBID(n)),n=t.FormSections[0].FormDisplayLines[3].FormDisplayItems[0],n.DisplayType===X.a.BOOLEAN_TYPE&&(i.HideFromUI="true"===n.Value.toLowerCase()),n=t.FormSections[0].FormDisplayLines[4].FormDisplayItems[0],n.DisplayType===X.a.BOOLEAN_TYPE&&(i.HideFromInfoMap="true"===n.Value.toLowerCase()),i}createEdgeDefEditForm(e,t){const i={ContainsTabs:!1,FormSections:new Array,SPFFormTabs:[],ClassDefUID:"EdgeDef",ComplexClassDefDetails:[],IsMainTabValid:!0};let n,o;n={CollapseSection:!1,DisplayName:this.EDITNAV_HDR_MAIN_DETAILS,FormDisplayLines:new Array,IsHidden:!1,RevisionSchemeSection:!1,AssociatedObjectOBIDForUpdate:e},i.FormSections.push(n),n.FormDisplayLines=new Array;let a={ReadOnly:!0,DisplayName:this.EDITNAV_NAME,DisplayType:X.a.STRING_TYPE,UID:"DI_Name_DisplayItem",FieldSize:55,LabelSize:25,PropertyUID:"Name",Value:t.Name};o={FormDisplayItems:[a]},n.FormDisplayLines.push(o),a={ReadOnly:!0,DisplayName:this.EDITNAV_DESCRIPTION,DisplayType:X.a.STRING_TYPE,UID:"DI_Description_DisplayItem",FieldSize:55,LabelSize:25,PropertyUID:"Description",Value:t.Description},o={FormDisplayItems:[a]},n.FormDisplayLines.push(o),o={FormDisplayItems:[{DisplayName:this.EDITNAV_COLUMN_SET,DisplayType:X.a.RELATIONSHIP_FIND,MaxRels:"1",NavigationPath:"+SPFEdgeDefColumnSet",UID:"DI_ISPFAPIEntryPoint_Column_Set_DisplayItem",Value:t.EdgeDefColumnSet.OBID,FieldSize:0,LabelSize:25,DefaultDropDownOptions:[{OBID:t.EdgeDefColumnSet.OBID,UID:t.EdgeDefColumnSet.UID,DisplayValue:t.EdgeDefColumnSet.DisplayValue,Description:t.EdgeDefColumnSet.Description}]}]},n.FormDisplayLines.push(o);let s={DisplayName:this.EDITNAV_HIDE_FROM_ACTIONS,DisplayType:X.a.BOOLEAN_TYPE,UID:"DI_HideEdgeInSPF_DisplayItem",Value:t.HideFromUI?"True":"False",FieldSize:0,LabelSize:25,PropertyUID:"HideEdgeInSPF"};return o={FormDisplayItems:[s]},n.FormDisplayLines.push(o),s={DisplayName:this.EDITNAV_HIDE_FROM_INFOMAP,DisplayType:X.a.BOOLEAN_TYPE,UID:"DI_HideEdgeInInfoMap_DisplayItem",Value:t.HideFromInfoMap?"True":"False",FieldSize:0,LabelSize:25,PropertyUID:"HideEdgeInInfoMap"},o={FormDisplayItems:[s]},n.FormDisplayLines.push(o),n={CollapseSection:!1,DisplayName:this.EDITNAV_HDR_ACCESS_GROUPS,FormDisplayLines:new Array,IsHidden:!1,RevisionSchemeSection:!1,AssociatedObjectOBIDForUpdate:e},i.FormSections.push(n),o={FormDisplayItems:[{DisplayName:this.EDITNAV_REQUIRED_ACCESS_GROUPS,DisplayType:X.a.RELATIONSHIP_MAINTENANCE,MaxRels:"*",NavigationPath:t.NavigationPath,UID:t.DisplayItemUID,Value:t.Value,FieldSize:35,LabelSize:25}]},n.FormDisplayLines.push(o),i}getSelectedColumnSetOBID(e){let t="";const i=e.RelObjects.filter(e=>!e.Terminate).map(e=>e.Key);return i&&1===i.length&&(t=i[0]),t}}return e.\u0275fac=function(t){return new(t||e)(k.dc(O.a))},e.\u0275prov=k.Ob({token:e,factory:e.\u0275fac}),e})();var J=i("819/");function K(e,t){if(1&e&&k.Tb(0,"sda-form-control",1),2&e){const e=k.lc();k.sc("form",e.form)}}let Q=(()=>{class e extends Y.a{constructor(e,t,i,n,o,a,s){super(e),this.loadingOverlayService=t,this.adminDataService=i,this.adminFormService=n,this.notificationService=o,this.exceptionService=a,this.sdaTranslateService=s,this.initialized=!1,this.LOADING_FORM_PLEASE_WAIT=this.sdaTranslateService.get("LOADING_FORM_PLEASE_WAIT","Loading form, please wait..."),this.UPDATE=this.sdaTranslateService.get("UPDATE","Update"),this.CANCEL=this.sdaTranslateService.get("CANCEL","Cancel"),this.NAVIGATION_UPDATED=this.sdaTranslateService.get("NAVIGATION_UPDATED","Navigation updated")}ngOnInit(){this.selectedNavigationID=this.getData(),this.getFormForNavigation(this.selectedNavigationID)}getFormForNavigation(e){this.loadingOverlayService.showLoadingOverlay(this.LOADING_FORM_PLEASE_WAIT),this.adminDataService.getNavigationUpdateForm(e).subscribe(e=>{this.loadingOverlayService.hideLoadingOverlay(),this.navigationDetails=e,this.form=this.adminFormService.createEdgeDefEditForm(this.selectedNavigationID,e),this.initialized=!0},e=>{this.loadingOverlayService.hideLoadingOverlay(),this.exceptionService.handleException(new f.a(e,"Navigation Edit","editnavigation.component","getFormForNavigation"))})}cancel(){const e=new H.a(!1);this.closeModal.next(e)}ok(){this.loadingOverlayService.showLoadingOverlay(),this.navigationDetails=this.adminFormService.extractEdgeDefFormData(this.navigationDetails,this.form),this.adminDataService.updateNavigationFromForm(this.navigationDetails,this.selectedNavigationID).subscribe(e=>{this.loadingOverlayService.hideLoadingOverlay();const t=new H.a(e);this.closeModal.next(t),this.notificationService.success(this.NAVIGATION_UPDATED)})}}return e.\u0275fac=function(t){return new(t||e)(k.Sb(z.a),k.Sb(b.a),k.Sb(B),k.Sb(q),k.Sb(P.a),k.Sb(g.a),k.Sb(O.a))},e.\u0275cmp=k.Mb({type:e,selectors:[["sda-admin-editedgedef-modal"]],features:[k.Bb],decls:1,vars:1,consts:[[3,"form",4,"ngIf"],[3,"form"]],template:function(e,t){1&e&&k.Sc(0,K,1,1,"sda-form-control",0),2&e&&k.sc("ngIf",t.initialized)},directives:[n.t,J.a],encapsulation:2}),e})();var Z=i("QIK8"),ee=i("+0xr"),te=i("bSwM");function ie(e,t){1&e&&k.Tb(0,"mat-header-cell")}function ne(e,t){if(1&e&&(k.Yb(0,"mat-cell"),k.Uc(1),k.Xb()),2&e){const e=t.$implicit;k.Eb(1),k.Vc(e.DisplayName)}}function oe(e,t){if(1&e&&(k.Yb(0,"mat-header-cell"),k.Uc(1),k.Xb()),2&e){const e=k.lc();k.Eb(1),k.Wc(" ",e.EDITNAV_AG_HDR_EXPAND12," ")}}function ae(e,t){if(1&e&&(k.Yb(0,"mat-cell",15),k.hc("click",(function(){const e=t.$implicit;return e.Expand12=!e.Expand12})),k.Tb(1,"mat-checkbox",16),k.Xb()),2&e){const e=t.$implicit;k.Eb(1),k.sc("checked",e.Expand12)}}function se(e,t){if(1&e&&(k.Yb(0,"mat-header-cell"),k.Uc(1),k.Xb()),2&e){const e=k.lc();k.Eb(1),k.Wc(" ",e.EDITNAV_AG_HDR_EXPAND21," ")}}function re(e,t){if(1&e&&(k.Yb(0,"mat-cell",15),k.hc("click",(function(){const e=t.$implicit;return e.Expand21=!e.Expand21})),k.Tb(1,"mat-checkbox",16),k.Xb()),2&e){const e=t.$implicit;k.Eb(1),k.sc("checked",e.Expand21)}}function ce(e,t){if(1&e&&(k.Yb(0,"mat-header-cell"),k.Uc(1),k.Xb()),2&e){const e=k.lc();k.Eb(1),k.Wc(" ",e.EDITNAV_AG_HDR_INFOMAP12," ")}}function le(e,t){if(1&e&&(k.Yb(0,"mat-cell",15),k.hc("click",(function(){const e=t.$implicit;return e.InfoMapExpand12=!e.InfoMapExpand12})),k.Tb(1,"mat-checkbox",16),k.Xb()),2&e){const e=t.$implicit;k.Eb(1),k.sc("checked",e.InfoMapExpand12)}}function de(e,t){if(1&e&&(k.Yb(0,"mat-header-cell"),k.Uc(1),k.Xb()),2&e){const e=k.lc();k.Eb(1),k.Wc(" ",e.EDITNAV_AG_HDR_INFOMAP21," ")}}function he(e,t){if(1&e&&(k.Yb(0,"mat-cell",15),k.hc("click",(function(){const e=t.$implicit;return e.InfoMapExpand21=!e.InfoMapExpand21})),k.Tb(1,"mat-checkbox",16),k.Xb()),2&e){const e=t.$implicit;k.Eb(1),k.sc("checked",e.InfoMapExpand21)}}function pe(e,t){1&e&&k.Tb(0,"mat-header-row")}function ue(e,t){1&e&&k.Tb(0,"mat-row")}function me(e,t){if(1&e&&(k.Yb(0,"div",17),k.Uc(1),k.Xb()),2&e){const e=k.lc();k.Eb(1),k.Vc(e.EDITNAV_NO_ACCESS_GROUPS)}}let fe=(()=>{class e{constructor(e){this.sdaTranslateService=e,this.accessGroups=[],this.EDITNAV_HDR_ATTRIBUTES=this.sdaTranslateService.get("EDITNAV_HDR_ATTRIBUTES","Attributes"),this.EDITNAV_AG_HDR_EXPAND12=this.sdaTranslateService.get("EDITNAV_AG_HDR_EXPAND12","Expand 1-2"),this.EDITNAV_AG_HDR_EXPAND21=this.sdaTranslateService.get("EDITNAV_AG_HDR_EXPAND21","Expand 2-1"),this.EDITNAV_AG_HDR_INFOMAP12=this.sdaTranslateService.get("EDITNAV_AG_HDR_INFOMAP12","InfoMap 1-2"),this.EDITNAV_AG_HDR_INFOMAP21=this.sdaTranslateService.get("EDITNAV_AG_HDR_INFOMAP21","InfoMap 2-1"),this.EDITNAV_NO_ACCESS_GROUPS=this.sdaTranslateService.get("EDITNAV_NO_ACCESS_GROUPS","No access groups"),this.displayedColumns=[]}ngOnInit(){this.displayedColumns=["DisplayName","Expand12","Expand21","InfoMapExpand12","InfoMapExpand21"]}}return e.\u0275fac=function(t){return new(t||e)(k.Sb(O.a))},e.\u0275cmp=k.Mb({type:e,selectors:[["sda-admin-editreldef-table"]],inputs:{accessGroups:"accessGroups"},decls:23,vars:6,consts:[[1,"form__content"],[1,"form__title"],[1,"form__component","admin-editreldef-table-wrapper"],[3,"dataSource"],["matColumnDef","DisplayName"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","Expand12"],[3,"click",4,"matCellDef"],["matColumnDef","Expand21"],["matColumnDef","InfoMapExpand12"],["matColumnDef","InfoMapExpand21"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["class","admin-editreldef-empty-table",4,"ngIf"],[3,"click"],[3,"checked"],[1,"admin-editreldef-empty-table"]],template:function(e,t){1&e&&(k.Yb(0,"div",0),k.Yb(1,"div",1),k.Uc(2),k.Xb(),k.Yb(3,"div",2),k.Yb(4,"mat-table",3),k.Wb(5,4),k.Sc(6,ie,1,0,"mat-header-cell",5),k.Sc(7,ne,2,1,"mat-cell",6),k.Vb(),k.Wb(8,7),k.Sc(9,oe,2,1,"mat-header-cell",5),k.Sc(10,ae,2,1,"mat-cell",8),k.Vb(),k.Wb(11,9),k.Sc(12,se,2,1,"mat-header-cell",5),k.Sc(13,re,2,1,"mat-cell",8),k.Vb(),k.Wb(14,10),k.Sc(15,ce,2,1,"mat-header-cell",5),k.Sc(16,le,2,1,"mat-cell",8),k.Vb(),k.Wb(17,11),k.Sc(18,de,2,1,"mat-header-cell",5),k.Sc(19,he,2,1,"mat-cell",8),k.Vb(),k.Sc(20,pe,1,0,"mat-header-row",12),k.Sc(21,ue,1,0,"mat-row",13),k.Xb(),k.Sc(22,me,2,1,"div",14),k.Xb(),k.Xb()),2&e&&(k.Eb(2),k.Wc("",t.EDITNAV_HDR_ATTRIBUTES,":"),k.Eb(2),k.sc("dataSource",t.accessGroups),k.Eb(16),k.sc("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),k.Eb(1),k.sc("matRowDefColumns",t.displayedColumns),k.Eb(1),k.sc("ngIf",0===t.accessGroups.length))},directives:[ee.j,ee.c,ee.e,ee.b,ee.g,ee.i,n.t,ee.d,ee.a,te.a,ee.f,ee.h],styles:[".admin-editreldef-table-wrapper[_ngcontent-%COMP%]{width:100%;border:1px solid #cfd6dd}.form__content[_ngcontent-%COMP%]{width:100%}.mat-table[_ngcontent-%COMP%]{max-height:200px;overflow:auto}.mat-header-cell[_ngcontent-%COMP%]{color:#1f2429}.mat-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.mat-cell[_ngcontent-%COMP%]:not(:first-child){cursor:pointer}.mat-checkbox[_ngcontent-%COMP%]{pointer-events:none}.admin-editreldef-empty-table[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:50px}",'.form__title[_ngcontent-%COMP%]{overflow-wrap:break-word;word-wrap:break-word;word-break:break-word}[_nghost-%COMP%]{display:flex;flex-wrap:wrap}[_nghost-%COMP%]     sda-searchbar{max-width:340px}[_nghost-%COMP%]     .date-time-input, [_nghost-%COMP%]     .double-input, [_nghost-%COMP%]     .ens-item-input, [_nghost-%COMP%]     .enum-select, [_nghost-%COMP%]     .int-input, [_nghost-%COMP%]     .prime-calendar .ui-inputtext, [_nghost-%COMP%]     .rel-pick__select, [_nghost-%COMP%]     .string-input, [_nghost-%COMP%]     .uom-input, [_nghost-%COMP%]     .url-input, [_nghost-%COMP%]     .ymd-input{width:270px!important;height:34px}[_nghost-%COMP%]     .uxt-toolbar--top{height:42px!important;padding:0 8px}[_nghost-%COMP%]     .rel-find__list .list-base__items{height:170px;max-height:272px}[_nghost-%COMP%]     .mat-list-item{height:34px}.form__content[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;padding:5px 10px}.form__content--single[_ngcontent-%COMP%]     .rel-empty, .form__content--single[_ngcontent-%COMP%]     .rel-find__list, .form__content--single[_ngcontent-%COMP%]     .rel-multi{min-width:340px}.form__content--single[_ngcontent-%COMP%]     .rel-empty .list-base, .form__content--single[_ngcontent-%COMP%]     .rel-find__list .list-base, .form__content--single[_ngcontent-%COMP%]     .rel-multi .list-base{max-width:600px}.form__content--multiple[_ngcontent-%COMP%]     .string-non-editable, .form__content--multiple[_ngcontent-%COMP%]     input, .form__content--multiple[_ngcontent-%COMP%]     select{min-width:150px!important;max-width:200px}.form__content--multiple[_ngcontent-%COMP%]     .rel-find__list{width:auto!important;max-width:340px}.form__content[_ngcontent-%COMP%]:not(.form__content--non-editable){border:none;color:#000}.form__content[_ngcontent-%COMP%]:not(.form__content--non-editable)     .rel-pick--multiple sda-loading-indicator{position:absolute;top:50%;right:-30px;-webkit-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0)}.form__content--error[_ngcontent-%COMP%]     .double-input, .form__content--error[_ngcontent-%COMP%]     .enum-select, .form__content--error[_ngcontent-%COMP%]     .int-input, .form__content--error[_ngcontent-%COMP%]     .list-base, .form__content--error[_ngcontent-%COMP%]     .prime-calendar .ui-inputtext, .form__content--error[_ngcontent-%COMP%]     .rel-pick__select, .form__content--error[_ngcontent-%COMP%]     .rel__no-results, .form__content--error[_ngcontent-%COMP%]     .search-query, .form__content--error[_ngcontent-%COMP%]     .string-input, .form__content--error[_ngcontent-%COMP%]     .string-textarea, .form__content--error[_ngcontent-%COMP%]     .uom-input, .form__content--error[_ngcontent-%COMP%]     .uom-select, .form__content--error[_ngcontent-%COMP%]     .url-input, .form__content--error[_ngcontent-%COMP%]     uxt-list{border:2px solid #db142d!important}.form__content--error[_ngcontent-%COMP%]     .rel-query--empty{border:0;background-color:#db142d}.form__content--error[_ngcontent-%COMP%]     .list-base, .form__content--error[_ngcontent-%COMP%]     .rel__no-results, .form__content--error[_ngcontent-%COMP%]     uxt-list{border-radius:2px;overflow:hidden}.form__title[_ngcontent-%COMP%]{position:relative;width:200px;min-width:200px;min-height:34px;margin-right:10px;padding-top:10px;padding-right:12px;font-size:14px;color:#444;font-weight:500;line-height:1.1;text-align:end}.form__title--required[_ngcontent-%COMP%]:after{content:"*";position:absolute;top:0;right:0;color:#d7142c;font-size:16px}.form__component[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-size:14px}.form__component__type[_ngcontent-%COMP%]{position:relative;display:flex}.form-validation-message[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:2px;color:#d7142c;font-size:12px}.form-validation-message__icon[_ngcontent-%COMP%]{flex-shrink:0;width:16px;height:16px;margin-right:3px}']}),e})();function ge(e,t){if(1&e&&k.Tb(0,"sda-form-display-line",7),2&e){const e=t.$implicit,i=t.index,n=k.lc(2);k.sc("line",e)("editable",!n.mainDetailsFormDisplayLines[i].FormDisplayItems[0].ReadOnly)}}function De(e,t){if(1&e){const e=k.Zb();k.Yb(0,"mat-accordion",1),k.Yb(1,"mat-expansion-panel",2),k.Yb(2,"mat-expansion-panel-header",3),k.Yb(3,"mat-panel-title"),k.Uc(4),k.Xb(),k.Xb(),k.Sc(5,ge,1,2,"sda-form-display-line",4),k.Xb(),k.Yb(6,"mat-expansion-panel",2),k.Yb(7,"mat-expansion-panel-header",3),k.Yb(8,"mat-panel-title"),k.Uc(9),k.Xb(),k.Xb(),k.Yb(10,"sda-form-display-line",5),k.hc("valueChanged",(function(t){return k.Kc(e),k.lc().onAccessGroupsValueChanged(t)})),k.Xb(),k.Tb(11,"sda-admin-editreldef-table",6),k.Xb(),k.Xb()}if(2&e){const e=k.lc();k.Eb(1),k.sc("expanded",!0),k.Eb(3),k.Vc(e.EDITNAV_HDR_MAIN_DETAILS),k.Eb(1),k.sc("ngForOf",e.mainDetailsFormDisplayLines),k.Eb(1),k.sc("expanded",!0),k.Eb(3),k.Vc(e.EDITNAV_HDR_ACCESS_GROUPS),k.Eb(1),k.sc("line",e.accessGroupsFormDisplayLine)("editable",!0),k.Eb(1),k.sc("accessGroups",e.accessGroups)}}let be=(()=>{class e extends Y.a{constructor(e,t,i,n,o,a,s){super(e),this.loadingOverlayService=t,this.adminDataService=i,this.adminFormService=n,this.notificationService=o,this.exceptionService=a,this.sdaTranslateService=s,this.initialized=!1,this.EDITNAV_HDR_MAIN_DETAILS=this.sdaTranslateService.get("EDITNAV_HDR_MAIN_DETAILS","Main details"),this.EDITNAV_HDR_ACCESS_GROUPS=this.sdaTranslateService.get("EDITNAV_HDR_ACCESS_GROUPS","Access Groups"),this.accessGroups=[],this.mainDetailsFormDisplayLines=[],this.formDisplayItems=[],this.LOADING_FORM_PLEASE_WAIT=this.sdaTranslateService.get("LOADING_FORM_PLEASE_WAIT","Loading form, please wait..."),this.NAVIGATION_UPDATED=this.sdaTranslateService.get("NAVIGATION_UPDATED","Navigation updated")}ngOnInit(){this.selectedNavigationID=this.getData(),this.getFormForNavigation(this.selectedNavigationID)}getFormForNavigation(e){this.loadingOverlayService.showLoadingOverlay(this.LOADING_FORM_PLEASE_WAIT),this.adminDataService.getNavigationUpdateForm(e).subscribe(e=>{this.loadingOverlayService.hideLoadingOverlay(),this.form=e,this.accessGroups=this.form.AccessGroupRelAttributes,this.mainDetailsFormDisplayLines=this.adminFormService.createRelDefEditFormMainDetailsLine(this.form),this.accessGroupsFormDisplayLine=this.adminFormService.createRelDefEditFormAccessGroupsLine(this.form),this.mainDetailsFormDisplayLines.forEach(e=>{this.formDisplayItems.push(e.FormDisplayItems[0])}),this.initialized=!0},e=>{this.loadingOverlayService.hideLoadingOverlay(),this.exceptionService.handleException(new f.a(e,"Navigation Edit","editnavigation.component","getFormForNavigation"))})}onAccessGroupsValueChanged(e){if(e.RelObjects.length>0){const t=[];e.RelObjects.filter(e=>!e.Terminate).forEach(i=>{const n=this.accessGroups.find(e=>e.OBID===i.Key);if(n)t.push(n);else if(e.dropDownOptions){const n=e.dropDownOptions.find(e=>e.obid===i.Key);t.push({DisplayName:n.displayValue,OBID:n.obid,Expand12:!1,Expand21:!1,InfoMapExpand12:!1,InfoMapExpand21:!1})}}),this.accessGroups=t.sort((e,t)=>T.a.sortByString(e.DisplayName,t.DisplayName))}}cancel(){const e=new H.a(!1);this.closeModal.next(e)}ok(){this.loadingOverlayService.showLoadingOverlay(),this.form.AccessGroupRelAttributes=this.accessGroups,this.form=this.adminFormService.extractRelDefFormData(this.form,this.formDisplayItems),this.adminDataService.updateNavigationFromForm(this.form,this.selectedNavigationID).subscribe(e=>{this.loadingOverlayService.hideLoadingOverlay();const t=new H.a(e);this.closeModal.next(t),this.notificationService.success(this.NAVIGATION_UPDATED)})}}return e.\u0275fac=function(t){return new(t||e)(k.Sb(z.a),k.Sb(b.a),k.Sb(B),k.Sb(q),k.Sb(P.a),k.Sb(g.a),k.Sb(O.a))},e.\u0275cmp=k.Mb({type:e,selectors:[["sda-admin-editreldef-modal"]],features:[k.Bb],decls:1,vars:1,consts:[["displayMode","flat","multi","true",4,"ngIf"],["displayMode","flat","multi","true"],[3,"expanded"],["collapsedHeight","38px","expandedHeight","38px"],[3,"line","editable",4,"ngFor","ngForOf"],[3,"line","editable","valueChanged"],[3,"accessGroups"],[3,"line","editable"]],template:function(e,t){1&e&&k.Sc(0,De,12,8,"mat-accordion",0),2&e&&k.sc("ngIf",t.initialized)},directives:[n.t,o.a,o.c,o.g,o.h,n.s,Z.a,fe],styles:["@-webkit-keyframes delay-overflow{0%{overflow:hidden}}@keyframes delay-overflow{0%{overflow:hidden}}[_nghost-%COMP%]{height:100%}[_nghost-%COMP%]     .mat-expansion-panel-body{padding:5px 0!important}[_nghost-%COMP%]   .mat-accordion[_ngcontent-%COMP%]   .mat-expansion-panel[_ngcontent-%COMP%]{border-radius:0!important;box-shadow:none}[_nghost-%COMP%]   .mat-accordion[_ngcontent-%COMP%]   .mat-expansion-panel.mat-expanded[_ngcontent-%COMP%]{overflow:visible;-webkit-animation:delay-overflow 1s;animation:delay-overflow 1s}[_nghost-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{background-color:#ebedf0!important}"]}),e})();function Ie(e){var t=0,i=e.children,n=i&&i.length;if(n)for(;--n>=0;)t+=i[n].value;else t=1;e.value=t}function _e(e,t){var i,n,o,a,s,r=new ve(e),c=+e.value&&(r.value=e.value),l=[r];for(null==t&&(t=ye);i=l.pop();)if(c&&(i.value=+i.data.value),(o=t(i.data))&&(s=o.length))for(i.children=new Array(s),a=s-1;a>=0;--a)l.push(n=i.children[a]=new ve(o[a])),n.parent=i,n.depth=i.depth+1;return r.eachBefore(Ee)}function ye(e){return e.children}function Se(e){e.data=e.data.data}function Ee(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function ve(e){this.data=e,this.depth=this.height=0,this.parent=null}function Oe(e,t){return e.parent===t.parent?1:2}function Ne(e){var t=e.children;return t?t[0]:e.t}function Te(e){var t=e.children;return t?t[t.length-1]:e.t}function Pe(e,t,i){var n=i/(t.i-e.i);t.c-=n,t.s+=i,e.c+=n,t.z+=i,t.m+=i}function we(e,t,i){return e.a.parent===t.parent?e.a:i}function Ce(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}ve.prototype=_e.prototype={constructor:ve,count:function(){return this.eachAfter(Ie)},each:function(e){var t,i,n,o,a=this,s=[a];do{for(t=s.reverse(),s=[];a=t.pop();)if(e(a),i=a.children)for(n=0,o=i.length;n<o;++n)s.push(i[n])}while(s.length);return this},eachAfter:function(e){for(var t,i,n,o=this,a=[o],s=[];o=a.pop();)if(s.push(o),t=o.children)for(i=0,n=t.length;i<n;++i)a.push(t[i]);for(;o=s.pop();)e(o);return this},eachBefore:function(e){for(var t,i,n=this,o=[n];n=o.pop();)if(e(n),t=n.children)for(i=t.length-1;i>=0;--i)o.push(t[i]);return this},sum:function(e){return this.eachAfter((function(t){for(var i=+e(t.data)||0,n=t.children,o=n&&n.length;--o>=0;)i+=n[o].value;t.value=i}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,i=function(e,t){if(e===t)return e;var i=e.ancestors(),n=t.ancestors(),o=null;for(e=i.pop(),t=n.pop();e===t;)o=e,e=i.pop(),t=n.pop();return o}(t,e),n=[t];t!==i;)n.push(t=t.parent);for(var o=n.length;e!==i;)n.splice(o,0,e),e=e.parent;return n},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){var e=[];return this.each((function(t){e.push(t)})),e},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(i){i!==e&&t.push({source:i.parent,target:i})})),t},copy:function(){return _e(this).eachBefore(Se)}},Ce.prototype=Object.create(ve.prototype);var Ae=i("AWXE"),Re=i("AKWm"),Me=i("5Iso"),xe=i("2TRZ"),Fe=i("6JPj"),Le=i("vOvS"),Ve=i("tqyv"),ke=i("2ufx"),Be=i("dEBh"),je=i("PuHP"),Ue=i("YsXg");class Ge{constructor(e,t){this.height=e,this.width=t}}function ze(e){return+e}var Ye=i("UCFJ");let He=(()=>{class e{constructor(){this.desktopNodeRadius=65,this.tabletNodeRadius=50,this.desktopFontSize=16,this.tabletFontSize=12}getCenterNodeX(e){return 1.5*-e}getCenterNodeY(e){return 1.5*-e}getCenterNodeHeight(e){return 3*e}getCenterNodeWidth(e){return 3*e}getNodeRadius(e){return e.height<768||e.width<768?this.tabletNodeRadius:this.desktopNodeRadius}getFontSize(e){return e.height<768||e.width<768?this.tabletFontSize:this.desktopFontSize}appendD3Lines(e,t,i=500){e.selectAll("line").data(t).enter().append("line").attr("class","node-line").attr("x1",e=>this.findX(e.source)).attr("y1",e=>this.findY(e.source)).attr("x2",e=>this.findX(e.target)).attr("y2",e=>this.findY(e.target)).style("opacity","0").transition().duration(1.5*i).style("opacity","1")}generateD3Groups(e){return e.append("g").attr("class",e=>{let t="node-group-inner "+e.data.type;return t+=" depth-"+e.depth,t}).attr("transform",e=>e.depth>0?"rotate("+Math.round(90-e.x)+")":"")}appendD3Rectangles(e,t){const i=.75*-t,n=-t,o=.75*-t,a=-t,s=1.5*t,r=2*t,c=1.5*t,l=2*t;e.append("rect").attr("x",e=>2===e.depth?i:n).attr("y",e=>2===e.depth?o:a).attr("height",e=>2===e.depth?s:r).attr("width",e=>2===e.depth?c:l).attr("rx","15").attr("class","backer"),e.append("rect").attr("x",e=>2===e.depth?i:n).attr("y",e=>2===e.depth?o:a).attr("height",e=>2===e.depth?s:r).attr("width",e=>2===e.depth?c:l).attr("rx","15").attr("class",e=>{let t="object-node ";return t+=e.data.count&&1!==e.data.count?"collection":"instance",t})}appendD3Images(e,t){const i=-.75*t/4,n=-t/4,o=-.75*t/4,a=-t/4,s=.75*t/2,r=t/2,c=.75*t/2,l=t/2;e.append("image").attr("x",e=>2===e.depth?i:n).attr("y",e=>{let t=a;return 0===e.depth?t=0:2===e.depth&&(t=o),t}).attr("height",e=>2===e.depth?s:r).attr("width",e=>2===e.depth?c:l).attr("xlink:href",e=>e.data.image&&e.data.image).attr("class","infomap-object-type-img").attr("alt",e=>e.data.name).on("error",(function(){const e=Ye.b+Ye.a+".svg";Object(Re.a)(this).attr("href")!==e&&Object(Re.a)(this).attr("xlink:href",e)}))}appendD3Labels(e,t,i){const n=-.75*i/2,o=-i/2,a=this;e.each((function(e){e.data.type&&Object(Re.a)(this).append("text").attr("text-anchor","middle").attr("y",e=>2===e.depth?n:o).attr("font-size",t).text(e=>a.getNodeText(e.data.type,e.depth,i))}))}appendD3Text(e,t,i){const n=.75*i*.7,o=.7*i,a=this;e.append("text").attr("text-anchor","middle").attr("y",e=>2===e.depth?n:o).attr("font-size",t).each((function(e){const t=Object(Re.a)(this);if(e.data.count&&1!==e.data.count)t.text(e.data.count);else{const n=a.getNodeText(e.data.name,e.depth,i);t.text(n)}}))}enhanceGroup(e,t,i,n,o,a,s,r,c,l){const d=this.getCenterNodeHeight(i),h=this.getCenterNodeWidth(i),p=this.getCenterNodeX(i),u=this.getCenterNodeY(i),m=this.getNodeText(o,0,i),f=this.getNodeText(n,0,i);e.selectAll("text").remove(),e.append("text").attr("text-anchor","left").attr("font-size",t).attr("y",-d/2+65).attr("x",-h/2+15).text(f).append("svg:title").text(n).attr("role","tooltip"),e.append("line").attr("stroke","#006699").attr("stroke-width","3").attr("y1",-d/2+45).attr("x1",+p).attr("y2",-d/2+45).attr("x2",+h/2);const g=e.append("g").attr("class","node-group-inner").on("click",s);g.append("svg:title").text("Actions Menu").attr("role","tooltip"),g.append("svg:image").attr("class","node-group__img").attr("id","center-node-actions-menu-img").attr("y",-d/2+10).attr("x",+p+15).attr("xlink:href","content/images/info-map-action-menu.svg").attr("width",25).attr("height",25);const D=e.append("g").attr("class","node-group-inner").on("click",r);D.append("svg:title").text("View Files").attr("role","tooltip"),D.append("svg:image").attr("class","node-group__img").attr("id","center-node-view-file-img").attr("y",-d/2+10).attr("x",+h/2+p-12.5).attr("xlink:href","content/images/File.svg").attr("width",25).attr("height",25).attr("visibility","hidden"),c().subscribe(t=>{e.select("#center-node-view-file-img").attr("visibility",t)});const b=e.append("g").attr("class","node-group-inner").on("click",a);b.append("svg:title").text("Details").attr("role","tooltip"),b.append("svg:image").attr("class","node-group__img").attr("id","center-node-expand-img").attr("y",-d/2+10).attr("x",+h/2-40).attr("xlink:href","content/images/expand.svg").attr("width",25).attr("height",25),e.append("text").attr("class","properties-grid-subject").attr("text-anchor","middle").attr("font-size",t).attr("y",d/2-20).attr("x",0).text(m).on("click",l).append("svg:title").text(o).attr("role","tooltip"),e.selectAll("rect").attr("height",d).attr("width",h).attr("x",p).attr("y",u).attr("rx","15").attr("ry","15")}fitContainerToNode(e,t){if(t){const i=t.getBoundingClientRect(),n=$(e);n&&n.length>0&&n.css({visibility:"visible",top:i.top+9,left:i.left+5,height:i.height-15,width:i.width-10})}}findX(e){const t=e.y*Math.cos((e.x-90)/180*Math.PI);return Math.round(100*t)/100}findY(e){const t=e.y*Math.sin((e.x-90)/180*Math.PI);return Math.round(100*t)/100}getNodeText(e,t,i){let n=i/4-3*t;n=Math.floor(n);let o="";return e&&(o=e.length>n?e.slice(0,n-1)+"...":e),o}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=k.Ob({token:e,factory:e.\u0275fac}),e})(),Xe=(()=>{class e{constructor(e){this.entryPointViewerElementService=e,this.animateNode=(e,t)=>{e&&e.selectAll("rect").transition().duration(800).attr("height",this.entryPointViewerElementService.getCenterNodeHeight(t)).attr("width",this.entryPointViewerElementService.getCenterNodeWidth(t)).attr("x",this.entryPointViewerElementService.getCenterNodeX(t)).attr("y",this.entryPointViewerElementService.getCenterNodeY(t)).style("stroke-width",7).on("end",()=>{this.animateLines(e,t,0)})},this.animateLines=(e,t,i)=>{e&&(e.style("stroke-dasharray",40).style("stroke-dashoffset",-750*i).transition().ease(ze).duration(4e3).style("stroke-dashoffset",-750*(i+1)).on("end",()=>{this.animateLines(e,t,i)}),i+=1)}}moveNodeToCenter(e,t,i,n){const o=Object(Re.a)(t);e.selectAll("g.node-group").filter((function(){return t!==this})).transition().attr("opacity",0),e.selectAll(".action-group").remove(),e.selectAll("line").transition().style("opacity",0),o.transition().attr("transform",e=>"rotate("+(e.x-90)+")translate(0)").duration(n).on("end",()=>{this.animateNode(o,i)})}growNode(e,t){return new Promise(i=>{e.transition().attr("height",.9*t.height).attr("width",.5*t.width).attr("x",.25*-t.width).attr("y",.45*-t.height).on("end",()=>{i()})})}shrinkCenterNode(e,t){e.select(".center-node-group").selectAll("rect").transition().attr("height",this.entryPointViewerElementService.getCenterNodeHeight(t)).attr("width",this.entryPointViewerElementService.getCenterNodeWidth(t)).attr("x",this.entryPointViewerElementService.getCenterNodeX(t)).attr("y",this.entryPointViewerElementService.getCenterNodeY(t))}}return e.\u0275fac=function(t){return new(t||e)(k.dc(He))},e.\u0275prov=k.Ob({token:e,factory:e.\u0275fac}),e})(),We=(()=>{class e{addGradientsToSvg(e){const t=e.append("defs");this.addTopLeftBottomRightGradient(t,"collection-gradient","#e6f4ff","#b5d8f4")}addTopLeftBottomRightGradient(e,t,i,n){const o=e.append("svg:linearGradient").attr("id",t).attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","100%");o.append("svg:stop").attr("offset","0%").attr("stop-color",i),o.append("svg:stop").attr("offset","100%").attr("stop-color",n)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=k.Ob({token:e,factory:e.\u0275fac}),e})();var qe=i("NFeN"),Je=i("+T9e");function $e(e,t){if(1&e){const e=k.Zb();k.Yb(0,"div",3),k.Yb(1,"div",4),k.Yb(2,"h2",5),k.Uc(3),k.Xb(),k.Yb(4,"mat-icon",6),k.hc("click",(function(){return k.Kc(e),k.lc().centerNodeShrink()})),k.Xb(),k.Xb(),k.Tb(5,"sda-object-details",7),k.Xb()}if(2&e){const e=k.lc();k.Eb(2),k.sc("title",e.entityTree.name),k.Eb(1),k.Vc(e.entityTree.name),k.Eb(2),k.sc("id",e.entityTree.key)("config",e.config)}}let Ke=(()=>{class e{constructor(e,t,i,n,o,a,s,r,c,l,d,h,p,u){this.entryPointViewer=e,this.entryPointViewerAnimationService=t,this.entryPointViewerElementService=i,this.entryPointViewerGradientService=n,this.documentService=o,this.windowService=a,this.contentMenuService=s,this.actionMenuProvider=r,this.viewNativeDataService=c,this.loadingOverlayService=l,this.defaultMethodService=d,this.exceptionService=h,this.router=p,this.urlFilterFactory=u,this.class="wc-background",this.embeddedMode=!1,this.showProperties=!1,this.dimensions=new Ge(0,0),this.translateX=0,this.translateY=0,this.nodeR=65,this.fontSize=16,this.centerNodeShrink=()=>{this.showProperties=!1,this.entryPointViewerAnimationService.shrinkCenterNode(this.svgRootGroup,this.nodeR)},this.centerNodeExpand=()=>{const e=this.svgRootGroup.select(".center-node-group").selectAll("rect");this.entryPointViewerAnimationService.growNode(e,this.dimensions).then(()=>{this.showProperties=!0,this.resizePropertyContainer()})},this.toggleActionsMenu=()=>{this.actionsMenuContainsOBID(this.entityTree.key)?this.contentMenuService.showActionsMenu(!0):(this.actionMenuProvider.clearItems(),this.actionMenuProvider.addItem(new L.a(this.entityTree.key,this.entityTree.name,this.config)),this.contentMenuService.showActionsMenu())},this.viewFile=()=>{this.loadingOverlayService.showLoadingOverlay(),this.viewNativeDataService.viewFile(this.entityId,this.config)},this.viewFileAvailable=()=>this.viewNativeDataService.getFileViewType(this.entityId,this.config).pipe(Object(A.a)(e=>e===Le.a.INVALID?"hidden":"visible")),this.defaultAction=()=>{this.defaultMethodService.tryExecuteDefaultAction(this.entityId,this.config).subscribe(e=>{if(!e){const e=JSON.stringify(this.urlFilterFactory.createLinkFilterSettings(this.entityId)),t=JSON.stringify([this.config]);this.router.navigate(["/objects",{queryFilter:e,config:t},"detail",this.entityId])}},e=>{this.exceptionService.handleException(e)})},this.buildEntryPointViewer=()=>{this.showProperties=!1,this.buildRootSvgElement(),this.buildNodes(this.entityTree)},this.resizePropertyContainer=()=>{setTimeout(()=>{const e=this.documentService.Document.querySelector(".center-node-group g.node-group-inner rect:not(.pattern-rect)"),t=this.documentService.Document.getElementById("infomap-properties-container");this.entryPointViewerElementService.fitContainerToNode(t,e)},10)},this.nodeClicked=new k.o}ngOnInit(){this.buildEntryPointViewer(),this.windowService.Window.addEventListener("resize",this.buildEntryPointViewer)}ngOnChanges(e){this.buildEntryPointViewer()}ngOnDestroy(){this.windowService.Window.removeEventListener("resize",this.buildEntryPointViewer)}actionsMenuContainsOBID(e){return!!this.actionMenuProvider.getItems().find(t=>t.obid===e)}buildRootSvgElement(){const e=this.documentService.Document.getElementById("info-map");e&&e.parentNode.removeChild(e),this.dimensions.height=this.entryPointViewer.nativeElement.clientHeight,this.dimensions.width=this.entryPointViewer.nativeElement.clientWidth,this.nodeR=this.entryPointViewerElementService.getNodeRadius(this.dimensions),this.fontSize=this.entryPointViewerElementService.getFontSize(this.dimensions),this.translateX=this.dimensions.width/2,this.translateY=this.dimensions.height/2;const t=Object(xe.a)().scaleExtent([.25,5]).on("zoom",()=>{this.zoomableElement.attr("transform",Ae.c.transform),this.resizePropertyContainer()});this.svgRootGroup=Object(Re.a)(this.entryPointViewer.nativeElement).append("svg").attr("width",this.dimensions.width).attr("height",this.dimensions.height).attr("id","info-map"),this.zoomableElement=this.svgRootGroup.call(t).on("dblclick.zoom",void 0).append("g").attr("class","root-group"),this.svgRootGroup.call(t.transform,xe.b.translate(this.translateX,this.translateY)),this.entryPointViewerGradientService.addGradientsToSvg(this.svgRootGroup)}buildNodes(e){if(!e)return;const t=this,i=function(){var e=Oe,t=1,i=1,n=null;function o(o){var c=function(e){for(var t,i,n,o,a,s=new Ce(e,0),r=[s];t=r.pop();)if(n=t._.children)for(t.children=new Array(a=n.length),o=a-1;o>=0;--o)r.push(i=t.children[o]=new Ce(n[o],o)),i.parent=t;return(s.parent=new Ce(null,0)).children=[s],s}(o);if(c.eachAfter(a),c.parent.m=-c.z,c.eachBefore(s),n)o.eachBefore(r);else{var l=o,d=o,h=o;o.eachBefore((function(e){e.x<l.x&&(l=e),e.x>d.x&&(d=e),e.depth>h.depth&&(h=e)}));var p=l===d?1:e(l,d)/2,u=p-l.x,m=t/(d.x+p+u),f=i/(h.depth||1);o.eachBefore((function(e){e.x=(e.x+u)*m,e.y=e.depth*f}))}return o}function a(t){var i=t.children,n=t.parent.children,o=t.i?n[t.i-1]:null;if(i){!function(e){for(var t,i=0,n=0,o=e.children,a=o.length;--a>=0;)(t=o[a]).z+=i,t.m+=i,i+=t.s+(n+=t.c)}(t);var a=(i[0].z+i[i.length-1].z)/2;o?(t.z=o.z+e(t._,o._),t.m=t.z-a):t.z=a}else o&&(t.z=o.z+e(t._,o._));t.parent.A=function(t,i,n){if(i){for(var o,a=t,s=t,r=i,c=a.parent.children[0],l=a.m,d=s.m,h=r.m,p=c.m;r=Te(r),a=Ne(a),r&&a;)c=Ne(c),(s=Te(s)).a=t,(o=r.z+h-a.z-l+e(r._,a._))>0&&(Pe(we(r,t,n),t,o),l+=o,d+=o),h+=r.m,l+=a.m,p+=c.m,d+=s.m;r&&!Te(s)&&(s.t=r,s.m+=h-d),a&&!Ne(c)&&(c.t=a,c.m+=l-p,n=t)}return n}(t,o,t.parent.A||n[0])}function s(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function r(e){e.x*=t,e.y=e.depth*i}return o.separation=function(t){return arguments.length?(e=t,o):e},o.size=function(e){return arguments.length?(n=!1,t=+e[0],i=+e[1],o):n?null:[t,i]},o.nodeSize=function(e){return arguments.length?(n=!0,t=+e[0],i=+e[1],o):n?[t,i]:null},o}().size([360,(this.dimensions.height<this.dimensions.width?this.dimensions.height:this.dimensions.width)/2-this.nodeR]).separation((e,t)=>e.depth>1?(e.parent===t.parent?.5:2)/e.depth:1===e.depth?(e.parent===t.parent?1:2)/e.depth:e.parent===t.parent?1:2),n=e;this.embeddedMode||(this.actionMenuProvider.clearItems(),this.actionMenuProvider.addItem(new L.a(n.key,n.name,this.config))),this.entityId=n.key,Me.b.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))};const o=i(_e(n)).descendants(),a=i(_e(n)).links();let s,r,c=0;o.forEach(e=>{c=e.depth>c?e.depth:c}),o.forEach(c>1?e=>{1===e.depth?e.y+=this.nodeR-12:e.depth>1&&(e.y+=this.nodeR/3-12)}:e=>{1===e.depth&&(e.y-=20)});let l=0;this.entryPointViewerElementService.appendD3Lines(this.zoomableElement,a),r=this.zoomableElement.selectAll("g.node-group").data(o,()=>(++l).toString()).enter().append("g").attr("class","node-group"),s=this.zoomableElement.select("g.node-group"),s.classed("center-node-group",!0),this.zoomableElement.selectAll("g.node-group:not(.center-node-group)").on("click",(function(e){t.nodeClicked.emit(e.data),e.data.count&&1===e.data.count&&t.entryPointViewerAnimationService.moveNodeToCenter(t.zoomableElement,this,t.nodeR,500)}));const d=this.entryPointViewerElementService.generateD3Groups(r);this.entryPointViewerElementService.appendD3Rectangles(d,this.nodeR),this.entryPointViewerElementService.appendD3Images(d,this.nodeR),this.entryPointViewerElementService.appendD3Labels(d,this.fontSize,this.nodeR),this.entryPointViewerElementService.appendD3Text(d,this.fontSize,this.nodeR),s.moveToFront();let h=n.type;if(n.properties){const e=n.properties.find(e=>"Class@Intergraph.SPF.Server.API.Model.ClassDisplayNameAnnotation"===e.key);e&&e.value&&(h=e.value)}this.entryPointViewerElementService.enhanceGroup(s,this.fontSize,this.nodeR,h,n.name,this.centerNodeExpand,this.toggleActionsMenu,this.viewFile,this.viewFileAvailable,this.defaultAction);const p=this.svgRootGroup.selectAll("g.node-group:not(.center-node-group)");p.attr("transform",e=>"rotate("+Math.round(e.x-90)+")"),p.transition().duration(500).attr("transform",e=>"rotate("+Math.round(e.x-90)+")translate("+Math.round(e.y)+")")}}return e.\u0275fac=function(t){return new(t||e)(k.Sb(k.l),k.Sb(Xe),k.Sb(He),k.Sb(We),k.Sb(ke.a),k.Sb(Be.a),k.Sb(Fe.a),k.Sb(u.a),k.Sb(Ve.a),k.Sb(b.a),k.Sb(je.a),k.Sb(g.a),k.Sb(p.g),k.Sb(Ue.a))},e.\u0275cmp=k.Mb({type:e,selectors:[["sda-entrypoint-viewer"]],hostVars:2,hostBindings:function(e,t){2&e&&k.Gb(t.class)},inputs:{entityTree:"entityTree",config:"config",embeddedMode:"embeddedMode"},outputs:{nodeClicked:"nodeClicked"},features:[k.Db([Xe,He,We]),k.Cb],decls:3,vars:1,consts:[[1,"info-map-container"],["infomap",""],["id","infomap-properties-container","class","info-map-properties",4,"ngIf"],["id","infomap-properties-container",1,"info-map-properties"],[1,"properties-nav"],[1,"properties-nav__title",3,"title"],["svgIcon","shrink",1,"properties-nav__icon",3,"click"],[3,"id","config"]],template:function(e,t){1&e&&(k.Yb(0,"div",0,1),k.Sc(2,$e,6,4,"div",2),k.Xb()),2&e&&(k.Eb(2),k.sc("ngIf",t.showProperties))},directives:[n.t,qe.a,Je.a],styles:[".properties-nav__title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}[_nghost-%COMP%]{position:relative;display:flex;flex:1}[_nghost-%COMP%]     .node-group{cursor:pointer}[_nghost-%COMP%]     .node-group.center-node-group{cursor:move}[_nghost-%COMP%]     .node-group__img{cursor:pointer}[_nghost-%COMP%]     .node-group .backer{fill:#fff}[_nghost-%COMP%]     .node-group .object-node{fill:#fff;stroke:#069;stroke-width:3}[_nghost-%COMP%]     .node-group .object-node.collection{fill:url(#collection-gradient);fill-opacity:.75}[_nghost-%COMP%]     .node-line{stroke:#666;stroke-width:5}[_nghost-%COMP%]     .properties-grid-subject{cursor:pointer}[_nghost-%COMP%]     .properties-grid-subject:hover{fill:#1f8cdf}.info-map-container[_ngcontent-%COMP%]{display:flex;flex:1;align-items:center;justify-content:center}.info-map-properties[_ngcontent-%COMP%]{position:fixed;top:100px;left:24.5%;right:24.5%;bottom:6%;display:flex;flex-direction:column;overflow:hidden;background-color:#fff;visibility:hidden}.info-map-properties[_ngcontent-%COMP%]     .form__content{width:100%}.properties-nav[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:space-between;margin-bottom:4px;padding:8px 16px}.properties-nav__title[_ngcontent-%COMP%]{width:95%;font-size:20px;font-weight:500}.properties-nav__icon[_ngcontent-%COMP%]{align-self:flex-start;cursor:pointer;fill:#1f8cdf}sda-object-details[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column;border:1px solid #ccc;overflow-x:hidden;overflow-y:auto}sda-object-details[_ngcontent-%COMP%]     .properties-list-title{font-weight:500}sda-object-details[_ngcontent-%COMP%]     .properties-row{display:flex;flex-direction:row;border-bottom:1px solid #efefef}sda-object-details[_ngcontent-%COMP%]     .properties-row div{flex:1;padding:8px 16px}"]}),e})();function Qe(e,t){if(1&e){const e=k.Zb();k.Yb(0,"sda-entrypoint-viewer",1),k.hc("nodeClicked",(function(t){return k.Kc(e),k.lc().nodeClicked(t)})),k.Xb()}if(2&e){const e=k.lc();k.sc("entityTree",e.entryPointObject)("config",e.config)}}let Ze=(()=>{class e{constructor(e,t,i,n,o,a,s){this.router=e,this.sdaTranslateService=t,this.exceptionService=i,this.route=n,this.modalService=o,this.componentFactoryResolver=a,this.injector=s,this.myClass="infomap-viewer-component-container",this.refreshPageWithOBID=new k.o,this.INFOMAP_RELATIONSHIP_ERROR=this.sdaTranslateService.get("INFOMAP_RELATIONSHIP_ERROR","Retrieving the relationships for this object failed")}nodeClicked(e){"RelDef"===e.type||"EdgeDef"===e.type?(this.selectedNavigationID=e.key,"RelDef"===e.type?this.showEditModal(this.selectedNavigationID,this.sdaTranslateService.get("ENTRYPOINT_EDITRELDEF_TITLE","Edit RelDef"),be).subscribe(e=>{e&&this.refreshPageWithOBID.emit(this.entryPointObject.key)}):this.showEditModal(this.selectedNavigationID,this.sdaTranslateService.get("ENTRYPOINT_EDITEDGEDEF_TITLE","Edit EdgeDef"),Q).subscribe(e=>{e&&this.refreshPageWithOBID.emit(this.entryPointObject.key)})):this.navigateToSelectedObject(e)}navigateToSelectedObject(e){const t=new L.a(e.key,e.name,this.config);this.router.navigate(["/adminEntryPoints"],{queryParams:{objects:JSON.stringify([t]),DisplayName:this.route.snapshot.params[N.x],ClientAPI:this.route.snapshot.params[N.s]}}).then(e=>{e||(this.storedSelectedObject=this.entryPointObject,this.entryPointObject=void 0,setTimeout(()=>{this.entryPointObject=this.storedSelectedObject,this.storedSelectedObject=void 0},0))}).catch(e=>{const t=new f.a(e,this.INFOMAP_RELATIONSHIP_ERROR,"EntryPointViewerComponent","navigateToSelectedObject");this.exceptionService.handleException(t)})}showEditModal(e,t,i){return U.a.create(n=>{const o=new G.a(t,i,this.componentFactoryResolver,this.injector);o.data=e,o.size="large",o.okBtnText=this.sdaTranslateService.get("UPDATE","Update"),this.modalService.showModal(o).then(e=>{n.next(e.ok),n.complete()})})}}return e.\u0275fac=function(t){return new(t||e)(k.Sb(p.g),k.Sb(O.a),k.Sb(g.a),k.Sb(p.a),k.Sb(z.a),k.Sb(k.j),k.Sb(k.s))},e.\u0275cmp=k.Mb({type:e,selectors:[["sda-admin-entry-point-viewer"]],hostVars:2,hostBindings:function(e,t){2&e&&k.Gb(t.myClass)},inputs:{entryPointObject:"entryPointObject",config:"config",selectedRole:"selectedRole"},outputs:{refreshPageWithOBID:"refreshPageWithOBID"},decls:1,vars:1,consts:[[3,"entityTree","config","nodeClicked",4,"ngIf"],[3,"entityTree","config","nodeClicked"]],template:function(e,t){1&e&&k.Sc(0,Qe,1,2,"sda-entrypoint-viewer",0),2&e&&k.sc("ngIf",t.entryPointObject)},directives:[n.t,Ke],styles:["[_nghost-%COMP%]{display:flex;flex:1}"]}),e})();var et=i("Qcck");function tt(e,t){if(1&e){const e=k.Zb();k.Yb(0,"sda-admin-entry-point-viewer",5),k.hc("refreshPageWithOBID",(function(t){return k.Kc(e),k.lc().handleSelectedEntryPointIdChange(t)})),k.Xb()}if(2&e){const e=k.lc();k.sc("selectedRole",e.selectedRole)("entryPointObject",e.selectedEntryPointObject)("config",e.config)}}function it(e,t){if(1&e&&(k.Yb(0,"div",6),k.Uc(1),k.Xb()),2&e){const e=k.lc();k.Eb(1),k.Wc(" ",e.ENTRYPOINT_NO_ACCESS_MESSAGE," ")}}function nt(e,t){if(1&e){const e=k.Zb();k.Yb(0,"sda-pagination",7),k.hc("changePage",(function(t){return k.Kc(e),k.lc().changePageNumber(t)})),k.Xb()}if(2&e){const e=k.lc();k.sc("totalPages",e.totalPages)("currentPage",e.currentPageNumber)}}const ot=[{path:"",component:(()=>{class e{constructor(e,t,i,n,o,a,s,r,c,l,d,h){this.featureSetNavigationService=e,this.applicationSettingsService=t,this.sdaTranslateService=i,this.loadingOverlayService=n,this.adminDataService=o,this.exceptionService=a,this.route=s,this.actionMenuProvider=r,this.notificationService=c,this.helpService=l,this.dataRefreshService=d,this.rolesRespository=h,this.config="none",this.ENDPOINTADMIN_TITLE=this.sdaTranslateService.get("ENTRYPOINT_ADMIN_TITLE","Configure Entry Point"),this.ENTRYPOINT_INFOMAP_MODE=this.sdaTranslateService.get("ENTRYPOINT_INFOMAP_MODE","INFO MAP NAVIGATION"),this.ENTRYPOINT_INFOMAP_MODE_TOOLTIP=this.sdaTranslateService.get("ENTRYPOINT_INFOMAP_MODE_TOOLTIP","View navigations visible in Info Map"),this.ENTRYPOINT_ROLES=this.sdaTranslateService.get("ENTRYPOINT_ROLES","Role"),this.ENTRYPOINT_EMPTY_ROLES=this.sdaTranslateService.get("ENTRYPOINT_EMPTY_ROLES","No roles available"),this.NOENTRYPOINT_GIVEN_ERROR=this.sdaTranslateService.get("NO_ENTRYPOINT_GIVEN","No Entry Point given"),this.ENTRYPOINT_NO_ACCESS_MESSAGE=this.sdaTranslateService.get("ENTRYPOINT_NO_ACCESS_MESSAGE","Selected role does not have access to configure this entry point. Please select another role from the dropdown above."),this.ENTRYPOINT_SHOWALL=this.sdaTranslateService.get("ENTRYPOINT_SHOWALL","SHOW ALL"),this.ENTRYPOINT_SHOWALL_TOOLTIP=this.sdaTranslateService.get("ENTRYPOINT_SHOWALL_TOOLTIP","Show all items regardless of access restrictions"),this.currentUserRoleUID=void 0,this.infoMapMode=!1,this.showAll=!1,this.totalPages=0,this.currentPageNumber=0,this.leftPowerBarControls=new Array,this.showSettingsMenu=!0,this.showNoAccessMessage=!1,this.powerBarControlsWithoutInfoMap=new Array,this.powerBarControlsInfoMap=new Array,this.applicationSettingsService.setPageTitle(this.ENDPOINTADMIN_TITLE),this.helpService.setHandlers(w.q)}ngOnInit(){this.initialiseContent()}handleSelectedRoleIdChange(e){this.selectedRole=e,this.loadEntryPointData()}handleSelectedEntryPointIdChange(e){this.selectedObjectId=e,this.loadEntryPointData()}handleCheckBoxChangeInfoMap(e){this.infoMapMode=e.checked,this.loadEntryPointData()}handleShowAllCheckBoxChangeInfoMap(e){this.showAll=e.checked,this.loadEntryPointData()}changePageNumber(e){this.currentPageNumber=e,this.selectedEntryPointObject=this.pagedEntryPointData[e]}ngOnDestroy(){this.actionMenuProvider.clearAndCloseActionsMenu()}initialiseContent(){this.selectedEntryPointObject=void 0,this.rolesRespository.roles$.subscribe(e=>{e.forEach(e=>{this.currentUserRoleUID||!0!==e.Selected||(this.currentUserRoleUID=e.RoleUID)})}),this.dataRefreshService.itemsRemoved$.subscribe(e=>{e.indexOf(this.selectedObjectId)>-1&&this.featureSetNavigationService.navigateBackToPreviousRoute()}),this.route.queryParamMap.subscribe(e=>{if(e.has("objects")){const t=JSON.parse(e.get("objects"));this.onObjectSelected(t)}}),this.route.data.subscribe(e=>{e&&e[N.z]&&this.onObjectSelected(e[N.z])},e=>{this.exceptionService.handleException(e),this.loadingOverlayService.hideLoadingOverlay()})}onObjectSelected(e){(!e||e.length<1)&&this.exceptionService.handleException(new f.a(this.NOENTRYPOINT_GIVEN_ERROR,void 0,"admin-entrypoint.api.component","initialiseContent")),this.config=e[0].config,this.selectedObjectId=e[0].obid,this.roles?this.loadEntryPointData():this.setupRolesForPage()}addPowerBarItems(){this.powerBarControlsWithoutInfoMap=[],this.powerBarControlsInfoMap=[];const e=new y.a(this.ENTRYPOINT_ROLES),t=new _.a(this.roles,e=>{this.handleSelectedRoleIdChange(e.obid)});this.currentUserRoleUID&&this.selectedRole&&(t.selectedItem=this.roles.find(e=>e.obid===this.selectedRole)),t.isDisabled=!1,this.powerBarControlsWithoutInfoMap.push(e),this.powerBarControlsWithoutInfoMap.push(t),this.powerBarControlsWithoutInfoMap.push(new S.a);const i=new I.a(e=>this.handleCheckBoxChangeInfoMap(e),this.ENTRYPOINT_INFOMAP_MODE,!1,void 0,"");i.tooltip=this.ENTRYPOINT_INFOMAP_MODE_TOOLTIP;const n=new I.a(e=>this.handleShowAllCheckBoxChangeInfoMap(e),this.ENTRYPOINT_SHOWALL,this.showAll,void 0,"");n.tooltip=this.ENTRYPOINT_SHOWALL_TOOLTIP,this.powerBarControlsWithoutInfoMap.push(n),this.powerBarControlsInfoMap.push(i),this.setPowerBarWithInfoMap()}setPowerBarWithoutInfoMap(){this.leftPowerBarControls=this.powerBarControlsWithoutInfoMap}setPowerBarWithInfoMap(){this.leftPowerBarControls=this.powerBarControlsWithoutInfoMap,this.leftPowerBarControls=this.leftPowerBarControls.concat(this.powerBarControlsInfoMap)}setupRolesForPage(){this.loadingOverlayService.showLoadingOverlay(),this.adminDataService.getAllRoles().subscribe(e=>{if(this.roles=e.sort((e,t)=>T.a.sortByString(e.name,t.name)),this.currentUserRoleUID){const t=e.find(e=>e.uid===this.currentUserRoleUID);t&&(this.selectedRole=t.obid)}this.selectedRole||(this.selectedRole=this.roles[0].obid),this.addPowerBarItems(),this.loadEntryPointData()},e=>{this.exceptionService.handleException(e),this.loadingOverlayService.hideLoadingOverlay()})}loadEntryPointData(){this.showNoAccessMessage=!1,void 0!==this.selectedRole&&(this.actionMenuProvider.clearAndCloseActionsMenu(),this.adminDataService.getEntryPointMaintenanceObject(this.selectedObjectId,this.config,this.selectedRole,this.infoMapMode,!this.showAll).subscribe(e=>{e.length>0?(this.pagedEntryPointData=e,this.selectedEntryPointObject=e[0],this.currentPageNumber=0,this.totalPages=e.length,this.setPowerBarWithInfoMap()):(this.selectedEntryPointObject=void 0,this.showNoAccessMessage=!0,this.totalPages=0,this.setPowerBarWithoutInfoMap(),this.notificationService.info(this.sdaTranslateService.get("ENTRYPOINT_NO_ACCESS","Selected role does not have access"))),this.loadingOverlayService.hideLoadingOverlay()},e=>{this.exceptionService.handleException(e),this.loadingOverlayService.hideLoadingOverlay()}))}}return e.\u0275fac=function(t){return new(t||e)(k.Sb(D.a),k.Sb(m.a),k.Sb(O.a),k.Sb(b.a),k.Sb(B),k.Sb(g.a),k.Sb(p.a),k.Sb(u.a),k.Sb(P.a),k.Sb(v.a),k.Sb(E.a),k.Sb(C.a))},e.\u0275cmp=k.Mb({type:e,selectors:[["ng-component"]],decls:5,vars:8,consts:[[3,"leftControls"],[1,"entrypoints"],[3,"selectedRole","entryPointObject","config","refreshPageWithOBID",4,"ngIf"],["class","entrypoints__noaccess",4,"ngIf"],[3,"totalPages","currentPage","changePage",4,"ngIf"],[3,"selectedRole","entryPointObject","config","refreshPageWithOBID"],[1,"entrypoints__noaccess"],[3,"totalPages","currentPage","changePage"]],template:function(e,t){1&e&&(k.Tb(0,"sda-power-bar-view",0),k.Yb(1,"div",1),k.Sc(2,tt,1,3,"sda-admin-entry-point-viewer",2),k.Sc(3,it,2,1,"div",3),k.Sc(4,nt,1,2,"sda-pagination",4),k.Xb()),2&e&&(k.sc("leftControls",t.leftPowerBarControls),k.Eb(1),k.Ib("entrypoints--noaccess",t.showNoAccessMessage)("wc-background",t.showNoAccessMessage),k.Eb(1),k.sc("ngIf",t.selectedEntryPointObject&&t.selectedRole&&!t.showNoAccessMessage),k.Eb(1),k.sc("ngIf",t.showNoAccessMessage),k.Eb(1),k.sc("ngIf",t.totalPages>1&&!t.showNoAccessMessage))},directives:[j.a,n.t,Ze,et.a],styles:["[_nghost-%COMP%]{display:flex;flex:1;flex-direction:column}sda-power-bar-view[_ngcontent-%COMP%]     .power-bar-checkbox{margin-right:8px}.entrypoints[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column}.entrypoints--noaccess[_ngcontent-%COMP%]{justify-content:center}.entrypoints__noaccess[_ngcontent-%COMP%]{align-self:center;max-width:500px;margin:0 20px;padding:15px 20px;background-color:rgba(0,0,0,.15);border-radius:5px}"]}),e})(),resolve:{objects:i("5iMO").a}}];let at=(()=>{class e{}return e.\u0275mod=k.Qb({type:e}),e.\u0275inj=k.Pb({factory:function(t){return new(t||e)},imports:[[p.k.forChild(ot)],p.k]}),e})(),st=(()=>{class e{}return e.\u0275mod=k.Qb({type:e}),e.\u0275inj=k.Pb({factory:function(t){return new(t||e)},imports:[[n.c,ee.l,te.b]]}),e})();var rt=i("Xys1"),ct=i("K9v4"),lt=i("LRne"),dt=i("z6cu"),ht=i("JIr8"),pt=i("JrsU");let ut=(()=>{class e{constructor(e,t,i){this.exceptionService=e,this.sdaTranslateService=t,this.objectIconService=i,this.ERROR_LOADING_ITEM=this.sdaTranslateService.get("ERROR_LOADING_ITEM","Specified item not found. <BR/><BR/>This could be because the item doesn't exist or because you don\u2019t have permission to view it. Please contact your administrator for more information."),this.images=[],this.formatDataAsProperties=e=>{const t=[];for(const i in e)if(e.hasOwnProperty(i)&&-1===i.indexOf("@odata")&&(null===e[i]||"object"!=typeof e[i])){const n=new pt.a(i,e[i]);t.push(n)}return t}}buildEntityTree(e,t,i){if(e&&204!==e.originalResponse.status){const n=this.consolidateObjectData("OBID",e.value,t);return this.getImages("OBID",n,t,i).pipe(Object(A.a)(e=>(this.images=e,this.parseDataToBuildTree("OBID",n,t))),Object(ht.a)(e=>{const i=new f.a(e,void 0,"EntryPointViewerEntityService","buildEntityTree");return this.exceptionService.handleException(i),Object(lt.a)(this.parseDataToBuildTree("OBID",n,t))}))}return Object(dt.a)(new f.a(this.ERROR_LOADING_ITEM))}parseDataToBuildTree(e,t,i){let n;const o=t.Class,a=this.formatDataAsProperties(t);n=new F(t.Name,o),n.key=t[e],n.properties=a,n.image=this.getImageForType(t[e]);for(const s in i)if(i.hasOwnProperty(s)){const o=i[s];1===o.count?n=this.displayInstance(n,t,s,o,e):o.count>1&&(n=this.displayChildren(n,t,s,o,e))}return n}displayInstance(e,t,i,n,o){const a=t[i]instanceof Array?t[i][0]:t[i];if(a){const t=new F(a.Name,n.displayName);t.key=a[o],t.count=1,t.image=this.getImageForType(a[o]),a.FileId&&(t.fileId=a.FileId),e.children.push(t)}return e}displayChildren(e,t,i,n,o){const a=new F(n.displayName,n.displayName,n);if(a.count=n.count,a.image=Ye.b+"ObjectGroup.svg",n.count<=3&&n.count>1)for(let s=0;s<t[i].length;s++){const e=new F(t[i][s].Name,n.displayName);e.key=t[i][s][o],e.count=1,e.image=this.getImageForType(t[i][s][o]),t[i][s].FileId&&(e.fileId=t[i][s].FileId),a.children.push(e)}return e.children.push(a),e}getImageForType(e){let t=Ye.a;if(e){const i=this.images.filter(t=>t.OBID===e);i&&i.length&&i[0].IconName&&(t=i[0].IconName)}return Ye.b+t+".svg"}getImages(e,t,i,n){const o=[t[e]];for(const a in i)if(i.hasOwnProperty(a)){const n=i[a];if(1===n.count){const i=t[a]instanceof Array?t[a][0]:t[a];i&&o.push(i[e])}else if(n.count>1&&n.count<=3&&n.count>1)for(let i=0;i<t[a].length;i++)o.push(t[a][i][e])}return this.objectIconService.getIconNames(o,n)}consolidateObjectData(e,t,i){let n;if(t.length>1){if(n=t.find(e=>"Version"===e["Class@Intergraph.SPF.Server.API.Model.DocumentLevelAnnotation"]),!n)throw new f.a(this.ERROR_LOADING_ITEM);t.forEach(t=>{const o=t[e];if(o!==n.key)for(const e in i)i.hasOwnProperty(e)&&i[e].objectObid===o&&(n[e]=t[e],n[e+"@odata.count"]=t[e+"@odata.count"])})}else n=t[0];return n}}return e.\u0275fac=function(t){return new(t||e)(k.dc(g.a),k.dc(O.a),k.dc(M.a))},e.\u0275prov=k.Ob({token:e,factory:e.\u0275fac}),e})(),mt=(()=>{class e{}return e.\u0275mod=k.Qb({type:e}),e.\u0275inj=k.Pb({factory:function(t){return new(t||e)},providers:[Xe,He,ut,We],imports:[[n.c,ct.a,c.a,rt.a,qe.b]]}),e})(),ft=(()=>{class e{}return e.\u0275mod=k.Qb({type:e}),e.\u0275inj=k.Pb({factory:function(t){return new(t||e)},providers:[B,q],imports:[[at,mt,n.c,c.a,s.a,a.b,h.a,o.b,r.a,l.a,d.a,st]]}),e})()},d74k:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t){this.field=e,this.dir=t}}},ltBE:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("fXoL");let o=(()=>{class e{transform(e,t,i){return e?i?e.filter(e=>e[t].toLowerCase().includes(i.toLowerCase())):e:[]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=n.Rb({name:"sdaFilter",type:e,pure:!0}),e})()},yzqN:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"e",(function(){return s})),i.d(t,"f",(function(){return r})),i.d(t,"g",(function(){return c})),i.d(t,"h",(function(){return l})),i.d(t,"k",(function(){return d})),i.d(t,"i",(function(){return h})),i.d(t,"j",(function(){return p})),i.d(t,"m",(function(){return u})),i.d(t,"o",(function(){return m})),i.d(t,"p",(function(){return f})),i.d(t,"r",(function(){return g})),i.d(t,"s",(function(){return D})),i.d(t,"t",(function(){return b})),i.d(t,"u",(function(){return I})),i.d(t,"v",(function(){return _})),i.d(t,"w",(function(){return y})),i.d(t,"x",(function(){return S})),i.d(t,"y",(function(){return E})),i.d(t,"z",(function(){return v})),i.d(t,"A",(function(){return O})),i.d(t,"B",(function(){return N})),i.d(t,"C",(function(){return T})),i.d(t,"E",(function(){return P})),i.d(t,"F",(function(){return w})),i.d(t,"q",(function(){return C})),i.d(t,"D",(function(){return A})),i.d(t,"n",(function(){return R})),i.d(t,"d",(function(){return M})),i.d(t,"l",(function(){return x}));const n="787103",o="820826",a="825969",s="858646",r="858646",c="858646",l="858646",d="858646",h="858646",p="858646",u="791026",m="858646",f="817611",g="787103",D="794537",b="824313",I="791026",_="926854",y="939623",S="816118",E="791870",v="812357",O="794563",N="939623",T="791037",P="820826",w="817611",C="865948",A="987283",R="1016694",M="1028155",x="1125484"}}]);