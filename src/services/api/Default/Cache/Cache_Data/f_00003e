(window.webpackJsonp=window.webpackJsonp||[]).push([[57,122],{"+bLt":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Xfrm");class s{constructor(e,t){this.router=e,this.featureSetNavigationService=t,this.onExecuteMethod=(e,t)=>{this.args=t,this.onExecute(e)}}navigateToActionRoute(e,t,i){if(this.args&&this.args.openInNewTab){const s=this.router.createUrlTree(t,i),o=this.router.serializeUrl(s),r=new n.a(e.name,o);this.featureSetNavigationService.navigateViaRoute(e,r,!0,!1)}else e.showInRelativeRoute&&(t[0]=t[0].replace("/",""),i=Object.assign(Object.assign({},i),this.args.extras)),this.router.navigate(t,i)}}},"20dk":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t=!0,i=""){this.objectsToRefresh=e,this.refreshResultsGrid=t,this.origin=i}}},"49qs":function(e,t,i){"use strict";i.d(t,"a",(function(){return B}));var n=i("ofXK"),s=i("3Pt+"),o=i("NFeN"),r=i("dPl2"),a=i("Xys1"),c=i("CakU"),l=i("PMIr"),h=i("F+hv"),d=i("mQCr"),u=i("69YF"),p=i("fdS2"),b=i("mRuZ"),_=i("83Gb"),g=i("VG3f"),f=i("CRLB"),m=i("Z9D8"),E=i("LUpO"),S=i("C4gn"),x=i("c+03"),R=i("+ooB"),v=i("jNCI"),I=i("PEjJ"),O=i("20dk"),T=i("+bLt"),P=i("Ejbi"),C=i("8ihU"),D=i("fXoL");const w=["api"];let y=(()=>{class e extends C.a{ngOnInit(){this.feature=this.getData()}ok(){this.api.onFinish()}cancel(){this.api.onCancel?this.api.onCancel():super.cancel()}}return e.\u0275fac=function(t){return L(t||e)},e.\u0275dir=D.Nb({type:e,viewQuery:function(e,t){var i;1&e&&D.bd(w,!0),2&e&&D.Gc(i=D.ic())&&(t.api=i.first)},features:[D.Bb]}),e})();const L=D.ac(y);var M=i("sSB5");let A=(()=>{class e extends y{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(D.Sb(v.a))},e.\u0275cmp=D.Mb({type:e,selectors:[["ng-component"]],features:[D.Bb],decls:2,vars:6,consts:[[1,"api",3,"allowTerminate","securityRuleDefinition","selectedObjects","enableDetailSelection","showSidebar","showActionsMenuButton","onChangeFinishButtonText","onChangeFinishButtonEnabled"],["api",""]],template:function(e,t){1&e&&(D.Yb(0,"sda-relationship-builder",0,1),D.hc("onChangeFinishButtonText",(function(e){return t.updateButtonText(e)}))("onChangeFinishButtonEnabled",(function(e){return e?t.enableOkayButton():t.disableOkayButton()})),D.Xb()),2&e&&D.sc("allowTerminate","true"===(null==t.feature.apiParam2?null:t.feature.apiParam2.toLowerCase()))("securityRuleDefinition",t.feature.apiParam3)("selectedObjects",t.feature.objects)("enableDetailSelection",!1)("showSidebar",!1)("showActionsMenuButton",!1)},directives:[M.a],styles:[".api[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;flex:1}.api[_ngcontent-%COMP%]{flex-direction:column}"]}),e})();var N=i("tyNb");let k=(()=>{class e extends T.a{constructor(e,t,i,n,s,o,r,a,c){super(a,c),this.modalService=e,this.sdaTranslateService=t,this.loadingIndicatorService=i,this.exceptionService=n,this.componentFactoryResolver=s,this.injector=o,this.dataRefreshService=r,this.router=a,this.featureSetNavigationService=c,this.clientApiName="SDARelationshipBuilder"}onExecute(e){try{let t=e.apiParam1&&e.apiParam1.length>0?e.apiParam1:this.sdaTranslateService.get("REL_BUILDER_TITLE","Relationship Builder");e.objects&&e.objects.length>0&&e.objects[0].name&&e.objects[0].name.length>0&&(t+=" - "+e.objects[0].name);const i=new R.a(t,A,this.componentFactoryResolver,this.injector);i.disableThirdButton=!0,i.disableOk=!0,i.okBtnText=this.sdaTranslateService.get("OK","Ok"),i.cancelBtnText=this.sdaTranslateService.get("CANCEL","Cancel"),i.size="xlarge",i.data=e,this.modalService.showModal(i).then(()=>{this.dataRefreshService.refreshData(new O.a(e.objects,!1))}).catch(e=>{this.exceptionService.handleException(new m.a(e))})}catch(t){this.exceptionService.handleException(t),this.loadingIndicatorService.hideLoadingOverlay()}}}return e.\u0275fac=function(t){return new(t||e)(D.dc(v.a),D.dc(P.a),D.dc(x.a),D.dc(E.a),D.dc(D.j),D.dc(D.s),D.dc(I.a),D.dc(N.g),D.dc(S.a))},e.\u0275prov=D.Ob({token:e,factory:e.\u0275fac}),e})(),B=(()=>{class e{}return e.\u0275mod=D.Qb({type:e}),e.\u0275inj=D.Pb({factory:function(t){return new(t||e)},providers:[{provide:b.a,useClass:k}],imports:[[a.a,n.c,s.j,l.a,h.a,p.a,r.c,_.a,f.a,c.a,g.a,o.b,d.a,u.a]]}),e})()},"7OzN":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("8U5n"),s=i("Ejbi"),o=(i("mOod"),i("fXoL")),r=i("PSAI");let a=(()=>{class e{constructor(e){this.sdaTranslateService=e,this.displayItems=[],this.REL_BUILDER_ERROR_INFO=this.sdaTranslateService.get("REL_BUILDER_ERROR_INFO","It is not possible to create a relationship between the two selected objects. Here are the relationship definitions identified for creation and the reasons they are not allowed."),this.errorIcon="error",this.relErrorIcon="connection",this.relErrorList=[]}ngOnInit(){this.checkForErrors(this.relDictionary.cardinalityError)&&this.relErrorList.push(this.relDictionary.cardinalityError),this.checkForErrors(this.relDictionary.conditionNotSatisfied)&&this.relErrorList.push(this.relDictionary.conditionNotSatisfied),this.checkForErrors(this.relDictionary.existingRelation)&&this.relErrorList.push(this.relDictionary.existingRelation),this.checkForErrors(this.relDictionary.interfaceAccess)&&this.relErrorList.push(this.relDictionary.interfaceAccess),this.displayItems=this.setDisplayItems()}checkForErrors(e){return e&&e.Rels&&e.Rels.length>0}setDisplayItems(){return this.relErrorList.map(e=>new n.a(e.DisplayAs,e.DisplayAs,void 0,void 0,void 0,this.getChildren(e.Rels),!1,this.errorIcon))}getChildren(e){return e?e.map(e=>{const t=e.Description?e.Name.concat(", ",e.Description):e.Name;return new n.a(t,e.Name,e.Description,void 0,void 0,void 0,!1,this.relErrorIcon)}):[]}}return e.\u0275fac=function(t){return new(t||e)(o.Sb(s.a))},e.\u0275cmp=o.Mb({type:e,selectors:[["sda-relationship-error"]],inputs:{relDictionary:"relDictionary"},decls:3,vars:4,consts:[[1,"relationship-info"],["textProperty","displayName","iconProperty","iconName",3,"defaultCollapsed","expandOnSelect","items"]],template:function(e,t){1&e&&(o.Yb(0,"p",0),o.Uc(1),o.Xb(),o.Tb(2,"uxt-tree-list",1)),2&e&&(o.Eb(1),o.Vc(t.REL_BUILDER_ERROR_INFO),o.Eb(1),o.sc("defaultCollapsed",!1)("expandOnSelect",!0)("items",t.displayItems))},directives:[r.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.relationship-info[_ngcontent-%COMP%]{padding:0 20px 20px}uxt-tree-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:114px;max-height:190px;border:1px solid #ebedf0;margin:0 20px;overflow-x:hidden;overflow-y:auto}"]}),e})()},GW71:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("R0Ic"),s=i("fXoL"),o=i("WPJx"),r=i("ofXK"),a=i("qKxU");function c(e,t){if(1&e){const e=s.Zb();s.Yb(0,"uxt-icon-button",12),s.hc("click",(function(){return s.Kc(e),s.lc().handleSubmit()})),s.Xb()}}function l(e,t){if(1&e){const e=s.Zb();s.Yb(0,"uxt-icon-button",13),s.hc("click",(function(){return s.Kc(e),s.lc().handleCancel()})),s.Xb()}}function h(e,t){if(1&e){const e=s.Zb();s.Yb(0,"button",14),s.hc("click",(function(){return s.Kc(e),s.lc().handleSubmit()})),s.Uc(1),s.Xb()}if(2&e){const e=s.lc();s.Eb(1),s.Wc(" ",e.submitText," ")}}function d(e,t){if(1&e){const e=s.Zb();s.Yb(0,"button",15),s.hc("click",(function(){return s.Kc(e),s.lc().handleCancel()})),s.Uc(1),s.Xb()}if(2&e){const e=s.lc();s.Eb(1),s.Wc(" ",e.cancelText," ")}}const u=["*"];let p=(()=>{class e{constructor(){this.cancelText="Cancel",this.showCancelButton=!0,this.submitText="Ok",this.enableSubmitButton=!0,this.cancel=new s.o,this.submit=new s.o,this.className=!0}get isOpenClass(){return this.isOpen}handleCancel(){this.cancel.emit()}handleSubmit(){this.submit.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Mb({type:e,selectors:[["uxt-modal"]],hostVars:4,hostBindings:function(e,t){2&e&&s.Ib("uxt-modal",t.className)("uxt-modal--open",t.isOpenClass)},inputs:{isOpen:"isOpen",cancelText:"cancelText",showCancelButton:"showCancelButton",submitText:"submitText",titleText:"titleText",enableSubmitButton:"enableSubmitButton"},outputs:{cancel:"cancel",submit:"submit"},ngContentSelectors:u,decls:15,vars:9,consts:[[1,"uxt-modal__overlay"],[1,"uxt-modal__window"],["position","top",1,"uxt-modal__header"],["class","uxt-modal__header__button__close uxt-modal__header__button__close__back","iconName","arrow-left",3,"click",4,"ngIf"],["class","uxt-modal__header__button__close uxt-modal__header__button__close__close","iconName","close",3,"click",4,"ngIf"],[1,"uxt-modal__header__title"],["class","uxt-modal__header__button__submit",3,"click",4,"ngIf"],[1,"uxt-modal__content"],[1,"uxt-modal__actions"],[1,"uxt-modal__actions__buttons"],["class","uxt-modal__actions__button uxt-modal__actions__button__cancel",3,"click",4,"ngIf"],[1,"uxt-modal__actions__button","uxt-modal__actions__button__submit",3,"disabled","click"],["iconName","arrow-left",1,"uxt-modal__header__button__close","uxt-modal__header__button__close__back",3,"click"],["iconName","close",1,"uxt-modal__header__button__close","uxt-modal__header__button__close__close",3,"click"],[1,"uxt-modal__header__button__submit",3,"click"],[1,"uxt-modal__actions__button","uxt-modal__actions__button__cancel",3,"click"]],template:function(e,t){1&e&&(s.rc(),s.Tb(0,"div",0),s.Yb(1,"div",1),s.Yb(2,"uxt-toolbar",2),s.Sc(3,c,1,0,"uxt-icon-button",3),s.Sc(4,l,1,0,"uxt-icon-button",4),s.Yb(5,"h1",5),s.Uc(6),s.Xb(),s.Sc(7,h,2,1,"button",6),s.Xb(),s.Yb(8,"div",7),s.qc(9),s.Xb(),s.Yb(10,"uxt-toolbar",8),s.Yb(11,"div",9),s.Sc(12,d,2,1,"button",10),s.Yb(13,"button",11),s.hc("click",(function(){return t.handleSubmit()})),s.Uc(14),s.Xb(),s.Xb(),s.Xb(),s.Xb()),2&e&&(s.sc("@overlay",t.isOpen?"open":"closed"),s.Eb(1),s.sc("@window",t.isOpen?"open":"closed"),s.Eb(2),s.sc("ngIf",!t.showCancelButton),s.Eb(1),s.sc("ngIf",t.showCancelButton),s.Eb(2),s.Wc(" ",t.titleText," "),s.Eb(1),s.sc("ngIf",t.showCancelButton),s.Eb(5),s.sc("ngIf",t.showCancelButton),s.Eb(1),s.sc("disabled",!t.enableSubmitButton),s.Eb(1),s.Wc(" ",t.submitText," "))},directives:[o.a,r.t,a.a],styles:[".uxt-modal{position:fixed;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;z-index:450}.uxt-modal:not(.uxt-modal--open){pointer-events:none}.uxt-modal__overlay{position:absolute;top:0;left:0;right:0;bottom:0;background-color:#000}.uxt-modal__window{display:flex;flex-direction:column;background-color:#fff;box-shadow:1px 1px 10px rgba(0,0,0,.25)}.uxt-modal__header{display:flex;align-items:center;height:56px;padding-right:8px;padding-left:8px;background-color:#fff!important}.uxt-modal__header__title{font-size:1.25rem;font-weight:500}.uxt-modal__content{display:flex;flex-grow:1;flex-direction:column;width:100%;min-height:100%;padding:16px;overflow-x:hidden;overflow-y:scroll}@media (max-height:300px){.uxt-modal__content{height:140px}}@media (max-width:768px){.uxt-modal__window{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;max-width:none;min-height:inherit}.uxt-modal__header{margin-top:56px;box-shadow:0 2px 5px rgba(0,0,0,.15)}.uxt-modal__header__title{flex-grow:1;margin-left:8px;padding-left:40px!important}.uxt-modal__header__button__close,.uxt-modal__header__button__submit{display:none!important}.uxt-modal__content{min-height:inherit;padding-left:56px}.uxt-modal textarea{overflow-y:scroll}.uxt-modal__actions{border-bottom-left-radius:2px;border-bottom-right-radius:2px;background-color:#fff!important;display:flex!important}.uxt-modal__actions__buttons{display:flex;margin-left:auto}.uxt-modal__actions__button{color:#02adff!important;border:none!important}}@media (min-width:769px){.uxt-modal__window{flex-shrink:1;min-width:420px;max-width:768px;max-height:90vh;border-radius:2px;z-index:451}.uxt-modal__header{border-top-left-radius:2px;border-top-right-radius:2px;padding-right:16px;padding-left:16px}.uxt-modal__header__button__close,.uxt-modal__header__button__submit{display:none!important}.uxt-modal__content{padding-right:24px;padding-left:24px;overflow-y:inherit}.uxt-modal__actions{border-bottom-left-radius:2px;border-bottom-right-radius:2px;background-color:#fff!important}.uxt-modal__actions__buttons{display:flex;margin-left:auto}.uxt-modal__actions__button{color:#02adff!important;border:none!important}}"],encapsulation:2,data:{animation:[Object(n.o)("overlay",[Object(n.l)("open",Object(n.m)({opacity:"0.5"})),Object(n.l)("closed",Object(n.m)({opacity:"0.0"})),Object(n.n)("open <=> closed",Object(n.e)("0.125s ease"))]),Object(n.o)("window",[Object(n.l)("open",Object(n.m)({marginTop:"0px"})),Object(n.l)("closed",Object(n.m)({marginTop:"2000px"})),Object(n.n)("open <=> closed",Object(n.e)("0.250s ease"))])]}}),e})()},sSB5:function(e,t,i){"use strict";i.d(t,"a",(function(){return be}));var n=i("fXoL"),s=i("FwyN"),o=i("/1FC"),r=i("NFsq"),a=i("cp0P"),c=i("IzEk"),l=i("4B5/"),h=i("m8I0"),d=i("wN6G"),u=i("Z9D8"),p=i("LUpO"),b=i("js/d"),_=i("xc+7"),g=i("c+03"),f=i("jNCI"),m=i("JSP6"),E=i("Qi+w"),S=i("wpY2"),x=i("ghPn"),R=i("4ZEd"),v=i("iwlc"),I=i("tCxB"),O=i("8IK6"),T=i("A3La"),P=i("Ejbi"),C=i("XwBL"),D=i("YsXg"),w=i("41Lq"),y=i("yzqN");class L{constructor(e){this.object=e,this.selected=!1}}var M=i("+Pa6"),A=i("zFBM"),N=i("tyNb"),k=i("ofXK"),B=i("dPl2"),F=i("6sHd"),j=i("XiP7"),U=i("YkmU"),X=i("TLn4"),Y=i("Jgl7"),G=i("yISo"),V=i("OtLZ"),K=i("NFeN");function z(e,t){if(1&e&&(n.Yb(0,"div"),n.Uc(1),n.Xb()),2&e){const e=n.lc();n.Eb(1),n.Wc(" ",e.NO_RELS_FOUND," ")}}function q(e,t){if(1&e){const e=n.Zb();n.Yb(0,"div",3),n.hc("click",(function(){n.Kc(e);const i=t.$implicit;return n.lc().toggle(i)})),n.Tb(1,"uxt-checkbox",4),n.Yb(2,"mat-icon",5),n.hc("click",(function(){n.Kc(e);const i=t.$implicit;return n.lc().terminateRelationship(i)})),n.Xb(),n.Yb(3,"div",6),n.Yb(4,"div",7),n.hc("click",(function(i){n.Kc(e);const s=t.$implicit;return n.lc().viewItemDetails(s,i)})),n.Uc(5),n.Xb(),n.Yb(6,"div",8),n.Uc(7),n.Xb(),n.Xb(),n.Xb()}if(2&e){const e=t.$implicit,i=n.lc();n.Ib("existing-relationship-list__item--no-terminate",!e.canTerminate),n.Eb(1),n.sc("isActive",i.isRelationshipSelected(e))("isDisabled",!e.canTerminate),n.Eb(3),n.Ib("existing-relationship-list__item__name--disabled",!i.enableDetailSelection),n.Eb(1),n.Wc(" ",null==e?null:e.otherItemName," "),n.Eb(2),n.Wc(" ",null==e?null:e.roleDisplayName," ")}}let H=(()=>{class e{constructor(e){this.sdaTranslateService=e,this.relationships=[],this.enableDetailSelection=!0,this.selectedRelationshipsChange=new n.o,this.terminate=new n.o,this.viewDetails=new n.o,this.NO_RELS_FOUND=this.sdaTranslateService.get("REL_BUILDER_NO_RELS_FOUND","No relationships found")}isRelationshipSelected(e){return Object(r.a)(this.selectedRelationships,e)}viewItemDetails(e,t){t.preventDefault(),t.stopPropagation(),this.viewDetails.emit(e.otherItemOBID)}terminateRelationship(e){e.canTerminate&&this.terminate.emit(e)}toggle(e){e.canTerminate&&(this.isRelationshipSelected(e)?this.selectedRelationshipsChange.emit(Object(V.a)(this.selectedRelationships,e)):this.selectedRelationshipsChange.emit(this.selectedRelationships.concat([e])))}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(P.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-existing-relationship-list"]],inputs:{relationships:"relationships",enableDetailSelection:"enableDetailSelection",selectedRelationships:"selectedRelationships"},outputs:{selectedRelationshipsChange:"selectedRelationshipsChange",terminate:"terminate",viewDetails:"viewDetails"},decls:3,vars:2,consts:[[1,"existing-relationship-list__items"],[4,"ngIf"],["class","existing-relationship-list__item",3,"existing-relationship-list__item--no-terminate","click",4,"ngFor","ngForOf"],[1,"existing-relationship-list__item",3,"click"],[3,"isActive","isDisabled"],["svgIcon","trash",1,"existing-relationship-list__icon",3,"click"],[1,"existing-relationship-list__item__text"],[1,"existing-relationship-list__item__name",3,"click"],[1,"existing-relationship-list__item__role-display-name"]],template:function(e,t){1&e&&(n.Yb(0,"div",0),n.Sc(1,z,2,1,"div",1),n.Sc(2,q,8,8,"div",2),n.Xb()),2&e&&(n.Eb(1),n.sc("ngIf",0===t.relationships.length),n.Eb(1),n.sc("ngForOf",t.relationships))},directives:[k.t,k.s,F.a,K.a],styles:["[_nghost-%COMP%]{position:relative;overflow:hidden}[_nghost-%COMP%], [_nghost-%COMP%]   .existing-relationship-list__items[_ngcontent-%COMP%]{display:flex;flex:1 1 100%;flex-direction:column}[_nghost-%COMP%]   .existing-relationship-list__items[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]   .existing-relationship-list__item[_ngcontent-%COMP%]{display:flex;align-items:center;flex:0 0 60px;padding-right:16px;padding-left:16px;border-bottom:1px solid #cad0d7;cursor:pointer;overflow:hidden}[_nghost-%COMP%]   .existing-relationship-list__icon[_ngcontent-%COMP%]{flex-shrink:0;margin-right:10px;color:#0087c8}[_nghost-%COMP%]   .existing-relationship-list__item__text[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow:hidden}[_nghost-%COMP%]   .existing-relationship-list__item__name[_ngcontent-%COMP%]{color:#0087c8;font-size:1em;font-weight:500;line-height:16px;cursor:pointer;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}[_nghost-%COMP%]   .existing-relationship-list__item__name[_ngcontent-%COMP%]:not(.existing-relationship-list__item__name--disabled):hover{text-decoration:underline}[_nghost-%COMP%]   .existing-relationship-list__item__name--disabled[_ngcontent-%COMP%]{color:#333}[_nghost-%COMP%]   .existing-relationship-list__item__role-display-name[_ngcontent-%COMP%]{color:#515e6b;font-size:.875em;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}[_nghost-%COMP%]   .existing-relationship-list__item[_ngcontent-%COMP%]:not(.existing-relationship-list__item--no-terminate):hover{background-color:#ebedf0}[_nghost-%COMP%]   .existing-relationship-list__item--no-terminate[_ngcontent-%COMP%]{cursor:default}[_nghost-%COMP%]   .existing-relationship-list__item--no-terminate[_ngcontent-%COMP%]   .existing-relationship-list__icon[_ngcontent-%COMP%]{color:#cad0d7}"]}),e})();var W=i("GW71"),Z=i("7OzN");const $=["relPicker"];function J(e,t){if(1&e&&(n.Yb(0,"div",4),n.Uc(1),n.Xb()),2&e){const e=n.lc();n.Eb(1),n.Vc(e.REL_BUILDER_NO_ITEMS_PARAMETER)}}function Q(e,t){if(1&e){const e=n.Zb();n.Yb(0,"div",31),n.hc("click",(function(){n.Kc(e);const i=t.$implicit;return n.lc(3).select(i)})),n.Yb(1,"div"),n.Yb(2,"div",32),n.hc("click",(function(){n.Kc(e);const i=t.$implicit;return n.lc(3).handleItemPress(i)})),n.Uc(3),n.Xb(),n.Yb(4,"div",33),n.Uc(5),n.Xb(),n.Xb(),n.Xb()}if(2&e){const e=t.$implicit,i=n.lc(3);n.Ib("active",i.selectedItem&&i.selectedItem.obid===e.obid),n.Eb(2),n.Ib("rel-builder-pinned-item__item__name--disabled",!i.enableDetailSelection),n.Eb(1),n.Wc(" ",e.name," "),n.Eb(2),n.Vc(e.displayAs)}}function ee(e,t){if(1&e&&(n.Yb(0,"div",28),n.Yb(1,"div",8),n.Yb(2,"span",9),n.Uc(3),n.Xb(),n.Xb(),n.Yb(4,"div",29),n.Sc(5,Q,6,6,"div",30),n.Xb(),n.Xb()),2&e){const e=n.lc(2);n.Eb(3),n.Vc(e.SELECTED_ITEMS),n.Eb(2),n.sc("ngForOf",e.items)}}function te(e,t){if(1&e){const e=n.Zb();n.Yb(0,"sda-pins-group-selector",34),n.hc("selectedGroupChanged",(function(t){return n.Kc(e),n.lc(2).selectPinGroup(t)})),n.Xb()}if(2&e){const e=n.lc(2);n.sc("pinToGroupMode",!1)("hideIcon",!0)("showCreateListButton",!1)("configFilterOverride",e.configKey)("selectedGroup",e.selectedPinGroup)("syncSelectedGroupWithMenu",!1)("fixedWidth",230)}}function ie(e,t){if(1&e&&n.Tb(0,"sda-loading-indicator",35),2&e){const e=n.lc(2);n.sc("centered",!0)("message",e.REL_BUILDER_LOADING_MESSAGE)}}function ne(e,t){if(1&e){const e=n.Zb();n.Yb(0,"div",37),n.Yb(1,"uxt-checkbox",38),n.hc("isActiveChange",(function(i){return n.Kc(e),t.$implicit.selected=i}))("isActiveChange",(function(){return n.Kc(e),n.lc(3).toggleCheckbox()})),n.Xb(),n.Tb(2,"sda-object-icon",39),n.Yb(3,"div"),n.Yb(4,"div",32),n.hc("click",(function(){n.Kc(e);const i=t.$implicit;return n.lc(3).handleItemPress(i.object)})),n.Uc(5),n.Xb(),n.Yb(6,"div",33),n.Uc(7),n.Xb(),n.Yb(8,"div",33),n.Uc(9),n.Xb(),n.Xb(),n.Xb()}if(2&e){const e=t.$implicit,i=n.lc(3);n.Eb(1),n.sc("isActive",e.selected),n.Eb(1),n.sc("imageName",e.object.icon),n.Eb(2),n.Ib("rel-builder-pinned-item__item__name--disabled",!i.enableDetailSelection),n.Eb(1),n.Wc(" ",e.object.name," "),n.Eb(2),n.Vc(e.object.displayAs),n.Eb(2),n.Vc(e.object.configName)}}function se(e,t){if(1&e&&(n.Yb(0,"div",29),n.Sc(1,ne,10,7,"div",36),n.Xb()),2&e){const e=n.lc(2);n.Eb(1),n.sc("ngForOf",e.pinnedItems)}}function oe(e,t){if(1&e&&(n.Yb(0,"div",40),n.Tb(1,"sda-kendo-grid",41),n.Xb()),2&e){const e=n.lc(2);n.Eb(1),n.sc("showActions",!1)("gridId","REL_BUILDER")("odataRequest",e.odataRequest)("enableDetailsSelection",e.enableDetailSelection)("autoResize",!1)("showActionsMenuButton",e.showActionsMenuButton)("clickableURLs",!0)}}function re(e,t){1&e&&n.Tb(0,"sda-loading-indicator",45),2&e&&n.sc("centered",!0)}function ae(e,t){if(1&e){const e=n.Zb();n.Yb(0,"sda-existing-relationship-list",46),n.hc("selectedRelationshipsChange",(function(t){return n.Kc(e),n.lc(3).selectedExistingRelationships=t}))("selectedRelationshipsChange",(function(t){return n.Kc(e),n.lc(3).selectedRelationshipsChange(t)}))("terminate",(function(t){return n.Kc(e),n.lc(3).terminateRelationship(t)}))("viewDetails",(function(t){return n.Kc(e),n.lc(3).viewItemDetails(t)})),n.Xb()}if(2&e){const e=n.lc(3);n.sc("relationships",e.existingRelationships)("enableDetailSelection",e.enableDetailSelection)("selectedRelationships",e.selectedExistingRelationships)}}function ce(e,t){if(1&e&&(n.Yb(0,"p-tabPanel",23),n.Yb(1,"div",42),n.Sc(2,re,1,1,"sda-loading-indicator",43),n.Sc(3,ae,1,3,"sda-existing-relationship-list",44),n.Xb(),n.Xb()),2&e){const e=n.lc(2);n.Ib("hide",2!==e.activeTab),n.sc("header",e.EXISTING)("selected",2===e.activeTab),n.Eb(2),n.sc("ngIf",e.isLoadingExisting()),n.Eb(1),n.sc("ngIf",!e.isLoadingExisting())}}function le(e,t){if(1&e){const e=n.Zb();n.Yb(0,"div",5),n.Sc(1,ee,6,2,"div",6),n.Yb(2,"div",7),n.Yb(3,"div",8),n.Yb(4,"span",9),n.Uc(5),n.Xb(),n.Xb(),n.Yb(6,"p-tabView",10),n.hc("onChange",(function(t){return n.Kc(e),n.lc().panelChange(t.index)})),n.Yb(7,"p-tabPanel",11),n.Yb(8,"div",12),n.Yb(9,"div",13),n.hc("click",(function(){return n.Kc(e),n.lc().selectPinTab(0)})),n.Yb(10,"div",14),n.Uc(11),n.Xb(),n.Yb(12,"div",15),n.Uc(13),n.Xb(),n.Xb(),n.Yb(14,"div",13),n.hc("click",(function(){return n.Kc(e),n.lc().selectPinTab(1)})),n.Yb(15,"div",14),n.Uc(16),n.Xb(),n.Xb(),n.Xb(),n.Yb(17,"div",16),n.Yb(18,"div",17),n.Yb(19,"uxt-checkbox",18),n.hc("isActiveChange",(function(t){return n.Kc(e),n.lc().pinsSelectAll=t}))("isActiveChange",(function(){return n.Kc(e),n.lc().toggleSelectAllPins()})),n.Xb(),n.Sc(20,te,1,7,"sda-pins-group-selector",19),n.Xb(),n.Yb(21,"div",20),n.Sc(22,ie,1,2,"sda-loading-indicator",21),n.Sc(23,se,2,1,"div",22),n.Xb(),n.Xb(),n.Xb(),n.Yb(24,"p-tabPanel",23),n.Yb(25,"div",24),n.Yb(26,"sda-feature-search",25),n.hc("onSearch",(function(t){return n.Kc(e),n.lc().search(t)}))("selectedDataTypeChange",(function(t){return n.Kc(e),n.lc().selectedEntityTypeChange(t)}))("searchFocusedChange",(function(t){return n.Kc(e),n.lc().searchFocused=t})),n.Xb(),n.Xb(),n.Sc(27,oe,2,7,"div",26),n.Xb(),n.Sc(28,ce,4,6,"p-tabPanel",27),n.Xb(),n.Xb(),n.Xb()}if(2&e){const e=n.lc();n.Eb(1),n.sc("ngIf",e.showSidebar),n.Eb(4),n.Vc(e.RELATIONSHIP_ITEMS),n.Eb(2),n.Ib("hide",0!==e.activeTab),n.sc("header",e.PINS)("selected",0===e.activeTab),n.Eb(2),n.Ib("active",0===e.pinView),n.Eb(2),n.Vc(e.NEW_ITEMS),n.Eb(2),n.Vc(e.newPins.length),n.Eb(1),n.Ib("active",1===e.pinView),n.Eb(2),n.Vc(e.PINBOARD),n.Eb(3),n.sc("text",e.REL_BUILDER_SELECT_ALL)("isActive",e.pinsSelectAll)("isDisabled",e.pinnedItems.length<1),n.Eb(1),n.sc("ngIf",1===e.pinView&&e.selectedPinGroup),n.Eb(2),n.sc("ngIf",e.isLoading),n.Eb(1),n.sc("ngIf",!e.isLoading),n.Eb(1),n.Ib("hide",1!==e.activeTab),n.sc("header",e.REL_BUILDER_SEARCH)("selected",1===e.activeTab),n.Eb(2),n.sc("setIsLoading",e.isLoading)("features",e.featureSets)("filters",e.searchProperties)("displayUseIsEqualTo",!0)("searchFocused",e.searchFocused)("selectedDataType",e.selectedEntity),n.Eb(1),n.sc("ngIf",e.odataRequest),n.Eb(1),n.sc("ngIf",e.allowTerminate)}}function he(e,t){if(1&e&&n.Tb(0,"sda-relationship-error",52),2&e){const e=n.lc(3);n.sc("relDictionary",e.relationshipValidation)}}function de(e,t){if(1&e){const e=n.Zb();n.Yb(0,"uxt-modal",50),n.hc("submit",(function(){return n.Kc(e),n.lc(2).onAfterHideValidation()})),n.Sc(1,he,1,1,"sda-relationship-error",51),n.Xb()}if(2&e){const e=n.lc(2);n.sc("isOpen",e.showValidation)("titleText",e.REL_BUILDER_VALIDATION_ERRORS)("submitText",e.SUBMIT_TEXT)("showCancelButton",!1),n.Eb(1),n.sc("ngIf",e.relationshipValidation&&e.showValidation)}}function ue(e,t){if(1&e){const e=n.Zb();n.Yb(0,"sda-relationship-picker",53,54),n.hc("onFinish",(function(t){return n.Kc(e),n.lc(2).onRelPickerSuccess(t)})),n.Xb()}if(2&e){const e=n.lc(2);n.sc("relDictionary",e.validatedRelationships)}}function pe(e,t){if(1&e){const e=n.Zb();n.Yb(0,"uxt-modal",47),n.hc("cancel",(function(){return n.Kc(e),n.lc().onAfterHideConfirmation()}))("submit",(function(){return n.Kc(e),n.lc().onRelPickerConfirm()})),n.Sc(1,de,2,5,"uxt-modal",48),n.Sc(2,ue,2,1,"sda-relationship-picker",49),n.Xb()}if(2&e){const e=n.lc();n.sc("isOpen",e.showRelPicker)("titleText",e.relationshipPickerTitle)("submitText",e.SUBMIT_TEXT)("cancelText",e.CANCEL_TEXT),n.Eb(1),n.sc("ngIf",e.relationshipValidation),n.Eb(1),n.sc("ngIf",e.validatedRelationships&&e.showRelPicker)}}let be=(()=>{class e{constructor(e,t,i,s,o,r,a,c,l,h,d,u,p,b,_,g,f,m,E){this.relationshipBuilderService=e,this.crudService=t,this.actionMenuProvider=i,this.loggingService=s,this.modalService=o,this.pinsMenuService=r,this.pinsHelperService=a,this.urlFilterFactory=c,this.odataService=l,this.notificationService=h,this.sdaTranslateService=d,this.objectItemsHelperService=u,this.helpService=p,this.featureSearchProvider=b,this.exceptionService=_,this.saveChangesDialogService=g,this.featureSetService=f,this.router=m,this.loadingIndicatorService=E,this.allowTerminate=!1,this.showSidebar=!0,this.enableDetailSelection=!0,this.showActionsMenuButton=!0,this.onChangeFinishButtonText=new n.o,this.onChangeFinishButtonEnabled=new n.o,this.onChangeFinishButtonVisible=new n.o,this.onChangeFinishButtonType=new n.o,this.activeTab=0,this.showPinGroupMenu=!1,this.pinboardPins=[],this.newPins=[],this.savedPins=[],this.pinnedItems=[],this.pinView=0,this.initializationFailed=!1,this.pinsSelectAll=!1,this.relateReadyFlag=!1,this.relsRetrived=!1,this.existingRelationships=[],this.selectedExistingRelationships=[],this.searchProperties=[],this.featureSets=new Array,this.featuresRetrived=!1,this.searchFocused=!1,this.isLoading=!1,this.cardinalityActualErrorRels=[],this.conditionActualNotSatisfiedErrorRels=[],this.interfaceActualAccessErrorRels=[],this.REL_BUILDER_TITLE=this.sdaTranslateService.get("REL_BUILDER_TITLE","Relationship Builder"),this.NO_ITEMS_SELECTED=this.sdaTranslateService.get("REL_BUILDER_NO_ITEMS_SELECTED","No valid items are selected to relate"),this.RELATIONS_TERMINATION_CONFIRMATION_TITLE=this.sdaTranslateService.get("REL_BUILDER_RELATIONS_TERMINATION_CONFIRMATION_TITLE","Terminate Relationships"),this.RELATIONS_TERMINATION_CONFIRMATION_MESSAGE=this.sdaTranslateService.get("REL_BUILDER_RELATIONS_TERMINATION_CONFIRMATION_MESSAGE","Are you sure you want to terminate these relationships?"),this.RELS_ERRORS_TERMINATING_RELS=this.sdaTranslateService.get("RELS_ERRORS_TERMINATING_RELS","There were errors while attempting to terminate these relationships."),this.RELATIONS_TERMINATION_SUCCESS=this.sdaTranslateService.get("REL_BUILDER_RELATIONS_TERMINATION_SUCCESS","Relationships successfully terminated"),this.RELATION_SUCCESS=this.sdaTranslateService.get("REL_BUILDER_RELATION_SUCCESS","Relationship successfully created"),this.NO_VALID_REL_DEFS=this.sdaTranslateService.get("REL_BUILDER_NO_VALID_REL_DEFS","It was not possible to create a relationship between the objects selected. Either no relationship definition exists, a relationship condition has not been met, or cardinality issues would prevent creation."),this.TERMINATE=this.sdaTranslateService.get("TERMINATE","Terminate"),this.REL_BUILDER_VALIDATION_ERRORS=this.sdaTranslateService.get("REL_BUILDER_VALIDATION_ERRORS","Validation Errors"),this.CLOSE=this.sdaTranslateService.get("CLOSE","Close"),this.SELECTED_ITEMS=this.sdaTranslateService.get("SELECTED_ITEMS","Selected Items"),this.RELATIONSHIP_ITEMS=this.sdaTranslateService.get("RELATIONSHIP_ITEMS","Relationship Items"),this.NEW_ITEMS=this.sdaTranslateService.get("PINS_NEW_ITEMS","New Items"),this.PINBOARD=this.sdaTranslateService.get("PINS_PINBOARD","Pinboard"),this.SAVED=this.sdaTranslateService.get("PINS_SAVED","Saved"),this.RELATE=this.sdaTranslateService.get("RELATE","Relate"),this.PINS=this.sdaTranslateService.get("PINS_PINS","Pins"),this.REL_BUILDER_SEARCH=this.sdaTranslateService.get("REL_BUILDER_SEARCH","Search"),this.EXISTING=this.sdaTranslateService.get("REL_BUILDER_EXISTING","Existing"),this.REL_BUILDER_NO_ITEMS_PARAMETER=this.sdaTranslateService.get("REL_BUILDER_NO_ITEMS_PARAMETER","Required parameter 'items' is not found"),this.REL_BUILDER_SELECT_ALL=this.sdaTranslateService.get("SELECT_ALL","Select All"),this.REL_BUILDER_NO_REL_SAME_OBJS=this.sdaTranslateService.get("REL_BUILDER_NO_REL_SAME_OBJS","No valid relationships can be created if both sides of the relationship are the same object"),this.REL_BUILDER_FEATURESET_DESCRIPTION=this.sdaTranslateService.get("REL_BUILDER_FEATURESET_DESCRIPTION","Available Data Types"),this.REL_BUILDER_ERROR_TITLE=this.sdaTranslateService.get("REL_BUILDER_ERROR_TITLE","Relationships could not be created"),this.REL_BUILDER_LOADING_MESSAGE=this.sdaTranslateService.get("REL_BUILDER_LOADING_MESSAGE","Retrieving pins, please wait..."),this.SUBMIT_TEXT=this.sdaTranslateService.get("OK","OK"),this.CANCEL_TEXT=this.sdaTranslateService.get("CANCEL","Cancel"),this.OTHER_DATA_TYPES=this.sdaTranslateService.get("OTHER_DATA_TYPES","Other Data Types"),this.actionMenuProviderSubscription=this.actionMenuProvider.hasItemsSubject.subscribe(()=>this.handleReadyFlag()),this.helpService.setHandlers(y.x)}ngOnInit(){this.initRelBuilder()}ngOnChanges(e){e.selectedObjects&&!1===e.selectedObjects.isFirstChange()&&this.initRelBuilder()}ngOnDestroy(){this.newPinsSubscription&&this.newPinsSubscription.unsubscribe(),this.pinboardPinsSubscription&&this.pinboardPinsSubscription.unsubscribe(),this.actionMenuProviderSubscription&&this.actionMenuProviderSubscription.unsubscribe()}canDeactivate(){let e=Promise.resolve(!0);return(this.canTerminateMultiple()||this.relateReadyFlag)&&(e=this.saveChangesDialogService.showDialog()),e}onFinish(){this.finishButtonAction()}canTerminateMultiple(){return this.selectedExistingRelationships.length>0}isLoadingExisting(){return!!this.selectedItem&&!this.relsRetrived&&0===this.existingRelationships.length}togglePinGroupMenu(){this.showPinGroupMenu=!this.showPinGroupMenu}selectPinGroup(e){e&&setTimeout(()=>{this.selectedPinGroup=e,this.togglePinGroupMenu(),this.selectPinTab()})}selectPinTab(e=this.pinView){this.clearAllPins(),this.pinView=e,0===e?this.setPinnedItems(this.newPins):1===e?this.updatePinGroupPins():this.setPinnedItems(this.savedPins)}toggleSelectAllPins(){this.pinnedItems.forEach(e=>{e.selected=this.pinsSelectAll}),this.handleReadyFlag()}toggleCheckbox(){this.handleReadyFlag()}panelChange(e){this.activeTab=e,this.clearAllPins(),this.actionMenuProvider.clearItems(),this.fetchRelevantDataForTab(),this.handleReadyFlag(),1!==e||this.odataRequest?this.searchFocused=!1:setTimeout(()=>{this.searchFocused=!0}),this.updateControlBar()}select(e){this.selectedItem!==e&&(this.selectedItem=e,this.relsRetrived=!1,this.featuresRetrived=!1,this.fetchRelevantDataForTab(),this.handleReadyFlag())}terminateRelationship(e){this.terminate([e])}terminateSelectedExistingRelationships(){this.terminate(this.selectedExistingRelationships)}relate(){if(!this.selectedItem)return;const e=[];0===this.activeTab?(this.pinnedItems.forEach(t=>{t.selected&&t.object.obid!==this.selectedItem.obid&&e.push(t.object.obid)}),this.clearAllPins()):1===this.activeTab&&(this.actionMenuProvider.getItems().forEach(t=>{t.obid!==this.selectedItem.obid&&e.push(t.obid)}),this.actionMenuProvider.clearItems()),0===e.length?this.modalService.alert(this.REL_BUILDER_NO_REL_SAME_OBJS):this.relationshipBuilderService.getRelsForTarget(this.selectedItem.obid,e).subscribe(e=>{e&&!e.relsExist?(this.modalService.alert(this.NO_VALID_REL_DEFS),this.showValidation=!1):(this.relationshipPickerTitle=this.sdaTranslateService.getFormatted("REL_BUILDER_RELATE_ITEMS_TO-NAME","Relate items to: {0}",[this.selectedItem.name]),this.validatedRelationships=e,this.showRelPicker=!0)})}onRelPickerConfirm(){let e=[],t=[],i=[];this.relPicker.sourceObjects&&this.relPicker.sourceObjects.forEach(n=>{this.relPicker.relDictionary&&(this.relPicker.relDictionary.cardinalityError&&(this.cardinalityActualErrorRels=this.relPicker.relDictionary.cardinalityError.Rels,e=e.concat(this.relPicker.relDictionary.cardinalityError.Rels.filter(e=>n.fullRelDef.includes(e.OBID1+":"+e.OBID2)&&n.fullRelDef.includes(e.UID)))),this.relPicker.relDictionary.conditionNotSatisfied&&(this.conditionActualNotSatisfiedErrorRels=this.relPicker.relDictionary.conditionNotSatisfied.Rels,t=t.concat(this.relPicker.relDictionary.conditionNotSatisfied.Rels.filter(e=>n.fullRelDef.includes(e.OBID1+":"+e.OBID2)&&n.fullRelDef.includes(e.UID)))),this.relPicker.relDictionary.interfaceAccess&&(this.interfaceActualAccessErrorRels=this.relPicker.relDictionary.interfaceAccess.Rels,i=i.concat(this.relPicker.relDictionary.interfaceAccess.Rels.filter(e=>n.fullRelDef.includes(e.OBID1+":"+e.OBID2)&&n.fullRelDef.includes(e.UID)))))}),e.length>0||t.length>0||i.length>0?(this.relationshipValidation=this.validatedRelationships,this.relationshipValidation.cardinalityError&&(this.relationshipValidation.cardinalityError.Rels=e),this.relationshipValidation.conditionNotSatisfied&&(this.relationshipValidation.conditionNotSatisfied.Rels=t),this.relationshipValidation.interfaceAccess&&(this.relationshipValidation.interfaceAccess.Rels=i),this.showValidation=!0):this.relPicker.ok()}onRelPickerSuccess(e){this.validatedRelationships.sourceObjects.filter(e=>e.Rels&&e.Rels.length>0).length===e&&(this.notificationService.success(1===e?this.RELATION_SUCCESS:this.sdaTranslateService.getFormatted("REL_BUILDER_RELATIONS_SUCCESS-NO_RELS","{0} relationships successfully created",[e.toString()])),this.onAfterHideConfirmation()),this.fetchExistingRelationships()}onAfterHideValidation(){this.relationshipValidation=void 0,this.showValidation=!1,this.showRelPicker&&(this.relPicker&&this.relPicker.relDictionary&&this.relPicker.relDictionary.interfaceAccess&&(this.relPicker.relDictionary.interfaceAccess.Rels=this.interfaceActualAccessErrorRels),this.relPicker&&this.relPicker.relDictionary&&this.relPicker.relDictionary.conditionNotSatisfied&&(this.relPicker.relDictionary.conditionNotSatisfied.Rels=this.conditionActualNotSatisfiedErrorRels),this.relPicker&&this.relPicker.relDictionary&&this.relPicker.relDictionary.cardinalityError&&(this.relPicker.relDictionary.cardinalityError.Rels=this.cardinalityActualErrorRels))}onAfterHideConfirmation(){this.validatedRelationships=void 0,this.showRelPicker=!1}search(e){const t=this.featureSearchProvider.featureSearchToOdataSettings(e);t.config={value:this.configKey,key:this.configKey},this.securityRuleDefinition&&(t.securityRuleDefinition=this.securityRuleDefinition),this.odataRequest=t}handleItemPress(e){this.enableDetailSelection&&this.pinsMenuService.viewPinItemDetails(Object.assign({},e))}viewItemDetails(e){if(this.enableDetailSelection){const t=this.urlFilterFactory.createLinkFilterSettings(e);t.resolveDocumentsToVersion=!1;const i=JSON.stringify(t),n=JSON.stringify([this.configKey]);this.router.navigate(["/objects",{queryFilter:i,config:n},"detail",e])}}selectedEntityTypeChange(e){e?(this.selectedEntity=e,this.searchProperties=this.featureSearchProvider.getSearchPropertiesDefaultName(e.id)):(this.searchProperties=[],this.selectedEntity=void 0)}selectedRelationshipsChange(e){this.onChangeFinishButtonEnabled.emit(this.canTerminateMultiple())}initRelBuilder(){this.selectedPinGroup||(this.selectedPinGroup=this.pinsMenuService.selectedPinGroupObid),this.selectedObjects&&0!==this.selectedObjects.length?(this.fixObjectItems(this.selectedObjects),this.newPinsSubscription&&this.newPinsSubscription.unsubscribe(),this.pinboardPinsSubscription&&this.pinboardPinsSubscription.unsubscribe(),this.newPinsSubscription=this.pinsMenuService.newItemPinsChanges$.subscribe(e=>{this.newPins=e,0===this.pinView&&this.selectPinTab()}),this.pinboardPinsSubscription=this.pinsMenuService.selectedPinGroupPinsChanges$.subscribe(()=>{this.selectedPinGroup===this.pinsMenuService.selectedPinGroupObid&&1===this.pinView&&this.selectPinTab()})):this.initializationFailed=!0,this.pinsMenuService.refreshPinGroupsAndPins(),this.updateControlBar()}updateControlBar(){2===this.activeTab?(this.onChangeFinishButtonVisible.emit(this.allowTerminate),this.onChangeFinishButtonType.emit(h.a.Destroy),this.onChangeFinishButtonText.emit(this.TERMINATE),this.onChangeFinishButtonEnabled.emit(this.canTerminateMultiple()),this.finishButtonAction=()=>{this.terminateSelectedExistingRelationships()}):(this.onChangeFinishButtonVisible.emit(!0),this.onChangeFinishButtonType.emit(h.a.Primary),this.onChangeFinishButtonText.emit(this.RELATE),this.onChangeFinishButtonEnabled.emit(this.relateReadyFlag),this.finishButtonAction=()=>{this.relate()})}handleReadyFlag(){if(this.selectedItem){if(0===this.activeTab&&(this.relateReadyFlag=this.pinnedItems.length>0&&this.pinnedItems.some(e=>!(!e.selected||e.object.obid===this.selectedItem.obid))),1===this.activeTab){const e=this.actionMenuProvider.getItems();this.relateReadyFlag=e.length>0}}else this.relateReadyFlag=!1;this.onChangeFinishButtonEnabled.emit(this.relateReadyFlag),this.pinsSelectAll=this.pinnedItems.every(e=>e.selected)}updatePinGroupPins(){this.selectedPinGroup&&(this.isLoading=!0,this.pinsMenuService.getSpecificGroupPins(this.selectedPinGroup,!1).pipe(Object(c.a)(1)).subscribe(e=>{this.pinboardPins=this.pinsHelperService.filterPinsByConfigFamily(e),this.setPinnedItems(this.pinboardPins),this.isLoading=!1}))}setPinnedItems(e){this.pinnedItems=e.map(e=>new L(e)),this.handleReadyFlag()}clearAllPins(){this.pinsSelectAll=!1,this.toggleSelectAllPins()}fetchExistingRelationships(){this.existingRelationships=[],this.selectedExistingRelationships=[],this.relsRetrived=!1,this.isLoading=!0,this.odataService.get(`GetAvailableRelsFromObject(SourceOBID='${this.selectedItem.obid}')`).pipe(Object(c.a)(1)).subscribe(e=>{var t,i,n;this.relsRetrived=!0,this.isLoading=!1,this.existingRelationships=(i=["roleDisplayName","otherItemName"],null==(t=this.getExistingRelationshipsFromMaintenanceDetails(e.value))?[]:(Object(o.a)(i)||(i=null==i?[]:[i]),n=n,Object(o.a)(n)||(n=null==n?[]:[n]),Object(s.a)(t,i,n)))})}getExistingRelationshipsFromMaintenanceDetails(e){return e.Rels.map(t=>{const i=Object(r.a)(e.SourceObjectOBIDs,t.OBID1),n=i?t.OBID2:t.OBID1,s=i?t.OBID1:t.OBID2,o=e.Objects.find(e=>e.OBID===n);return{canTerminate:t.CanTerminate,defUID:t.DefUID,otherItemName:o.Name,roleDisplayName:t.RoleDisplayName,directionIs12:i,otherItemOBID:n,sourceItemOBID:s}})}terminate(e){this.modalService.confirm(this.RELATIONS_TERMINATION_CONFIRMATION_TITLE,this.RELATIONS_TERMINATION_CONFIRMATION_MESSAGE).then(t=>{if(!t)return;const i=e.filter(e=>e.canTerminate);Object(a.a)(i.map(e=>this.crudService.unrelate(e.sourceItemOBID,e.otherItemOBID,e.defUID,e.directionIs12,!0))).subscribe(()=>{this.fetchExistingRelationships(),this.selectedRelationshipsChange(void 0),this.notificationService.success(this.RELATIONS_TERMINATION_SUCCESS)},e=>{const t=new u.a(e,this.RELS_ERRORS_TERMINATING_RELS);this.loggingService.error(t),this.exceptionService.handleException(t)})})}fixObjectItems(e){this.loadingIndicatorService.showLoadingOverlay(),this.objectItemsHelperService.getCompleteObjects(e).pipe(Object(c.a)(1)).subscribe(e=>{this.items=e,this.items&&(this.select(this.items[0]),this.configKey=this.items[0].config),this.loadingIndicatorService.hideLoadingOverlay()},e=>{this.exceptionService.handleException(e),this.loadingIndicatorService.hideLoadingOverlay()})}fetchRelevantDataForTab(){1===this.activeTab&&(this.featuresRetrived||this.fetchRelevantEntryPoints()),2===this.activeTab&&(this.relsRetrived||this.fetchExistingRelationships())}fetchRelevantEntryPoints(){const e=`GetEntryPointsRelevantForSelectedObject(SourceOBID='${this.selectedItem.obid}')`;this.isLoading=!0,this.odataService.get(e).pipe(Object(c.a)(1)).subscribe(e=>{const t=new b.a(e.value.Name,this.REL_BUILDER_FEATURESET_DESCRIPTION,e.value.ImageUrl),i=this.getEntryPointDetails(e.value);this.getFeatureSetsOftheObject(t,i);let n=!0;this.featureSets.forEach(e=>{this.selectedEntity&&e.id===this.selectedEntity.id&&n&&(n=!1)}),n&&this.clearEntityAndGrid(),this.featuresRetrived=!0,this.isLoading=!1},e=>{this.isLoading=!1,this.exceptionService.handleException(e)})}clearEntityAndGrid(){this.odataRequest=void 0,this.selectedEntityTypeChange(void 0),this.actionMenuProvider.clearItems()}getFeatureSetsOftheObject(e,t){this.featureSets=new Array,t.forEach(t=>{if(e){const e=new x.b(C.a.replaceSpace(t.setName),t.displayName,0,t.parentFeatureSetName,t.parentFeatureSetDisplayName);e.peekCount=t.peekCount,e.equalToSearchByDefault=!!t.equalToSearchByDefault&&t.equalToSearchByDefault,this.featureSets.push(e)}})}getEntryPointDetails(e){return e.EntryPoints.map(e=>{const t={orderValue:e.OrderValue,displayName:e.DisplayName,name:e.Name,setName:e.SetName,hideFromHomePage:e.HideFromHomePage,hideFromSearch:e.HideFromList,parentFeatureSetName:e.ParentFeatureSetName,parentFeatureSetDisplayName:e.ParentFeatureSetDisplayName,redirectToSearch:e.RedirectToSearch,equalToSearchByDefault:e.EqualTo,peekCount:e.PeekSearch};return"SDAFSEverythingElse"===t.parentFeatureSetName&&(t.parentFeatureSetDisplayName=this.OTHER_DATA_TYPES),t})}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(M.a),n.Sb(d.a),n.Sb(l.a),n.Sb(I.a),n.Sb(f.a),n.Sb(E.a),n.Sb(m.a),n.Sb(D.a),n.Sb(T.a),n.Sb(w.a),n.Sb(P.a),n.Sb(O.a),n.Sb(v.a),n.Sb(R.a),n.Sb(p.a),n.Sb(S.a),n.Sb(_.a),n.Sb(N.g),n.Sb(g.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-relationship-builder"]],viewQuery:function(e,t){var i;1&e&&n.bd($,!0),2&e&&n.Gc(i=n.ic())&&(t.relPicker=i.first)},inputs:{allowTerminate:"allowTerminate",securityRuleDefinition:"securityRuleDefinition",selectedObjects:"selectedObjects",showSidebar:"showSidebar",enableDetailSelection:"enableDetailSelection",showActionsMenuButton:"showActionsMenuButton"},outputs:{onChangeFinishButtonText:"onChangeFinishButtonText",onChangeFinishButtonEnabled:"onChangeFinishButtonEnabled",onChangeFinishButtonVisible:"onChangeFinishButtonVisible",onChangeFinishButtonType:"onChangeFinishButtonType"},features:[n.Db([O.a]),n.Cb],decls:4,vars:3,consts:[[1,"relationship-builder__container"],["class","relationship-builder__column error",4,"ngIf"],["class","relationship-builder__columns",4,"ngIf"],[3,"isOpen","titleText","submitText","cancelText","cancel","submit",4,"ngIf"],[1,"relationship-builder__column","error"],[1,"relationship-builder__columns"],["class","relationship-builder__column objects-column",4,"ngIf"],[1,"relationship-builder__column"],[1,"target__heading"],[1,"target__heading__text"],[1,"relationship-builder__tabs",3,"onChange"],[1,"rel-pins-container",3,"header","selected"],[1,"pin-header-container"],[1,"pin-tab-header",3,"click"],[1,"pin-tab-title"],[1,"pin-badge"],[1,"pins-container"],[1,"pins-container__header"],[3,"text","isActive","isDisabled","isActiveChange"],[3,"pinToGroupMode","hideIcon","showCreateListButton","configFilterOverride","selectedGroup","syncSelectedGroupWithMenu","fixedWidth","selectedGroupChanged",4,"ngIf"],[1,"rel-builder-pinned-item__wrapper"],[3,"centered","message",4,"ngIf"],["class","rel-builder-pinned-item",4,"ngIf"],[1,"rel-search-container",3,"header","selected"],[1,"horizontal-gutter"],[3,"setIsLoading","features","filters","displayUseIsEqualTo","searchFocused","selectedDataType","onSearch","selectedDataTypeChange","searchFocusedChange"],["class","rel-grid-container",4,"ngIf"],["class","rel-search-container",3,"header","hide","selected",4,"ngIf"],[1,"relationship-builder__column","objects-column"],[1,"rel-builder-pinned-item"],["class","rel-builder-pinned-item__item",3,"active","click",4,"ngFor","ngForOf"],[1,"rel-builder-pinned-item__item",3,"click"],[1,"rel-builder-pinned-item__item__name",3,"click"],[1,"rel-builder-pinned-item__item__description"],[3,"pinToGroupMode","hideIcon","showCreateListButton","configFilterOverride","selectedGroup","syncSelectedGroupWithMenu","fixedWidth","selectedGroupChanged"],[3,"centered","message"],["class","rel-builder-pinned-item__item",4,"ngFor","ngForOf"],[1,"rel-builder-pinned-item__item"],[3,"isActive","isActiveChange"],[3,"imageName"],[1,"rel-grid-container"],[3,"showActions","gridId","odataRequest","enableDetailsSelection","autoResize","showActionsMenuButton","clickableURLs"],[1,"rel-existing-container"],[3,"centered",4,"ngIf"],[3,"relationships","enableDetailSelection","selectedRelationships","selectedRelationshipsChange","terminate","viewDetails",4,"ngIf"],[3,"centered"],[3,"relationships","enableDetailSelection","selectedRelationships","selectedRelationshipsChange","terminate","viewDetails"],[3,"isOpen","titleText","submitText","cancelText","cancel","submit"],[3,"isOpen","titleText","submitText","showCancelButton","submit",4,"ngIf"],[3,"relDictionary","onFinish",4,"ngIf"],[3,"isOpen","titleText","submitText","showCancelButton","submit"],[3,"relDictionary",4,"ngIf"],[3,"relDictionary"],[3,"relDictionary","onFinish"],["relPicker",""]],template:function(e,t){1&e&&(n.Yb(0,"div",0),n.Sc(1,J,2,1,"div",1),n.Sc(2,le,29,31,"div",2),n.Sc(3,pe,3,6,"uxt-modal",3),n.Xb()),2&e&&(n.Eb(1),n.sc("ngIf",t.initializationFailed),n.Eb(1),n.sc("ngIf",!t.initializationFailed),n.Eb(1),n.sc("ngIf",t.validatedRelationships))},directives:[k.t,B.b,B.a,F.a,j.a,k.s,U.a,X.a,Y.a,G.a,H,W.a,Z.a,A.a],styles:["[_nghost-%COMP%]     .pins-container, [_nghost-%COMP%]     .rel-builder-pinned-item, [_nghost-%COMP%]     .rel-pins-container, [_nghost-%COMP%]     .rel-search-container{overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]     .rel-builder-pinned-item__item__description, [_nghost-%COMP%]     .rel-builder-pinned-item__item__name{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}[_nghost-%COMP%]{display:flex;flex-grow:1;flex-direction:column;height:100%;font-size:14px;overflow:hidden}[_nghost-%COMP%]   sda-pins-group-selector[_ngcontent-%COMP%]     .quick-select-toggle{max-width:150px}@media screen and (min-width:1200px){[_nghost-%COMP%]   sda-pins-group-selector[_ngcontent-%COMP%]     .quick-select-toggle{max-width:230px}}[_nghost-%COMP%]     .uxt-modal{z-index:1200!important}[_nghost-%COMP%]     .error{padding:20px}[_nghost-%COMP%]     .horizontal-gutter{padding:10px}[_nghost-%COMP%]     .horizontal-gutter__button{color:#fff;background-color:#02adff;margin-left:auto}[_nghost-%COMP%]     .horizontal-gutter__button:hover{background-color:#3cc0ff}[_nghost-%COMP%]     .horizontal-gutter__button:active{background-color:#0087c8}[_nghost-%COMP%]     .horizontal-gutter__button:disabled{background-color:#a9b4be;cursor:no-drop}[_nghost-%COMP%]     .target{border-bottom:1px solid #ccc;cursor:pointer}[_nghost-%COMP%]     .target__heading{background-color:#afe5ff;padding:13px 16px}[_nghost-%COMP%]     .ui-tabview, [_nghost-%COMP%]     .ui-tabview-panels{position:relative;display:flex;flex:1;flex-direction:column;overflow:hidden}[_nghost-%COMP%]     .ui-tabview-panel{display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]     .rel-pins-container, [_nghost-%COMP%]     .rel-search-container{height:100%}[_nghost-%COMP%]     .rel-grid-container{position:absolute;top:60px;left:0;right:0;bottom:0;display:flex;flex:1;overflow:hidden}[_nghost-%COMP%]     .rel-existing-container{display:flex;flex:1 1 100%;overflow:hidden}[_nghost-%COMP%]     .pins-container{display:flex;flex-grow:1;flex-shrink:1;flex-direction:column}[_nghost-%COMP%]     .pins-container__header{display:flex;align-items:center;flex-shrink:0;height:60px;padding-right:8px;padding-left:8px;border-bottom:1px solid #cad0d7;background-color:#ebedf0;cursor:default}[_nghost-%COMP%]     .pins-container__header .uxt-checkbox{flex-grow:1}[_nghost-%COMP%]     .pins-container .rel-builder-pinned-item__item:hover{background-color:#ebedf0}[_nghost-%COMP%]     .rel-builder-pinned-item{display:flex;flex-shrink:1;flex-grow:1;flex-direction:column;cursor:default}[_nghost-%COMP%]     .rel-builder-pinned-item__wrapper{display:flex;flex-grow:1;flex-shrink:1;flex-direction:column;overflow:hidden}[_nghost-%COMP%]     .rel-builder-pinned-item__item{display:flex;flex-shrink:0;align-items:center;height:60px;padding-right:8px;padding-left:8px;border-bottom:1px solid #cad0d7;cursor:pointer}[_nghost-%COMP%]     .rel-builder-pinned-item__item__name{display:flex;color:#0087c8;font-size:1em;font-weight:500;line-height:16px;margin-left:8px;cursor:pointer}[_nghost-%COMP%]     .rel-builder-pinned-item__item__name:not(.rel-builder-pinned-item__item__name--disabled):hover{text-decoration:underline}[_nghost-%COMP%]     .rel-builder-pinned-item__item__name--disabled{color:#333}[_nghost-%COMP%]     .rel-builder-pinned-item__item__description{display:flex;color:#515e6b;font-size:.875em;margin-left:8px}[_nghost-%COMP%]     .rel-builder-pinned-item__item:hover{background-color:#cad0d7}[_nghost-%COMP%]     .rel-builder-pinned-item__item.active{background-color:#0087c8}[_nghost-%COMP%]     .rel-builder-pinned-item__item.active .rel-builder-pinned-item__item__name{color:#fff}[_nghost-%COMP%]     .rel-builder-pinned-item__item.active .rel-builder-pinned-item__item__description{color:#ebedf0}[_nghost-%COMP%]     .pin-header-container{display:flex;flex-shrink:0;border-bottom:1px solid #cad0d7}[_nghost-%COMP%]     .pin-tab-header{display:flex;align-items:center;min-width:120px;height:48px;padding-right:8px;padding-left:8px;border-right:1px solid #cad0d7;border-bottom:none;cursor:pointer}[_nghost-%COMP%]     .pin-tab-header:hover{background-color:#ebedf0}[_nghost-%COMP%]     .pin-tab-header.active{background-color:#efefef}[_nghost-%COMP%]     .pin-badge{display:flex;align-items:center;justify-content:center;height:20px;margin-left:auto;padding-right:6px;padding-left:6px;background-color:#cad0d7;border-radius:12px;font-size:.875em}[_nghost-%COMP%]     .relationship-builder__container{display:flex;flex:1;flex-direction:column;overflow:hidden}[_nghost-%COMP%]     .relationship-builder__columns{display:flex;flex:1;min-height:0}[_nghost-%COMP%]     .relationship-builder__column{position:relative;display:flex;flex:3;flex-direction:column;border-top:1px solid #ccc;overflow:hidden;background-color:#ebedf0}[_nghost-%COMP%]     .relationship-builder__column:first-child{border-right:1px solid #ccc}[_nghost-%COMP%]     .relationship-builder__column.objects-column{flex:1;min-width:250px}[_nghost-%COMP%]     .relationship-builder__tabs{display:flex;flex:1;flex-direction:column;overflow:hidden}[_nghost-%COMP%]     .relationship-builder__top{padding-left:10px}"]}),e})()},yzqN:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return o})),i.d(t,"e",(function(){return r})),i.d(t,"f",(function(){return a})),i.d(t,"g",(function(){return c})),i.d(t,"h",(function(){return l})),i.d(t,"k",(function(){return h})),i.d(t,"i",(function(){return d})),i.d(t,"j",(function(){return u})),i.d(t,"m",(function(){return p})),i.d(t,"o",(function(){return b})),i.d(t,"p",(function(){return _})),i.d(t,"r",(function(){return g})),i.d(t,"s",(function(){return f})),i.d(t,"t",(function(){return m})),i.d(t,"u",(function(){return E})),i.d(t,"v",(function(){return S})),i.d(t,"w",(function(){return x})),i.d(t,"x",(function(){return R})),i.d(t,"y",(function(){return v})),i.d(t,"z",(function(){return I})),i.d(t,"A",(function(){return O})),i.d(t,"B",(function(){return T})),i.d(t,"C",(function(){return P})),i.d(t,"E",(function(){return C})),i.d(t,"F",(function(){return D})),i.d(t,"q",(function(){return w})),i.d(t,"D",(function(){return y})),i.d(t,"n",(function(){return L})),i.d(t,"d",(function(){return M})),i.d(t,"l",(function(){return A}));const n="787103",s="820826",o="825969",r="858646",a="858646",c="858646",l="858646",h="858646",d="858646",u="858646",p="791026",b="858646",_="817611",g="787103",f="794537",m="824313",E="791026",S="926854",x="939623",R="816118",v="791870",I="812357",O="794563",T="939623",P="791037",C="820826",D="817611",w="865948",y="987283",L="1016694",M="1028155",A="1125484"},zFBM:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var n=i("fXoL"),s=i("LRne"),o=i("Z9D8"),r=i("HLw3"),a=i("tCxB"),c=i("Ejbi"),l=(i("mOod"),function(e){return e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Success=2]="Success",e[e.Error=3]="Error",e}({}));class h{constructor(e,t){if(this.obid=e,this.object=t,this.status=l.None,t.Rels.length&&t.Rels.length>0){const e=t.Rels[0];this.relDef=e.OBID+e.Direction,this.fullRelDef=e.Name+":"+e.Direction+":"+e.OBID1+":"+e.OBID2}else this.relDef="",this.fullRelDef=""}updateRelDef(e){this.relDef=e;const t=e.substr(e.length-1,1),i=e.substr(0,e.length-1);this.object.Rels.some(e=>e.OBID===i&&e.Direction===t&&(this.fullRelDef=e.Name+":"+e.Direction+":"+e.OBID1+":"+e.OBID2,!0))}}var d=i("ofXK"),u=i("6sHd"),p=i("3Pt+"),b=i("TLn4"),_=i("NFeN");function g(e,t){if(1&e){const e=n.Zb();n.Yb(0,"div",7),n.Yb(1,"uxt-checkbox",8),n.hc("isActiveChange",(function(t){return n.Kc(e),n.lc(2).useSharedRel=t})),n.Xb(),n.Xb()}if(2&e){const e=n.lc(2);n.Eb(1),n.sc("isActive",e.useSharedRel)("text",e.USE_SAME_RELS)}}function f(e,t){if(1&e&&(n.Yb(0,"option",20),n.Uc(1),n.Xb()),2&e){const e=t.$implicit,i=n.lc(2).$implicit;n.sc("value",e.OBID+e.Direction)("selected",e.OBID===i.relDef),n.Eb(1),n.Wc(" ",e.DisplayAs," ")}}function m(e,t){if(1&e){const e=n.Zb();n.Yb(0,"select",18),n.hc("change",(function(t){n.Kc(e);const i=n.lc().$implicit;return n.lc(3).newSelected(i,t.target.value)})),n.Sc(1,f,2,3,"option",19),n.Xb()}if(2&e){const e=n.lc().$implicit,t=n.lc(3);n.sc("disabled",t.disableSelection&&t.useSharedRel||e.object.Rels&&1===e.object.Rels.length)("ngModel",e.relDef),n.Eb(1),n.sc("ngForOf",e.object.Rels)}}function E(e,t){1&e&&n.Tb(0,"sda-loading-indicator",21),2&e&&n.sc("size",20)}function S(e,t){1&e&&n.Tb(0,"mat-icon",22)}function x(e,t){if(1&e&&(n.Yb(0,"div",23),n.Tb(1,"mat-icon",24),n.Uc(2),n.Xb()),2&e){const e=n.lc().$implicit;n.Eb(2),n.Wc(" ",e.error," ")}}function R(e,t){if(1&e&&(n.Yb(0,"div",11),n.Yb(1,"div",12),n.Yb(2,"div",13),n.Uc(3),n.Xb(),n.Sc(4,m,2,3,"select",14),n.Sc(5,E,1,1,"sda-loading-indicator",15),n.Sc(6,S,1,0,"mat-icon",16),n.Sc(7,x,3,1,"div",17),n.Xb(),n.Xb()),2&e){const e=t.$implicit;n.Eb(1),n.Ib("picker-row--none",0===e.status)("picker-row--pending",1===e.status)("picker-row--success",2===e.status)("picker-row--error",3===e.status),n.Eb(1),n.sc("title",e.object.Name),n.Eb(1),n.Vc(e.object.Name),n.Eb(1),n.sc("ngIf",e.relDef),n.Eb(1),n.sc("ngIf",1===e.status),n.Eb(1),n.sc("ngIf",2===e.status),n.Eb(1),n.sc("ngIf",3===e.status)}}function v(e,t){if(1&e&&(n.Yb(0,"div",9),n.Sc(1,R,8,14,"div",10),n.Xb()),2&e){const e=n.lc(2);n.Eb(1),n.sc("ngForOf",e.sourceObjects)}}function I(e,t){if(1&e&&(n.Yb(0,"div",2),n.Sc(1,g,2,2,"div",3),n.Yb(2,"div",4),n.Yb(3,"div",5),n.Uc(4),n.Xb(),n.Yb(5,"div",5),n.Uc(6),n.Xb(),n.Xb(),n.Sc(7,v,2,1,"div",6),n.Xb()),2&e){const e=n.lc();n.Eb(1),n.sc("ngIf",e.sourceObjects.length>1),n.Eb(3),n.Vc(e.SELECTED_ITEMS),n.Eb(2),n.Vc(e.AVAILABLE_RELATIONSHIPS),n.Eb(1),n.sc("ngIf",e.sourceObjects)}}function O(e,t){if(1&e&&(n.Yb(0,"div",25),n.Uc(1),n.Xb()),2&e){const e=n.lc();n.Eb(1),n.Wc(" ",e.message,"\n")}}let T=(()=>{class e{constructor(e,t,i){this.loggingSvc=e,this.translateSvc=t,this.batchRequestFactory=i,this.onFinish=new n.o,this.sharedRelDefs=[],this.useSharedRel=!0,this.initialized=!1,this.disableSelection=!1,this.SELECTED_ITEMS=this.translateSvc.get("REL_PICKER_SELECTED_ITEMS","Selected Items"),this.AVAILABLE_RELATIONSHIPS=this.translateSvc.get("REL_PICKER_AVAILABLE_RELS","Available Relationships"),this.NO_REL_SELECTED=this.translateSvc.get("REL_PICKER_NO_REL_SELECTED","No relationship definition selected for this item"),this.USE_SAME_RELS=this.translateSvc.get("REL_PICKER_USE_SAME_RELS","Apply to similar items"),this.RELS_ERRORS_CREATING_RELS=this.translateSvc.get("RELS_ERRORS_CREATING_RELS","There were errors while attempting to create these relationships")}ngOnInit(){this.serialize(this.relDictionary)}newSelected(e,t){this.useSharedRel?this.sourceObjects.forEach(e=>{e.updateRelDef(t)}):e.updateRelDef(t)}ok(){this.buildbatchRequestService().subscribe(e=>{let t=0;e.forEach(e=>{if(e.statusCode){let i;(e.statusCode<200||e.statusCode>=300)&&(i=e.data&&e.data.error&&e.data.error.innererror&&e.data.error.innererror.message?e.data.error.innererror.message:e.exception.message);const n=this.sourceObjects[t];if(n.status=i?l.Error:l.Success,i){n.error=i;const e=new o.a(i);this.loggingSvc.error(e)}t+=1}});const i=this.sourceObjects.filter(e=>e.status===l.Success).length;0===i?this.message=this.RELS_ERRORS_CREATING_RELS:this.onFinish.emit(i)},e=>{this.message=e.message,this.loggingSvc.error(e)})}serialize(e){let t;this.sourceObjects=[];const i=Object.keys(e.sharedRelDefs);i.length>0?(1===i.length&&(this.disableSelection=!0),t=e.sharedRelDefs[i[0]]):this.useSharedRel=!1,e.sourceObjects.forEach(e=>{const i=new h(e.OBID,e);e.Rels.length>0?t&&i.updateRelDef(t.OBID+t.Direction):(i.error=this.translateSvc.get("REL_PICKER_NO_REL_AVAILABLE","No relationships available, item will not be related."),i.status=l.Error),this.sourceObjects.push(i)}),this.initialized=!0}buildbatchRequestService(){const e=this.batchRequestFactory.createBatchRequest();let t=!1;return this.sourceObjects.forEach(i=>{if(i.fullRelDef){i.status=l.Pending;const n=i.fullRelDef.split(":"),s=e.createChangeset();s.addRelateRequest(n[2],n[3],n[0],!0),e.addChangeset(s),t=!0}else i.status===l.Error&&i.error||(i.status=l.Error,i.error=this.NO_REL_SELECTED)}),t?e.execute():Object(s.a)([])}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(a.a),n.Sb(c.a),n.Sb(r.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["sda-relationship-picker"]],inputs:{relDictionary:"relDictionary"},outputs:{onFinish:"onFinish"},decls:2,vars:2,consts:[["class","rel-picker",4,"ngIf"],["class","picker-message",4,"ngIf"],[1,"rel-picker"],["class","picker-checkbox",4,"ngIf"],[1,"picker-heading"],[1,"picker-heading__title"],["class","picker-list",4,"ngIf"],[1,"picker-checkbox"],[3,"isActive","text","isActiveChange"],[1,"picker-list"],["class","picker-list__item",4,"ngFor","ngForOf"],[1,"picker-list__item"],[1,"picker-row"],[1,"picker-row__title",3,"title"],["class","picker-row__select",3,"disabled","ngModel","change",4,"ngIf"],[3,"size",4,"ngIf"],["class","picker-row__icon","svgIcon","check",4,"ngIf"],["class","picker-error",4,"ngIf"],[1,"picker-row__select",3,"disabled","ngModel","change"],[3,"value","selected",4,"ngFor","ngForOf"],[3,"value","selected"],[3,"size"],["svgIcon","check",1,"picker-row__icon"],[1,"picker-error"],["svgIcon","error",1,"picker-error__icon"],[1,"picker-message"]],template:function(e,t){1&e&&(n.Sc(0,I,8,4,"div",0),n.Sc(1,O,2,1,"div",1)),2&e&&(n.sc("ngIf",t.initialized),n.Eb(1),n.sc("ngIf",(null==t.message?null:t.message.length)>0))},directives:[d.t,u.a,d.s,p.B,p.p,p.s,p.u,p.E,b.a,_.a],styles:[".picker-list[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto}.picker-row__title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.rel-picker[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex}.rel-picker[_ngcontent-%COMP%]{flex-direction:column;margin:0 auto}.rel-picker[_ngcontent-%COMP%]   .uxt-checkbox[_ngcontent-%COMP%]{height:20px;margin-bottom:10px}.picker-checkbox[_ngcontent-%COMP%]{padding:6px}.picker-heading[_ngcontent-%COMP%]{display:flex;flex:0 0 auto;margin-bottom:10px;border-bottom:1px solid #cad0d7}.picker-heading__title[_ngcontent-%COMP%]{width:250px;padding:6px;font-size:16px}.picker-list[_ngcontent-%COMP%]{flex:1 1 auto;min-height:40px;max-height:240px}@media screen and (max-height:510px){.picker-list[_ngcontent-%COMP%]{max-height:120px}}.picker-list__item[_ngcontent-%COMP%]:nth-child(2n){background:rgba(0,0,0,.04)}.picker-row[_ngcontent-%COMP%]{display:flex;min-width:420px;min-height:40px;align-items:center}.picker-row--pending[_ngcontent-%COMP%]   sda-loading-indicator[_ngcontent-%COMP%]{margin-left:12px}.picker-row--success[_ngcontent-%COMP%]   .picker-row__icon[_ngcontent-%COMP%]{color:#3e732a}.picker-row__title[_ngcontent-%COMP%]{width:250px;min-width:250px}.picker-row__title[_ngcontent-%COMP%]:first-child{padding:6px}.picker-row__select[_ngcontent-%COMP%]{flex:1;max-width:165px;height:32px;border-radius:2px;margin-left:6px}.picker-error[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:#fcefc7;border:1px solid #d1a00c;margin:0 6px;padding:6px}.picker-error__icon[_ngcontent-%COMP%]{min-width:24px;color:#f2bf25;margin-right:6px}.picker-message[_ngcontent-%COMP%]{padding:6px}"]}),e})()}}]);