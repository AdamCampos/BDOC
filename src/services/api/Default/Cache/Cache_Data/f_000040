(window.webpackJsonp=window.webpackJsonp||[]).push([[93],{"+T9e":function(e,t,i){"use strict";i.d(t,"a",(function(){return I}));var a=i("mrSG"),s=i("IzEk"),n=i("ONOH"),o=i("Z9D8"),r=i("LUpO"),l=i("PoZZ"),c=i("d74k"),d=i("Ejbi"),h=i("W5cs"),p=i("gBNM"),f=i("UVhF"),u=i("zewe"),m=i("fXoL"),b=i("ofXK"),g=i("TLn4"),S=i("qx4N"),T=i("+qkj");function E(e,t){if(1&e&&m.Tb(0,"sda-loading-indicator",3),2&e){const e=m.lc();m.sc("message",e.OBJECT_DETAILS_LOADING)("centered",!0)}}function O(e,t){if(1&e&&(m.Yb(0,"div",4),m.Tb(1,"sda-form-controls",5),m.Xb()),2&e){const e=m.lc();m.Ib("object-details--fixed-height",e.relatedItemTabs.length>0),m.Eb(1),m.sc("form",e.form)("isEditable",!1)}}function v(e,t){if(1&e&&m.Tb(0,"sda-related-items-section",6),2&e){const e=m.lc();m.sc("tabs",e.relatedItemTabs)}}let I=(()=>{class e{constructor(e,t,i,a,s,n,o){this.formService=e,this.exceptionService=t,this.filterService=i,this.objectDetailsService=a,this.sdaTranslateService=s,this.changeDetection=n,this.configService=o,this.relatedItemTabs=[],this.initialized=!1,this.OBJECT_DETAILS_LOADING=this.sdaTranslateService.get("OBJECT_DETAILS_LOADING","Loading object details, please wait..."),this.OBJECT_DETAILS_ERROR=this.sdaTranslateService.get("INITIALISATION_ERROR","An error occurred whilst initializing"),this.showTodoListForm=!1}ngOnChanges(){this.getFormSubscription&&this.getFormSubscription.unsubscribe(),this.buildForm()}ngOnDestroy(){this.getFormSubscription&&this.getFormSubscription.unsubscribe()}buildForm(){try{this.id&&this.config&&(this.initialized=!1,this.getFormSubscription=this.formService.getForm(this.id,this.config,this.methodOBID,this.showTodoListForm).pipe(Object(s.a)(1)).subscribe(e=>{this.relatedItemTabs=[];const t=this.formService.filterDisplayItemsByDisplayType(e,"RelationshipMaintenance"),{filteredItems:i=[]}=t,s=Object(a.a)(t,["filteredItems"]);this.form=s,this.generateGridTabs(i),this.initialized=!0,this.changeDetection.detectChanges()}))}catch(e){const t=new o.a(e,this.OBJECT_DETAILS_ERROR,"ObjectDetailsComponent","buildForm");this.exceptionService.handleException(t)}}generateGridTabs(e){e.forEach(e=>{const t=e.navigation?new p.a(e.name,`Objects('${e.obid}')/${e.navigation}?$count=true`,this.config,void 0,e.obid,e.navigation):new p.a(e.name,void 0,this.config);t.isRowSelectable=!0,t.config=this.config,t.onCellClicked=e=>this.routeToDetailsView(e),this.relatedItemTabs.push(t)})}routeToDetailsView(e){this.objectDetailsService.showObjectDetailsForm(this.filterService.createLinkOdataQueryFilter(this.getDataSource(e),e.parentTab.parentOBID,e.parentTab.parentRelDef,void 0),e.object.OBID,this.configService.selectedQueryConfigs,e.parentTab.columnSetUID)}getDataSource(e){const t=new kendo.data.DataSource,i=new h.a,a=[new c.a(e.parentTab.state.sort[0].field,e.parentTab.state.sort[0].dir)];return t.filter(i),t.page=()=>e.parentTab.currentPageNumber,t.sort=()=>a,t}}return e.\u0275fac=function(t){return new(t||e)(m.Sb(f.a),m.Sb(r.a),m.Sb(l.a),m.Sb(u.a),m.Sb(d.a),m.Sb(m.h),m.Sb(n.a))},e.\u0275cmp=m.Mb({type:e,selectors:[["sda-object-details"]],inputs:{id:"id",config:"config",methodOBID:"methodOBID",showTodoListForm:"showTodoListForm"},features:[m.Cb],decls:3,vars:3,consts:[[3,"message","centered",4,"ngIf"],["class","object-details",3,"object-details--fixed-height",4,"ngIf"],[3,"tabs",4,"ngIf"],[3,"message","centered"],[1,"object-details"],[3,"form","isEditable"],[3,"tabs"]],template:function(e,t){1&e&&(m.Sc(0,E,1,2,"sda-loading-indicator",0),m.Sc(1,O,2,4,"div",1),m.Sc(2,v,1,1,"sda-related-items-section",2)),2&e&&(m.sc("ngIf",!t.initialized),m.Eb(1),m.sc("ngIf",t.initialized),m.Eb(1),m.sc("ngIf",t.initialized&&t.relatedItemTabs.length>0))},directives:[b.t,g.a,S.a,T.a],styles:[".object-details[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]{display:flex;flex:1;flex-direction:column;height:100%}.object-details[_ngcontent-%COMP%]{display:flex;flex:1 1 100%;flex-direction:column;border-bottom:1px solid #cad0d7}"]}),e})()},K9v4:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var a=i("ofXK"),s=i("3Pt+"),n=i("tyNb"),o=i("F+hv"),r=i("txXS"),l=i("Tfoa"),c=i("uD/B"),d=i("BLqR"),h=i("+T9e"),p=i("fXoL"),f=i("TLn4"),u=i("ue3H"),m=i("qx4N"),b=i("+qkj"),g=i("RY2J"),S=i("HDO1"),T=i("4dwF"),E=i("dLJk"),O=i("F8dI"),v=i("rrPm"),I=i("8OmR"),D=i("ltBE"),C=i("XwBL");let y=(()=>{class e{transform(e){return C.a.replaceUnderscore(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=p.Rb({name:"sdaFormatEntityType",type:e,pure:!0}),e})();var _=i("7Ihv");let w=(()=>{class e{}return e.\u0275mod=p.Qb({type:e}),e.\u0275inj=p.Pb({factory:function(t){return new(t||e)},imports:[[a.c,s.j,r.a,n.k,o.a,c.a,l.a]]}),e})();p.Nc(d.a,[a.q,a.r,a.s,a.t,a.A,a.w,a.x,a.y,a.z,a.u,a.v,s.F,s.u,s.E,s.c,s.v,s.y,s.a,s.B,s.C,s.x,s.p,s.q,s.A,s.l,s.k,s.w,s.b,s.d,s.s,s.t,s.r,n.l,n.h,n.j,n.i,n.n,f.a,u.a,m.a,b.a,h.a,d.a],[a.b,a.G,a.p,a.k,a.E,a.g,a.C,a.F,a.d,a.f,a.i,a.j,a.l,g.a,S.a,T.a,E.a,O.a,v.a,I.a,D.a,y,_.a])},"T6+9":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var a=i("ofXK"),s=i("0IaG"),n=i("NFeN"),o=i("8yBR"),r=i("l3mi"),l=i("F+hv"),c=i("fXoL");let d=(()=>{class e{}return e.\u0275mod=c.Qb({type:e}),e.\u0275inj=c.Pb({factory:function(t){return new(t||e)},imports:[[a.c,o.e,n.b,l.a,s.e,r.a]]}),e})()},W5dB:function(e,t,i){"use strict";i.r(t),i.d(t,"EditWizardObjRoutingModule",(function(){return ee}));var a=i("K9v4"),s=i("ofXK"),n=i("uD/B"),o=i("XS8G"),r=i("F+hv"),l=i("uJvP"),c=i("0Ndu"),d=i("mQCr"),h=i("fXoL");let p=(()=>{class e{}return e.\u0275mod=h.Qb({type:e}),e.\u0275inj=h.Pb({factory:function(t){return new(t||e)},imports:[[s.c,r.a,c.a,n.a,l.a,o.a,d.a]]}),e})();var f=i("tyNb"),u=i("5iMO"),m=i("quZr"),b=i("IzEk"),g=i("eIep"),S=i("YwUS"),T=i("S2YF"),E=i("11V9"),O=i("UVhF"),v=i("cyhI"),I=i("zuZ1"),D=i("Z9D8"),C=i("LUpO"),y=i("C4gn"),_=i("xc+7"),w=i("c+03"),R=i("jNCI"),F=i("I2fW"),N=i("wpY2"),P=i("iwlc"),x=i("XpAN"),L=i("CymU"),M=i("Ejbi"),A=i("NEWU"),j=i("41Lq"),U=i("ONOH");class z{constructor(){this.relationships=[],this.editedColumnData=[]}}var k=i("TLn4"),B=i("pEK1"),X=i("Jgl7"),Y=i("ouxa"),V=i("qx4N"),K=i("L18N"),W=i("HXFx");function J(e,t){if(1&e&&h.Tb(0,"sda-loading-indicator",2),2&e){const e=h.lc();h.sc("centered",!0)("message",e.LOADING_FORM_PLEASE_WAIT)}}function G(e,t){if(1&e){const e=h.Zb();h.Yb(0,"uxt-wizard-step",13),h.Yb(1,"sda-form-relation-step-view",14),h.hc("isDocumentRelated",(function(t){return h.Kc(e),h.lc(3).setAndUpdateDocumentRelation(t)}))("setRelationData",(function(t){return h.Kc(e),h.lc(3).setRelationData(t)}))("setFileType",(function(t){return h.Kc(e),h.lc(3).setFileType(t)}))("editedColumnEmitter",(function(t){return h.Kc(e),h.lc(3).editedColumnEmitter(t)})),h.Xb(),h.Xb()}if(2&e){const e=h.lc(3);h.sc("stepId",e.formRelationStep.name),h.Eb(1),h.sc("relDefForWizard",e.relDefForWizard)("interfaceDefFilterColumnSet",e.interfaceDefFilterColumnSet)("updateOBID",e.objectOBID)("displayItemNavigationPath",e.displayItemNavigationPath)("linkPropertyList",e.linkPropertyList)}}function q(e,t){if(1&e&&(h.Yb(0,"div",15),h.Tb(1,"sda-tabbed-grid-view",16),h.Xb()),2&e){const e=h.lc(3);h.Eb(1),h.sc("tabs",e.relatedItemTabs)("openInfoMapInNewTab",!0)("showItemCount",!0)}}function Q(e,t){if(1&e){const e=h.Zb();h.Yb(0,"uxt-wizard",5),h.hc("finish",(function(){return h.Kc(e),h.lc(2).updateObject()}))("cancel",(function(){return h.Kc(e),h.lc(2).cancelWizard()}))("stepChange",(function(t){return h.Kc(e),h.lc(2).stepChange(t)})),h.Yb(1,"div",6),h.Tb(2,"sda-object-icon",7),h.Yb(3,"div",8),h.Uc(4),h.Xb(),h.Xb(),h.Yb(5,"uxt-wizard-step",9),h.Tb(6,"sda-form-controls",10),h.Xb(),h.Sc(7,G,2,6,"uxt-wizard-step",11),h.Sc(8,q,2,3,"div",12),h.Xb()}if(2&e){const e=h.lc(2);h.sc("finishText",e.UPDATE)("applyText",e.APPLY_TEXT)("cancelText",e.CANCEL_TEXT)("stepTranslation",e.STEP_TEXT)("ofTranslation",e.OF_TEXT)("step",e.stepName)("isNextEnabled",e.isNextEnabled),h.Eb(2),h.sc("imageName",e.objectIcon),h.Eb(1),h.sc("title",e.formPageTitle),h.Eb(1),h.Vc(e.formPageTitle),h.Eb(1),h.sc("stepId",e.updateForm)("isMandatory",!0),h.Eb(1),h.sc("form",e.form),h.Eb(1),h.sc("ngIf",e.formRelationStep.showStep),h.Eb(1),h.sc("ngIf",e.initialized&&e.relatedItemTabs.length>0)}}function Z(e,t){if(1&e&&(h.Yb(0,"div",3),h.Sc(1,Q,9,15,"uxt-wizard",4),h.Xb()),2&e){const e=h.lc();h.Eb(1),h.sc("ngIf",e.initialized)}}const H=[{path:"",component:(()=>{class e extends v.a{constructor(e,t,i,a,s,n,o,r,l,c,d,h,p,f,u,m,b,g,S){super(e,t,i,a,s,n,o,r,l,c,d,h,p,f,u,m,b,g),this.routeService=e,this.route=t,this.formService=i,this.applicationSettingsService=a,this.notificationService=s,this.exceptionService=n,this.loadingOverlayService=o,this.modalService=r,this.formValidationService=l,this.saveChangesDialogService=c,this.sdaTranslateService=d,this.helpService=h,this.featureSetService=p,this.featureSetNavigationService=f,this.relationshipMaintenanceService=u,this.objectIconService=m,this.configService=b,this.iconService=g,this.formRelationStepService=S,this.updateForm="form",this.validateRelationStepGrid=!1,this.relationItems=new z,this.editableColumnData=[],this.isAllEditableColumnSet=!1,this.isAnyMandatory=!1,this.FORM_RELATION_STEP_FILE_TYPE_NOT_SELECTED=this.sdaTranslateService.get("FORM_RELATION_STEP_FILE_TYPE_NOT_SELECTED","The file type for some of the attached documents is not defined. To proceed, select at least one file type."),this.FORM_RELATION_STEP_MANDATORY_COLUMN_NOT_SELECTED=this.sdaTranslateService.get("FORM_RELATION_STEP_MANDATORY_COLUMN_NOT_SELECTED","One or more of the mandatory columns is not defined. To proceed, select at least one value."),this.paramMapSubscription=this.route.paramMap.subscribe(e=>{this.setupFormRelationParameter(e.get(A.l),e.get(A.m)),this.formRelationStep.relDefUID=e.get(A.n),this.displayItemNavigationPath=e.get(A.o),e.has(A.p)&&(this.linkPropertyList=e.get(A.p).split(","))})}updateObject(){this.onBeforeUpdate();let e=this.onValidateBeforeUpdate();e.length||(e=this.validateForm()),e.length?this.modalService.multiMessageAlert(e):(this.loadingOverlayService.showLoadingOverlay(),this.relateEditableColumnData(),this.formRelationStep.url?this.updateWithFormRelationRelation():this.updateWithFormRelation())}updateWithFormRelationRelation(){this.formRelationStepService.getIntermediateObids(this.formRelationStep.url,"EDG_VersionMaster").pipe(Object(b.a)(1),Object(g.a)(e=>(this.relationItems.masterObids=e,this.relationItems.formrelationStep=this.formRelationStep,this.formService.updateObjectFromForm(this.form,this.objectOBID,this.additionalRelDisplayItems,this.relationItems)))).subscribe(e=>{this.handleUpdateSuccess(e)},e=>{this.handleUpdateError(e)})}updateWithFormRelation(){this.formService.updateObjectFromForm(this.form,this.objectOBID,this.additionalRelDisplayItems,this.relationItems).pipe(Object(b.a)(1)).subscribe(e=>{this.handleUpdateSuccess(e)},e=>{this.handleUpdateError(e)})}ngOnDestroy(){super.ngOnDestroy(),this.paramMapSubscription&&this.paramMapSubscription.unsubscribe()}setRelationData(e){this.formRelationStep.url=e.url,this.formRelationStep.otherEndObid=e.obid,this.formRelationStep.isValid=e.isChekedAll}stepChange(e){this.stepName=e,this.updateStepValidity(),this.formRelationStep.showStep&&this.displayItemNavigationPath&&this.stepName===this.formRelationStep.name&&this.formRelationStepService.getUpdatedDisplayItem(this.form)}updateStepValidity(){this.isNextEnabled=this.isStepValid()}isStepValid(){let e=!1;return"form"===this.stepName&&(e=!0),e}setAndUpdateDocumentRelation(e){e.relDefName&&(this.relationItems.relDefUID=e.relDefName.substring(1),this.relationItems.navigationPath=e.relDefName.startsWith("+")),(e.obids&&e.obids.length>0||e.updateObids&&e.updateObids.length>0)&&(this.relationItems.relationships=this.selectedItemsChanged(e.obids,e.updateObids))}formValueChanged(e){}setFileType(e){const t=Object.values(e);this.relationItems.relationships.map(e=>{e.linkProperties=new Map,t.filter(t=>e.Key===t.obid).forEach(t=>{e.linkProperties.set(t.propertyUID,t.isCheked?"True":"False")})})}selectedItemsChanged(e,t){const i=[];return e&&e.forEach(e=>{t&&-1!==t.lastIndexOf(e)?i.push({Key:e,Value:"",DisplayAs:"",Config:"",Terminate:!1,Existing:!0}):i.push({Key:e,Value:"",DisplayAs:"",Config:"",Terminate:!1,Existing:!1})}),t&&t.forEach(e=>{-1===i.map(e=>e.Key).indexOf(e)&&i.push({Key:e,Value:"",DisplayAs:"",Config:"",Terminate:!0,Existing:!0})}),i}editedColumnEmitter(e){this.editableColumnData=e.editableColumns,this.isAllEditableColumnSet=e.isValid,this.isAnyMandatory=e.isAnyMandatory}onValidateBeforeUpdate(){const e=[];if(void 0!==this.linkPropertyList&&this.linkPropertyList.length>0){let t=!1;if(this.relationItems.relationships.map(e=>{if(e.linkProperties){const i=[...e.linkProperties.values()];void 0!==i&&i.length>0&&(i.some(e=>"True"===e)||(t=!0))}}),t)return e.push(this.FORM_RELATION_STEP_FILE_TYPE_NOT_SELECTED),e}if(this.editableColumnData.length>0&&this.isAnyMandatory){if(!this.isAllEditableColumnSet)return e.push(this.FORM_RELATION_STEP_MANDATORY_COLUMN_NOT_SELECTED),e;{let t=!1;if(this.editableColumnData.forEach(e=>{!0===e.isMandatory&&"-"===e.value&&(t=!0)}),t)return e.push(this.FORM_RELATION_STEP_MANDATORY_COLUMN_NOT_SELECTED),e}}return e}setupFormRelationParameter(e,t){e&&t&&(this.formRelationStep.showStep=!0,this.relDefForWizard=e,this.interfaceDefFilterColumnSet=t)}handleUpdateSuccess(e){e&&(this.notificationService.success(this.FORM_OBJECT_UPDATED_SUCCESS),this.cancelWizard(!0)),this.loadingOverlayService.hideLoadingOverlay()}handleUpdateError(e){e&&(this.exceptionService.handleException(new D.a(e,this.FORM_UPDATE_OBJECT_ERROR,"edit-obj-base.component","editObject")),this.loadingOverlayService.hideLoadingOverlay()),this.loadingOverlayService.hideLoadingOverlay()}onBeforeUpdate(){"form"===this.stepName&&this.formRelationStep.showStep&&this.formRelationStep.url&&this.formRelationStepService.getUpdatedDisplayItem(this.form)}relateEditableColumnData(){this.editableColumnData.length>0&&this.relationItems.relationships.length>0&&this.editableColumnData.forEach(e=>{e.editedColumnDetails&&e.editedColumnDetails.length>0&&e.editedColumnDetails.forEach(e=>{this.relationItems.editedColumnData.push({thisEndObid:e.thisEndObid,otherEndObid:e.otherEndObid,relDef:e.relDef,direction:e.direction,isTerminate:e.isTerminate})})})}}return e.\u0275fac=function(t){return new(t||e)(h.Sb(L.a),h.Sb(f.a),h.Sb(O.a),h.Sb(S.a),h.Sb(j.a),h.Sb(C.a),h.Sb(w.a),h.Sb(R.a),h.Sb(E.a),h.Sb(N.a),h.Sb(M.a),h.Sb(P.a),h.Sb(_.a),h.Sb(y.a),h.Sb(T.a),h.Sb(F.a),h.Sb(U.a),h.Sb(x.a),h.Sb(I.a))},e.\u0275cmp=h.Mb({type:e,selectors:[["sda-edit-wizard-obj-view"]],features:[h.Db([T.a]),h.Bb],decls:2,vars:2,consts:[["class","wc-background",3,"centered","message",4,"ngIf"],["class","form-wrapper",4,"ngIf"],[1,"wc-background",3,"centered","message"],[1,"form-wrapper"],[3,"finishText","applyText","cancelText","stepTranslation","ofTranslation","step","isNextEnabled","finish","cancel","stepChange",4,"ngIf"],[3,"finishText","applyText","cancelText","stepTranslation","ofTranslation","step","isNextEnabled","finish","cancel","stepChange"],[1,"uxt-wizard-header"],[1,"update-form-icon",3,"imageName"],[1,"update-form-title",3,"title"],[3,"stepId","isMandatory"],[3,"form"],[3,"stepId",4,"ngIf"],["class","uxt-wizard-bottom-content",4,"ngIf"],[3,"stepId"],[3,"relDefForWizard","interfaceDefFilterColumnSet","updateOBID","displayItemNavigationPath","linkPropertyList","isDocumentRelated","setRelationData","setFileType","editedColumnEmitter"],[1,"uxt-wizard-bottom-content"],[3,"tabs","openInfoMapInNewTab","showItemCount"]],template:function(e,t){1&e&&(h.Sc(0,J,1,2,"sda-loading-indicator",0),h.Sc(1,Z,2,1,"div",1)),2&e&&(h.sc("ngIf",!t.initialized),h.Eb(1),h.sc("ngIf",t.initialized))},directives:[s.t,k.a,B.a,X.a,Y.a,V.a,K.a,W.a],styles:["[_nghost-%COMP%]{overflow:hidden}[_nghost-%COMP%], [_nghost-%COMP%]   .form-wrapper[_ngcontent-%COMP%]{display:flex;width:100%;height:100%}[_nghost-%COMP%]   .form-wrapper[_ngcontent-%COMP%]{flex-direction:column;align-items:center;background-color:#cad0d7}[_nghost-%COMP%]   sda-loading-indicator[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]     sda-tabbed-grid{position:relative;padding:7px}","[_nghost-%COMP%]   .update-form-title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}[_nghost-%COMP%]   .uxt-wizard-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:20px 50px 10px}[_nghost-%COMP%]   .update-form-icon[_ngcontent-%COMP%]{flex-shrink:0}[_nghost-%COMP%]   .update-form-icon[_ngcontent-%COMP%]     .object-icon{width:30px;height:30px;margin:0 10px}[_nghost-%COMP%]   .update-form-title[_ngcontent-%COMP%]{font-size:20px;font-weight:500}"]}),e})(),resolve:{objects:u.a},canDeactivate:[m.a]}];let $=(()=>{class e{}return e.\u0275mod=h.Qb({type:e}),e.\u0275inj=h.Pb({factory:function(t){return new(t||e)},imports:[[f.k.forChild(H)],f.k]}),e})(),ee=(()=>{class e{}return e.\u0275mod=h.Qb({type:e}),e.\u0275inj=h.Pb({factory:function(t){return new(t||e)},imports:[[$,p,a.a]]}),e})()},d74k:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));class a{constructor(e,t){this.field=e,this.dir=t}}},ltBE:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var a=i("fXoL");let s=(()=>{class e{transform(e,t,i){return e?i?e.filter(e=>e[t].toLowerCase().includes(i.toLowerCase())):e:[]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=a.Rb({name:"sdaFilter",type:e,pure:!0}),e})()}}]);